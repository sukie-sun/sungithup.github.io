<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Sparkå­¦ä¹ ]]></title>
    <url>%2F2019%2F02%2F16%2FSpark%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Sparkç®€ä»‹1ã€ä»€ä¹ˆæ˜¯Sparkï¼Ÿ Apache Spark æ˜¯ä¸“ä¸ºå¤§è§„æ¨¡æ•°æ®å¤„ç†è€Œè®¾è®¡çš„å¿«é€Ÿé€šç”¨çš„è®¡ç®—å¼•æ“Žã€‚ å¤§æ•°æ®åˆ†æžå¼•æ“Žï¼šè®¡ç®—æ¡†æž¶ Jobçš„ä¸­é—´ç»“æžœå¯ä»¥ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸éœ€è¦è¯»å–HDFS èƒ½æ›´å¥½çš„çš„é€‚ç”¨äºŽæ•°æ®æŒ–æŽ˜ä¸Žæœºå™¨å­¦ä¹ ç­‰éœ€è¦è¿­ä»£çš„ç®—æ³• å¿«é€Ÿï¼ˆ100å€ï¼‰:ç”¨äºŽé€»è¾‘å›žå½’ç®—æ³•ï¼ˆæœºå™¨å­¦ä¹ ï¼‰,è¿­ä»£ç®—æ³•ï¼ˆåœ¨è®¡ç®—ç»“æžœçš„åŸºç¡€ä¸Šå†è®¡ç®—ï¼‰æ—¶ï¼šä¸­é—´ç»“æžœå€¼åœ¨å†…å­˜ä¸­æµè½¬ï¼Œå±è”½ç£ç›˜å¼€é”€ï¼›DAGè°ƒåº¦ mrï¼šç¦»çº¿ï¼Œï¼ˆè¿­ä»£æ—¶ï¼šç£ç›˜IOï¼Œè¾ƒæ…¢ï¼‰ stormï¼šæµå¼ Sparkæ˜¯ç”¨Scalaç¼–å†™çš„ï¼Œæ–¹ä¾¿å¿«é€Ÿç¼–ç¨‹ 2ã€ä¸ŽMapReduceçš„åŒºåˆ« MapReduce Spark åŒºåˆ«ï¼š åŒï¼šåˆ†å¸ƒå¼è®¡ç®—æ¡†æž¶ ä¸åŒï¼š SparkåŸºäºŽå†…å­˜ï¼ŒMRåŸºäºŽHDFS Sparkå¤„ç†æ•°æ®çš„èƒ½åŠ›æ˜¯MRçš„åå€ä»¥ä¸Š Sparké™¤äº†åŸºäºŽå†…å­˜è®¡ç®—ä¹‹å¤–ï¼Œè¿˜æœ‰DAGæœ‰å‘æ— çŽ¯å›¾æ¥åˆ‡åˆ†ä»»åŠ¡çš„æ‰§è¡Œé¡ºåº Spark API çš„ä½¿ç”¨è¯­è¨€ Scalaï¼ˆå¾ˆå¥½ï¼‰Python(ä¸é”™)Java(â€¦) 3ã€Sparkè¿è¡Œæ¨¡å¼ local å¤šç”¨äºŽæœ¬åœ°æµ‹è¯•ï¼Œå¦‚åœ¨ eclipseï¼Œidea ä¸­å†™ç¨‹åºæµ‹è¯• standalone standaloneæ˜¯Sparkè‡ªå¸¦çš„èµ„æºè°ƒåº¦æ¡†æž¶ï¼Œå®ƒæ”¯æŒå®Œå…¨åˆ†å¸ƒå¼ yarn Hadoopç”Ÿæ€åœˆçš„èµ„æºè°ƒåº¦æ¡†æž¶ï¼ŒSparkä¹Ÿæ˜¯å¯ä»¥åŸºäºŽyarnæ¥è®¡ç®—çš„ åŸºäºŽyarnæ¥è¿›è¡Œèµ„æºè°ƒåº¦ï¼Œå¿…é¡»å®žçŽ°ApplicationMasteræŽ¥å£ï¼ŒSparkå®žçŽ°çš„è¿™ä¸ªæŽ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ mesos èµ„æºè°ƒåº¦æ¡†æž¶ äºŒã€Sparkcore1ã€RDDï¼ˆ1ï¼‰æ¦‚å¿µï¼šRDD(Resilient Distributed Dateset)å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›† ï¼ˆ2ï¼‰äº”å¤§ç‰¹æ€§ RDD æ˜¯ç”±ä¸€ç³»åˆ—çš„ partition ç»„æˆçš„ã€‚ å‡½æ•°æ˜¯ä½œç”¨åœ¨æ¯ä¸€ä¸ª partitionï¼ˆsplitï¼‰ä¸Šçš„ã€‚ RDD ä¹‹é—´æœ‰ä¸€ç³»åˆ—çš„ä¾èµ–å…³ç³»ã€‚ åˆ†åŒºå™¨æ˜¯ä½œç”¨åœ¨ K,V æ ¼å¼çš„ RDD ä¸Šã€‚ RDD æä¾›ä¸€ç³»åˆ—æœ€ä½³çš„è®¡ç®—ä½ç½®ã€‚ ï¼ˆ3ï¼‰RDDç†è§£å›¾ ç†è®ºæ³¨è§£ 1ï¸âƒ£ RDD å®žé™…ä¸Šä¸å­˜å‚¨æ•°æ®ï¼Œè¿™é‡Œæ–¹ä¾¿ç†è§£ï¼Œæš‚æ—¶ç†è§£ä¸ºå­˜å‚¨æ•°æ®ã€‚ 2ï¸âƒ£ textFile æ–¹æ³•åº•å±‚å°è£…çš„æ˜¯MR è¯»å–æ–‡ä»¶çš„æ–¹å¼ï¼Œè¯»å–æ–‡ä»¶ä¹‹å‰å…ˆ splitï¼Œé»˜è®¤ split å¤§å°æ˜¯ä¸€ä¸ª block å¤§å°ã€‚ 3ï¸âƒ£RDD æä¾›è®¡ç®—æœ€ä½³ä½ç½®ï¼Œä½“çŽ°äº†æ•°æ®æœ¬åœ°åŒ–ã€‚ä½“çŽ°äº†å¤§æ•°æ®ä¸­â€œè®¡ç®—ç§»åŠ¨æ•°æ®ä¸ç§»åŠ¨â€çš„ç†å¿µã€‚ â” å“ªé‡Œä½“çŽ° RDD çš„åˆ†å¸ƒå¼ï¼Ÿ ðŸ‘† RDD æ˜¯ç”± Partition ç»„æˆï¼Œpartition æ˜¯åˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šçš„ã€‚ â” å“ªé‡Œä½“çŽ° RDD çš„å¼¹æ€§ï¼ˆå®¹é”™ï¼‰ï¼Ÿ ðŸ‘† partition æ•°é‡ï¼Œå¤§å°æ²¡æœ‰é™åˆ¶,é»˜è®¤å’Œsplitï¼ˆblockï¼‰ä¸€è‡´ï¼Œä½“çŽ°äº† RDD çš„å¼¹æ€§ã€‚ðŸ‘† RDD ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œå¯ä»¥åŸºäºŽä¸Šä¸€ä¸ª RDD é‡æ–°è®¡ç®—å‡º RDDã€‚ â” ä»€ä¹ˆæ˜¯ K,V æ ¼å¼çš„ RDD? ðŸ‘† å¦‚æžœ RDD é‡Œé¢å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯äºŒå…ƒç»„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ª RDD æˆ‘ä»¬å°±å«åš K,V æ ¼å¼çš„ RDDã€‚ ðŸ‘† MRæœ‰åˆ†åŒºå™¨ï¼ˆæ ¹æ®keyå€¼æ±‚hashï¼Œæ¥å†³å®šæ•°æ®å­˜æ”¾åœ¨å“ªä¸ªåˆ†åŒºä¸­ï¼Œæ‰€ä»¥åˆ†åŒºå™¨å¿…é¡»ä½œç”¨åœ¨Kï¼ŒVæ ¼å¼çš„RDDä¸Šï¼‰ 2ã€Sparkä»»åŠ¡æ‰§è¡ŒåŽŸç† Driverï¼šï¼ˆç›¸å½“äºŽApplicationMasterï¼‰ Workerï¼šï¼ˆç›¸å½“äºŽNodeManagerï¼‰ ä»¥ä¸Šå›¾ä¸­æœ‰å››ä¸ªæœºå™¨èŠ‚ç‚¹ï¼Œ Driver å’Œ Worker æ˜¯å¯åŠ¨åœ¨èŠ‚ç‚¹ä¸Šçš„è¿›ç¨‹ï¼Œè¿è¡Œåœ¨ JVM ä¸­çš„è¿›ç¨‹ã€‚ïƒ˜ Driver ä¸Žé›†ç¾¤èŠ‚ç‚¹ä¹‹é—´æœ‰é¢‘ç¹çš„é€šä¿¡ã€‚ïƒ˜ Driverï¼šä»»åŠ¡çš„è°ƒåº¦ï¼ˆç›‘æŽ§ä»»åŠ¡ã€ è´Ÿè´£ä»»åŠ¡(tasks)çš„åˆ†å‘å’Œç»“æžœçš„å›žæ”¶ï¼‰ã€‚å¦‚æžœ taskçš„è®¡ç®—ç»“æžœéžå¸¸å¤§å°±ä¸è¦å›žæ”¶äº†ã€‚ä¼šé€ æˆ oomã€‚ïƒ˜ Worker æ˜¯ Standalone èµ„æºè°ƒåº¦æ¡†æž¶é‡Œé¢èµ„æºç®¡ç†çš„ä»ŽèŠ‚ç‚¹ã€‚ä¹Ÿæ˜¯JVM è¿›ç¨‹ã€‚ïƒ˜ Master æ˜¯ Standalone èµ„æºè°ƒåº¦æ¡†æž¶é‡Œé¢èµ„æºç®¡ç†çš„ä¸»èŠ‚ç‚¹ã€‚ä¹Ÿæ˜¯JVM è¿›ç¨‹ã€‚ 3ã€Sparkä»£ç æµç¨‹ä»¥ç”¨Scalaç¼–å†™WordCountä¸ºä¾‹1ã€åˆ›å»º SparkConf å¯¹è±¡ïƒ˜ å¯ä»¥è®¾ç½® Application nameã€‚ïƒ˜ å¯ä»¥è®¾ç½®è¿è¡Œæ¨¡å¼åŠèµ„æºéœ€æ±‚ã€‚ 123456789val conf = new SparkConf() /** * å‡ ç§è¿è¡Œæ–¹å¼ï¼š * 1.æœ¬åœ°è¿è¡Œ * 2.yarn * 3.standalone * 4.mesos */ conf.setMaster("local").setAppName("wc") 2ã€åˆ›å»º SparkContext å¯¹è±¡ 1val context = new SparkContext(conf) 3ã€åŸºäºŽ Spark çš„ä¸Šä¸‹æ–‡åˆ›å»ºä¸€ä¸ª RDDï¼Œå¯¹ RDD è¿›è¡Œå¤„ç†ã€‚ 12345678910//èŽ·å–æ–‡ä»¶ä¸­æ¯ä¸€è¡Œæ•°æ®çš„ADD val lineADD = context.textFile("./wc.txt")//èŽ·å–æ¯ä¸€è¡Œæ•°æ®æŒ‰ç©ºæ ¼åˆ‡åˆ†åŽçš„ADD val wordADD = lineADD.flatMap(x=&gt;&#123;x.split(" ")&#125;)//èŽ·å–æ¯ä¸ªå•è¯åŠ ä¸Š,1 åŽçš„ADDï¼ˆK,Væ ¼å¼ï¼‰ val KVADD = wordADD.map(x=&gt;&#123;(x,1)&#125;)//èŽ·å–å°†ç›¸åŒkeyçš„valueç›¸åŠ åŽçš„ADDï¼ˆK,Væ ¼å¼ï¼‰ï¼Œç›¸å½“äºŽTuple2 val resultADD = KVADD.reduceByKey((x,y)=&gt;&#123;x+y&#125;)//é™åºæŽ’åº val sortADD = resultADD.sortBy(_._2,false) 4ã€åº”ç”¨ç¨‹åºä¸­è¦æœ‰ Action ç±»ç®—å­æ¥è§¦å‘ Transformation ç±»ç®—å­æ‰§è¡Œã€‚ 1sortADD.foreach(println) 5ã€å…³é—­ Spark ä¸Šä¸‹æ–‡å¯¹è±¡ SparkContextã€‚ 1context.stop() 4ã€Transformations è½¬æ¢ç®—å­ï¼ˆ1ï¼‰æ¦‚å¿µTransformations ç±»ç®—å­æ˜¯ä¸€ç±»ç®—å­ï¼ˆå‡½æ•°ï¼‰å«åšè½¬æ¢ç®—å­ï¼Œå¦‚map,flatMap,reduceByKey ç­‰ã€‚Transformations ç®—å­æ˜¯å»¶è¿Ÿæ‰§è¡Œï¼Œä¹Ÿå«æ‡’åŠ è½½æ‰§è¡Œã€‚ æœ‰actionè§¦å‘ç®—å­ä»»åŠ¡æ‰èƒ½æäº¤ï¼Œæ‰ä¼šæ‰§è¡Œrunjob ç®—å­å¿…é¡»ä½œç”¨åœ¨RDDä¸Š ï¼ˆ2ï¼‰Transformation ç±»ç®—å­ :arrow_up_small: filterè¿‡æ»¤ç¬¦åˆæ¡ä»¶çš„è®°å½•æ•°ï¼Œtrue ä¿ç•™ï¼Œfalse è¿‡æ»¤æŽ‰ã€‚ ðŸ”¼ contains ä½œä¸ºæ¡ä»¶ï¼Œæ˜¯å¦åŒ…å«ï¼Œè¿”å›žtrue|false :arrow_up_small:mapå°†ä¸€ä¸ª RDD ä¸­çš„æ¯ä¸ªæ•°æ®é¡¹ï¼Œé€šè¿‡ map ä¸­çš„å‡½æ•°æ˜ å°„å˜ä¸ºä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚ç‰¹ç‚¹ï¼šè¾“å…¥ä¸€æ¡ï¼Œè¾“å‡ºä¸€æ¡æ•°æ®ã€‚ :arrow_up_small: flatMapå…ˆ map åŽ flatã€‚ä¸Ž map ç±»ä¼¼ï¼Œæ¯ä¸ªè¾“å…¥é¡¹å¯ä»¥æ˜ å°„ä¸º 0 åˆ°å¤šä¸ªè¾“å‡ºé¡¹ã€‚ :arrow_up_small:sampleéšæœºæŠ½æ ·ç®—å­ï¼Œæ ¹æ®ä¼ è¿›åŽ»çš„å°æ•°æŒ‰æ¯”ä¾‹è¿›è¡Œï¼Œæœ‰æ”¾å›žæˆ–è€…æ— æ”¾å›žçš„æŠ½æ ·ã€‚ :arrow_up_small:reduceByKeyå°†ç›¸åŒçš„ Key æ ¹æ®ç›¸åº”çš„é€»è¾‘è¿›è¡Œå¤„ç†ã€‚ :arrow_up_small:sortByKey/sortByä½œç”¨åœ¨ K,V æ ¼å¼çš„ RDD ä¸Šï¼Œå¯¹ key è¿›è¡Œå‡åºæˆ–è€…é™åºæŽ’åºã€‚ 1234567891011121314151617181920212223242526272829303132object WordCount &#123; def main(args: Array[String]): Unit = &#123; val conf = new SparkConf() conf.setMaster("local").setAppName("WC") val context = new SparkContext(conf) //ç”¨äºŽäº†è§£é›†ç¾¤ val linesRDD :RDD[String] = sc.textFile("./words.txt") // lineRDD.filter(x=&gt;&#123;// x.contains("sh")// &#125;).foreach(println)// lineRDD.sample(true,0.2).foreach(println) // lineRDD.map((_,1)).reduceByKey(_ + _).sortBy(_._2,false).foreach(println)// lineRDD.map((_,1)).sortByKey().foreach(println) val wordRDD :RDD[String] = linesRDD.flatMap&#123;lines =&gt; &#123; lines.split(" ") //åŒ¿åå‡½æ•° &#125;&#125; val KVRDD:RDD[(String,Int)] = wordRDD.map&#123; x =&gt; (x,1) &#125; val result:RDD[(String,Int)] = KVRDD.reduceByKey&#123;(a,b)=&gt; &#123; println("a:"+a+",b:"+b) a+b &#125;&#125; 5ã€Action è¡ŒåŠ¨ç®—å­ï¼ˆ1ï¼‰æ¦‚å¿µAction ç±»ç®—å­ä¹Ÿæ˜¯ä¸€ç±»ç®—å­ï¼ˆå‡½æ•°ï¼‰å«åšè¡ŒåŠ¨ç®—å­ï¼Œå¦‚foreach,collectï¼Œcount ç­‰ã€‚ Transformations ç±»ç®—å­æ˜¯å»¶è¿Ÿæ‰§è¡Œï¼ŒAction ç±»ç®—å­æ˜¯è§¦å‘æ‰§è¡Œï¼ˆç«‹å³ï¼‰ã€‚ ä¸€ä¸ª application åº”ç”¨ç¨‹åºä¸­æœ‰å‡ ä¸ª Action ç±»ç®—å­æ‰§è¡Œï¼Œå°±æœ‰å‡ ä¸ª job è¿è¡Œã€‚ ï¼ˆ2ï¼‰Action ç±»ç®—å­ :arrow_up_small: countè¿”å›žæ•°æ®é›†ä¸­çš„å…ƒç´ æ•°ã€‚ä¼šåœ¨ç»“æžœè®¡ç®—å®ŒæˆåŽå›žæ”¶åˆ° Driver ç«¯ã€‚:arrow_up_small: take(n)è¿”å›žä¸€ä¸ªåŒ…å«æ•°æ®é›†å‰ n ä¸ªå…ƒç´ çš„é›†åˆã€‚:arrow_up_small: firstfirst=take(1),è¿”å›žæ•°æ®é›†ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  :arrow_up_small: foreachå¾ªçŽ¯éåŽ†æ•°æ®é›†ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè¿è¡Œç›¸åº”çš„é€»è¾‘ã€‚:arrow_up_small: collectå°†è®¡ç®—ç»“æžœå›žæ”¶åˆ° Driver ç«¯ã€‚ 12345678910111213141516171819 val conf = new SparkConf() conf.setMaster("local").setAppName("transf") val context = new SparkContext(conf) val lineADD = context.textFile("./wc.txt") val wordADD = lineADD.flatMap(x=&gt;&#123;x.split(" ")&#125;) // println(wordADD.count())//lineADDä¸­æ•°æ®å›žæ”¶ val arr= lineADD.collect() arr.foreach(println)// val takes: Array[String] = lineRDD.take(5)// takes.foreach(println)// val str: String = lineRDD.first()// println(str) WordCountä»¥ç”¨Javaç¼–å†™ä¸ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697package com.shsxt.spark.java;import org.apache.spark.SparkConf;import org.apache.spark.api.java.JavaPairRDD;import org.apache.spark.api.java.JavaRDD;import org.apache.spark.api.java.JavaSparkContext;import org.apache.spark.api.java.function.*;import scala.Tuple2;import java.util.Arrays;import java.util.List;public class WordCount &#123; public static void main(String[] args) &#123; SparkConf conf = new SparkConf(); conf.setMaster("local").setAppName("wc"); JavaSparkContext context = new JavaSparkContext(conf); JavaRDD&lt;String&gt; rdd = context.textFile("./wc.txt"); long count = rdd.count(); List&lt;String&gt; collect = rdd.collect(); List&lt;String&gt; take = rdd.take(5); String first = rdd.first(); JavaRDD&lt;String&gt; wordRDD = rdd.flatMap(new FlatMapFunction&lt;String, String&gt;() &#123; @Override public Iterable&lt;String&gt; call(String line) throws Exception &#123; String[] split = line.split(" "); List&lt;String&gt; list = Arrays.asList(split); return list; &#125; &#125;);// wordRDD.map(new Function&lt;String&gt;() &#123;// @Override// public String call(String v1) throws Exception &#123;// return null;// &#125;// &#125;) JavaPairRDD&lt;String, Integer&gt; pairRDD = wordRDD.mapToPair(new PairFunction&lt;String, String, Integer&gt;() &#123; @Override public Tuple2&lt;String, Integer&gt; call(String word) throws Exception &#123; return new Tuple2(word, 1); &#125; &#125;); JavaPairRDD&lt;String, Integer&gt; resultRDD = pairRDD.reduceByKey(new Function2&lt;Integer, Integer, Integer&gt;() &#123; @Override public Integer call(Integer v1, Integer v2) throws Exception &#123; return v1 + v2; &#125; &#125;); JavaPairRDD&lt;Integer, String&gt; reverseRDD = resultRDD.mapToPair(new PairFunction&lt;Tuple2&lt;String, Integer&gt;, Integer, String&gt;() &#123; @Override public Tuple2&lt;Integer, String&gt; call(Tuple2&lt;String, Integer&gt; tuple2) throws Exception &#123; return new Tuple2&lt;&gt;(tuple2._2, tuple2._1); &#125; &#125;); JavaPairRDD&lt;Integer, String&gt; sortByKey = reverseRDD.sortByKey(false); JavaPairRDD&lt;String, Integer&gt; result = sortByKey.mapToPair(new PairFunction&lt;Tuple2&lt;Integer, String&gt;, String, Integer&gt;() &#123; @Override public Tuple2&lt;String, Integer&gt; call(Tuple2&lt;Integer, String&gt; tuple2) throws Exception &#123; return new Tuple2&lt;&gt;(tuple2._2, tuple2._1); &#125; &#125;); result.foreach(new VoidFunction&lt;Tuple2&lt;String, Integer&gt;&gt;() &#123; @Override public void call(Tuple2&lt;String, Integer&gt; tuple2) throws Exception &#123; System.out.println(tuple2); &#125; &#125;); &#125;&#125;]]></content>
      <categories>
        <category>Spark</category>
      </categories>
      <tags>
        <tag>è®¡ç®—å¼•æ“Ž</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Listæ–¹æ³•]]></title>
    <url>%2F2019%2F02%2F16%2FList%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137def +(elem: A): List[A]å‰ç½®ä¸€ä¸ªå…ƒç´ åˆ—è¡¨def ::(x: A): List[A]åœ¨è¿™ä¸ªåˆ—è¡¨çš„å¼€å¤´æ·»åŠ çš„å…ƒç´ ã€‚def :::(prefix: List[A]): List[A]å¢žåŠ äº†ä¸€ä¸ªç»™å®šåˆ—è¡¨ä¸­è¯¥åˆ—è¡¨å‰é¢çš„å…ƒç´ ã€‚def ::(x: A): List[A]å¢žåŠ äº†ä¸€ä¸ªå…ƒç´ xåœ¨åˆ—è¡¨çš„å¼€å¤´def addString(b: StringBuilder): StringBuilderè¿½åŠ åˆ—è¡¨çš„ä¸€ä¸ªå­—ç¬¦ä¸²ç”Ÿæˆå™¨çš„æ‰€æœ‰å…ƒç´ ã€‚def addString(b: StringBuilder, sep: String): StringBuilderè¿½åŠ åˆ—è¡¨çš„ä½¿ç”¨åˆ†éš”å­—ç¬¦ä¸²ä¸€ä¸ªå­—ç¬¦ä¸²ç”Ÿæˆå™¨çš„æ‰€æœ‰å…ƒç´ ã€‚def apply(n: Int): Aé€‰æ‹©é€šè¿‡å…¶åœ¨åˆ—è¡¨ä¸­ç´¢å¼•çš„å…ƒç´ def contains(elem: Any): Booleanæµ‹è¯•è¯¥åˆ—è¡¨ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªç»™å®šå€¼ä½œä¸ºå…ƒç´ ã€‚def copyToArray(xs: Array[A], start: Int, len: Int): Unitåˆ—è¡¨çš„å‰¯æœ¬å…ƒä»¶é˜µåˆ—ã€‚å¡«å……ç»™å®šçš„æ•°ç»„xsä¸Žæ­¤åˆ—è¡¨ä¸­æœ€å¤šlenä¸ªå…ƒç´ ï¼Œåœ¨ä½ç½®å¼€å§‹ã€‚def distinct: List[A]å»ºç«‹ä»Žåˆ—è¡¨ä¸­æ²¡æœ‰ä»»ä½•é‡å¤çš„å…ƒç´ çš„æ–°åˆ—è¡¨ã€‚def drop(n: Int): List[A]è¿”å›žé™¤äº†ç¬¬nä¸ªçš„æ‰€æœ‰å…ƒç´ ã€‚def dropRight(n: Int): List[A]è¿”å›žé™¤äº†æœ€åŽçš„nä¸ªçš„å…ƒç´ def dropWhile(p: (A) =&gt; Boolean): List[A]ä¸¢å¼ƒæ»¡è¶³è°“è¯çš„å…ƒç´ æœ€é•¿å‰ç¼€ã€‚def endsWith[B](that: Seq[B]): Booleanæµ‹è¯•åˆ—è¡¨æ˜¯å¦ä½¿ç”¨ç»™å®šåºåˆ—ç»“æŸã€‚def equals(that: Any): Booleanequalsæ–¹æ³•çš„ä»»æ„åºåˆ—ã€‚æ¯”è¾ƒè¯¥åºåˆ—åˆ°æŸäº›å…¶ä»–å¯¹è±¡ã€‚def exists(p: (A) =&gt; Boolean): Booleanæµ‹è¯•è°“è¯æ˜¯å¦æŒæœ‰ä¸€äº›åˆ—è¡¨çš„å…ƒç´ ã€‚def filter(p: (A) =&gt; Boolean): List[A]è¿”å›žåˆ—è¡¨æ»¡è¶³è°“è¯çš„æ‰€æœ‰å…ƒç´ ã€‚def forall(p: (A) =&gt; Boolean): Booleanæµ‹è¯•è°“è¯æ˜¯å¦æŒæœ‰è¯¥åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚def foreach(f: (A) =&gt; Unit): Unitåº”ç”¨ä¸€ä¸ªå‡½æ•°fä»¥åˆ—è¡¨çš„æ‰€æœ‰å…ƒç´ ã€‚def head: Aé€‰æ‹©åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ def indexOf(elem: A, from: Int): Intç»è¿‡æˆ–åœ¨æŸäº›èµ·å§‹ç´¢å¼•æŸ¥æ‰¾åˆ—è¡¨ä¸­çš„ä¸€äº›å€¼ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„ç´¢å¼•ã€‚def init: List[A]è¿”å›žé™¤äº†æœ€åŽçš„æ‰€æœ‰å…ƒç´ def intersect(that: Seq[A]): List[A]è®¡ç®—åˆ—è¡¨å’Œå¦ä¸€åºåˆ—ä¹‹é—´çš„å¤šé‡é›†äº¤é›†ã€‚def isEmpty: Booleanæµ‹è¯•åˆ—è¡¨æ˜¯å¦ä¸ºç©ºdef iterator: Iterator[A]åˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ä¸­åŒ…å«çš„å¯è¿­ä»£å¯¹è±¡ä¸­çš„æ‰€æœ‰å…ƒç´ def last: Aè¿”å›žæœ€åŽä¸€ä¸ªå…ƒç´ def lastIndexOf(elem: A, end: Int): Intä¹‹å‰æˆ–åœ¨ä¸€ä¸ªç»™å®šçš„æœ€ç»ˆæŒ‡æ•°æŸ¥æ‰¾çš„åˆ—è¡¨ä¸­çš„ä¸€äº›å€¼æœ€åŽä¸€æ¬¡å‡ºçŽ°çš„ç´¢å¼•def length: Intè¿”å›žåˆ—è¡¨çš„é•¿åº¦def map[B](f: (A) =&gt; B): List[B]é€šè¿‡åº”ç”¨å‡½æ•°ä»¥gè¿™ä¸ªåˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ æž„å»ºä¸€ä¸ªæ–°çš„é›†åˆdef max: AæŸ¥æ‰¾æœ€å¤§çš„å…ƒç´ def min: AæŸ¥æ‰¾æœ€å°å…ƒç´ def mkString: Stringæ˜¾ç¤ºåˆ—è¡¨çš„å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å…ƒç´ def mkString(sep: String): Stringæ˜¾ç¤ºçš„åˆ—è¡¨ä¸­çš„å­—ç¬¦ä¸²ä¸­ä½¿ç”¨åˆ†éš”ä¸²çš„æ‰€æœ‰å…ƒç´ def reverse: List[A]è¿”å›žæ–°åˆ—è¡¨ï¼Œåœ¨ç›¸åçš„é¡ºåºå…ƒç´ def sorted[B &gt;: A]: List[A]æ ¹æ®æŽ’åºå¯¹åˆ—è¡¨è¿›è¡ŒæŽ’åºdef startsWith[B](that: Seq[B], offset: Int): Booleanæµ‹è¯•è¯¥åˆ—è¡¨ä¸­æ˜¯å¦åŒ…å«ç»™å®šçš„ç´¢å¼•å¤„çš„ç»™å®šçš„åºåˆ—def sum: Aæ¦‚æ‹¬è¿™ä¸ªé›†åˆçš„å…ƒç´ def tail: List[A]è¿”å›žé™¤äº†ç¬¬ä¸€çš„æ‰€æœ‰å…ƒç´ def take(n: Int): List[A]è¿”å›žå‰nä¸ªå…ƒç´ def takeRight(n: Int): List[A]è¿”å›žæœ€åŽnä¸ªå…ƒç´ def toArray: Array[A]åˆ—è¡¨ä»¥ä¸€ä¸ªæ•°ç»„å˜æ¢def toBuffer[B &gt;: A]: Buffer[B]åˆ—è¡¨ä»¥ä¸€ä¸ªå¯å˜ç¼“å†²å™¨è½¬æ¢def toMap[T, U]: Map[T, U]æ­¤åˆ—è¡¨çš„æ˜ å°„è½¬æ¢def toSeq: Seq[A]åˆ—è¡¨çš„åºåˆ—è½¬æ¢def toSet[B &gt;: A]: Set[B]åˆ—è¡¨åˆ°é›†åˆå˜æ¢def toString(): Stringåˆ—è¡¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>List</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mapæ–¹æ³•]]></title>
    <url>%2F2019%2F02%2F16%2FMap%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138Scala Map æ–¹æ³•ä¸‹è¡¨åˆ—å‡ºäº† Scala Map å¸¸ç”¨çš„æ–¹æ³•ï¼šåºå· æ–¹æ³•åŠæè¿°def ++(xs: Map[(A, B)]): Map[A, B]è¿”å›žä¸€ä¸ªæ–°çš„ Mapï¼Œæ–°çš„ Map xs ç»„æˆdef -(elem1: A, elem2: A, elems: A*): Map[A, B]è¿”å›žä¸€ä¸ªæ–°çš„ Map, ç§»é™¤ key ä¸º elem1, elem2 æˆ–å…¶ä»– elemsã€‚ def --(xs: GTO[A]): Map[A, B]è¿”å›žä¸€ä¸ªæ–°çš„ Map, ç§»é™¤ xs å¯¹è±¡ä¸­å¯¹åº”çš„ keydef get(key: A): Option[B]è¿”å›žæŒ‡å®š key çš„å€¼def iterator: Iterator[(A, B)]åˆ›å»ºæ–°çš„è¿­ä»£å™¨ï¼Œå¹¶è¾“å‡º key/value å¯¹def addString(b: StringBuilder): StringBuilderå°† Map ä¸­çš„æ‰€æœ‰å…ƒç´ é™„åŠ åˆ°StringBuilderï¼Œå¯åŠ å…¥åˆ†éš”ç¬¦def addString(b: StringBuilder, sep: String): StringBuilderå°† Map ä¸­çš„æ‰€æœ‰å…ƒç´ é™„åŠ åˆ°StringBuilderï¼Œå¯åŠ å…¥åˆ†éš”ç¬¦ def apply(key: A): Bè¿”å›žæŒ‡å®šé”®çš„å€¼ï¼Œå¦‚æžœä¸å­˜åœ¨è¿”å›ž Map çš„é»˜è®¤æ–¹æ³•def clone(): Map[A, B]ä»Žä¸€ä¸ª Map å¤åˆ¶åˆ°å¦ä¸€ä¸ª Mapdef contains(key: A): Booleanå¦‚æžœ Map ä¸­å­˜åœ¨æŒ‡å®š keyï¼Œè¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž falseã€‚def copyToArray(xs: Array[(A, B)]): Unitå¤åˆ¶é›†åˆåˆ°æ•°ç»„def count(p: ((A, B)) =&gt; Boolean): Intè®¡ç®—æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„é›†åˆå…ƒç´ æ•°é‡def default(key: A): Bå®šä¹‰ Map çš„é»˜è®¤å€¼ï¼Œåœ¨ key ä¸å­˜åœ¨æ—¶è¿”å›žã€‚def drop(n: Int): Map[A, B]è¿”å›žä¸¢å¼ƒå‰nä¸ªå…ƒç´ æ–°é›†åˆdef dropRight(n: Int): Map[A, B]è¿”å›žä¸¢å¼ƒæœ€åŽnä¸ªå…ƒç´ æ–°é›†åˆdef dropWhile(p: ((A, B)) =&gt; Boolean): Map[A, B]ä»Žå·¦å‘å³ä¸¢å¼ƒå…ƒç´ ï¼Œç›´åˆ°æ¡ä»¶pä¸æˆç«‹def empty: Map[A, B]è¿”å›žç›¸åŒç±»åž‹çš„ç©º Mapdef equals(that: Any): Booleanå¦‚æžœä¸¤ä¸ª Map ç›¸ç­‰(key/value å‡ç›¸ç­‰)ï¼Œè¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalsedef exists(p: ((A, B)) =&gt; Boolean): Booleanåˆ¤æ–­é›†åˆä¸­æŒ‡å®šæ¡ä»¶çš„å…ƒç´ æ˜¯å¦å­˜åœ¨def filter(p: ((A, B))=&gt; Boolean): Map[A, B]è¿”å›žæ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ‰€æœ‰é›†åˆdef filterKeys(p: (A) =&gt; Boolean): Map[A, B]è¿”å›žç¬¦åˆæŒ‡å®šæ¡ä»¶çš„çš„ä¸å¯å˜ Mapdef find(p: ((A, B)) =&gt; Boolean): Option[(A, B)]æŸ¥æ‰¾é›†åˆä¸­æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ def foreach(f: ((A, B)) =&gt; Unit): Unitå°†å‡½æ•°åº”ç”¨åˆ°é›†åˆçš„æ‰€æœ‰å…ƒç´ def init: Map[A, B]è¿”å›žæ‰€æœ‰å…ƒç´ ï¼Œé™¤äº†æœ€åŽä¸€ä¸ªdef isEmpty: Booleanæ£€æµ‹ Map æ˜¯å¦ä¸ºç©º def keys: Iterable[A]è¿”å›žæ‰€æœ‰çš„key/p&gt;def last: (A, B)è¿”å›žæœ€åŽä¸€ä¸ªå…ƒç´ def max: (A, B)æŸ¥æ‰¾æœ€å¤§å…ƒç´ def min: (A, B)æŸ¥æ‰¾æœ€å°å…ƒç´ def mkString: Stringé›†åˆæ‰€æœ‰å…ƒç´ ä½œä¸ºå­—ç¬¦ä¸²æ˜¾ç¤ºdef product: (A, B)è¿”å›žé›†åˆä¸­æ•°å­—å…ƒç´ çš„ç§¯ã€‚def remove(key: A): Option[B]ç§»é™¤æŒ‡å®š keydef retain(p: (A, B) =&gt; Boolean): Map.this.typeå¦‚æžœç¬¦åˆæ»¡è¶³æ¡ä»¶çš„è¿”å›ž truedef size: Intè¿”å›ž Map å…ƒç´ çš„ä¸ªæ•°def sum: (A, B)è¿”å›žé›†åˆä¸­æ‰€æœ‰æ•°å­—å…ƒç´ ä¹‹å’Œdef tail: Map[A, B]è¿”å›žä¸€ä¸ªé›†åˆä¸­é™¤äº†ç¬¬ä¸€å…ƒç´ ä¹‹å¤–çš„å…¶ä»–å…ƒç´ def take(n: Int): Map[A, B]è¿”å›žå‰ n ä¸ªå…ƒç´ def takeRight(n: Int): Map[A, B]è¿”å›žåŽ n ä¸ªå…ƒç´ def takeWhile(p: ((A, B)) =&gt; Boolean): Map[A, B]è¿”å›žæ»¡è¶³æŒ‡å®šæ¡ä»¶çš„å…ƒç´ def toArray: Array[(A, B)]é›†åˆè½¬æ•°ç»„def toBuffer[B &gt;: A]: Buffer[B]è¿”å›žç¼“å†²åŒºï¼ŒåŒ…å«äº† Map çš„æ‰€æœ‰å…ƒç´ def toList: List[A]è¿”å›ž Listï¼ŒåŒ…å«äº† Map çš„æ‰€æœ‰å…ƒç´ def toSeq: Seq[A]è¿”å›ž Seqï¼ŒåŒ…å«äº† Map çš„æ‰€æœ‰å…ƒç´ def toSet: Set[A]è¿”å›ž Setï¼ŒåŒ…å«äº† Map çš„æ‰€æœ‰å…ƒç´ def toString(): Stringè¿”å›žå­—ç¬¦ä¸²å¯¹è±¡]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>Map</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Setæ–¹æ³•]]></title>
    <url>%2F2019%2F02%2F16%2FSet%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147Scala Set å¸¸ç”¨æ–¹æ³•ä¸‹è¡¨åˆ—å‡ºäº† Scala Set å¸¸ç”¨çš„æ–¹æ³•ï¼šåºå· æ–¹æ³•åŠæè¿°def +(elem: A): Set[A]ä¸ºé›†åˆæ·»åŠ æ–°å…ƒç´ ï¼Œxå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆï¼Œé™¤éžå…ƒç´ å·²å­˜åœ¨ def -(elem: A): Set[A]ç§»é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆ def contains(elem: A): Booleanå¦‚æžœå…ƒç´ åœ¨é›†åˆä¸­å­˜åœ¨ï¼Œè¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž falseã€‚def &amp;(that: Set[A]): Set[A]è¿”å›žä¸¤ä¸ªé›†åˆçš„äº¤é›† def &amp;~(that: Set[A]): Set[A]è¿”å›žä¸¤ä¸ªé›†åˆçš„å·®é›†def +(elem1: A, elem2: A, elems: A*): Set[A]é€šè¿‡æ·»åŠ ä¼ å…¥æŒ‡å®šé›†åˆçš„å…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸å¯å˜é›†åˆ def ++(elems: A): Set[A]åˆå¹¶ä¸¤ä¸ªé›†åˆdef -(elem1: A, elem2: A, elems: A*): Set[A]é€šè¿‡ç§»é™¤ä¼ å…¥æŒ‡å®šé›†åˆçš„å…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸å¯å˜é›†åˆdef addString(b: StringBuilder): StringBuilderå°†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°å­—ç¬¦ä¸²ç¼“å†²åŒºdef addString(b: StringBuilder, sep: String): StringBuilderå°†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°å­—ç¬¦ä¸²ç¼“å†²åŒºï¼Œå¹¶ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦def apply(elem: A)æ£€æµ‹é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ def count(p: (A) =&gt; Boolean): Intè®¡ç®—æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„é›†åˆå…ƒç´ ä¸ªæ•°def copyToArray(xs: Array[A], start: Int, len: Int): Unitå¤åˆ¶ä¸å¯å˜é›†åˆå…ƒç´ åˆ°æ•°ç»„def diff(that: Set[A]): Set[A]æ¯”è¾ƒä¸¤ä¸ªé›†åˆçš„å·®é›†def drop(n: Int): Set[A]]è¿”å›žä¸¢å¼ƒå‰nä¸ªå…ƒç´ æ–°é›†åˆ def dropRight(n: Int): Set[A]è¿”å›žä¸¢å¼ƒæœ€åŽnä¸ªå…ƒç´ æ–°é›†åˆdef dropWhile(p: (A) =&gt; Boolean): Set[A]ä»Žå·¦å‘å³ä¸¢å¼ƒå…ƒç´ ï¼Œç›´åˆ°æ¡ä»¶pä¸æˆç«‹def equals(that: Any): Booleanequals æ–¹æ³•å¯ç”¨äºŽä»»æ„åºåˆ—ã€‚ç”¨äºŽæ¯”è¾ƒç³»åˆ—æ˜¯å¦ç›¸ç­‰ã€‚def exists(p: (A) =&gt; Boolean): Booleanåˆ¤æ–­ä¸å¯å˜é›†åˆä¸­æŒ‡å®šæ¡ä»¶çš„å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚def filter(p: (A) =&gt; Boolean): Set[A]è¾“å‡ºç¬¦åˆæŒ‡å®šæ¡ä»¶çš„æ‰€æœ‰ä¸å¯å˜é›†åˆå…ƒç´ ã€‚def find(p: (A) =&gt; Boolean): Option[A]æŸ¥æ‰¾ä¸å¯å˜é›†åˆä¸­æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´  def forall(p: (A) =&gt; Boolean): BooleanæŸ¥æ‰¾ä¸å¯å˜é›†åˆä¸­æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ‰€æœ‰å…ƒç´ def foreach(f: (A) =&gt; Unit): Unitå°†å‡½æ•°åº”ç”¨åˆ°ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´  def head: AèŽ·å–ä¸å¯å˜é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ def init: Set[A]è¿”å›žæ‰€æœ‰å…ƒç´ ï¼Œé™¤äº†æœ€åŽä¸€ä¸ªdef intersect(that: Set[A]): Set[A]è®¡ç®—ä¸¤ä¸ªé›†åˆçš„äº¤é›†def isEmpty: Booleanåˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºdef iterator: Iterator[A]åˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨æ¥è¿­ä»£å…ƒç´ def last: Aè¿”å›žæœ€åŽä¸€ä¸ªå…ƒç´ def map[B](f: (A) =&gt; B): immutable.Set[B]é€šè¿‡ç»™å®šçš„æ–¹æ³•å°†æ‰€æœ‰å…ƒç´ é‡æ–°è®¡ç®—def max: AæŸ¥æ‰¾æœ€å¤§å…ƒç´  def min: AæŸ¥æ‰¾æœ€å°å…ƒç´  def mkString: Stringé›†åˆæ‰€æœ‰å…ƒç´ ä½œä¸ºå­—ç¬¦ä¸²æ˜¾ç¤ºdef mkString(sep: String): Stringä½¿ç”¨åˆ†éš”ç¬¦å°†é›†åˆæ‰€æœ‰å…ƒç´ ä½œä¸ºå­—ç¬¦ä¸²æ˜¾ç¤ºdef product: Aè¿”å›žä¸å¯å˜é›†åˆä¸­æ•°å­—å…ƒç´ çš„ç§¯ã€‚def size: Intè¿”å›žä¸å¯å˜é›†åˆå…ƒç´ çš„æ•°é‡def splitAt(n: Int): (Set[A], Set[A])æŠŠä¸å¯å˜é›†åˆæ‹†åˆ†ä¸ºä¸¤ä¸ªå®¹å™¨ï¼Œç¬¬ä¸€ä¸ªç”±å‰ n ä¸ªå…ƒç´ ç»„æˆï¼Œç¬¬äºŒä¸ªç”±å‰©ä¸‹çš„å…ƒç´ ç»„æˆdef subsetOf(that: Set[A]): Booleanå¦‚æžœé›†åˆAä¸­å«æœ‰å­é›†Bè¿”å›ž trueï¼Œå¦åˆ™è¿”å›žfalsedef sum: Aè¿”å›žä¸å¯å˜é›†åˆä¸­æ‰€æœ‰æ•°å­—å…ƒç´ ä¹‹å’Œ def tail: Set[A]è¿”å›žä¸€ä¸ªä¸å¯å˜é›†åˆä¸­é™¤äº†ç¬¬ä¸€å…ƒç´ ä¹‹å¤–çš„å…¶ä»–å…ƒç´ def take(n: Int): Set[A]è¿”å›žå‰ n ä¸ªå…ƒç´ def takeRight(n: Int):Set[A]è¿”å›žåŽ n ä¸ªå…ƒç´ def toArray: Array[A]å°†é›†åˆè½¬æ¢ä¸ºæ•°ç»„def toBuffer[B &gt;: A]: Buffer[B]è¿”å›žç¼“å†²åŒºï¼ŒåŒ…å«äº†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´ def toList: List[A]è¿”å›ž Listï¼ŒåŒ…å«äº†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´ def toMap[T, U]: Map[T, U]è¿”å›ž Mapï¼ŒåŒ…å«äº†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´  def toSeq: Seq[A]è¿”å›ž Seqï¼ŒåŒ…å«äº†ä¸å¯å˜é›†åˆçš„æ‰€æœ‰å…ƒç´ def toString(): Stringè¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥å¯¹è±¡æ¥è¡¨ç¤º]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>Set</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•°ç»„æ–¹æ³•]]></title>
    <url>%2F2019%2F02%2F16%2F%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95%20%2F</url>
    <content type="text"><![CDATA[12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849åºå· æ–¹æ³•å’Œæè¿°def apply( x: T, xs: T* ): Array[T]åˆ›å»ºæŒ‡å®šå¯¹è±¡ T çš„æ•°ç»„, T çš„å€¼å¯ä»¥æ˜¯ Unit, Double, Float, Long, Int, Char, Short, Byte, Booleanã€‚def concat[T]( xss: Array[T]* ): Array[T]åˆå¹¶æ•°ç»„def copy( src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int ): Unitå¤åˆ¶ä¸€ä¸ªæ•°ç»„åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸Šã€‚ç›¸ç­‰äºŽ Java's System.arraycopy(src, srcPos, dest, destPos, length)ã€‚def empty[T]: Array[T]è¿”å›žé•¿åº¦ä¸º 0 çš„æ•°ç»„def iterate[T]( start: T, len: Int )( f: (T) =&gt; T ): Array[T]è¿”å›žæŒ‡å®šé•¿åº¦æ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å…ƒç´ ä¸ºæŒ‡å®šå‡½æ•°çš„è¿”å›žå€¼ã€‚ä»¥ä¸Šå®žä¾‹æ•°ç»„åˆå§‹å€¼ä¸º 0ï¼Œé•¿åº¦ä¸º 3ï¼Œè®¡ç®—å‡½æ•°ä¸ºa=&gt;a+1ï¼šscala&gt; Array.iterate(0,3)(a=&gt;a+1)res1: Array[Int] = Array(0, 1, 2) def fill[T]( n: Int )(elem: =&gt; T): Array[T]è¿”å›žæ•°ç»„ï¼Œé•¿åº¦ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼ŒåŒæ—¶æ¯ä¸ªå…ƒç´ ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œå¡«å……ã€‚ def fill[T]( n1: Int, n2: Int )( elem: =&gt; T ): Array[Array[T]]è¿”å›žäºŒæ•°ç»„ï¼Œé•¿åº¦ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼ŒåŒæ—¶æ¯ä¸ªå…ƒç´ ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œå¡«å……ã€‚def ofDim[T]( n1: Int ): Array[T]åˆ›å»ºæŒ‡å®šé•¿åº¦çš„æ•°ç»„def ofDim[T]( n1: Int, n2: Int ): Array[Array[T]]åˆ›å»ºäºŒç»´æ•°ç»„def ofDim[T]( n1: Int, n2: Int, n3: Int ): Array[Array[Array[T]]]åˆ›å»ºä¸‰ç»´æ•°ç»„ def range( start: Int, end: Int, step: Int ): Array[Int]åˆ›å»ºæŒ‡å®šåŒºé—´å†…çš„æ•°ç»„ï¼Œstep ä¸ºæ¯ä¸ªå…ƒç´ é—´çš„æ­¥é•¿def range( start: Int, end: Int ): Array[Int]åˆ›å»ºæŒ‡å®šåŒºé—´å†…çš„æ•°ç»„def tabulate[T]( n: Int )(f: (Int)=&gt; T): Array[T]è¿”å›žæŒ‡å®šé•¿åº¦æ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å…ƒç´ ä¸ºæŒ‡å®šå‡½æ•°çš„è¿”å›žå€¼ï¼Œé»˜è®¤ä»Ž 0 å¼€å§‹ã€‚ä»¥ä¸Šå®žä¾‹è¿”å›ž 3 ä¸ªå…ƒç´ ï¼šscala&gt; Array.tabulate(3)(a =&gt; a + 5)res0: Array[Int] = Array(5, 6, 7)def tabulate[T]( n1: Int, n2: Int )( f: (Int, Int ) =&gt; T): Array[Array[T]]è¿”å›žæŒ‡å®šé•¿åº¦çš„äºŒç»´æ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å…ƒç´ ä¸ºæŒ‡å®šå‡½æ•°çš„è¿”å›žå€¼ï¼Œé»˜è®¤ä»Ž 0 å¼€å§‹ã€‚]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[String æ–¹æ³•]]></title>
    <url>%2F2019%2F02%2F16%2FString%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139String æ–¹æ³• char charAt(int index)è¿”å›žæŒ‡å®šä½ç½®çš„å­—ç¬¦ ä»Ž0å¼€å§‹ int compareTo(Object o)æ¯”è¾ƒå­—ç¬¦ä¸²ä¸Žå¯¹è±¡ int compareTo(String anotherString)æŒ‰å­—å…¸é¡ºåºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸² int compareToIgnoreCase(String str)æŒ‰å­—å…¸é¡ºåºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä¸è€ƒè™‘å¤§å°å†™ String concat(String str)å°†æŒ‡å®šå­—ç¬¦ä¸²è¿žæŽ¥åˆ°æ­¤å­—ç¬¦ä¸²çš„ç»“å°¾ boolean contentEquals(StringBuffer sb)å°†æ­¤å­—ç¬¦ä¸²ä¸ŽæŒ‡å®šçš„ StringBuffer æ¯”è¾ƒã€‚ static String copyValueOf(char[] data)è¿”å›žæŒ‡å®šæ•°ç»„ä¸­è¡¨ç¤ºè¯¥å­—ç¬¦åºåˆ—çš„ String static String copyValueOf(char[] data, int offset, int count)è¿”å›žæŒ‡å®šæ•°ç»„ä¸­è¡¨ç¤ºè¯¥å­—ç¬¦åºåˆ—çš„ String boolean endsWith(String suffix)æµ‹è¯•æ­¤å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„åŽç¼€ç»“æŸ boolean equals(Object anObject)å°†æ­¤å­—ç¬¦ä¸²ä¸ŽæŒ‡å®šçš„å¯¹è±¡æ¯”è¾ƒ boolean equalsIgnoreCase(String anotherString)å°†æ­¤ String ä¸Žå¦ä¸€ä¸ª String æ¯”è¾ƒï¼Œä¸è€ƒè™‘å¤§å°å†™ byte getBytes()ä½¿ç”¨å¹³å°çš„é»˜è®¤å­—ç¬¦é›†å°†æ­¤ String ç¼–ç ä¸º byte åºåˆ—ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åˆ°ä¸€ä¸ªæ–°çš„ byte æ•°ç»„ä¸­ byte[] getBytes(String charsetNameä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦é›†å°†æ­¤ String ç¼–ç ä¸º byte åºåˆ—ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åˆ°ä¸€ä¸ªæ–°çš„ byte æ•°ç»„ä¸­ void getChars(int srcBegin, int srcEnd, char[] dst, int dstBegin)å°†å­—ç¬¦ä»Žæ­¤å­—ç¬¦ä¸²å¤åˆ¶åˆ°ç›®æ ‡å­—ç¬¦æ•°ç»„ int hashCode()è¿”å›žæ­¤å­—ç¬¦ä¸²çš„å“ˆå¸Œç 16 int indexOf(int ch)è¿”å›žæŒ‡å®šå­—ç¬¦åœ¨æ­¤å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼•ï¼ˆè¾“å…¥çš„æ˜¯asciiç å€¼ï¼‰ int indexOf(int ch, int fromIndex)è¿”è¿”å›žåœ¨æ­¤å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°æŒ‡å®šå­—ç¬¦å¤„çš„ç´¢å¼•ï¼Œä»ŽæŒ‡å®šçš„ç´¢å¼•å¼€å§‹æœç´¢ int indexOf(String str)è¿”å›žæŒ‡å®šå­å­—ç¬¦ä¸²åœ¨æ­¤å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼• int indexOf(String str, int fromIndex)è¿”å›žæŒ‡å®šå­å­—ç¬¦ä¸²åœ¨æ­¤å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼•ï¼Œä»ŽæŒ‡å®šçš„ç´¢å¼•å¼€å§‹ String intern()è¿”å›žå­—ç¬¦ä¸²å¯¹è±¡çš„è§„èŒƒåŒ–è¡¨ç¤ºå½¢å¼ int lastIndexOf(int ch)è¿”å›žæŒ‡å®šå­—ç¬¦åœ¨æ­¤å­—ç¬¦ä¸²ä¸­æœ€åŽä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼• int lastIndexOf(int ch, int fromIndex)è¿”å›žæŒ‡å®šå­—ç¬¦åœ¨æ­¤å­—ç¬¦ä¸²ä¸­æœ€åŽä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼•ï¼Œä»ŽæŒ‡å®šçš„ç´¢å¼•å¤„å¼€å§‹è¿›è¡Œåå‘æœç´¢ int lastIndexOf(String str)è¿”å›žæŒ‡å®šå­å­—ç¬¦ä¸²åœ¨æ­¤å­—ç¬¦ä¸²ä¸­æœ€å³è¾¹å‡ºçŽ°å¤„çš„ç´¢å¼• int lastIndexOf(String str, int fromIndex)è¿”å›žæŒ‡å®šå­å­—ç¬¦ä¸²åœ¨æ­¤å­—ç¬¦ä¸²ä¸­æœ€åŽä¸€æ¬¡å‡ºçŽ°å¤„çš„ç´¢å¼•ï¼Œä»ŽæŒ‡å®šçš„ç´¢å¼•å¼€å§‹åå‘æœç´¢ int length()è¿”å›žæ­¤å­—ç¬¦ä¸²çš„é•¿åº¦ boolean matches(String regex)å‘ŠçŸ¥æ­¤å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼ boolean regionMatches(boolean ignoreCase, int toffset, String other, int ooffset, int len)æµ‹è¯•ä¸¤ä¸ªå­—ç¬¦ä¸²åŒºåŸŸæ˜¯å¦ç›¸ç­‰28 boolean regionMatches(int toffset, String other, int ooffset, int len)æµ‹è¯•ä¸¤ä¸ªå­—ç¬¦ä¸²åŒºåŸŸæ˜¯å¦ç›¸ç­‰ String replace(char oldChar, char newChar)è¿”å›žä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯é€šè¿‡ç”¨ newChar æ›¿æ¢æ­¤å­—ç¬¦ä¸²ä¸­å‡ºçŽ°çš„æ‰€æœ‰ oldChar å¾—åˆ°çš„ String replaceAll(String regex, String replacementä½¿ç”¨ç»™å®šçš„ replacement æ›¿æ¢æ­¤å­—ç¬¦ä¸²æ‰€æœ‰åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼çš„å­å­—ç¬¦ä¸² String replaceFirst(String regex, String replacement)ä½¿ç”¨ç»™å®šçš„ replacement æ›¿æ¢æ­¤å­—ç¬¦ä¸²åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼çš„ç¬¬ä¸€ä¸ªå­å­—ç¬¦ä¸² String[] split(String regex)æ ¹æ®ç»™å®šæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ‹†åˆ†æ­¤å­—ç¬¦ä¸² String[] split(String regex, int limit)æ ¹æ®åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ¥æ‹†åˆ†æ­¤å­—ç¬¦ä¸² boolean startsWith(String prefix)æµ‹è¯•æ­¤å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„å‰ç¼€å¼€å§‹ boolean startsWith(String prefix, int toffset)æµ‹è¯•æ­¤å­—ç¬¦ä¸²ä»ŽæŒ‡å®šç´¢å¼•å¼€å§‹çš„å­å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šå‰ç¼€å¼€å§‹ã€‚ CharSequence subSequence(int beginIndex, int endIndex)è¿”å›žä¸€ä¸ªæ–°çš„å­—ç¬¦åºåˆ—ï¼Œå®ƒæ˜¯æ­¤åºåˆ—çš„ä¸€ä¸ªå­åºåˆ— String substring(int beginIndex)è¿”å›žä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯æ­¤å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­å­—ç¬¦ä¸² String substring(int beginIndex, int endIndex)è¿”å›žä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯æ­¤å­—ç¬¦ä¸²çš„ä¸€ä¸ªå­å­—ç¬¦ä¸² char[] toCharArray()å°†æ­¤å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦æ•°ç»„ String toLowerCase()ä½¿ç”¨é»˜è®¤è¯­è¨€çŽ¯å¢ƒçš„è§„åˆ™å°†æ­¤ String ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢ä¸ºå°å†™ String toLowerCase(Locale locale)ä½¿ç”¨ç»™å®š Locale çš„è§„åˆ™å°†æ­¤ String ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢ä¸ºå°å†™ String toString()è¿”å›žæ­¤å¯¹è±¡æœ¬èº«ï¼ˆå®ƒå·²ç»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ï¼‰ String toUpperCase()ä½¿ç”¨é»˜è®¤è¯­è¨€çŽ¯å¢ƒçš„è§„åˆ™å°†æ­¤ String ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢ä¸ºå¤§å†™ String toUpperCase(Locale locale)ä½¿ç”¨ç»™å®š Locale çš„è§„åˆ™å°†æ­¤ String ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢ä¸ºå¤§å†™ String trim()åˆ é™¤æŒ‡å®šå­—ç¬¦ä¸²çš„é¦–å°¾ç©ºç™½ç¬¦ static String valueOf(primitive data type x)è¿”å›žæŒ‡å®šç±»åž‹å‚æ•°çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>String</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>%2F2019%2F02%2F15%2FScala%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[[TOC] ä¸€ã€Scalaå®˜ç½‘6ä¸ªç‰¹å¾ã€‚ç®€æ·ï¼Œå¿«é€Ÿ1ã€Java ä¸ŽJavaæ— ç¼æ•´åˆï¼Œè¿è¡Œåœ¨JVMä¸Šï¼Œç¼–è¯‘å½¢æˆ.classæ–‡ä»¶ 2ã€ç±»åž‹ ç±»åž‹è‡ªåŠ¨æŽ¨æ–­:var å˜é‡ç±»åž‹ val å¸¸é‡ç±»åž‹ ï¼ˆvar s = 1 è‡ªåŠ¨æŽ¨æ–­s ä¸ºintç±»åž‹ ï¼‰ dosçª—å£è¿è¡ŒScalaè¯­è¨€ï¼ˆcmd - &gt;scalaï¼‰ 3ã€å¹¶å‘ åº•å±‚æœ‰actorï¼Œå¤©ç”Ÿç”¨äºŽé«˜å¹¶å‘å’Œåˆ†å¸ƒå¼ 4ã€ç»§æ‰¿ trait ç‰¹å¾ç‰¹è´¨ï¼ˆJavaä¸­æŽ¥å£å’ŒæŠ½è±¡ç±»çš„ç»“åˆä½“ï¼Ÿï¼Ÿï¼Ÿä¸¤è€…åŒºåˆ«ï¼Ÿï¼Ÿå•ç»§æ‰¿å¤šå®žçŽ°ï¼‰â€‹ é™æ€è¯­è¨€ ï¼ˆJavaé™æ€è¯­è¨€ shell ã€PythonåŠ¨æ€è¯­è¨€ï¼‰ 5ã€åŒ¹é… æ¨¡å¼åŒ¹é…:(Javaä¸­çš„switch caseç±»åž‹å¿…é¡»ä¸€è‡´)å¯åŒ¹é…å¤šç§ç±»åž‹ 6ã€é«˜é˜¶ é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•ä¸­ï¼ˆJdk 8 streamæµï¼ŒèŽ±å§†å¡”è¡¨è¾¾å¼ï¼‰ â€‹ å·¥å…·ç±»ä¸­æ–¹æ³•ä¸ºé™æ€çš„ äºŒã€Scalaå®‰è£…1ã€windowså®‰è£…,é…ç½®çŽ¯å¢ƒå˜é‡Ã˜ å®˜ç½‘ä¸‹è½½scala2.10ï¼šï¼ˆå› ä¸ºsparkéœ€è¦çš„æ˜¯è¿™ä¸ªç‰ˆæœ¬çš„Scalaï¼‰ http://www.scala-lang.org/download/2.10.4.html Ã˜ ä¸‹è½½å¥½åŽå®‰è£…ã€‚åŒå‡»msiåŒ…å®‰è£…,è®°ä½å®‰è£…çš„è·¯å¾„ã€‚ Ã˜ é…ç½®çŽ¯å¢ƒå˜é‡ï¼ˆå’Œé…ç½®jdkä¸€æ ·ï¼‰ æ–°å»ºSCALA_HOME ç¼–è¾‘Pathå˜é‡ï¼Œåœ¨åŽé¢è¿½åŠ å¦‚ä¸‹ï¼š 1;%SCALA_HOME%\bin Ã˜ æ‰“å¼€cmd,è¾“å…¥ï¼š 1scala - version çœ‹æ˜¯å¦æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œç¡®å®šæ˜¯å¦å®‰è£…æˆåŠŸ 2ã€eclipse é…ç½®scalaæ’ä»¶Ã˜ ä¸‹è½½æ’ä»¶ï¼ˆä¸€å®šè¦å¯¹åº”eclipseç‰ˆæœ¬ä¸‹è½½ï¼‰,å¹¶è§£åŽ‹ http://scala-ide.org/download/prev-stable.html Ã˜ å°†è§£åŽ‹ç›®å½•ä¸‹çš„featureså’Œpluginsä¸¤ä¸ªæ–‡ä»¶å¤¹æ‹·è´åˆ°eclipseå®‰è£…ç›®å½•ä¸­çš„â€dropins/scalaâ€ç›®å½•ä¸‹ã€‚ è¿›å…¥dropinsï¼Œæ–°å»ºscalaæ–‡ä»¶å¤¹ï¼Œå°†ä¸¤ä¸ªæ–‡ä»¶å¤¹æ‹·è´åˆ°â€œdropins/scalaâ€ä¸‹ 3ã€Scalaç¼–è¾‘å™¨ï¼šscala ideä¸‹è½½ç½‘å€ï¼šhttp://scala-ide.org/download/sdk.html 4ã€Idea ä¸­é…ç½®scalaæ’ä»¶Ã˜ æ‰“å¼€idea,closeé¡¹ç›®åŽï¼Œç‚¹å‡»Configure-&gt;Plugins Ã˜ æœç´¢scalaï¼Œç‚¹å‡»Installå®‰è£… Ã˜ è®¾ç½®jdkï¼Œæ‰“å¼€Project Structure,ç‚¹å‡»new é€‰æ‹©å®‰è£…å¥½çš„jdkè·¯å¾„ Ã˜ æ–°å»ºScalaé¡¹ç›® ä¸‰ã€ScalaåŸºç¡€è¯­æ³•1ã€æ•°æ®ç±»åž‹ 2ã€å˜é‡å’Œå¸¸é‡çš„å£°æ˜Ž123456789101112 /** * å®šä¹‰å˜é‡å’Œå¸¸é‡ * å˜é‡ :ç”¨ var å®šä¹‰ ï¼Œå¯ä¿®æ”¹ * å¸¸é‡ :ç”¨ val å®šä¹‰ï¼Œä¸å¯ä¿®æ”¹ */ var name = "zhangsan" println(name) name ="lisi" println(name) val gender = "m"// gender = "m"//é”™è¯¯ï¼Œä¸èƒ½ç»™å¸¸é‡å†èµ‹å€¼// å®šä¹‰å˜é‡æˆ–è€…å¸¸é‡çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥å†™ä¸Šè¿”å›žçš„ç±»åž‹ï¼Œä¸€èˆ¬çœç•¥ï¼Œå¦‚ï¼šval a:Int = 10 3ã€ç±»å’Œå¯¹è±¡Ã˜ åˆ›å»ºç±» 1234567class Person&#123; val name = "zhangsan" val age = 18 def sayName() = &#123; "my name is "+ name &#125;&#125; Ã˜ åˆ›å»ºå¯¹è±¡ 1234567object Lesson_Class &#123; def main(args: Array[String]): Unit = &#123; val person = new Person() println(person.age); println(person.sayName()) &#125;&#125; Ã˜ ä¼´ç”Ÿç±»å’Œä¼´ç”Ÿå¯¹è±¡ 12345678910111213141516171819202122232425class Person(xname :String , xage :Int)&#123; var name = Person.name val age = xage var gender = "m" def this(name:String,age:Int,g:String)&#123; this(name,age) gender = g &#125; def sayName() = &#123; "my name is "+ name &#125;&#125;object Person &#123; val name = "zhangsanfeng" def main(args: Array[String]): Unit = &#123; val person = new Person("wagnwu",10,"f") println(person.age); println(person.sayName()) println(person.gender) &#125;&#125; æ³¨æ„ å»ºè®®ç±»åé¦–å­—æ¯å¤§å†™ ï¼Œæ–¹æ³•é¦–å­—æ¯å°å†™ï¼Œç±»å’Œæ–¹æ³•å‘½åå»ºè®®ç¬¦åˆé©¼å³°å‘½åæ³•ã€‚ .ä¸€è¡Œç»“æŸï¼Œä¸éœ€è¦åˆ†å·ã€‚å¦‚æžœä¸€è¡Œé‡Œæœ‰å¤šä¸ªè¯­å¥ï¼Œåˆ™ä¹‹é—´ç”¨åˆ†å·éš”å¼€ã€‚ scala ä¸­çš„objectæ˜¯å•ä¾‹å¯¹è±¡ï¼Œç›¸å½“äºŽjavaä¸­çš„å·¥å…·ç±»ï¼Œå®ƒé‡Œé¢çš„æ–¹æ³•å¯ä»¥çœ‹æˆéƒ½æ˜¯staticé™æ€çš„ã€‚objectä¸å¯ä»¥ä¼ å‚æ•°ã€‚å¦ï¼šTraitä¸å¯ä»¥ä¼ å‚æ•° scalaä¸­çš„classç±»é»˜è®¤å¯ä»¥ä¼ å‚æ•°ï¼Œé»˜è®¤çš„ä¼ å‚æ•°å°±æ˜¯é»˜è®¤çš„æž„é€ å‡½æ•°ã€‚ é‡å†™æž„é€ å‡½æ•°çš„æ—¶å€™ï¼Œå¿…é¡»è¦å…ˆè°ƒç”¨é»˜è®¤çš„æž„é€ å‡½æ•°ã€‚ class ç±»å±žæ€§è‡ªå¸¦getter ï¼Œsetteræ–¹æ³•ã€‚ ä½¿ç”¨objectæ—¶ï¼Œä¸ç”¨newï¼Œä½¿ç”¨classæ—¶è¦new ,å¹¶ä¸”newçš„æ—¶å€™ï¼Œclassä¸­é™¤äº†æ–¹æ³•ä¸æ‰§è¡Œï¼Œå…¶ä»–éƒ½æ‰§è¡Œã€‚ å¦‚æžœåœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œobjectå¯¹è±¡å’Œclassç±»çš„åç§°ç›¸åŒï¼Œåˆ™è¿™ä¸ªå¯¹è±¡å°±æ˜¯è¿™ä¸ªç±»çš„ä¼´ç”Ÿå¯¹è±¡ï¼Œclassç§°ä¸ºobjectå¯¹è±¡çš„ä¼´ç”Ÿç±»ï¼Œobject ç§°ä¸ºclassç±»çš„ä¼´ç”Ÿå¯¹è±¡ï¼Œä»–ä»¬å¯ä»¥ç›´æŽ¥è®¿é—®å¯¹æ–¹çš„ç§æœ‰å˜é‡ã€‚ 3. if else1234567891011/** * if else */val age =18 if (age &lt; 18 )&#123; println("no allow")&#125;else if (18&lt;=age&amp;&amp;age&lt;=20)&#123; println("allow with other")&#125;else&#123; println("allow self")&#125; 4. for ,while,doâ€¦while toå’Œuntil çš„ç”¨æ³•ï¼ˆä¸å¸¦æ­¥é•¿ï¼Œå¸¦æ­¥é•¿åŒºåˆ«ï¼‰ 123456789101112131415 /** * toå’Œuntil * ä¾‹ï¼š * 1 to 10 è¿”å›ž1åˆ°10çš„Rangeæ•°ç»„ï¼ŒåŒ…å«10 * 1 until 10 è¿”å›ž1åˆ°10 Rangeæ•°ç»„ ï¼Œä¸åŒ…å«10 */ println(1 to 10 )//æ‰“å°ï¼š Range(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) println(1.to(10))//åŒä¸Šprintln(1 to (10 ,2))//æ­¥é•¿ä¸º2ï¼Œä»Ž1å¼€å§‹æ‰“å°ï¼š Range(1, 3, 5, 7, 9) println(1.to(10, 2)) //åŒä¸Šprintln(1 until 10 ) //ä¸åŒ…å«æœ€åŽä¸€ä¸ªæ•°ï¼Œæ‰“å°1,2,3,4,5,6,7,8,9 println(1.until(10))//åŒä¸Š println(1 until (10 ,3 ))//æ­¥é•¿ä¸º2ï¼Œä»Ž1å¼€å§‹æ‰“å°ï¼Œæ‰“å°1,4,7 åˆ›å»ºforå¾ªçŽ¯ 1234567/** * for å¾ªçŽ¯ * */ for( i &lt;- 1 to 10 )&#123; println(i) &#125; åˆ›å»ºå¤šå±‚forå¾ªçŽ¯ 123456789101112131415161718192021222324252627282930313233343536//å¯ä»¥åˆ†å·éš”å¼€ï¼Œå†™å…¥å¤šä¸ªlistèµ‹å€¼çš„å˜é‡ï¼Œæž„æˆå¤šå±‚forå¾ªçŽ¯ //scalaä¸­ ä¸èƒ½å†™count++ count-- åªèƒ½å†™count+ var count = 0; for(i &lt;- 1 to 10; j &lt;- 1 until 10)&#123; println("i="+ i +", j="+j) count += 1 &#125; println(count); //ä¾‹å­ï¼š æ‰“å°å°ä¹ä¹ for(i &lt;- 1 until 10 ;j &lt;- 1 until 10)&#123; if(i&gt;=j)&#123; print(i +" * " + j + " = "+ i*j+" ") &#125; if(i==j )&#123; println() &#125; &#125;//ä¹ä¹ä¹˜æ³•è¡¨ //æ–¹æ³•ä¸€// for(i&lt;- 1 to 9 )&#123;// for (j &lt;- 1 to i)&#123;// print(j+"*"+i+"="+i*j+"\t")// &#125;// println()// &#125; //æ–¹æ³•äºŒ// for(i&lt;- 1 to 9 )&#123;// for (j&lt;- 1 to 9)&#123;// if(j&lt;=i)&#123;// print(j+"*"+i+"="+i*j+"\t")// &#125;//// if(i==j)println()// &#125;// &#125; forå¾ªçŽ¯ä¸­å¯ä»¥åŠ æ¡ä»¶åˆ¤æ–­ï¼Œåˆ†å·éš”å¼€ 1234 //å¯ä»¥åœ¨forå¾ªçŽ¯ä¸­åŠ å…¥æ¡ä»¶åˆ¤æ–­ for(i&lt;- 1 to 10 ;if (i%2) == 0 ;if (i == 4) )&#123; println(i)&#125; scalaä¸­ä¸èƒ½ä½¿ç”¨count++ï¼Œcountåªèƒ½ä½¿ç”¨count = count+1 ï¼Œcount += 1 whileå¾ªçŽ¯ï¼Œwhileï¼ˆï¼‰{}ï¼Œdo {}while() 12345678910111213141516171819 //å°†forä¸­çš„ç¬¦åˆæ¡ä»¶çš„å…ƒç´ é€šè¿‡yieldå…³é”®å­—è¿”å›žæˆä¸€ä¸ªé›†åˆ val list = for(i &lt;- 1 to 10 ; if(i &gt; 5 )) yield i //&lt;- åŽé¢æ˜¯ä¸€ä¸ªé›†åˆ for( w &lt;- list )&#123; println(w)&#125; /** * while å¾ªçŽ¯ */ var index = 0 while(index &lt; 100 )&#123; println("ç¬¬"+index+"æ¬¡while å¾ªçŽ¯") index += 1 &#125; index = 0 do&#123; index +=1 println("ç¬¬"+index+"æ¬¡do while å¾ªçŽ¯")&#125;while(index &lt;100 ) å››ã€Scalaå‡½æ•°1ã€å‡½æ•°å®šä¹‰1234567def fun (a: Int , b: Int ) : Unit = &#123; println(a+b) &#125;fun(1,1) def fun1 (a : Int , b : Int)= a+b println(fun1(1,2)) è¯­æ³•è§£é‡Š å‡½æ•°å®šä¹‰è¯­æ³• ç”¨defæ¥å®šä¹‰ å¯ä»¥å®šä¹‰ä¼ å…¥çš„å‚æ•°ï¼Œè¦æŒ‡å®šä¼ å…¥å‚æ•°çš„ç±»åž‹ scalaä¸­å‡½æ•°ä¸­å¦‚æžœè¿”å›žè¿”å›žå€¼ç±»åž‹ä¸ºUnit ï¼Œå³æ— è¿”å›žå€¼ 12345&gt; def add(x:Int=10,y:Int=11):Unit =&#123;&gt; x+y&gt; &#125;&gt; //å†™è¿”å›žå€¼ç±»åž‹æ˜¯=æ—¶ï¼Œä¸€å®šè¦è®°å¾—å†™ ï¼šï¼ˆå†’å·ï¼‰&gt; scalaä¸­å‡½æ•°æœ‰è¿”å›žå€¼æ—¶ï¼Œå¯ä»¥å†™returnï¼Œä¹Ÿå¯ä»¥ä¸å†™returnï¼š çœç•¥returnçš„æ—¶å€™ï¼Œå‡½æ•°è‡ªåŠ¨å›žå°†æœ€åŽä¸€è¡Œçš„è¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›žå€¼ 123456789&gt; def max(x:Int,y:Int )=&#123;&gt; if (x&gt;y)&gt; x&gt; else&gt; y&gt; &#125;&gt; println(max(5,7))&gt; ç»“æžœæ˜¾ç¤ºï¼š7&gt; * * å¦‚æžœå‡½æ•°æœ‰retrun,åˆ™å¿…é¡»å†™è¿”å›žç±»åž‹ã€‚ 12345678&gt; def min(m:Int,n:Int):Int=&#123;&gt; if(m&gt;n)&gt; return n&gt; else&gt; return m&gt; &#125;&gt; println(min(5,7))&gt; * scalaä¸­å‡½æ•°æœ‰è¿”å›žå€¼æ—¶ï¼Œå¯ä»¥å†™è¿”å›žå€¼çš„ç±»åž‹ï¼Œä¹Ÿå¯ä»¥çœç•¥ï¼Œå› ä¸ºscalaå¯ä»¥ç±»åž‹è‡ªåŠ¨æŽ¨æ–­ï¼Œæœ‰æ—¶å€™ä¸èƒ½çœç•¥ï¼Œå¿…é¡»å†™ï¼Œ * * æ¯”å¦‚åœ¨é€’å½’å‡½æ•°ä¸­æˆ–è€…å‡½æ•°çš„è¿”å›žå€¼æ˜¯å‡½æ•°ç±»åž‹çš„æ—¶å€™ã€‚ 12345678&gt; def num(x: Int): Int = &#123;&gt; if (x == 1)&gt; 1&gt; else &#123;&gt; x * num(x - 1)&gt; &#125;&gt; &#125;&gt; * å‡½æ•°å®šä¹‰çš„æ—¶å€™ï¼Œå¦‚æžœåŽ»æŽ‰ = ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•è¿”å›žç±»åž‹å¿…å®šæ˜¯Unitçš„ã€‚ è¿™ç§è¯´æ³•æ— è®ºæ–¹æ³•ä½“é‡Œé¢ä»€ä¹ˆé€»è¾‘éƒ½æˆç«‹ï¼Œscalaå¯ä»¥æŠŠä»»æ„ç±»åž‹è½¬æ¢ä¸ºUnitã€‚ å‡è®¾ï¼Œé‡Œé¢çš„é€»è¾‘æœ€åŽè¿”å›žäº†ä¸€ä¸ªstringï¼Œé‚£ä¹ˆè¿™ä¸ªè¿”å›žå€¼ä¼šè¢«è½¬æ¢æˆUnitï¼Œå¹¶ä¸”å€¼ä¼šè¢«ä¸¢å¼ƒã€‚ åˆ™ç›¸å½“äºŽï¼Œå‡½æ•°å°±å°†è¿”å›žå€¼åŽ»æŽ‰ï¼Œå³æ— è¿”å›žå€¼ã€‚ * {}é‡Œçš„ä»£ç ï¼Œå¦‚æžœåªæœ‰ä¸€è¡Œï¼Œåˆ™å¯ä»¥çœç•¥{} * ä¼ é€’ç»™æ–¹æ³•çš„å‚æ•°å¯ä»¥åœ¨æ–¹æ³•ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”scalaè§„å®šæ–¹æ³•çš„ä¼ è¿‡æ¥çš„å‚æ•°ä¸ºvalç±»åž‹ï¼Œä¸èƒ½ä¿®æ”¹ï¼Œä¸æ˜¯varã€‚ 2ã€é€’å½’å‡½æ•°1234567891011/** * é€’å½’å‡½æ•° * 5çš„é˜¶ä¹˜ */ def fun2(num :Int) :Int= &#123; if(num ==1) num else num * fun2(num-1) &#125; print(fun2(5)) 3ã€åŒ…å«å‚æ•°é»˜è®¤å€¼çš„å‡½æ•°12345678910/** * åŒ…å«é»˜è®¤å‚æ•°å€¼çš„å‡½æ•° * æ³¨æ„ï¼š * 1.é»˜è®¤å€¼çš„å‡½æ•°ä¸­ï¼Œå¦‚æžœä¼ å…¥çš„å‚æ•°ä¸ªæ•°ä¸Žå‡½æ•°å®šä¹‰ç›¸åŒï¼Œåˆ™ä¼ å…¥çš„æ•°å€¼ä¼šè¦†ç›–é»˜è®¤å€¼ * 2.å¦‚æžœä¸æƒ³è¦†ç›–é»˜è®¤å€¼ï¼Œä¼ å…¥çš„å‚æ•°ä¸ªæ•°å°äºŽå®šä¹‰çš„å‡½æ•°çš„å‚æ•°ï¼Œåˆ™éœ€è¦æŒ‡å®šå‚æ•°åç§° */ def fun3(a :Int = 10,b:Int) = &#123; println(a+b) &#125; fun3(b=2) 4ã€å¯å˜å‚æ•°ä¸ªæ•°çš„å‡½æ•°12345678910111213/** * å¯å˜å‚æ•°ä¸ªæ•°çš„å‡½æ•° * æ³¨æ„ï¼šå¤šä¸ªå‚æ•°é€—å·åˆ†å¼€ */def fun4(elem :Int*)=&#123; var sum = 0; for(e &lt;- elem)&#123; sum += e &#125; sum&#125;println(fun4(1,2,3,4)) 5ã€åŒ¿åå‡½æ•° æœ‰å‚åŒ¿åå‡½æ•° æ— å‚åŒ¿åå‡½æ•° æœ‰è¿”å›žå€¼çš„åŒ¿åå‡½æ•° å¯ä»¥å°†åŒ¿åå‡½æ•°è¿”å›žç»™valå®šä¹‰çš„å€¼ åŒ¿åå‡½æ•°ä¸èƒ½æ˜¾å¼å£°æ˜Žå‡½æ•°çš„è¿”å›žç±»åž‹ 123456789101112131415161718//æœ‰å‚æ•°åŒ¿åå‡½æ•°val fun1 = (a : Int ï¼Œ b : Int) =&gt; &#123; println(a+b)&#125;value1(1,2)//æ— å‚æ•°åŒ¿åå‡½æ•°val fun2 = ()=&gt;&#123; println("å•¦å•¦å•¦")&#125;fun2()//æœ‰è¿”å›žå€¼çš„åŒ¿åå‡½æ•°val fun3 = (a:Int,b:Int) =&gt;&#123; a+b&#125;println(fun3(4,4)) 6ã€ åµŒå¥—å‡½æ•°123456789101112131415/** * åµŒå¥—å‡½æ•° * ä¾‹å¦‚ï¼šåµŒå¥—å‡½æ•°æ±‚5çš„é˜¶ä¹˜ */ def fun5(num:Int)=&#123; def fun6(a:Int,b:Int):Int=&#123; if(a == 1)&#123; b &#125;else&#123; fun6(a-1,a*b) &#125; &#125; fun6(num,1) &#125; println(fun5(5)) 7ã€ååº”ç”¨å‡½æ•°123456789101112131415161718192021222324import java.util.Date /** * ååº”ç”¨å‡½æ•°æ˜¯ä¸€ç§è¡¨è¾¾å¼ * ä¸éœ€è¦æä¾›å‡½æ•°éœ€è¦çš„æ‰€æœ‰å‚æ•°ï¼Œ * åªéœ€è¦æä¾›éƒ¨åˆ†ï¼Œæˆ–ä¸æä¾›æ‰€éœ€å‚æ•°ã€‚ */ def log(date :Date, s :String)= &#123; println("date is "+ date +",log is "+ s) &#125; val date = new Date() log(date ,"log1") log(date ,"log2") log(date ,"log3") //æƒ³è¦è°ƒç”¨logï¼Œä»¥ä¸Šå˜åŒ–çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¯ä»¥ç”¨ååº”ç”¨å‡½æ•°å¤„ç†,æ¥ä¼˜åŒ–logæ–¹æ³• /* ç»‘å®šç¬¬ä¸€ä¸ª date å‚æ•°ï¼Œ * ç¬¬äºŒä¸ªå‚æ•°ä½¿ç”¨ä¸‹åˆ’çº¿(_)æ›¿æ¢ç¼ºå¤±çš„å‚æ•°åˆ—è¡¨ï¼Œ * å¹¶æŠŠè¿™ä¸ªæ–°çš„å‡½æ•°å€¼çš„ç´¢å¼•çš„èµ‹ç»™å˜é‡ã€‚ */ val logWithDate = log(date,_:String) logWithDate("log11") logWithDate("log22") logWithDate("log33") 8ã€é«˜é˜¶å‡½æ•°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970 /** * é«˜é˜¶å‡½æ•°:å°±æ˜¯æ“ä½œå…¶ä»–å‡½æ•°çš„å‡½æ•° * å‡½æ•°çš„å‚æ•°æ˜¯å‡½æ•° * æˆ–è€…å‡½æ•°çš„è¿”å›žæ˜¯å‡½æ•° * æˆ–è€…å‡½æ•°çš„å‚æ•°å’Œè¿”å›žéƒ½æ˜¯å‡½æ•° *///å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…è¿”å›žç´¯å¿ƒæ—¶ï¼Œåªéœ€æŒ‡æ˜Žå‡½æ•°ä¸­çš„ç±»åž‹ //å‡½æ•°çš„å‚æ•°æ˜¯å‡½æ•°ï¼š //f : (Int,Int) =&gt;Int ï¼ˆä¸¤ä¸ªIntåž‹å‚æ•°ã€Intåž‹è¿”å›žå€¼ï¼‰ def hightFun(f : (Int,Int) =&gt;Int, a:Int ) : Int = &#123; f(a,100) &#125; def f(v1 :Int,v2: Int):Int = &#123; v1+v2 &#125; println(hightFun(f, 1)) //*************** def test1(x: Int, f: (Int, Int) =&gt; Int) = &#123; var a = x + 100 a * f(1, 3) &#125; def sum(x: Int, y: Int): Int = &#123; x - y &#125; println(test6(10,sum))//------------------------------------------------ //å‡½æ•°çš„è¿”å›žå€¼ç±»åž‹ä¸ºå‡½æ•° ï¼š(Int,Int)=&gt;Int f2 //1ï¼Œ2,3,4ç›¸åŠ  def hightFun2(a : Int,b:Int) : (Int,Int)=&gt;Int = &#123; def f2 (v1: Int,v2:Int) :Int = &#123; v1+v2+a+b &#125; f2 &#125; println(hightFun2(1,2)(3,4)) //*********** def test2(x: Int): (Int) =&gt; String = &#123; def concat(y: Int): String = &#123; x + " !! " + y &#125; concat &#125; val concat: Int =&gt; String = test2(5) println(concat(7))// println(test2(5)(7)) //------------------------------------------------- //å‡½æ•°çš„å‚æ•°æ˜¯å‡½æ•°: f : (Int ,Int) =&gt; Int) //å‡½æ•°çš„è¿”å›žæ˜¯å‡½æ•°: (Int,Int) =&gt; Int def hightFun3(f : (Int ,Int) =&gt; Int) : (Int,Int) =&gt; Int = &#123; f &#125; println(hightFun3(f)(100,200)) println(hightFun3((a,b) =&gt;&#123;a+b&#125;)(200,200)) //ä»¥ä¸Šè¿™å¥è¯è¿˜å¯ä»¥å†™æˆè¿™æ · //å¦‚æžœå‡½æ•°çš„å‚æ•°åœ¨æ–¹æ³•ä½“ä¸­åªä½¿ç”¨äº†ä¸€æ¬¡ é‚£ä¹ˆå¯ä»¥å†™æˆ_è¡¨ç¤º println(hightFun3(_+_)(200,200)) //********** def test3(y: Int, f: (Int) =&gt; Int): (Int) =&gt; Int = &#123; var sum = f(1) + y def sum4(x: Int) = &#123; x + sum &#125; sum4 &#125;// def f2 (x: Int) =&#123;// x + 10// &#125; val f = test3(10,(x:Int)=&gt;&#123;x + 10&#125;)// println(f(5)) 9ã€æŸ¯é‡ŒåŒ–å‡½æ•°12345678910111213/** * æŸ¯é‡ŒåŒ–å‡½æ•° * å¯ä»¥ç†è§£ä¸ºé«˜é˜¶å‡½æ•°çš„ç®€åŒ– */ def fun1(a :Int,b:Int)(c:Int,d:Int) = &#123; a+b+c+d &#125; println(fun1(1,2)(3,4)) //******* def fun(a :Int)(c:Int) = &#123; a+c &#125; println(fun(1)(3)) äº”ã€å­—ç¬¦ä¸²1ã€string | stringBuilder (å¯å˜)2ã€æ“ä½œæ–¹æ³•Ã˜ æ¯”è¾ƒ:equals Ã˜ æ¯”è¾ƒå¿½ç•¥å¤§å°å†™:equalsIgnoreCase Ã˜ indexOfï¼šå¦‚æžœå­—ç¬¦ä¸²ä¸­æœ‰ä¼ å…¥çš„assciç å¯¹åº”çš„å€¼ï¼Œè¿”å›žä¸‹æ ‡ 12345678910111213141516171819202122232425262728293031323334353637383940 /** * String &amp;&amp; StringBuilder */ val str = "abcd" val str1 = "ABCD" println(str.indexOf(97)) println(str.indexOf("b")) println(str==str1) println(str.equals(str1)) println(str.equalsIgnoreCase(str1)) /** * compareToIgnoreCase * * å¦‚æžœå‚æ•°å­—ç¬¦ä¸²ç­‰äºŽæ­¤å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›žå€¼ 0ï¼› * å¦‚æžœæ­¤å­—ç¬¦ä¸²å°äºŽå­—ç¬¦ä¸²å‚æ•°ï¼Œåˆ™è¿”å›žä¸€ä¸ªå°äºŽ 0 çš„å€¼ï¼› * å¦‚æžœæ­¤å­—ç¬¦ä¸²å¤§äºŽå­—ç¬¦ä¸²å‚æ•°ï¼Œåˆ™è¿”å›žä¸€ä¸ªå¤§äºŽ 0 çš„å€¼ã€‚ * */ println(str.compareToIgnoreCase(str1)) val strBuilder = new StringBuilder() //æ‹¬å·å¯çœ strBuilder.append("abc")//ä¸€ä¸ª + åªèƒ½è·Ÿå•ä¸ªå­—ç¬¦ä¸”å¿…é¡»ç”¨å•å¼•å·ï¼Œå¦åˆ™æ— æ•ˆ // strBuilder.+('d') strBuilder+ 'd'// strBuilder.+=('h') strBuilder+= 'h' //ä¸¤ä¸ª+ å¯è·Ÿå¤šä¸ªå­—ç¬¦ä¸”å¿…é¡»ç”¨åŒå¼•å·// strBuilder.++=("efg") strBuilder++= "efg"//StringBuilderå¯ä»¥è¿½åŠ æµ®ç‚¹æ•° strBuilder.append(1.0) strBuilder.append(18f) println(strBuilder) println(strBuilder.toString()) å…­ã€é›†åˆ1ã€æ•°ç»„ï¼ˆ1ï¼‰åˆ›å»ºä¸€ç»´æ•°ç»„1234567891011121314/** * åˆ›å»ºæ•°ç»„ä¸¤ç§æ–¹å¼ï¼š * 1.new Array[String](3) * 2.ç›´æŽ¥Array */ //åˆ›å»ºç±»åž‹ä¸ºInt é•¿åº¦ä¸º3çš„æ•°ç»„ val arr1 = new Array[Int](3) //åˆ›å»ºString ç±»åž‹çš„æ•°ç»„ï¼Œç›´æŽ¥èµ‹å€¼ val arr2 = Array[String]("s100","s200","s300") //èµ‹å€¼ arr1(0) = 100 arr1(1) = 200 arr1(2) = 300 ï¼ˆ2ï¼‰æ•°ç»„éåŽ†123456789101112131415161718/** * éåŽ†ä¸¤ç§æ–¹å¼ * for * foreach */ for(i &lt;- arr1)&#123; println(i) &#125; arr1.foreach(i =&gt; &#123; println(i) &#125;) for(s &lt;- arr2)&#123; println(s) &#125; arr2.foreach &#123; x =&gt; println(x) &#125; ï¼ˆ3ï¼‰æ•°ç»„æ“ä½œ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768Array.concatï¼šåˆå¹¶æ•°ç»„Array.fill(5)(â€œshsxtâ€)ï¼šåˆ›å»ºåˆå§‹å€¼çš„å®šé•¿æ•°ç»„def main(args: Array[String]): Unit = &#123; val a = new Array[Int](3) a(0) = 1 a(1) = 2 a(2) = 3//åˆ¤æ–­æ•°ç»„ä¸­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ çš„ä¸ªæ•°// val n = a.count(x=&gt;&#123;// if(x&gt;2)// true// else// false// &#125;)//// println(n) val b = Array(4,5,6)//å°†ä¸¤ä¸ªæ•°ç»„çš„å…ƒç´ åˆå¹¶åœ¨ä¸€ä¸ªæ–°çš„æ•°ç»„ä¸­ val ints = Array.concat(a,b)//éåŽ†æ•°ç»„ ints.foreach(println)//åˆ›å»ºåŒ…å«5ä¸ªæŒ‡å®šå…ƒç´ çš„æ•°ç»„ val strings = Array.fill(5)("shsxt") strings.foreach(println)//// for(i &lt;- a)&#123;// println(i)// &#125;//// val b = Array(4,5,6)//// for(i &lt;- b)&#123;// println(i)// &#125;// a.foreach(x=&gt; &#123; println(x) &#125; )// a.foreach(println(_))// a.foreach(println)// val c = new Array[Array[Int]](3)// c(0) = Array(1,2,3)// c(1) = Array(4,5,6)// c(2) = Array(7,8,9)// c.foreach(x=&gt;&#123;// x.foreach(y=&gt;&#123;// print(y + "\t")// &#125;)// println()// &#125;)// for(i&lt;-c)&#123;// for(j &lt;-i)&#123;// print(j + "\t")// &#125;// println()// &#125; &#125; ï¼ˆ4ï¼‰åˆ›å»ºäºŒç»´æ•°ç»„123456789101112131415161718192021222324252627282930313233343536/** * åˆ›å»ºäºŒç»´æ•°ç»„å’ŒéåŽ† */ val arr3 = new Array[Array[String]](3) arr3(0)=Array("1","2","3") arr3(1)=Array("4","5","6") arr3(2)=Array("7","8","9") for(i &lt;- 0 until arr3.length)&#123; for(j &lt;- 0 until arr3(i).length)&#123; print(arr3(i)(j)+" ") &#125; println() &#125; var count = 0 for(arr &lt;- arr3 ;i &lt;- arr)&#123; if(count%3 == 0)&#123; println() &#125; print(i+" ") count +=1 &#125; arr3.foreach &#123; arr =&gt; &#123; arr.foreach &#123; println &#125; &#125;&#125; val arr4 = Array[Array[Int]](Array(1,2,3),Array(4,5,6)) arr4.foreach &#123; arr =&gt; &#123; arr.foreach(i =&gt; &#123; println(i) &#125;) &#125;&#125; println("-------") for(arr &lt;- arr4;i &lt;- arr)&#123; println(i) 2ã€listï¼ˆ1ï¼‰åˆ›å»ºlist1val list = List(1,2,3,4) å¤‡æ³¨ Nil é•¿åº¦ä¸º0çš„list ï¼ˆ2ï¼‰listéåŽ† foreach ï¼Œfor ï¼ˆ3ï¼‰listæ“ä½œ12345678910111213141516171819202122232425262728 //åˆ›å»º val list = List(1,2,3,4,5) //éåŽ† list.foreach &#123; x =&gt; println(x)&#125;// list.foreach &#123; println&#125; //filter è¿‡æ»¤å…ƒç´  val list1 = list.filter &#123; x =&gt; x&gt;3 &#125; list1.foreach &#123; println&#125; //count è®¡ç®—ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ªæ•° val value = list1.count &#123; x =&gt; x&gt;3 &#125; println(value) //map å¯¹å…ƒç´ æ“ä½œ å¦‚åˆ‡åˆ† val nameList = List( "hello shsxt", "hello xasxt", "hello shsxt" ) val mapResult:List[Array[String]] = nameList.map&#123; x =&gt; x.split(" ") &#125; mapResult.foreach&#123;println&#125; //flatmap å°†å…ƒç´ åŽ‹æ‰å¹³,å…ˆmapå†flat val flatMapResult : List[String] = nameList.flatMap&#123; x =&gt; x.split(" ") &#125; flatMapResult.foreach &#123; println &#125; 3ã€setæ³¨æ„ï¼šseté›†åˆè‡ªåŠ¨åŽ»é‡ 1234567891011121314151617181920212223242526272829303132val s = Set(1,2,3,3)val s1 = Set(1ï¼Œ2ï¼Œ3ï¼Œ4)//éåŽ†æ—¶ï¼Œè‡ªåŠ¨åŽ»é‡s.foreach(println) for(x&lt;- s)&#123;println(x)&#125;//äº¤é›†val inse = s.intersect(s1)val ins = s.&amp;(s1)inse.foreach(println)inse.foreach&#123;println&#125;//å·®é›†val di = s.diff(s1)val de = s.&amp;~(s1)//å­é›†:sæ˜¯ä¸æ˜¯s1çš„å­é›†val boo: Boolean = s.subsetof(s1)//max ,minval max = s.maxval min = s.minprintln(max + ":" + min)//è½¬æˆæ•°ç»„ï¼Œlists.toArray.foreach(println)s.toList.foreach(println)//mkString , å…ƒç´ ä»¥ï¼åˆ†éš”æ‹¼æˆå­—ç¬¦ä¸²println(s.mkString)println(s.mkstring("!")) 4ã€map1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162//mapåˆ›å»ºæ—¶ï¼Œè‹¥keyç›¸åŒï¼Œåˆ™éƒ½ä¼šè¢«åŽä¸€ä¸ªkeyè¦†ç›–val map =Mapï¼ˆ"1"-&gt;"a",("3","c"),"2"-&gt;"b"ï¼‰//èŽ·å–mapå€¼println(map.get("1"))println(map.get("1").get)//èŽ·å–æŒ‡å®škeyï¼Œè‹¥æ²¡æœ‰ï¼Œå°±ç”¨å¦ä¸€ä¸ªæŒ‡å®šå€¼ä»£æ›¿println(map.getOrElse("5","100"))val res = map.get("8").getOrElse("800")println(res)//éåŽ†map//xä¸ºmapä¸­çš„ä¸€ç»„é”®å€¼å¯¹for(x-&gt; map)&#123;println("key:"+x._1+",value:"+ x._2) &#125;map.foreach(x=&gt;&#123; println("key:"+x._1+",value:"+ x._2) &#125;)//éåŽ†keyval keyIteratable = map.keyskeyIteratable.foreach(k=&gt;&#123;println("key"+k+",value"+map.get(k).get)&#125;)//éåŽ†valueval valueIteratable = map.valuesvalueIteratable.foreach&#123;v=&gt;&#123; println("value"+v)&#125;&#125;//åˆå¹¶mapval map1 = Mapï¼ˆ(1ï¼Œ"a"),(2,"b"),(3,"c")ï¼‰val map2 = Mapï¼ˆ(1,"aa"),(2,"bb"),(3,"cc")ï¼‰map1.++(map2).foreach(println)map1.++:(map2).oreach(println)//mapæ“ä½œæ–¹æ³•//filter:è¿‡æ»¤ï¼Œç•™ä¸‹ç¬¦åˆæ¡ä»¶çš„å…ƒç´ val result = map.filter(x=&gt;&#123;if(x._1.equals("1")) trueelse false&#125;)result.foreach(println)map.filter(_._2.equals("a")).foreach(println)//countï¼šç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ªæ•°val countResult = map.countï¼ˆx=&gt;&#123; x._1.equals("1")ï¼‰println(countResult) //containsï¼šåˆ¤æ–­mapä¸­æ˜¯å¦åŒ…å«æŸä¸ªkeymap.contains("3")//existï¼šåˆ¤æ–­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æ˜¯å­˜åœ¨//è‹¥é‡åˆ°æ¡ä»¶è¿”å›žç»“æžœä¸ºtrueï¼Œå°±åœæ­¢è¿­ä»£map.exists(x=&gt;&#123;ifï¼ˆx._1.equals("3"))&#123;println("å­˜åœ¨å–½")&#125;elseprintln("ä¸å­˜åœ¨å–½")&#125;) 5ã€å…ƒç»„TupleåŒï¼šä¸Žåˆ—è¡¨ç±»ä¼¼ ä¸åŒï¼šå…ƒç»„å¯ä»¥åŒ…å«ä¸åŒç±»åž‹çš„å…ƒç´ ï¼›å…ƒç»„çš„å€¼æ˜¯é€šè¿‡å°†å•ä¸ªå€¼åŒ…å«åœ¨åœ†æ‹¬å·ä¸­æž„æˆ æ³¨æ„ï¼šTupleæœ€å¤šæ”¯æŒ22ä¸ªå‚æ•° 1234567891011121314151617181920212223//å…ƒç´ ä¸ªæ•°å–å†³äºŽTupleåŽé¢çš„æ•°å­—val t1 = new Tuple1(1)val t2 = new Tuple2(1,2)val t3 = Tuple3(1,2,3) val t5 = (1,2,3ï¼Œ4,5)val t22 = new Tuple22(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)//èŽ·å–å…ƒç»„ä¸­çš„å€¼ ï¼šç”¨ ._XX printlnï¼ˆt5._4ï¼‰val t = Tuple2((1,2),("zhangsan","lisi"))println(t._1._2)//å…ƒç»„éåŽ†ï¼šå…ƒç´ è¿­ä»£å™¨val interator = t5.productorInteratorinterator.foreach(println)while(interator.hasNext)&#123; println(intrator.next())&#125;//å…ƒç´ ç¿»è½¬ swapï¼Œ åªé’ˆå¯¹äºŒå…ƒæ•°ç»„println(t2.swap)//è½¬æ¢æˆå­—ç¬¦ä¸²println(t5.toString()) ä¸ƒã€traitScalaï¼šåªæœ‰extends ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªTrait Scala Trait(ç‰¹å¾) ç›¸å½“äºŽ Java çš„æŽ¥å£å’ŒæŠ½è±¡ç±»çš„ç»“åˆ å¯ä»¥å®šä¹‰å±žæ€§å’Œæ–¹æ³• æ³¨æ„ï¼š è‹¥ç»§æ‰¿çš„å¤šä¸ªtraitä¸­åŒ…å«åŒåçš„å±žæ€§å’Œæ–¹æ³•ï¼Œå°±å¿…é¡»åœ¨åœ¨ç±»ä¸­ä½¿ç”¨override é‡æ–°å®šä¹‰ è‹¥é‡æ–°å®šä¹‰çš„å±žæ€§æ˜¯ä½¿ç”¨varå®šä¹‰çš„åˆ™ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯ä½¿ç”¨valå®šä¹‰çš„å±žæ€§æ‰å¯ä½¿ç”¨override traitä¸­ä¸èƒ½ä¼ å‚æ•° ä¸¾ä¾‹ï¼štraitä¸­å¸¦å±žæ€§å¸¦æ–¹æ³•å®žçŽ° 1234567891011121314151617181920212223242526272829303132trait Read&#123; var name = "read" val age = 18 def read():Unit=&#123; println("read---") &#125;&#125;trait Write&#123; var name = "write" val age = 19 def write():Unit=&#123; println("write----") &#125;&#125;class Human extends Read with Write&#123; //å‰ænameå¿…é¡»æ˜¯ç”¨valå®šä¹‰çš„ // override var name = "person" override val age = 20 name = "person"&#125;object Trait&#123; def main(args:Array[String]):Unit = &#123; val human = new Human() println(human.name) human.read() human.write() &#125;&#125; ä¸¾ä¾‹ï¼štraitä¸­å¸¦æ–¹æ³•ä¸å®žçŽ° 12345678910111213141516171819202122232425262728293031trait Equal&#123; //æŠ½è±¡æ–¹æ³• def isEqual(p:Point):Boolean def isNoEqual(p:Point):Boolean=&#123; !isEqual(p) &#125;&#125;class Point(x:Int,y:Int) extends Equal &#123; var xx = x var yy = y override def isEqual (p:Point) = &#123; p.xx == xx &amp; p.yy ==yy &#125; def isEqule(p:Any) = &#123; p.isInstanceOf[Point] &amp;&amp; p.asInstanceOf[Point].xx==xx &#125;&#125;object Trait2&#123; def main(args:Array[String]):Unit = &#123; val p1 = new Point(3,5) val p2 = new Point(4,5) ptintln(p1.isNoEqual(p2)) ptintln(p1.isEqual(p2)) &#125;&#125; å…«ã€æ¨¡å¼åŒ¹é…match1ã€æ¦‚å¿µç†è§£ ä¸€ä¸ªæ¨¡å¼åŒ¹é…åŒ…å«å¤šä¸ªå¤‡é€‰é¡¹ï¼Œä¸”æ¯ä¸ªéƒ½ä»¥å…³é”®å­—caseå¼€å§‹ æ¯ä¸ªå¤‡é€‰é¡¹éƒ½åŒ…å«ä¸€ä¸ªæ¨¡å¼å’Œå¤šä¸ªè¡¨è¾¾å¼ï¼Œä¸”ç”¨ç®­å¤´ç¬¦å· =&gt; éš”å¼€äº†æ¨¡å¼å’Œè¡¨è¾¾å¼ã€‚ Ã˜ æ¨¡å¼åŒ¹é…ä¸ä»…å¯ä»¥åŒ¹é…å€¼è¿˜å¯ä»¥åŒ¹é…ç±»åž‹ Ã˜ ä»Žä¸Šåˆ°ä¸‹é¡ºåºåŒ¹é…ï¼Œå¦‚æžœåŒ¹é…åˆ°åˆ™ä¸å†å¾€ä¸‹åŒ¹é… Ã˜ éƒ½åŒ¹é…ä¸ä¸Šæ—¶ï¼Œä¼šåŒ¹é…åˆ°case_ ,ç›¸å½“äºŽdefault Ã˜ match çš„æœ€å¤–é¢çš„â€{ }â€å¯ä»¥åŽ»æŽ‰çœ‹æˆä¸€ä¸ªè¯­å¥ 123456789101112131415161718192021object Match&#123; def main(args:Array[String]):Unit = &#123; val p1 =(1,2,3f,"4","abc",55d) p1.foreach(x=&gt;&#123; println(mymatch(x)) &#125;) &#125; def mymatch(x:Any)=&#123; x match &#123; case "4" =&gt;println("macth 4--") case x:String =&gt; println("match String") case 1 =&gt; println("1--") case 2 =&gt; println("2--") case 3f =&gt; println("3f--") // case x :Double =&gt; println("type is Double") case _ =&gt; println("no match--") &#125; &#125;&#125; ä¹ã€æ ·ä¾‹ç±»1ã€æ¦‚å¿µç†è§£ ä½¿ç”¨äº†caseå…³é”®å­—çš„ç±»å®šä¹‰å°±æ˜¯æ ·ä¾‹ç±»(case classes) æ ·ä¾‹ç±»æ˜¯ç§ç‰¹æ®Šçš„ç±»ã€‚å®žçŽ°äº†ç±»æž„é€ å‚æ•°çš„getteræ–¹æ³•ï¼ˆæž„é€ å‚æ•°é»˜è®¤è¢«å£°æ˜Žä¸ºvalï¼‰ï¼Œå½“æž„é€ å‚æ•°æ˜¯å£°æ˜Žä¸ºvarç±»åž‹çš„ï¼Œå®ƒå°†å¸®ä½ å®žçŽ°setterå’Œgetteræ–¹æ³•ã€‚ Ã˜ æ ·ä¾‹ç±»é»˜è®¤å¸®ä½ å®žçŽ°äº†toString,equalsï¼Œcopyå’ŒhashCodeç­‰æ–¹æ³•ã€‚ Ã˜ æ ·ä¾‹ç±»å¯ä»¥new, ä¹Ÿå¯ä»¥ä¸ç”¨new 2ã€ä¸¾ä¾‹ï¼šç»“åˆæ¨¡å¼åŒ¹é…çš„ä»£ç  1234567891011121314151617181920212223object Match2&#123; def main(args:Array[String]):Unit = &#123; val zs = new Woman(18,"zs") println(zs.age + " : "+ zs . name) val mm = Woman(19,"meimei") val nn = Woman(19,"meimei") println(mm.equals(zs)) println(mm.equals(nn)) val wo = List(ls,mm) wo.foreach(x=&gt;&#123; x match &#123; case x:Woman =&gt; println("match Woman--") case Woman(18,"ls") =&gt; println("ls") case Woman(19,"mm") =&gt; println("mm") case Woman(19,"zs") =&gt; println("zs") &#125; &#125;) &#125;&#125;case class Woman (age:Int ,name:String) åã€Actor Model\1. æ¦‚å¿µç†è§£ Actor Modelæ˜¯ç”¨æ¥ç¼–å†™å¹¶è¡Œè®¡ç®—æˆ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„é«˜å±‚æ¬¡æŠ½è±¡ï¼ˆç±»ä¼¼javaä¸­çš„Threadï¼‰è®©ç¨‹åºå‘˜ä¸å¿…ä¸ºå¤šçº¿ç¨‹æ¨¡å¼ä¸‹å…±äº«é”è€Œçƒ¦æ¼,è¢«ç”¨åœ¨Erlang è¯­è¨€ä¸Š, é«˜å¯ç”¨æ€§99.9999999 % ä¸€å¹´åªæœ‰31ms å®•æœºActorså°†çŠ¶æ€å’Œè¡Œä¸ºå°è£…åœ¨ä¸€ä¸ªè½»é‡çš„è¿›ç¨‹/çº¿ç¨‹ä¸­ï¼Œä½†æ˜¯ä¸å’Œå…¶ä»–Actorsåˆ†äº«çŠ¶æ€ï¼Œæ¯ä¸ªActorsæœ‰è‡ªå·±çš„ä¸–ç•Œè§‚ï¼Œå½“éœ€è¦å’Œå…¶ä»–Actorsäº¤äº’æ—¶ï¼Œé€šè¿‡å‘é€äº‹ä»¶å’Œæ¶ˆæ¯ï¼Œå‘é€æ˜¯å¼‚æ­¥çš„ï¼Œéžå µå¡žçš„(fire-andforget)ï¼Œå‘é€æ¶ˆæ¯åŽä¸å¿…ç­‰å¦å¤–Actorså›žå¤ï¼Œä¹Ÿä¸å¿…æš‚åœï¼Œæ¯ä¸ªActorsæœ‰è‡ªå·±çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿›æ¥çš„æ¶ˆæ¯æŒ‰å…ˆæ¥åŽåˆ°æŽ’åˆ—ï¼Œè¿™å°±æœ‰å¾ˆå¥½çš„å¹¶å‘ç­–ç•¥å’Œå¯ä¼¸ç¼©æ€§ï¼Œå¯ä»¥å»ºç«‹æ€§èƒ½å¾ˆå¥½çš„äº‹ä»¶é©±åŠ¨ç³»ç»Ÿã€‚ Actorçš„ç‰¹å¾ï¼š Ã˜ ActorModelæ˜¯æ¶ˆæ¯ä¼ é€’æ¨¡åž‹,åŸºæœ¬ç‰¹å¾å°±æ˜¯æ¶ˆæ¯ä¼ é€’ Ã˜ æ¶ˆæ¯å‘é€æ˜¯å¼‚æ­¥çš„ï¼Œéžé˜»å¡žçš„ Ã˜ æ¶ˆæ¯ä¸€æ—¦å‘é€æˆåŠŸï¼Œä¸èƒ½ä¿®æ”¹ Ã˜ Actorä¹‹é—´ä¼ é€’æ—¶ï¼Œè‡ªå·±å†³å®šå†³å®šåŽ»æ£€æŸ¥æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰å¾…ï¼Œæ˜¯å¼‚æ­¥éžé˜»å¡žçš„ ä»€ä¹ˆæ˜¯Akka Akka æ˜¯ä¸€ä¸ªç”¨ Scala ç¼–å†™çš„åº“ï¼Œç”¨äºŽç®€åŒ–ç¼–å†™å®¹é”™çš„ã€é«˜å¯ä¼¸ç¼©æ€§çš„ Java å’ŒScala çš„ Actor æ¨¡åž‹åº”ç”¨ï¼Œåº•å±‚å®žçŽ°å°±æ˜¯Actor,Akkaæ˜¯ä¸€ä¸ªå¼€å‘åº“å’Œè¿è¡ŒçŽ¯å¢ƒï¼Œå¯ä»¥ç”¨äºŽæž„å»ºé«˜å¹¶å‘ã€åˆ†å¸ƒå¼ã€å¯å®¹é”™ã€äº‹ä»¶é©±åŠ¨çš„åŸºäºŽJVMçš„åº”ç”¨ã€‚ä½¿æž„å»ºé«˜å¹¶å‘çš„åˆ†å¸ƒå¼åº”ç”¨æ›´åŠ å®¹æ˜“ã€‚ spark1.6ç‰ˆæœ¬ä¹‹å‰ï¼Œsparkåˆ†å¸ƒå¼èŠ‚ç‚¹ä¹‹é—´çš„æ¶ˆæ¯ä¼ é€’ä½¿ç”¨çš„å°±æ˜¯Akkaï¼Œåº•å±‚ä¹Ÿå°±æ˜¯actorå®žçŽ°çš„ã€‚1.6ä¹‹åŽä½¿ç”¨çš„nettyä¼ è¾“ã€‚ 12345678910111213141516171819202122class MyActor extends Actor&#123;override def act():Unit=&#123; while(true)&#123; receive &#123; case "hello"=&gt;println("hello") case x:String =&gt; println("save String ="+ x) case x:Int =&gt; println("save Int") case _ =&gt; println("save default") &#125; &#125;&#125;object Actor&#123; def main(args:Array[String]):Unit = &#123; val actor = new MyActor() //å¯åŠ¨ actor.start() //å‘é€æ¶ˆæ¯ actor ! "hello" &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445case class Msg(actor)()class WoActor() extends Actor&#123; oevrride def act():Unit =&#123; while(true)&#123; receive &#123; case msg:Msg =&gt;&#123; msg.mes //æ”¶åˆ°çš„æ¶ˆæ¯ msg.actor //å›žå¤çš„æ¶ˆæ¯ println("too") msg.actor ! "hahaha" &#125; &#125; &#125; &#125;&#125;class HuActor(wo:WoActor) extends Actor&#123; oevrride def act():Unit =&#123; while(true)&#123; receive &#123; case "hello" =&gt;&#123; println("too") val msg = Msg(this,"rrr") wo ! msg &#125; case "rrr" =&gt;&#123; println("uuu") val msg = Msg(this,"heheh") wo ! msg &#125; &#125; &#125; &#125;&#125;object Actor2&#123; def main(args:Array[String]):Unit = &#123; val woman = new WoActor() val human = new HuActor(woman) human.start() woman.start() human ! "hello" &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243case class Message(actor:Actor,msg:Any)class Actor1 extends Actor&#123; def act()&#123; while(true)&#123; receive&#123; case msg :Message =&gt; &#123; println("i sava msg! = "+ msg.msg) msg.actor!"i love you too !" &#125; case msg :String =&gt; println(msg) case _ =&gt; println("default msg!") &#125; &#125; &#125;&#125;class Actor2(actor :Actor) extends Actor&#123; actor ! Message(this,"i love you !") def act()&#123; while(true)&#123; receive&#123; case msg :String =&gt; &#123; if(msg.equals("i love you too !"))&#123; println(msg) actor! "could we have a date !" &#125; &#125; case _ =&gt; println("default msg!") &#125; &#125; &#125;&#125;object Lesson_Actor2 &#123; def main(args: Array[String]): Unit = &#123; val actor1 = new Actor1() actor1.start() val actor2 = new Actor2(actor1) actor2.start() &#125;&#125; åä¸€ã€WordCount1234567891011121314151617181920212223242526272829303132333435363738//åœ¨libæ–‡ä»¶ä¸­æ·»åŠ sparkçš„jaråŒ… ï¼Œå¹¶addLibimport org.apache.spark.SparkConfimport org.apache.spark.SparkContextimport org.apache.spark.rdd.RDDimport org.apache.spark.rdd.RDD.rddToPairRDDFunctionsobject WordCount &#123; def main(args: Array[String]): Unit = &#123; val conf = new SparkConf() conf.setMaster("local").setAppName("WC") val sc = new SparkContext(conf) //ç”¨äºŽäº†è§£é›†ç¾¤ //RDD:é›†åˆ ï¼ŒæŠ½è±¡çš„ val lines :RDD[String] = sc.textFile("./words.txt") //æ–¹å¼ä¸€ï¼š val word :RDD[String] = lines.flatMap&#123;lines =&gt; &#123; lines.split(" ") //åŒ¿åå‡½æ•° &#125;&#125; val pairs:RDD[(String,Int)] = word.map&#123; x =&gt; (x,1) &#125; //map :ä¸€è¿›ä¸€å‡º flatmapï¼šä¸€è¿›å¤šå‡º xï¼šæ¯ä¸ªå•è¯ val result:RDD[(String,Int)] = pairs.reduceByKey&#123;(a,b)=&gt; &#123; println("a:"+a+",b:"+b) a+b //ç›¸å½“äºŽ a = a + bç”¨äºŽä¸‹ä¸€ä¸ªç»Ÿè®¡ &#125;&#125; //ä¼˜åŒ–ï¼šæŽ’åº falseï¼ˆé™åºï¼‰ ç¬¬ä¸€ä¸ª_ ä»£è¡¨æ¯ä¸ªå…ƒç´  result.sortBy(_._2,false).foreach(println) //æ–¹å¼äºŒï¼šç®€åŒ–å†™æ³• lines.flatMap &#123; _.split(" ")&#125;.map &#123; (_,1)&#125;.reduceByKey(_+_).foreach(println) &#125;&#125;]]></content>
      <categories>
        <category>Scala</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>é™æ€</tag>
        <tag>JVM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Rediså­¦ä¹ ]]></title>
    <url>%2F2019%2F02%2F14%2FRedis%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Redisçš„ç®€ä»‹1ã€å‰æƒ…æè¦ç£ç›˜æ•°æ®åº“ï¼š MySQLï¼ˆå…³ç³»åž‹æ•°æ®åº“ï¼‰ Hbase å†…å­˜æ•°æ®åº“ï¼š Redis memcached ï¼ˆæˆæœ¬é«˜ã€æ€§èƒ½å¥½ã€è¯»å†™é€Ÿåº¦å¿«ã€æ•°æ®å®‰å…¨æ€§ä½Žã€ç›´æŽ¥æŠŠå€¼æ”¾åˆ°å†…å­˜é‡Œé¢ï¼Œå†…å­˜æ•°æ®åº“å°±ç›´æŽ¥æŠŠå€¼å–åˆ°ï¼‰ 2ã€ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ äºŒå…«æ³•åˆ™ï¼š80%æ˜¯ç»å¸¸è¢«æŸ¥è¯¢ï¼Œä½¿ç”¨å†…å­˜æ•°æ®åº“åšç¼“å­˜ä¸­é—´ä»¶ï¼Œè¯»å–æ€§èƒ½é«˜ äºŒã€Redisçš„ç‰¹ç‚¹1ã€æ•°æ®ç»“æž„ä¸°å¯ŒRedisè™½ç„¶æ˜¯é”®å€¼å¯¹æ•°æ®åº“ï¼Œä½†ä»–æ”¯æŒå¤šç§ç±»åž‹çš„æ•°æ®ç»“æž„ï¼ˆä¸»è¦æ˜¯ä¸åŒç±»åž‹çš„valueï¼‰ å­—ç¬¦ä¸²ã€æ•£åˆ—ï¼ˆhashesï¼‰ï¼Œåˆ—è¡¨ï¼ˆlistsï¼‰ï¼Œé›†åˆï¼ˆsetsï¼‰ï¼Œæœ‰åºé›†åˆï¼ˆsorted setsï¼‰ 2ã€æ•°æ®çš„æŒä¹…åŒ–Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½åˆ°å†…å­˜è¿›è¡Œä½¿ç”¨ 3ã€æ•°æ®çš„å¤‡ä»½Redis æ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³ master-slave æ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚ ä¸‰ã€Redisçš„å®‰è£…1ã€ä¸‹è½½å®‰è£…åŒ…redis-3.2.9.tar.gz ç½‘å€ï¼šhttp://www.redis.cn/download.html 2ã€ä¾èµ–è½¯ä»¶å®‰è£…1yum install gcc tcl -y 3ã€è§£åŽ‹ rediså¹¶è¿›å…¥è§£åŽ‹ç›®å½• 1tar -zvxf redis-3.2.9.tar.gz 4ã€ æ‰§è¡Œ ç¼–è¯‘å‘½ä»¤ï¼ˆæ³¨æ„ï¼šå½“å‰è·¯å¾„ä¸‹éœ€åŒ…å« makefileæ–‡ä»¶ ï¼š ç”¨äºŽæ‰‹åŠ¨ç¼–è¯‘ï¼‰ 1make &amp;&amp; make install 5ã€ä¿®æ”¹ redis çš„é…ç½®æ–‡ä»¶ redis.config ( å…ˆ å¤‡ä»½ä¸€ä¸ªåŽŸåŽ‚é…ç½®æ–‡ä»¶) 1vim redis.config ä¿®æ”¹è¿è¡Œæ¨¡å¼ä¸ºåŽå°è¿è¡Œï¼ˆå¦‚æžœä¸ºnoï¼Œå¯åŠ¨redis-serveråŽï¼ŒæŽ§åˆ¶å°å°±ä¼šå¡åœ¨å¯åŠ¨çŠ¶æ€ï¼‰daemonizeå®ˆæŠ¤è¿›ç¨‹ daemonize yes æŒ‡å®šredisæ•°æ®æŒä¹…åŒ–çš„è·¯å¾„(åœ¨æ‰§è¡Œredis-cliå‘½ä»¤çš„å½“å‰è·¯å¾„ï¼Œä¼šç”Ÿæˆdump.rdbæ–‡ä»¶) dir ./ ä½¿ç”¨é»˜è®¤çš„ redis.conf æ–‡ä»¶ï¼Œredis é»˜è®¤åªèƒ½é€šè¿‡ 127.0.0.1:6379 è¿™ä¸ªåœ°å€è®¿é—®ï¼Œè¿™æ ·å°±åªèƒ½åœ¨æœ¬æœºä¸Šæ“ä½œäº† æƒ³è¦è¿œç¨‹æ“ä½œï¼Œéœ€è¦ä¿®æ”¹redis.conf è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”çš„ ip åœ°å€ï¼Œ åœ¨bind 127.0.0.1 åŽé¢è¿½åŠ  bind 127.0.0.1 192.168.198.128 6ã€å¯åŠ¨serveræœåŠ¡ï¼ˆå¦‚åœ¨redisçš„è§£åŽ‹ç›®å½•ä¸‹ï¼‰ å‘½ä»¤ï¼š redis-server é…ç½®æ–‡ä»¶çš„åœ°å€ 1redis-server redis-conf ç»ˆæ­¢æœåŠ¡ï¼šï¼ˆæŸ¥è¯¢redisè¿›ç¨‹å·ï¼Œç„¶åŽï¼Œkillè¯¥è¿›ç¨‹ï¼‰ 12ps -ef | grep rediskill è¿›ç¨‹å· 7ã€å¯åŠ¨å®¢æˆ·ç«¯æœåŠ¡1redis-cli æ˜¾ç¤ºï¼š 127.0.0.1:6379&gt; å››ã€Redisçš„ä½¿ç”¨0ã€å‰æƒ…æè¦Redisçš„key å€¼æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥ç”¨ä»»ä½•äºŒè¿›åˆ¶åºåˆ—ä½œä¸º keyå€¼ã€‚ 1ã€åˆ‡æ¢æ•°æ®åº“ï¼ˆå®žä¾‹ï¼‰ select databaseid é»˜è®¤å…±æœ‰ 16 ä¸ªå®žä¾‹åº“ï¼Œ ç™»å½•æ—¶æ˜¯ ID ä¸º0 çš„æ•°æ®åº“ï¼Œæ€»å…±æœ‰ 16 ä¸ª 1select 0 2ã€Keyæ“ä½œï¼šï¼ˆå‰æï¼šæ˜¯é’ˆå¯¹å·²ç»å­˜åœ¨keyï¼‰ KEYS patternæŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ pattern çš„ key ã€‚ 12&gt; keys * &gt; åˆ—å‡ºæ‰€æœ‰Key EXISTS keyæ£€æŸ¥ç»™å®š key æ˜¯å¦å­˜åœ¨ã€‚ 12&gt; EXISTS name&gt; è‹¥æ˜¾ç¤º0ï¼Œåˆ™ä¸å­˜åœ¨ï¼›è‹¥æ˜¾ç¤º1ï¼Œåˆ™å­˜åœ¨ EXPIRE key secondsä¸ºç»™å®š key è®¾ç½®ç”Ÿå­˜æ—¶é—´ï¼Œå½“ key è¿‡æœŸæ—¶(ç”Ÿå­˜æ—¶é—´ä¸º 0 )ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚ 12&gt; EXPIRE age 1&gt; è‹¥è®¾ç½®æˆåŠŸï¼Œæ˜¾ç¤º1ï¼›æ˜¾ç¤º0 ï¼Œåˆ™ä¸ºå¤±è´¥ï¼Œå¯èƒ½æ˜¯è¯¥keyä¸å­˜åœ¨ TTL keyä»¥ç§’ä¸ºå•ä½ï¼Œè¿”å›žç»™å®š key çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ MOVE key db å°†å½“å‰æ•°æ®åº“çš„ key ç§»åŠ¨åˆ°ç»™å®šçš„æ•°æ®åº“ db å½“ä¸­ã€‚å¦‚æžœå½“å‰æ•°æ®åº“(æºæ•°æ®åº“)å’Œç»™å®šæ•°æ®åº“(ç›®æ ‡æ•°æ®åº“)æœ‰ç›¸åŒåå­—çš„ç»™å®š key ï¼Œæˆ–è€… key ä¸å­˜åœ¨äºŽå½“å‰æ•°æ®åº“ï¼Œé‚£ä¹ˆ MOVE æ²¡æœ‰ä»»ä½•æ•ˆæžœ 12&gt; move name 1&gt; name æ˜¯æ•°æ®åº“0ä¸­å·²å­˜åœ¨çš„keyï¼Œç§»åŠ¨åˆ°æ•°æ®åº“1ä¸­åŽï¼Œ0ä¸­å°±ä¸å­˜åœ¨è¯¥key TYPE key è¿”å›ž key æ‰€å‚¨å­˜çš„å€¼çš„ç±»åž‹ã€‚ 12&gt; DEL key [key ...]&gt; åˆ é™¤ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ª key ã€‚ä¸å­˜åœ¨çš„ key ä¼šè¢«å¿½ç•¥ 3ã€String æ“ä½œå­—ç¬¦ä¸²æ˜¯ä¸€ç§æœ€åŸºæœ¬çš„ Redis å€¼ç±»åž‹ã€‚Redis å­—ç¬¦ä¸²æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ª Redis å­—ç¬¦ä¸²èƒ½åŒ…å«ä»»æ„ç±»åž‹çš„æ•°æ® 12&gt; SET key value [EX seconds][PX milliseconds] [NX|XX]&gt; ï® EX è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œç§’ï¼Œç­‰åŒäºŽ SETEX key seconds valueï® PX è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ¯«ç§’ï¼Œç­‰åŒäºŽ PSETEX key milliseconds valueï® NX é”®ä¸å­˜åœ¨ï¼Œæ‰èƒ½è®¾ç½®ï¼Œç­‰åŒäºŽ SETNX key valueï® XX é”®å­˜åœ¨æ—¶ï¼Œæ‰èƒ½è®¾ç½® æ³¨æ„ å°†å­—ç¬¦ä¸²å€¼ value å…³è”åˆ° key ã€‚å¦‚æžœ key å·²ç»æŒæœ‰å…¶ä»–å€¼ï¼Œ SET å°±è¦†å†™æ—§å€¼ï¼Œæ— è§†ç±»åž‹ã€‚å¯¹äºŽæŸä¸ªåŽŸæœ¬å¸¦æœ‰ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰çš„é”®æ¥è¯´ï¼Œ å½“ SET å‘½ä»¤æˆåŠŸåœ¨è¿™ä¸ªé”®ä¸Šæ‰§è¡Œæ—¶ï¼Œ è¿™ä¸ªé”®åŽŸæœ‰çš„ TTL å°†è¢«æ¸…é™¤ã€‚ 12&gt; GET key&gt; è¿”å›ž key æ‰€å…³è”çš„å­—ç¬¦ä¸²å€¼ã€‚å¦‚æžœ key ä¸å­˜åœ¨é‚£ä¹ˆè¿”å›žç‰¹æ®Šå€¼ nil ã€‚å‡å¦‚ key å‚¨å­˜çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œè¿”å›žä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º GET åªèƒ½ç”¨äºŽå¤„ç†å­—ç¬¦ä¸²å€¼ 12&gt; APPEND key value&gt; å¦‚æžœ key å·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ APPEND å‘½ä»¤å°† value è¿½åŠ åˆ° key åŽŸæ¥çš„å€¼çš„æœ«å°¾ã€‚å¦‚æžœ key ä¸å­˜åœ¨ï¼Œ APPEND å°±ç®€å•åœ°å°†ç»™å®š key è®¾ä¸º value ï¼Œå°±åƒæ‰§è¡Œ SET key value ä¸€æ ·ã€‚ 12&gt; STRLEN key&gt; è¿”å›ž key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚å½“ key å‚¨å­˜çš„ä¸æ˜¯å­—ç¬¦ä¸²å€¼æ—¶ï¼Œè¿”å›žä¸€ä¸ªé”™è¯¯ã€‚ 12&gt; INCR key&gt; å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å¢žä¸€ï¼Œå¹¶æ˜¾ç¤ºã€‚å¦‚æžœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åŽå†æ‰§è¡ŒINCR æ“ä½œã€‚å¦‚æžœå€¼åŒ…å«é”™è¯¯çš„ç±»åž‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»åž‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›žä¸€ä¸ªé”™è¯¯ã€‚ é”™è¯¯ï¼š (error) ERR value is not an integer or out of range 12&gt; INCRBY key increment&gt; å°† key æ‰€å‚¨å­˜çš„å€¼åŠ ä¸Šå¢žé‡ increment ï¼Œå¹¶æ˜¾ç¤ºã€‚å¦‚æžœ key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ key çš„å€¼ä¼šå…ˆè¢«åˆå§‹åŒ–ä¸º 0 ï¼Œç„¶åŽå†æ‰§è¡ŒINCRBY å‘½ä»¤ã€‚å¦‚æžœå€¼åŒ…å«é”™è¯¯çš„ç±»åž‹ï¼Œæˆ–å­—ç¬¦ä¸²ç±»åž‹çš„å€¼ä¸èƒ½è¡¨ç¤ºä¸ºæ•°å­—ï¼Œé‚£ä¹ˆè¿”å›žä¸€ä¸ªé”™è¯¯ã€‚ 12&gt; DECR key&gt; å°† key ä¸­å‚¨å­˜çš„æ•°å­—å€¼å‡ä¸€ã€‚ 12&gt; DECRBY key decrement&gt; å°† key æ‰€å‚¨å­˜çš„å€¼å‡åŽ»å‡é‡ decrement ã€‚ 12&gt; GETRANGE key start end&gt; è¿”å›ž key ä¸­å­—ç¬¦ä¸²å€¼çš„å­å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²çš„æˆªå–èŒƒå›´ç”± start å’Œend ä¸¤ä¸ªåç§»é‡å†³å®š(åŒ…æ‹¬ start å’Œ end åœ¨å†…)ã€‚è´Ÿæ•°åç§»é‡è¡¨ç¤ºä»Žå­—ç¬¦ä¸²æœ€åŽå¼€å§‹è®¡æ•°ï¼Œ -1 è¡¨ç¤ºæœ€åŽä¸€ä¸ªå­—ç¬¦ï¼Œ -2 è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªï¼Œä»¥æ­¤ç±»æŽ¨ 12&gt; SETRANGE key offset value&gt; ç”¨ value å‚æ•°è¦†å†™(overwrite)ç»™å®š key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œä»Žåç§»é‡ offset å¼€å§‹ã€‚ä¸å­˜åœ¨çš„ key å½“ä½œç©ºç™½å­—ç¬¦ä¸²å¤„ç†ã€‚ 12&gt; SETEX key seconds value&gt; å°†å€¼ value å…³è”åˆ° key ï¼Œå¹¶å°† key çš„ç”Ÿå­˜æ—¶é—´è®¾ä¸º secondså¦‚æžœ key å·²ç»å­˜åœ¨ï¼Œ SETEX å‘½ä»¤å°†è¦†å†™æ—§å€¼ã€‚è¿™ä¸ªå‘½ä»¤ç±»ä¼¼äºŽä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤ï¼š 123&gt; SET key value&gt; EXPIRE key seconds # è®¾ç½®ç”Ÿå­˜æ—¶é—´&gt; ä¸åŒä¹‹å¤„æ˜¯ï¼Œ SETEX æ˜¯ä¸€ä¸ªåŽŸå­æ€§(atomic)æ“ä½œï¼Œå…³è”å€¼å’Œè®¾ç½®ç”Ÿå­˜æ—¶é—´ä¸¤ä¸ªåŠ¨ä½œä¼šåœ¨åŒä¸€æ—¶é—´å†…å®Œæˆï¼Œè¯¥å‘½ä»¤åœ¨ Redis ç”¨ä½œç¼“å­˜æ—¶ï¼Œéžå¸¸å®žç”¨ã€‚ 12&gt; SETNX key value&gt; å°† key çš„å€¼è®¾ä¸º value ï¼Œå½“ä¸”ä»…å½“ key ä¸å­˜åœ¨ã€‚è‹¥ç»™å®šçš„ key å·²ç»å­˜åœ¨ï¼Œåˆ™ SETNX ä¸åšä»»ä½•åŠ¨ä½œã€‚SETNX æ˜¯ã€ŽSET if Not eXistsã€(å¦‚æžœä¸å­˜åœ¨ï¼Œåˆ™ SET)çš„ç®€å†™ã€‚ 12&gt; MGET key [key ...]&gt; è¿”å›žæ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®š key çš„å€¼ã€‚å¦‚æžœç»™å®šçš„ key é‡Œé¢ï¼Œæœ‰æŸä¸ª key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ª key è¿”å›žç‰¹æ®Šå€¼ nil ã€‚å› æ­¤ï¼Œè¯¥å‘½ä»¤æ°¸ä¸å¤±è´¥ 12&gt; MSET key value [key value ...]&gt; åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ã€‚å¦‚æžœæŸä¸ªç»™å®š key å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆ MSET ä¼šç”¨æ–°å€¼è¦†ç›–åŽŸæ¥çš„æ—§å€¼ï¼Œå¦‚æžœè¿™ä¸æ˜¯ä½ æ‰€å¸Œæœ›çš„æ•ˆæžœï¼Œè¯·è€ƒè™‘ä½¿ç”¨ MSETNX å‘½ä»¤ï¼šå®ƒåªä¼šåœ¨æ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨çš„æƒ…å†µä¸‹è¿›è¡Œè®¾ç½®æ“ä½œã€‚ 12&gt; MSETNX key value [key value ...]&gt; åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª key-value å¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®š key éƒ½ä¸å­˜åœ¨ã€‚å³ä½¿åªæœ‰ä¸€ä¸ªç»™å®š key å·²å­˜åœ¨ï¼Œ MSETNX ä¹Ÿä¼šæ‹’ç»æ‰§è¡Œæ‰€æœ‰ç»™å®š key çš„è®¾ç½®æ“ä½œã€‚MSETNX æ˜¯åŽŸå­æ€§çš„ï¼Œå› æ­¤å®ƒå¯ä»¥ç”¨ä½œè®¾ç½®å¤šä¸ªä¸åŒ key è¡¨ç¤ºä¸åŒå­—æ®µ(field)çš„å”¯ä¸€æ€§é€»è¾‘å¯¹è±¡(unique logic object)ï¼Œæ‰€æœ‰å­—æ®µè¦ä¹ˆå…¨è¢«è®¾ç½®ï¼Œè¦ä¹ˆå…¨ä¸è¢«è®¾ç½®ã€‚ 4ã€ List æ“ä½œ 12&gt; LPUSH key value [value ...]&gt; å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ value æ’å…¥åˆ°åˆ—è¡¨ key çš„è¡¨å¤´ã€‚ï¼ˆä»Žå·¦è¾¹æ’å…¥ï¼‰å¦‚æžœæœ‰å¤šä¸ª value å€¼ï¼Œé‚£ä¹ˆå„ä¸ª value å€¼æŒ‰ä»Žå·¦åˆ°å³çš„é¡ºåºä¾æ¬¡ æ’ å…¥ åˆ° è¡¨ å¤´ ï¼š æ¯” å¦‚ è¯´ ï¼Œ å¯¹ ç©º åˆ— è¡¨ mylist æ‰§ è¡Œ å‘½ä»¤ LPUSH mylist a b c ï¼Œåˆ—è¡¨çš„å€¼å°†æ˜¯ c b a ï¼Œ è¿™ç­‰åŒäºŽåŽŸ å­ æ€§ åœ° æ‰§è¡Œ LPUSH mylist a ã€ LPUSH mylist b å’Œ LPUSH mylistc ä¸‰ä¸ªå‘½ä»¤ã€‚ 12&gt; RPUSH key value [value ...]&gt; å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ value æ’å…¥åˆ°åˆ—è¡¨ key çš„è¡¨å°¾ã€‚ï¼ˆä»Žå³è¾¹æ’å…¥ï¼‰å¦‚æžœæœ‰å¤šä¸ª value å€¼ï¼Œé‚£ä¹ˆå„ä¸ª value å€¼æŒ‰ä»Žå·¦åˆ°å³çš„é¡ºåºä¾æ¬¡ æ’ å…¥ åˆ° è¡¨ å°¾ ï¼š æ¯” å¦‚ å¯¹ ä¸€ ä¸ª ç©º åˆ— è¡¨ mylist æ‰§è¡Œ RPUSH mylist a b c ï¼Œå¾—å‡ºçš„ç»“æžœåˆ—è¡¨ä¸º a b c ï¼Œ ç­‰åŒäºŽ æ‰§ è¡Œ å‘½ä»¤ RPUSH mylist a ã€ RPUSH mylist b ã€ RPUSH mylist c ã€‚ 12&gt; LRANGE key start stop&gt; è¿” å›ž åˆ— è¡¨ key ä¸­ æŒ‡ å®š åŒº é—´ å†… çš„ å…ƒ ç´  ï¼Œ åŒº é—´ ä»¥ å ç§»é‡ start å’Œ stop æŒ‡å®šã€‚ï¼ˆä»Žå·¦è‡³å³ï¼‰ä¸‹æ ‡(index)å‚æ•° start å’Œ stop éƒ½ä»¥ 0 ä¸ºåº•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥ 0 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä»¥ 1 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚-1 è¡¨ç¤ºæœ€åŽä¸€ä¸ªå…ƒç´  12&gt; LPOP key&gt; ç§»é™¤å¹¶è¿”å›žåˆ—è¡¨ key çš„å¤´å…ƒç´ ã€‚ï¼ˆä»Žåˆ—è¡¨keyçš„å·¦è¾¹å¼€å§‹å¼¹å‡ºå…ƒç´ ï¼‰ 12&gt; RPOP key&gt; ç§»é™¤å¹¶è¿”å›žåˆ—è¡¨ key çš„å°¾å…ƒç´ ã€‚ï¼ˆä»Žåˆ—è¡¨keyçš„å³è¾¹å¼€å§‹å¼¹å‡ºå…ƒç´ ï¼‰ å¤‡æ³¨ï¼š åŒå‘ä¸ºæ ˆï¼Œå¼‚å‘ä¸ºé˜Ÿåˆ—æ ˆï¼ˆlpush lpop ï¼› rpush rpopï¼‰ é˜Ÿåˆ—ï¼ˆlpush rpop ï¼› rpush lpop ï¼‰ ArrayList : æ•°ç»„ï¼ˆæŸ¥æ‰¾å¿«ï¼Œå¢žåˆ æ…¢ï¼‰LinkList : é“¾è¡¨ï¼ˆæŸ¥æ‰¾æ…¢ï¼Œå¢žåˆ å¿«ï¼‰ 12&gt; LINDEX key index&gt; è¿”å›žåˆ—è¡¨ key ä¸­ï¼Œä¸‹æ ‡ä¸º index çš„å…ƒç´ ã€‚ä¸‹æ ‡(index)å‚æ•° start å’Œ stop éƒ½ä»¥ 0 ä¸ºåº•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥ 0 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä»¥ 1 è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°ä¸‹æ ‡ï¼Œä»¥ -1 è¡¨ç¤ºåˆ—è¡¨çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œ -2 è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æŽ¨ 12&gt; LLEN key&gt; è¿”å›žåˆ—è¡¨ key çš„é•¿åº¦ã€‚å¦‚æžœ key ä¸å­˜åœ¨ï¼Œåˆ™ key è¢«è§£é‡Šä¸ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œè¿”å›ž 0 . 12&gt; LREM key count value&gt; æ ¹æ®å‚æ•° count çš„å€¼ï¼Œç§»é™¤åˆ—è¡¨ä¸­ä¸Žå‚æ•° value ç›¸ç­‰çš„å…ƒç´ ã€‚count çš„å€¼å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ï¼šcount &gt; 0 : ä»Žè¡¨å¤´å¼€å§‹å‘è¡¨å°¾æœç´¢ï¼Œç§»é™¤ä¸Ž value ç›¸ç­‰çš„å…ƒç´ ï¼Œæ•°é‡ä¸º count ã€‚count &lt; 0 : ä»Žè¡¨å°¾å¼€å§‹å‘è¡¨å¤´æœç´¢ï¼Œç§»é™¤ä¸Ž value ç›¸ç­‰çš„å…ƒç´ ï¼Œæ•°é‡ä¸º count çš„ç»å¯¹å€¼ã€‚count = 0 : ç§»é™¤è¡¨ä¸­æ‰€æœ‰ä¸Ž value ç›¸ç­‰çš„å€¼ã€‚ 12&gt; LTRIM key start stop&gt; å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œ ä¸åœ¨æŒ‡å®šåŒºé—´ä¹‹å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚ä¸¾ ä¸ª ä¾‹ å­ ï¼Œ æ‰§ è¡Œ å‘½ ä»¤ LTRIM list 0 2 ï¼Œ è¡¨ ç¤º åª ä¿ ç•™ åˆ—è¡¨ list çš„å‰ä¸‰ä¸ªå…ƒç´ ï¼Œå…¶ä½™å…ƒç´ å…¨éƒ¨åˆ é™¤ 12&gt; RPOPLPUSH source destination&gt; å‘½ä»¤ RPOPLPUSH åœ¨ä¸€ä¸ªåŽŸå­æ—¶é—´å†…ï¼Œæ‰§è¡Œä»¥ä¸‹ä¸¤ä¸ªåŠ¨ä½œï¼šå°†åˆ—è¡¨ source ä¸­çš„æœ€åŽä¸€ä¸ªå…ƒç´ (å°¾å…ƒç´ )å¼¹å‡ºï¼Œå¹¶è¿”å›žç»™å®¢æˆ·ç«¯ã€‚å°† source å¼¹ å‡º çš„ å…ƒ ç´  æ’ å…¥ åˆ° åˆ— è¡¨ destination ï¼Œ ä½œä¸º destination åˆ—è¡¨çš„çš„å¤´å…ƒç´ ã€‚ä¸¾ ä¸ª ä¾‹ å­ ï¼Œ ä½  æœ‰ ä¸¤ ä¸ª åˆ—è¡¨ source å’Œ destination ï¼Œ source åˆ— è¡¨ æœ‰ å…ƒç´  a, b, c ï¼Œ destination åˆ—è¡¨æœ‰å…ƒç´  x, y, z ï¼Œæ‰§è¡Œ RPOPLPUSH sourcedestination ä¹‹åŽï¼Œ source åˆ—è¡¨åŒ…å«å…ƒç´  a, b ï¼Œ destination åˆ—è¡¨åŒ…å«å…ƒç´  c, x, y, z ï¼Œå¹¶ä¸”å…ƒç´  c ä¼šè¢«è¿”å›žç»™å®¢æˆ·ç«¯ã€‚ 12&gt; LSET key index value&gt; å°†åˆ—è¡¨ key ä¸‹æ ‡ä¸º index çš„å…ƒç´ çš„å€¼è®¾ç½®ä¸º value ã€‚å½“ index å‚æ•°è¶…å‡ºèŒƒå›´ï¼Œæˆ–å¯¹ä¸€ä¸ªç©ºåˆ—è¡¨( key ä¸å­˜åœ¨)è¿›è¡Œ LSET æ—¶ï¼Œè¿”å›žä¸€ä¸ªé”™è¯¯ã€‚ 12&gt; LINSERT key BEFORE|AFTER pivot value&gt; å°†å€¼ value æ’å…¥åˆ°åˆ—è¡¨ key å½“ä¸­ï¼Œä½äºŽå€¼ pivot ä¹‹å‰æˆ–ä¹‹åŽã€‚å½“ pivot ä¸å­˜åœ¨äºŽåˆ—è¡¨ key æ—¶ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚å½“ key ä¸å­˜åœ¨æ—¶ï¼Œ key è¢«è§†ä¸ºç©ºåˆ—è¡¨ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ 5ã€Setæ“ä½œ 12&gt; SADD key member [member ...]&gt; å°†ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ åŠ å…¥åˆ°é›†åˆ key å½“ä¸­ï¼ˆæ— åºï¼‰ï¼Œå·²ç»å­˜åœ¨äºŽé›†åˆçš„ member å…ƒç´ å°†è¢«å¿½ç•¥ã€‚å‡å¦‚ key ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªåªåŒ…å« member å…ƒç´ ä½œæˆå‘˜çš„é›†åˆã€‚ 12&gt; SMEMBERS key&gt; è¿”å›žé›†åˆ key ä¸­çš„æ‰€æœ‰æˆå‘˜ã€‚ ä¸å­˜åœ¨çš„ key è¢«è§†ä¸ºç©ºé›†åˆã€‚ 12&gt; SISMEMBER key member&gt; åˆ¤æ–­ member å…ƒç´ æ˜¯å¦æ˜¯é›†åˆ key çš„æˆå‘˜ã€‚ 12&gt; SCARD key&gt; è¿”å›žé›†åˆ key çš„åŸºæ•°(é›†åˆä¸­å…ƒç´ çš„æ•°é‡)ã€‚ 12&gt; SREM key member [member ...]&gt; ç§» é™¤ é›† åˆ key ä¸­ çš„ ä¸€ ä¸ª æˆ– å¤š ä¸ª member å…ƒ ç´  ï¼Œ ä¸ å­˜ åœ¨çš„ member å…ƒç´ ä¼šè¢«å¿½ç•¥ã€‚ 12&gt; SPOP key ï¼ˆæŠ½å¥–åœºæ™¯ï¼‰&gt; ç§»é™¤å¹¶è¿”å›žé›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´ ã€‚å¦‚æžœåªæƒ³èŽ·å–ä¸€ä¸ªéšæœºå…ƒç´ ï¼Œä½†ä¸æƒ³è¯¥å…ƒç´ ä»Žé›†åˆä¸­è¢«ç§»é™¤çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ SRANDMEMBER å‘½ä»¤ã€‚ 12&gt; SMOVE source destination member&gt; å°† member å…ƒç´ ä»Ž source é›†åˆç§»åŠ¨åˆ° destination é›†åˆã€‚SMOVE æ˜¯åŽŸå­æ€§æ“ä½œã€‚å¦‚æžœ source é›†åˆä¸å­˜åœ¨æˆ–ä¸åŒ…å«æŒ‡å®šçš„ member å…ƒç´ ï¼Œåˆ™ SMOVE å‘½ä»¤ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä»…è¿”å›ž 0 ã€‚å¦åˆ™ï¼Œ member å…ƒç´ ä»Ž source é›†åˆä¸­è¢«ç§»é™¤ï¼Œå¹¶æ·»åŠ åˆ° destination é›†åˆä¸­åŽ»ã€‚å½“ destination é›†åˆå·²ç»åŒ…å« member å…ƒç´ æ—¶ï¼Œ SMOVE å‘½ä»¤åªæ˜¯ç®€å•åœ°å°† source é›†åˆä¸­çš„ member å…ƒç´ åˆ é™¤ã€‚å½“ source æˆ– destination ä¸æ˜¯é›†åˆç±»åž‹æ—¶ï¼Œè¿”å›žä¸€ä¸ªé”™è¯¯ã€‚ 12&gt; SDIFF key [key ...]&gt; æ±‚å·®é›†ï¼šä»Žç¬¬ä¸€ä¸ª key çš„é›†åˆä¸­åŽ»é™¤å…¶ä»–é›†åˆå’Œè‡ªå·±çš„äº¤é›†éƒ¨åˆ† sdiffæ±‚ä¸¤ä¸ªsetçš„å·®é›†ï¼Œæœ‰å…ˆåŽé¡ºåºï¼Œä»¥é å‰çš„ä¸ºåŸºå‡†ï¼Œåˆ—å‡ºå‰ä¸€ä¸ªsetæœ‰çš„ï¼Œè€ŒåŽä¸€ä¸ªsetæ²¡æœ‰çš„å…ƒç´  12&gt; SINTER key [key ...] ï¼ˆå¾®åšæ±‚å…±åŒå…³æ³¨åœºæ™¯ï¼‰&gt; è¿”å›žä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„äº¤é›†ã€‚ä¸å­˜åœ¨çš„ key è¢«è§†ä¸ºç©ºé›†ã€‚å½“ç»™å®šé›†åˆå½“ä¸­æœ‰ä¸€ä¸ªç©ºé›†æ—¶ï¼Œç»“æžœä¹Ÿä¸ºç©ºé›†(æ ¹æ®é›†åˆè¿ç®—å®šå¾‹)ã€‚ 12&gt; SUNION key [key ...]&gt; è¿”å›žä¸€ä¸ªé›†åˆçš„å…¨éƒ¨æˆå‘˜ï¼Œè¯¥é›†åˆæ˜¯æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†ã€‚ä¸å­˜åœ¨çš„ key è¢«è§†ä¸ºç©ºé›†ã€‚ 6ã€Sorted setæ“ä½œç±»ä¼¼ Sets,ä½†æ˜¯æ¯ä¸ªå­—ç¬¦ä¸²å…ƒç´ éƒ½å…³è”åˆ°ä¸€ä¸ªå« score æµ®åŠ¨æ•°å€¼ã€‚é‡Œé¢çš„å…ƒç´ æ€»æ˜¯é€šè¿‡ score è¿›è¡Œç€æŽ’åºï¼Œæ‰€ä»¥ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯å¯ä»¥æ£€ç´¢çš„ä¸€ç³»åˆ—å…ƒç´ ã€‚ æ³¨æ„ï¼š åœ¨ set åŸºç¡€ä¸Šï¼ŒåŠ ä¸Š score å€¼ï¼Œ ä¹‹å‰ set æ˜¯key value1 value2â€¦.çŽ°åœ¨ Zset æ˜¯ key score1 value1 score2 value2 12&gt; ZADD key score member [[score member][score member] ...]&gt; å°† ä¸€ ä¸ª æˆ– å¤š ä¸ª member å…ƒ ç´  åŠ å…¶ score å€¼ åŠ  å…¥ åˆ° æœ‰ åºé›† key å½“ä¸­ã€‚ æ˜¾ç¤º redis&gt; ZADD page_rank 9 baidu.com 8 bing.com 10 google.com(integer) 2redis&gt; ZRANGE page_rank 0 -1 WITHSCORES 1) â€œbing.comâ€2) â€œ8â€3) â€œbaidu.comâ€4) â€œ9â€5) â€œgoogle.comâ€6) â€œ10â€ 12&gt; ZRANGE key start stop [WITHSCORES]&gt; è¿”å›žæœ‰åºé›† key ä¸­ï¼ŒæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ã€‚å…¶ä¸­æˆå‘˜çš„ä½ç½®æŒ‰ score å€¼é€’å¢ž(ä»Žå°åˆ°å¤§)æ¥æŽ’åºã€‚å…·æœ‰ç›¸åŒ score å€¼çš„æˆå‘˜æŒ‰å­—å…¸åº(lexicographical order )æ¥æŽ’åˆ—ã€‚å¦‚æžœä½ éœ€è¦æˆå‘˜æŒ‰ score å€¼é€’å‡(ä»Žå¤§åˆ°å°)æ¥æŽ’åˆ—ï¼Œè¯·ä½¿ç”¨ ZREVRANGE å‘½ä»¤ã€‚ä¸‹æ ‡å‚æ•° start å’Œ stop éƒ½ä»¥ 0 ä¸ºåº•ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥ 0 è¡¨ç¤ºæœ‰åºé›†ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œä»¥ 1 è¡¨ç¤ºæœ‰åºé›†ç¬¬äºŒä¸ªæˆå‘˜ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°ä¸‹æ ‡ï¼Œä»¥ -1 è¡¨ç¤ºæœ€åŽä¸€ä¸ªæˆå‘˜ï¼Œ -2 è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªæˆå‘˜ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚è¶…å‡ºèŒƒå›´çš„ä¸‹æ ‡å¹¶ä¸ä¼šå¼•èµ·é”™è¯¯ã€‚æ¯” å¦‚ è¯´ ï¼Œ å½“ start çš„ å€¼ æ¯” æœ‰ åº é›† çš„ æœ€ å¤§ ä¸‹ æ ‡ è¿˜ è¦ å¤§ ï¼Œ æˆ–æ˜¯ start &gt; stop æ—¶ï¼Œ ZRANGE å‘½ä»¤åªæ˜¯ç®€å•åœ°è¿”å›žä¸€ä¸ªç©ºåˆ—è¡¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå‡å¦‚ stop å‚æ•°çš„å€¼æ¯”æœ‰åºé›†çš„æœ€å¤§ä¸‹æ ‡è¿˜è¦å¤§ï¼Œé‚£ä¹ˆRedis å°† stop å½“ä½œæœ€å¤§ä¸‹æ ‡æ¥å¤„ç†ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ WITHSCORES é€‰é¡¹ï¼Œæ¥è®©æˆå‘˜å’Œå®ƒçš„ score å€¼ä¸€å¹¶è¿”å›žï¼Œ è¿”å›žåˆ—è¡¨ä»¥ value1,score1, â€¦, valueN,scoreN çš„æ ¼å¼è¡¨ç¤ºã€‚ 12&gt; ZREVRANGE key start stop [WITHSCORES]( ( éŸ³ä¹æŽ’è¡Œæ¦œåœºæ™¯) )&gt; è¿”å›žæœ‰åºé›† key ä¸­ï¼ŒæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ã€‚å…¶ä¸­æˆå‘˜çš„ä½ç½®æŒ‰ score å€¼é€’å‡(ä»Žå¤§åˆ°å°)æ¥æŽ’åˆ—ã€‚ 12&gt; ZREM key member [member ...]&gt; ç§»é™¤æœ‰åºé›† key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œä¸å­˜åœ¨çš„æˆå‘˜å°†è¢«å¿½ç•¥ã€‚ 12&gt; ZREMRANGEBYSCORE key min max&gt; ç§»é™¤æœ‰åºé›† key ä¸­ï¼Œæ‰€æœ‰ score å€¼ä»‹äºŽ min å’Œ max ä¹‹é—´(åŒ…æ‹¬ç­‰äºŽ min æˆ– max )çš„æˆå‘˜ã€‚ 12&gt; ZSCORE key member&gt; è¿”å›žæœ‰åºé›† key ä¸­ï¼Œæˆå‘˜ member çš„ score å€¼ã€‚ 12&gt; ZCARD key&gt; è¿”å›žæœ‰åºé›† key çš„åŸºæ•°ï¼ˆåŒ…å«çš„å…ƒç´ çš„ä¸ªæ•°ï¼‰ã€‚ 12&gt; ZCOUNT key min max&gt; è¿”å›žæœ‰åºé›† key ä¸­ï¼Œ score å€¼åœ¨ min å’Œ max ä¹‹é—´(é»˜è®¤åŒ…æ‹¬ score å€¼ç­‰äºŽ min æˆ– max )çš„æˆå‘˜çš„æ•°é‡ã€‚ 12&gt; ZRANK key member&gt; è¿”å›žæœ‰åºé›† key ä¸­ï¼Œæˆå‘˜ member çš„ score å€¼ã€‚ZCARD keyè¿”å›žæœ‰åºé›† key çš„åŸºæ•°ï¼ˆåŒ…å«çš„å…ƒç´ çš„ä¸ªæ•°ï¼‰ã€‚ZCOUNT key min maxè¿”å›žæœ‰åºé›† key ä¸­ï¼Œ score å€¼åœ¨ min å’Œ max ä¹‹é—´(é»˜è®¤åŒ…æ‹¬ score å€¼ç­‰äºŽ min æˆ– max )çš„æˆå‘˜çš„æ•°é‡ã€‚ZRANK key member è¿”å›žæœ‰åºé›† key ä¸­æˆå‘˜ member çš„æŽ’åã€‚å…¶ä¸­æœ‰åºé›†æˆå‘˜æŒ‰ score å€¼é€’å¢ž(ä»Žå°åˆ°å¤§)é¡ºåºæŽ’åˆ—ã€‚ 7ã€ Hash æ“ä½œ ï¼ˆæ•£åˆ—ï¼‰KV æ¨¡å¼ä¸å˜ï¼Œä½†æ˜¯ V æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ 12&gt; HSET key field value&gt; å°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ä¸º value ã€‚ 12&gt; HGET key field&gt; è¿”å›žå“ˆå¸Œè¡¨ key ä¸­ç»™å®šåŸŸ field çš„å€¼ã€‚ 12&gt; HMSET key field value [field value ...]&gt; åŒæ—¶å°†å¤šä¸ª field-value (åŸŸ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨ key ä¸­ã€‚æ­¤å‘½ä»¤ä¼šè¦†ç›–å“ˆå¸Œè¡¨ä¸­å·²å­˜åœ¨çš„åŸŸã€‚ 12&gt; HMGET key field [field ...]&gt; è¿”å›žå“ˆå¸Œè¡¨ key ä¸­ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šåŸŸçš„å€¼ã€‚ 12&gt; HGETALL key&gt; è¿”å›žå“ˆå¸Œè¡¨ key ä¸­ï¼Œæ‰€æœ‰çš„åŸŸå’Œå€¼ã€‚ 12&gt; HKEYS key&gt; è¿”å›žå“ˆå¸Œè¡¨ key ä¸­çš„æ‰€æœ‰åŸŸã€‚ 12&gt; HVALS key&gt; è¿”å›žå“ˆå¸Œè¡¨ key ä¸­æ‰€æœ‰åŸŸçš„å€¼ã€‚ 12&gt; HSETNX key field value&gt; å°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ç½®ä¸º value ï¼Œå½“ä¸”ä»…å½“åŸŸ field ä¸å­˜åœ¨ã€‚è‹¥åŸŸ field å·²ç»å­˜åœ¨ï¼Œè¯¥æ“ä½œæ— æ•ˆã€‚ 12&gt; HEXISTS key field&gt; æŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­ï¼Œç»™å®šåŸŸ field æ˜¯å¦å­˜åœ¨ã€‚ 12&gt; HDEL key field [field ...]&gt; åˆ é™¤å“ˆå¸Œè¡¨ key ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šåŸŸï¼Œä¸å­˜åœ¨çš„åŸŸå°†è¢«å¿½ç•¥ã€‚ 12&gt; HINCRBY key field increment&gt; ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼åŠ ä¸Šå¢žé‡ increment ã€‚å¢žé‡ä¹Ÿå¯ä»¥ä¸ºè´Ÿæ•°ï¼Œç›¸å½“äºŽå¯¹ç»™å®šåŸŸè¿›è¡Œå‡æ³•æ“ä½œã€‚ 12&gt; HINCRBYFLOAT key field increment&gt; å¢žåŠ æµ®ç‚¹æ•°åœºæ™¯ï¼šç”¨æˆ·ç»´åº¦ç»Ÿè®¡ç»Ÿè®¡æ•°åŒ…æ‹¬ï¼šå…³æ³¨æ•°ã€ç²‰ä¸æ•°ã€å–œæ¬¢å•†å“æ•°ã€å‘å¸–æ•°ç”¨æˆ·ä¸º Keyï¼Œä¸åŒç»´åº¦ä¸º Fieldï¼ŒValue ä¸ºç»Ÿè®¡æ•° äº”ã€Redis çš„æŒä¹…åŒ–1ã€Redis æŒä¹…åŒ–æ–¹å¼ RDB æŒä¹…åŒ–å¯ä»¥åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ç”Ÿæˆæ•°æ®é›†çš„æ—¶é—´ç‚¹å¿«ç…§ï¼ˆpoint-in-time snapshotï¼‰ã€‚ AOF æŒä¹…åŒ–è®°å½•æœåŠ¡å™¨æ‰§è¡Œçš„æ‰€æœ‰å†™æ“ä½œå‘½ä»¤ï¼Œå¹¶åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡é‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥è¿˜åŽŸæ•°æ®é›†ã€‚ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤å…¨éƒ¨ä»¥ Redisåè®®çš„æ ¼å¼æ¥ä¿å­˜ï¼Œæ–°å‘½ä»¤ä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ã€‚ Redis è¿˜å¯ä»¥åœ¨åŽå°å¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼ˆrewriteï¼‰ï¼Œä½¿å¾— AOF æ–‡ä»¶çš„ä½“ç§¯ä¸ä¼šè¶…å‡ºä¿å­˜æ•°æ®é›†çŠ¶æ€æ‰€éœ€çš„å®žé™…å¤§å°ã€‚ Redis è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ AOF æŒä¹…åŒ–å’Œ RDB æŒä¹…åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å½“ Redis é‡å¯æ—¶ï¼Œ å®ƒä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶æ¥è¿˜åŽŸæ•°æ®é›†ï¼Œ å› ä¸º AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†é€šå¸¸æ¯” RDB æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®é›†æ›´å®Œæ•´ã€‚ ä½ ç”šè‡³å¯ä»¥å…³é—­æŒä¹…åŒ–åŠŸèƒ½ï¼Œè®©æ•°æ®åªåœ¨æœåŠ¡å™¨è¿è¡Œæ—¶å­˜åœ¨ã€‚ 2ã€Rdb:ï¼ˆ1ï¼‰åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯è¡Œè¯è®²çš„ snapshot å¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶å°±æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æŽ¥è¯»åˆ°å†…å­˜é‡Œã€‚ Rdb ä¿å­˜çš„æ˜¯ dump.rdb æ–‡ä»¶ ï¼ˆ2ï¼‰å¦‚ä½•è§¦å‘ RDB å¿«ç…§ Saveï¼šsave æ—¶åªç®¡ä¿å­˜ï¼Œå…¶ä»–ä¸ç®¡ï¼Œå…¨éƒ¨é˜»å¡žã€‚Bgsaveï¼šredis ä¼šåœ¨åŽå°è¿›è¡Œå¿«ç…§æ“ä½œï¼Œå¿«ç…§æ“ä½œçš„åŒæ—¶è¿˜å¯ä»¥å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ lastsave å‘½ä»¤èŽ·å–æœ€åŽä¸€æ¬¡æˆåŠŸæ‰§è¡Œå¿«ç…§çš„æ—¶é—´ã€‚ ï¼ˆ3ï¼‰å¦‚ä½•åœæ­¢ é™æ€åœæ­¢ï¼šå°†é…ç½®æ–‡ä»¶é‡Œçš„ RDB ä¿å­˜è§„åˆ™æ”¹ä¸º save â€œâ€åŠ¨æ€åœæ­¢ ï¼š config set save â€œ â€ 3ã€AOF(Append Only File) ï¼ˆ1ï¼‰ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°† redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥(è¯»æ“ä½œä¸è®°å½•)ã€‚åªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œredis å¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æž„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredis é‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»Žå‰åˆ°åŽæ‰§è¡Œä¸€æ¬¡ä¸€å®Œæˆæ•°æ®æ¢å¤å·¥ä½œã€‚======APPEND ONLY MODE======å¼€å¯ aof ï¼šappendonly yes (é»˜è®¤æ˜¯ no) ï¼ˆ2ï¼‰Aof ç­–ç•¥ Appendfsync å‚æ•°ï¼š Always ï¼šåŒæ­¥æŒä¹…åŒ– æ¯æ¬¡å‘ç”Ÿæ•°æ®å˜æ›´ä¼šè¢«ç«‹å³è®°å½•åˆ°ç£ç›˜ï¼Œæ€§èƒ½è¾ƒå·®ä½†æ•°æ®å®Œæ•´æ€§è¾ƒå¥½ã€‚Everysecï¼š å‡ºåŽ‚é»˜è®¤æŽ¨èï¼Œå¼‚æ­¥æ“ä½œï¼Œæ¯ç§’è®°å½•ï¼Œå¦‚æžœä¸€ç§’å®•æœºï¼Œæœ‰æ•°æ®ä¸¢å¤±Noï¼šä»Žä¸ fsync ï¼šå°†æ•°æ®äº¤ç»™æ“ä½œç³»ç»Ÿæ¥å¤„ç†ã€‚æ›´å¿«ï¼Œä¹Ÿæ›´ä¸å®‰å…¨çš„é€‰æ‹©ã€‚ ï¼ˆ3ï¼‰Rewrite æ¦‚å¿µï¼šAOF é‡‡ç”¨æ–‡ä»¶è¿½åŠ æ–¹å¼ï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šæ¥å¤§ä¸ºé¿å…å‡ºçŽ°æ­¤ç§æƒ…å†µï¼Œæ–°å¢žäº†é‡å†™æœºåˆ¶ï¼Œaof æ–‡ä»¶çš„å¤§å°è¶…è¿‡æ‰€è®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œredis å°±ä¼šè‡ªåŠ¨å°† aofæ–‡ä»¶çš„å†…å®¹åŽ‹ç¼©ï¼Œåªä¿ç•™å¯ä»¥æ¢å¤æ•°æ®çš„æœ€å°æŒ‡ä»¤é›†ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤bgrewirteaofã€‚ è§¦å‘æœºåˆ¶ï¼šredis ä¼šè®°å½•ä¸Šæ¬¡é‡å†™çš„ aof çš„å¤§å°ï¼Œé»˜è®¤çš„é…ç½®å½“ aof æ–‡ä»¶å¤§å°ä¸ºä¸Šæ¬¡ rewrite åŽå¤§å°çš„ä¸€å€ä¸”æ–‡ä»¶å¤§äºŽ 64M è§¦å‘ã€‚ é‡å†™åŽŸç†ï¼šaof æ–‡ä»¶æŒç»­å¢žé•¿è€Œå¤§æ—¶ï¼Œä¼š fork å‡ºä¸€æ¡æ–°è¿›ç¨‹æ¥å°†æ–‡ä»¶é‡å†™(ä¹Ÿå°±æ˜¯å…ˆå†™ä¸´æ—¶æ–‡ä»¶æœ€åŽå† rename)ï¼ŒéåŽ†æ–°è¿›ç¨‹çš„å†…å­˜ä¸­çš„æ•°æ®ï¼Œæ¯æ¡è®°å½•æœ‰ä¸€æ¡ set è¯­å¥ï¼Œé‡å†™ aof æ–‡ä»¶çš„æ“ä½œï¼Œå¹¶æ²¡æœ‰è¯»å–æ—§çš„çš„ aof æ–‡ä»¶ï¼Œè€Œæ˜¯å°†æ•´ä¸ªå†…å­˜çš„æ•°æ®åº“å†…å®¹ç”¨å‘½ä»¤çš„æ–¹å¼é‡å†™äº†ä¸€ä¸ªæ–°çš„ aof æ–‡ä»¶ï¼Œè¿™ç‚¹å’Œå¿«ç…§æœ‰ç‚¹ç±»ä¼¼ã€‚ no-appendfsync-on-rewrite no : é‡å†™æ—¶æ˜¯å¦å¯ä»¥è¿ç”¨ Appendfsync ç”¨é»˜è®¤ no å³å¯ï¼Œä¿è¯æ•°æ®å®‰å…¨ auto-aof-rewrite-percentage å€æ•° è®¾ç½®åŸºå‡†å€¼auto-aof-rewrite-min-size è®¾ç½®åŸºå‡†å€¼å¤§å° ï¼ˆ4ï¼‰flushallåˆ·æ–°å†…å­˜ä¸­çš„æ•°æ®ï¼Œå³æ¸…ç©ºæ•°æ®å¯é€šè¿‡åˆ é™¤aofæ–‡ä»¶ä¸­è¯¥æ“ä½œçš„è®°å½•æ¥æ¢å¤æ•°æ®rdbæ–‡ä»¶æ— æ³•å®žçŽ°æ•°æ®æ¢å¤ ï¼ˆ5ï¼‰aof ç‰¹ç‚¹ aofä¼˜ç‚¹ï¼šå¯ç”¨äºŽæ•°æ®æ¢å¤ç¼ºç‚¹ï¼šä½“ç§¯å¤§ï¼Œé€Ÿåº¦æ…¢ aofæ–‡ä»¶ä½“ç§¯ä¼šè¶Šæ¥è¶Šå¤§ ï¼ˆ6ï¼‰aofæ–‡ä»¶ä¼˜åŒ–é‡å†™ï¼šå½“æ–‡ä»¶å¤§å°è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼Œå¯åŠ¨åŽ‹ç¼©æ–‡ä»¶ netstat -anptæŸ¥çœ‹æ‰€æœ‰ç«¯å£çš„ä½¿ç”¨æƒ…å†µ 4ã€å¤‡ä»½ Redis æ•°æ®å»ºè®®ï¼šåˆ›å»ºä¸€ä¸ªå®šæœŸä»»åŠ¡ï¼ˆcron jobï¼‰ï¼Œ æ¯å°æ—¶å°†ä¸€ä¸ª RDB æ–‡ä»¶å¤‡ä»½åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œ å¹¶ä¸”æ¯å¤©å°†ä¸€ä¸ª RDB æ–‡ä»¶å¤‡ä»½åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚ç¡®ä¿å¿«ç…§çš„å¤‡ä»½éƒ½å¸¦æœ‰ç›¸åº”çš„æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼Œ æ¯æ¬¡æ‰§è¡Œå®šæœŸä»»åŠ¡è„šæœ¬æ—¶ï¼Œ ä½¿ç”¨ find å‘½ä»¤æ¥åˆ é™¤è¿‡æœŸçš„å¿«ç…§ï¼š æ¯”å¦‚è¯´ï¼Œ ä½ å¯ä»¥ä¿ç•™æœ€è¿‘ 48 å°æ—¶å†…çš„æ¯å°æ—¶å¿«ç…§ï¼Œ è¿˜å¯ä»¥ä¿ç•™æœ€è¿‘ä¸€ä¸¤ä¸ªæœˆçš„æ¯æ—¥å¿«ç…§ã€‚è‡³å°‘æ¯å¤©ä¸€æ¬¡ï¼Œ å°† RDB å¤‡ä»½åˆ°ä½ çš„æ•°æ®ä¸­å¿ƒä¹‹å¤–ï¼Œ æˆ–è€…è‡³å°‘æ˜¯å¤‡ä»½åˆ°ä½ è¿è¡Œ Redis æœåŠ¡å™¨çš„ç‰©ç†æœºå™¨ä¹‹å¤–ã€‚ å…­ã€Redis ä¸»ä»Žå¤åˆ¶0ã€å‰æƒ…æè¦Redis æ”¯æŒç®€å•ä¸”æ˜“ç”¨çš„ä¸»ä»Žå¤åˆ¶ï¼ˆmaster-slave replicationï¼‰åŠŸèƒ½ï¼Œ è¯¥åŠŸèƒ½å¯ä»¥è®©ä»ŽæœåŠ¡å™¨(slave server)æˆä¸ºä¸»æœåŠ¡å™¨(masterserver)çš„ç²¾ç¡®å¤åˆ¶å“ ã€‚ 1ã€å…³äºŽ Redis å¤åˆ¶åŠŸèƒ½çš„å‡ ä¸ªé‡è¦æ–¹é¢ï¼š Redis ä½¿ç”¨å¼‚æ­¥å¤åˆ¶ã€‚ ä¸€ä¸ªä¸»æœåŠ¡å™¨å¯ä»¥æœ‰å¤šä¸ªä»ŽæœåŠ¡å™¨ã€‚ ä¸ä»…ä¸»æœåŠ¡å™¨å¯ä»¥æœ‰ä»ŽæœåŠ¡å™¨ï¼Œ ä»ŽæœåŠ¡å™¨ä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„ä»ŽæœåŠ¡å™¨ï¼Œå¤šä¸ªä»ŽæœåŠ¡å™¨ä¹‹é—´å¯ä»¥æž„æˆä¸€ä¸ªå›¾çŠ¶ç»“æž„ã€‚ å¤åˆ¶åŠŸèƒ½ä¸ä¼šé˜»å¡žä¸»æœåŠ¡å™¨ï¼š å³ä½¿æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä»ŽæœåŠ¡å™¨æ­£åœ¨è¿›è¡Œåˆæ¬¡åŒæ­¥ï¼Œ ä¸»æœåŠ¡å™¨ä¹Ÿå¯ä»¥ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚ä¸è¿‡ï¼Œ åœ¨ä»ŽæœåŠ¡å™¨åˆ é™¤æ—§ç‰ˆæœ¬æ•°æ®é›†å¹¶è½½å…¥æ–°ç‰ˆæœ¬æ•°æ®é›†çš„é‚£æ®µæ—¶é—´å†…ï¼Œ è¿žæŽ¥è¯·æ±‚ä¼šè¢«é˜»å¡žã€‚ å¤åˆ¶åŠŸèƒ½å¯ä»¥å•çº¯åœ°ç”¨äºŽæ•°æ®å†—ä½™ï¼ˆdata redundancyï¼‰ï¼Œ ä¹Ÿå¯ä»¥é€šè¿‡è®©å¤šä¸ªä»ŽæœåŠ¡å™¨å¤„ç†åªè¯»å‘½ä»¤è¯·æ±‚æ¥æå‡æ‰©å±•æ€§ï¼ˆscalabilityï¼‰ï¼š æ¯”å¦‚è¯´ï¼Œ ç¹é‡çš„ SORT å‘½ä»¤å¯ä»¥äº¤ç»™é™„å±žèŠ‚ç‚¹åŽ»è¿è¡Œã€‚ 2ã€ä»ŽæœåŠ¡å™¨é…ç½®æ–¹å¼ä¸€ï¼šç¼–è¾‘é…ç½®æ–‡ä»¶ ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰ æ·»åŠ ä¸»æœåŠ¡å™¨çš„IP slaveof 192.168.198.128 6379 æ–¹å¼äºŒï¼šè°ƒç”¨ SLAVEOF å‘½ä»¤ï¼Œè¾“å…¥ä¸»æœåŠ¡å™¨çš„ IP å’Œç«¯å£ï¼Œç„¶åŽåŒæ­¥å°±ä¼šå¼€å§‹ å‰æï¼šä¸»ä»ŽæœåŠ¡å™¨çš„redis-serverå‡å¯åŠ¨äº† ï¼ˆä»…é€‚ç”¨äºŽå½“å‰çº¿ç¨‹çš„æœåŠ¡ï¼ŒåŒæ­¥æ—¶ï¼Œä¼šå°†è‡ªå·±åŽŸæ¥çš„keyå€¼æ•°æ®æ¸…ç©ºï¼Œå¹¶ä¸”åœ¨ä¸»æœåŠ¡å™¨é¡µé¢ä¼šæ˜¾ç¤ºå…³äºŽä»ŽæœåŠ¡å™¨çš„æ—¥å¿—ä¿¡æ¯ï¼‰ 127.0.0.1:6379&gt; SLAVEOF 192.168.198.128 6379 è‹¥æƒ³å–æ¶ˆè¯¥æœåŠ¡å™¨çš„ä¸»ä»Žå…³ç³»ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œä¸”è¿˜ä¼šä¿å­˜å½“å‰æ•°æ® 127.0.0.1:6379&gt; SLAVEOF no one è¿žæŽ¥è¿œç¨‹èŠ‚ç‚¹çš„redisæœåŠ¡ï¼ˆç«¯å£é»˜è®¤ä¸º6379ï¼‰ redis-cli -h 192.168.198.128 3ã€åªè¯»æœåŠ¡å™¨ä»Ž Redis 2.6 å¼€å§‹ï¼Œ ä»ŽæœåŠ¡å™¨æ”¯æŒåªè¯»æ¨¡å¼ï¼Œ å¹¶ä¸”è¯¥æ¨¡å¼ä¸ºä»ŽæœåŠ¡å™¨çš„é»˜è®¤æ¨¡å¼ã€‚ï‚· åªè¯»æ¨¡å¼é…ç½® æ–¹å¼ä¸€ï¼šç”± redis.conf æ–‡ä»¶ä¸­çš„ slave-read-only é€‰é¡¹æŽ§åˆ¶ slave-read-only yes æ–¹å¼äºŒï¼šé€šè¿‡ CONFIG SET å‘½ä»¤æ¥å¼€å¯æˆ–å…³é—­è¿™ä¸ªæ¨¡å¼ ï‚· åªè¯»ä»ŽæœåŠ¡å™¨ä¼šæ‹’ç»æ‰§è¡Œä»»ä½•å†™å‘½ä»¤ï¼Œ æ‰€ä»¥ä¸ä¼šå‡ºçŽ°å› ä¸ºæ“ä½œå¤±è¯¯è€Œå°†æ•°æ®ä¸å°å¿ƒå†™å…¥åˆ°äº†ä»ŽæœåŠ¡å™¨çš„æƒ…å†µã€‚ ï‚· å¦å¤–ï¼Œå¯¹ä¸€ä¸ªä»Žå±žæœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤ SLAVEOF NO ONE å°†ä½¿å¾—è¿™ä¸ªä»Žå±žæœåŠ¡å™¨å…³é—­å¤åˆ¶åŠŸèƒ½ï¼Œå¹¶ä»Žä»Žå±žæœåŠ¡å™¨è½¬å˜å›žä¸»æœåŠ¡å™¨ï¼ŒåŽŸæ¥åŒæ­¥æ‰€å¾—çš„æ•°æ®é›†ä¸ä¼šè¢«ä¸¢å¼ƒã€‚ ï‚· åˆ©ç”¨ã€Ž SLAVEOF NO ONE ä¸ä¼šä¸¢å¼ƒåŒæ­¥æ‰€å¾—æ•°æ®é›†ã€è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥åœ¨ä¸»æœåŠ¡å™¨å¤±è´¥çš„æ—¶å€™ï¼Œå°†ä»Žå±žæœåŠ¡å™¨ç”¨ä½œæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œä»Žè€Œå®žçŽ°æ— é—´æ–­è¿è¡Œã€‚ 4ã€ä»ŽæœåŠ¡å™¨ç›¸å…³é…ç½®ï¼šè®¾ç½®å¯†ç ï¼š â€‹ ä¸»æœåŠ¡å™¨ï¼š é€šè¿‡ requirepass é€‰é¡¹è®¾ç½®å¯†ç  â€‹ ä»ŽæœåŠ¡å™¨ï¼š æ–¹å¼ä¸€ï¼š æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œä½¿ç”¨å®¢æˆ·ç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼šconfig set masterauth æ–¹å¼äºŒï¼š å°†å®ƒåŠ å…¥åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼šmasterauth 5ã€ä¸»æœåŠ¡å™¨é…ç½®åªåœ¨æœ‰è‡³å°‘ N ä¸ªä»ŽæœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæ‰æ‰§è¡Œå†™æ“ä½œ ä»Ž Redis 2.8 å¼€å§‹ï¼Œ ä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œå¯ä»¥é€šè¿‡é…ç½®ï¼Œ è®©ä¸»æœåŠ¡å™¨åªåœ¨æœ‰è‡³å°‘ N ä¸ªå½“å‰å·²è¿žæŽ¥ä»ŽæœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œ æ‰æ‰§è¡Œå†™å‘½ä»¤ã€‚ min-slaves-to-write min-slaves-max-lag è‡³å°‘æœ‰ min-slaves-to-write ä¸ªä»ŽæœåŠ¡å™¨ï¼Œ å¹¶ä¸”è¿™äº›æœåŠ¡å™¨çš„å»¶è¿Ÿå€¼éƒ½å°‘äºŽ min-slaves-max-lag ç§’ï¼Œ é‚£ä¹ˆä¸»æœåŠ¡å™¨å°±ä¼šæ‰§è¡Œå®¢æˆ·ç«¯è¯·æ±‚çš„å†™æ“ä½œã€‚ ä¸ƒã€Redis-sentinel( å“¨å…µ)0ã€å‰æƒ…æè¦Redis çš„ Sentinel ç³»ç»Ÿç”¨äºŽç®¡ç†å¤šä¸ª Redis æœåŠ¡å™¨ï¼Œè¯¥ç³»ç»Ÿæ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªä»»åŠ¡ï¼š ç›‘æŽ§ï¼ˆMonitoringï¼‰ï¼š Sentinel ä¼šä¸æ–­åœ°æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»ŽæœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚ æé†’ï¼ˆNotificationï¼‰ï¼š å½“è¢«ç›‘æŽ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºçŽ°é—®é¢˜æ—¶ï¼ŒSentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚ è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomatic failoverï¼‰ï¼š å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œ Sentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œ å®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»ŽæœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä»–ä»ŽæœåŠ¡å™¨æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»æœåŠ¡å™¨ï¼› å½“å®¢æˆ·ç«¯è¯•å›¾è¿žæŽ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œé›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›žæ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œ ä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨ä»£æ›¿å¤±æ•ˆæœåŠ¡å™¨ã€‚ Redis Sentinel æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªæž¶æž„ä¸­è¿è¡Œå¤šä¸ª Sentinel è¿›ç¨‹ï¼Œ è¿™äº›è¿›ç¨‹ä½¿ç”¨æµè¨€åè®®ï¼ˆgossipprotocols)æ¥æŽ¥æ”¶å…³äºŽä¸»æœåŠ¡å™¨æ˜¯å¦ä¸‹çº¿çš„ä¿¡æ¯ï¼Œ å¹¶ä½¿ç”¨æŠ•ç¥¨åè®®ï¼ˆagreement protocolsï¼‰æ¥å†³å®šæ˜¯å¦æ‰§è¡Œè‡ªåŠ¨æ•…éšœè¿ç§»ï¼Œä»¥åŠé€‰æ‹©å“ªä¸ªä»ŽæœåŠ¡å™¨ä½œä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚ 1ã€å¯åŠ¨ Sentinelæ–¹å¼ä¸€ï¼š å¯¹äºŽ redis-sentinel ç¨‹åºï¼Œ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨Sentinel ç³»ç»Ÿï¼š redis-sentinel /path/to/sentinel.conf æ–¹å¼äºŒï¼š å¯¹äºŽ redis-server ç¨‹åºï¼Œ ä½ å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªè¿è¡Œåœ¨ Sentinel æ¨¡å¼ä¸‹çš„ Redis æœåŠ¡å™¨ï¼š redis- - server /path/to/sentinel.conf â€“ sentinel æ³¨æ„ï¼š å¯åŠ¨ Sentinel å®žä¾‹å¿…é¡»æŒ‡å®šç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼Œ ç³»ç»Ÿä¼šä½¿ç”¨é…ç½®æ–‡ä»¶æ¥ä¿å­˜ Sentinel çš„å½“å‰çŠ¶æ€ï¼Œ å¹¶åœ¨ Sentinel é‡å¯æ—¶é€šè¿‡è½½å…¥é…ç½®æ–‡ä»¶æ¥è¿›è¡ŒçŠ¶æ€è¿˜åŽŸã€‚å¦‚æžœå¯åŠ¨ Sentinel æ—¶æ²¡æœ‰æŒ‡å®šç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼Œ æˆ–è€…æŒ‡å®šçš„é…ç½®æ–‡ä»¶ä¸å¯å†™ï¼ˆnot writableï¼‰ï¼Œ é‚£ä¹ˆ Sentinel ä¼šæ‹’ç»å¯åŠ¨ã€‚ 2 ã€é…ç½® SentinelRedis æºç ä¸­åŒ…å«äº†ä¸€ä¸ªåä¸º sentinel.conf çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå¸¦æœ‰è¯¦ç»†æ³¨é‡Šçš„ Sentinel é…ç½®æ–‡ä»¶ç¤ºä¾‹ã€‚è¿è¡Œä¸€ä¸ª Sentinel æ‰€éœ€çš„æœ€å°‘é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š 12345sentinel monitor mymaster 192.168.198.128 6379 2 sentinel down-after-milliseconds mymaster 30000sentinel failover-timeout mymaster 180000sentinel parallel-syncs mymaster 1protected-mode no / bind æœ¬æœº IP æ³¨æ„ï¼šä¸»æœåŠ¡å™¨æ— å¯†ç æ—¶ï¼Œè®°å¾—åœ¨ sentinel é…ç½®é‡Œé…ä¸Šbind æœ¬æœº ip ï¼Œæˆ–è€…å…³æŽ‰ä¿æŠ¤æ¨¡å¼ protected-mode no é…ç½®è§£é‡Šï¼š ç¬¬ä¸€è¡Œé…ç½®æŒ‡ç¤º Sentinel åŽ»ç›‘è§†ä¸€ä¸ªåä¸º mymaster çš„ä¸»æœåŠ¡å™¨ï¼Œ è¿™ä¸ªä¸»æœåŠ¡å™¨çš„ IP åœ°å€ä¸º 127.0.0.1 ï¼Œ ç«¯å£å·ä¸º 6379 ï¼Œ è€Œå°†è¿™ä¸ªä¸»æœåŠ¡å™¨åˆ¤æ–­ä¸ºå¤±æ•ˆè‡³å°‘éœ€è¦ 2 ä¸ªSentinel åŒæ„ ï¼ˆåªè¦åŒæ„ Sentinel çš„æ•°é‡ä¸è¾¾æ ‡ï¼Œè‡ªåŠ¨æ•…éšœè¿ç§»å°±ä¸ä¼šæ‰§è¡Œï¼‰ã€‚ down-after-milliseconds é€‰é¡¹ æŒ‡å®šäº† Sentinel è®¤ä¸ºæœåŠ¡å™¨å·²ç»æ–­çº¿æ‰€éœ€çš„æ¯«ç§’æ•°ã€‚ å¦‚æžœæœåŠ¡å™¨åœ¨ç»™å®šçš„æ¯«ç§’æ•°ä¹‹å†…ï¼Œ æ²¡æœ‰è¿”å›ž Sentinelå‘é€çš„ PING å‘½ä»¤çš„å›žå¤ï¼Œ æˆ–è€…è¿”å›žä¸€ä¸ªé”™è¯¯ï¼Œ é‚£ä¹ˆ Sentinel å°†è¿™ä¸ªæœåŠ¡å™¨æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ parallel-syncs é€‰é¡¹æŒ‡å®šäº†åœ¨æ‰§è¡Œæ•…éšœè½¬ç§»æ—¶ï¼Œ æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªä»ŽæœåŠ¡å™¨åŒæ—¶å¯¹æ–°çš„ä¸»æœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ï¼Œ è¿™ä¸ªæ•°å­—è¶Šå°ï¼Œ å®Œæˆæ•…éšœè½¬ç§»æ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ã€‚ ä½ å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªä»ŽæœåŠ¡å™¨å¤„äºŽä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚]]></content>
      <categories>
        <category>å†…å­˜æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>Linuxç³»ç»ŸçŽ¯å¢ƒ</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Stormå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F29%2FStorm%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Stormç®€ä»‹å®˜ç½‘ï¼šStorm 1ã€Storm ï¼šæµå¼è®¡ç®—å¤„ç†æ¡†æž¶ 2ã€ ç‰¹ç‚¹ï¼š å®žæ—¶ åˆ†å¸ƒå¼ é«˜å®¹é”™ stormå¸¸é©»å†…å­˜ï¼ˆ7*24h:æ„å‘³ç€æ°¸ä¹…è¿è¡Œï¼Œéœ€äººä¸ºå…³é—­ï¼‰ æ•°æ®ä¸ç»è¿‡ç£ç›˜ï¼Œåœ¨å†…å­˜ä¸­å¤„ç† é«˜å¯é æ€§ï¼šå¼‚å¸¸å¤„ç†ã€æ¶ˆæ¯å¯é æ€§ä¿éšœæœºåˆ¶ å¯ç»´æŠ¤æ€§ï¼šStormUIå›¾å½¢åŒ–ç›‘æŽ§æŽ¥å£ 3ã€åº”ç”¨ ï¼ˆ1ï¼‰æµå¼å¤„ç†ï¼šï¼ˆå¼‚æ­¥ï¼‰ â€‹ å®¢æˆ·ç«¯æäº¤æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¹¶ä¸ä¼šç­‰å¾…è®¡ç®—ç»“æžœ ä¸¾ä¾‹ï¼š é€æ¡å¤„ç†ï¼šETLï¼ˆç”¨äºŽæ•°æ®æ¸…æ´—ï¼‰ ç»Ÿè®¡åˆ†æž ï¼ˆ2ï¼‰å®žæ—¶è¯·æ±‚åº”ç­”æœåŠ¡ï¼šï¼ˆåŒæ­¥ï¼‰ å®¢æˆ·ç«¯æäº¤æ•°æ®åŽï¼Œç«‹åˆ»å–å¾—è®¡ç®—ç»“æžœå¹¶è¿”å›žç»™å®¢æˆ·ç«¯ ä¸¾ä¾‹ï¼š äºŒã€Stormæž¶æž„ï¼ˆä»Žè¿›ç¨‹è§’åº¦ï¼‰ 1ã€nimbus : (ä¸»)æŽ¥æ”¶å®¢æˆ·ç«¯æäº¤çš„è¯·æ±‚ï¼› èµ„æºè°ƒåº¦ã€ä»»åŠ¡åˆ†é…ã€æŽ¥æ”¶jaråŒ… 2ã€supervisorï¼š(ä»Ž) æŽ¥æ”¶nimbusåˆ†é…çš„ä»»åŠ¡ã€å¯åœworker 3ã€workerâ€“ è¿è¡Œå…·ä½“å¤„ç†è¿ç®—ç»„ä»¶çš„è¿›ç¨‹ï¼ˆæ¯ä¸ªWorkerå¯¹åº”æ‰§è¡Œä¸€ä¸ªTopologyçš„å­é›†ï¼‰â€“ workerä»»åŠ¡ç±»åž‹ï¼Œå³spoutä»»åŠ¡ã€boltä»»åŠ¡ä¸¤ç§â€“ å¯åŠ¨executorï¼ˆexecutorå³worker JVMè¿›ç¨‹ä¸­çš„ä¸€ä¸ªjavaçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤æ¯ä¸ªexecutorè´Ÿè´£æ‰§è¡Œä¸€ä¸ªtaskä»»åŠ¡ï¼‰ 4ã€zookeeperå­˜å‚¨å¿ƒè·³ä¿¡æ¯ã€ä»»åŠ¡ä¿¡æ¯ æ•°æ®ä¼ è¾“ ZMQ ï¼šZeroMQå¼€æºçš„æ¶ˆæ¯ä¼ é€’æ¡†æž¶ã€‚å¹¶ä¸æ˜¯æ¶ˆæ¯é˜Ÿåˆ— Netty ï¼šåŸºäºŽNIOçš„ç½‘ç»œæ¡†æž¶ï¼Œé«˜æ•ˆï¼ˆStorm 0.9ä¹‹åŽä½¿ç”¨ï¼‰ ä¸‰ã€Stormç¼–ç¨‹æ¨¡åž‹ Topologyï¼ˆDAGæœ‰å‘æ— çŽ¯å›¾çš„å®žçŽ°ï¼‰ æ˜¯å¯¹Stormå®žæ—¶è®¡ç®—é€»è¾‘çš„å°è£…ï¼Œç”±ä¸€ç³»åˆ—é€šè¿‡æ•°æ®æµç›¸äº’å…³è”çš„Spoutã€Boltç»„æˆçš„æ‹“æ‰‘ç»“æž„ ç”Ÿå‘½å‘¨æœŸï¼š æ­¤æ‹“æ‰‘ç»“æž„åªè¦å¯åŠ¨ï¼Œå°±ä¼šåœ¨é›†ç¾¤ä¸­ä¸€ç›´è¿è¡Œï¼Œç›´åˆ°æ‰‹åŠ¨å°†å…¶killï¼Œå¦åˆ™ä¸ä¼šç»ˆæ­¢ã€‚ ï¼ˆä¸ŽMapReduceä¸­Jobçš„åŒºåˆ«ï¼ŒMRä¸­Jobåœ¨è®¡ç®—å®ŒæˆåŽå°±ä¼šç»ˆæ­¢ï¼‰ spoutï¼ˆæ•°æ®æºï¼šå‘é€æ•°æ®ï¼‰ ä¸€èˆ¬ä¼šä»ŽæŒ‡å®šçš„æ•°æ®æºè¯»å–å…ƒç¥–ï¼ˆTupleï¼‰å‘é€åˆ°æ‹“æ‰‘ï¼ˆTopologyï¼‰ä¸­ ä¸€ä¸ªSpoutå¯ä»¥å‘é€å¤šä¸ªStream ï¼ˆé€šè¿‡OutputFieldDeclareçš„declareæ–¹æ³•å£°æ˜Žä¸åŒçš„æ•°æ®æµï¼Œå‘é€æ•°æ®æ—¶é€šè¿‡SpoutOutputCollectorä¸­çš„emitæ–¹æ³•æŒ‡å®š StreamIdå°†æ•°æ®å‘é€å‡ºåŽ»ï¼‰ Spoutä¸­çš„æ ¸å¿ƒæ–¹æ³•æ˜¯nextTupleï¼Œè¯¥æ–¹æ³•ä¼šè¢«Stormçº¿ç¨‹ä¸æ–­è°ƒç”¨ã€ä¸»åŠ¨ä»Žæ•°æ®æºæ‹‰å–æ•°æ®ã€å†é€šè¿‡emitæ–¹æ³•å°†æ•°æ®ç”Ÿæˆå…ƒç¥–ï¼ˆTupleï¼‰å‘é€ç»™ä¹‹åŽçš„Boltè®¡ç®— boltï¼ˆæ•°æ®å¤„ç†ç»„ä»¶ï¼šè®¡ç®—æ•°æ®ï¼Œä¸ªæ•°ä¸é™ï¼‰ å•ä¸ªBoltå¯å®žçŽ°ç®€å•çš„ä»»åŠ¡æˆ–æ•°æ®æµè½¬æ¢ å¤æ‚çš„åœºæ™¯éœ€è¦å¤šä¸ªBoltåˆ†å¤šä¸ªæ­¥éª¤å®Œæˆ ä¸€ä¸ªBoltå¯ä»¥å‘é€å¤šä¸ªStream ï¼ˆé€šè¿‡OutputFieldDeclareçš„declareæ–¹æ³•å£°æ˜Žä¸åŒçš„æ•°æ®æµï¼Œå‘é€æ•°æ®æ—¶é€šè¿‡SpoutOutputCollectorä¸­çš„emitæ–¹æ³•æŒ‡å®š StreamIdå°†æ•°æ®å‘é€å‡ºåŽ»ï¼‰ Boltä¸­çš„æ ¸å¿ƒæ–¹æ³•æ˜¯executeï¼Œè¯¥æ–¹æ³•é€šè¿‡æŽ¥æ”¶ä¸€ä¸ªå…ƒç»„æ•°æ®ã€å®žçŽ°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ tupleï¼ˆStreamä¸­æœ€å°çš„æ•°æ®ç»„æˆå•ä½ï¼‰ Streamï¼ˆæ•°æ®æµï¼‰ ä»ŽSpoutä¸­ä¼ é€’æ•°æ®ç»™Boltã€ä¸Šä¸€ä¸ªBoltä¼ é€’æ•°æ®ç»™ä¸‹ä¸€ä¸ªBlotï¼Œè¿™æ ·å½¢æˆçš„æ•°æ®é€šé“å«åšStream Streamå£°æ˜Žæ—¶éœ€è¦ç»™å…¶æŒ‡å®šIdï¼ˆé»˜è®¤ä¸ºDefaultï¼Œå®žé™…å¼€å‘ä¸­å¤šä½¿ç”¨å•ä¸€æ•°æ®æµï¼Œæ— éœ€æŒ‡å®šStreamIdï¼‰ Stream Grouping â€“ æ•°æ®æµåˆ†ç»„ï¼ˆå³æ•°æ®åˆ†å‘ç­–ç•¥ï¼‰ å››ã€Stormå®‰è£…éƒ¨ç½²ï¼ˆå®Œå…¨åˆ†å¸ƒå¼ï¼‰ çŽ¯å¢ƒï¼šzookeeperé›†ç¾¤ï¼ˆnode00ï¼Œnode01ï¼Œnode02ï¼‰ 1ã€è§£åŽ‹å®‰è£… ç‰ˆæœ¬ï¼šapache-storm-0.10.0.tar.gz 1tar -zvxf apache-storm-0.10.0.tar.gz 2ã€åœ¨stormç›®å½•ä¸­åˆ›å»ºlogsç›®å½• 1mkdir logs 3ã€ç¼–è¾‘é…ç½®æ–‡ä»¶è§£åŽ‹è·¯å¾„/config/storm.yaml 1234567891011storm.zookeeper.servers:- &quot;node00&quot;- &quot;node01&quot;- &quot;node02&quot;storm.local.dir: &quot;/opt/storm&quot;nimbus.host: â€œnode00&quot;supervisor.slots.ports:- 6700- 6701- 6702- 6703 å°†å®‰è£…åŒ…å‘é€åˆ°å…¶ä»–èŠ‚ç‚¹ 4ã€å¯åŠ¨æœåŠ¡ ï¼ˆ1ï¼‰å¯åŠ¨zookeeperâ€˜ 1zkServer.sh start (2)å¯åŠ¨nimbusï¼ˆåœ¨node00ä¸Šï¼šstormå®‰è£…ç›®å½•ä¸‹ï¼‰ 1nohup ./bin/storm nimbus &gt;&gt; ./logs/nimbus.out 2&gt;&amp;1 &amp; nohup:é˜²æ­¢è¢«æ“ä½œç³»ç»Ÿæ„å¤–æŒ‚èµ· 2&gt;&amp;1ï¼šæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ &amp;ï¼šåŽå°è¿è¡Œ (3)å¯åŠ¨supervisorï¼ˆåœ¨node01 ï¼Œnode02ä¸Šï¼šstormå®‰è£…ç›®å½•ä¸‹ï¼‰ 1./bin/storm supervisor&gt;&gt; ./logs/supervisor.out 2&gt;&amp;1 &amp; (4)æŸ¥çœ‹è¿›ç¨‹ ï¼šjps æ˜¾ç¤ºï¼š node00ï¼š [root@node00 apache-storm-0.10.0]# jps8869 QuorumPeerMain9093 Jps9083 config_value node01 ã€ node02 [root@node01 apache-storm-0.10.0]# jps7280 config_value7290 Jps7230 QuorumPeerMain ä¸”ä¸‰ä¸ªèŠ‚ç‚¹çš„logsç›®å½•ä¸‹ä¹Ÿç›¸åº”çš„ç”Ÿæˆäº†æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶ 5ã€Storm UIï¼ˆä»Žæµè§ˆå™¨è®¿é—®ï¼Œåœ¨å‰å°é¡µé¢ä¸ŠæŸ¥çœ‹è¯¦æƒ…ï¼‰ ï¼ˆ1ï¼‰å¯åŠ¨æœåŠ¡ï¼ˆå¯åœ¨node00èŠ‚ç‚¹ï¼šstormå®‰è£…ç›®å½•ï¼‰ 1./bin/storm ui &gt;&gt; ./logs/ui.out 2&gt;&amp;1 &amp; ï¼ˆ2ï¼‰æµè§ˆå™¨è®¿é—® http://node00:8080 äº”ã€Stormé‡ç‚¹æ¦‚å¿µè¯¦è§£1ã€grouping æ•°æ®æµåˆ†ç»„ï¼ˆå³æ•°æ®åˆ†å‘ç­–ç•¥ï¼‰ 2ã€å¹¶å‘æœºåˆ¶topologyè´Ÿè½½å‡è¡¡ 3ã€å®¹é”™æœºåˆ¶4ã€demoAPIStorm WordCountï¼ˆæ•°æ®ç´¯åŠ ï¼‰ 5ã€ä¸ŽMapReduceçš„åŒºåˆ« Storm MapReduce æµå¼å¤„ç† æ‰¹å¤„ç† ï¼ˆæ¯«ï¼‰ç§’çº§ åˆ†é’Ÿçº§ DAGæ¨¡åž‹ Map+Reduceæ¨¡åž‹ å¸¸é©»å†…å­˜è¿è¡Œ åå¤å¯åœ 6ã€å’ŒSpark Streamingçš„åŒºåˆ« Storm Spark Streaming æµå¼å¤„ç† å¾®æ‰¹å¤„ç† ï¼ˆæ¯«ï¼‰ç§’çº§ ç§’çº§ æˆç†Ÿç¨³å®š ç¨³å®šæ€§æ”¹è¿›ä¸­ ç‹¬ç«‹ç³»ç»Ÿ ä¸“ä¸ºæµå¼è®¡ç®—è®¾è®¡ Sparkæ ¸å¿ƒçš„ä¸€ç§è®¡ç®—æ¨¡åž‹èƒ½ä¸Žå…¶ä»–ç»„ä»¶å¾ˆå¥½çš„ç»“åˆ å°è®° 1ã€stormæºç ä¸­åŒ…å«åŽç¼€åä¸º.cljçš„æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ç§Clojureç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€ç§è¿è¡Œåœ¨JVMä¸Šçš„Lispæ–¹è¨€ã€‚è€ŒLispæ˜¯ä¸€ç§ä»¥è¡¨è¾¾æ€§å’ŒåŠŸèƒ½å¼ºå¤§è‘—ç§°çš„ç¼–ç¨‹è¯­è¨€ã€‚ 2ã€é˜¿é‡Œå·´å·´åœ¨Stormçš„åŸºç¡€ä¸Šä½¿ç”¨Javaä»£ç å¹¶åšäº†ç›¸å…³çš„æ”¹è¿›ï¼Œå¼€å‘äº†JStormï¼Œå’ŒStormä¸€æ ·éƒ½æ˜¯å¼€æºçš„ã€‚ï¼ˆåå“ºè¡Œä¸ºï¼ŒåŒ…æ‹¬å°†Flinkâ†’Blinkï¼‰ $$ $$ st=>start: Start|past:>http://www.google.com[blank] e=>end: End:>http://www.google.com op1=>operation: My Operation|past op2=>operation: Stuff|current sub1=>subroutine: My Subroutine|invalid cond=>condition: Yes or No?|approved:>http://www.google.com c2=>condition: Good idea|rejected io=>inputoutput: catch something...|request st->op1(right)->cond cond(yes, right)->c2 cond(no)->sub1(left)->op1 c2(yes)->io->e c2(no)->op2->e{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12} var code = document.getElementById("flowchart-0-code").value; var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value)); var diagram = flowchart.parse(code); diagram.drawSVG("flowchart-0", options);]]></content>
      <categories>
        <category>åˆ†å¸ƒå¼æ¡†æž¶</category>
      </categories>
      <tags>
        <tag>Stormï¼Œæµå¼å¤„ç†æ¡†æž¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flumeå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F18%2FFlume%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€åˆ†ç±»execï¼š Unixç­‰æ“ä½œç³»ç»Ÿæ‰§è¡Œå‘½ä»¤è¡Œï¼Œå¦‚tail ï¼Œcat ã€‚å¯ç›‘å¬æ–‡ä»¶ netcat ç›‘å¬ä¸€ä¸ªæŒ‡å®šç«¯å£ï¼Œå¹¶å°†æŽ¥æ”¶åˆ°çš„æ•°æ®çš„æ¯ä¸€è¡Œè½¬æ¢ä¸ºä¸€ä¸ªeventäº‹ä»¶ avro åºåˆ—åŒ–çš„ä¸€ç§ï¼Œå®žçŽ°RPCï¼ˆä¸€ç§è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åè®®ï¼‰ã€‚ ç›‘å¬AVROç«¯å£æ¥æŽ¥æ”¶å¤–éƒ¨AVROå®¢æˆ·ç«¯äº‹ä»¶æµ capacityï¼šé»˜è®¤è¯¥é€šé“ä¸­æœ€å¤§çš„å¯ä»¥å­˜å‚¨çš„eventæ•°é‡æ˜¯1000 Trasaction Capacityï¼šæ¯æ¬¡æœ€å¤§å¯ä»¥sourceä¸­æ‹¿åˆ°æˆ–è€…é€åˆ°sinkä¸­çš„eventæ•°é‡ä¹Ÿæ˜¯100 äºŒã€æ“ä½œ1ã€ netcatï¼ˆç›‘å¬ç«¯å£ï¼Œåœ¨æœ¬åœ°æŽ§åˆ¶å°æ‰“å°ï¼‰ï¼ˆ1ï¼‰ vim netcat_logger1234567891011121314151617181920212223# example.conf: A single-node Flume configuration# Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1# Describe/configure the sourcea1.sources.r1.type = netcata1.sources.r1.bind = localhosta1.sources.r1.port = 44444# Describe the sinka1.sinks.k1.type = logger# Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100# Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 ï¼ˆ2ï¼‰å‘½ä»¤æ“ä½œ ï¼ˆåœ¨ä¼šè¯1ç«¯ï¼‰ åœ¨node00èŠ‚ç‚¹çš„æŽ§åˆ¶å°è¾“å…¥å¯åŠ¨å‘½ä»¤ï¼š (æ–¹å¼ä¸€ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶çš„è·¯å¾„+æ–‡ä»¶å) flume-ng agent â€“conf-file /root/flume/netcat_logger â€“name a1 -Dflume.root.logger=INFO,console ï¼ˆæ–¹å¼äºŒï¼šé…ç½®æ–‡ä»¶åœ¨å½“å‰ç›®å½•ï¼‰ flume-ng agent â€“conf ./ â€“conf-file netcat_logger â€“name a1 -Dflume.root.logger=INFO,console ç‰¹åˆ«æ³¨æ„ï¼š #####å®˜ç½‘æ–¹å¼######### flume-ng agent â€“conf conf â€“conf-file netcat_logger â€“name a1 -Dflume.root.logger=INFO,console è§£é‡Šï¼šæ­¤å‘½ä»¤é€‚ç”¨äºŽå°†é…ç½®æ–‡ä»¶æ”¾åœ¨flumeè§£åŽ‹å®‰è£…ç›®å½•çš„confä¸­ï¼ˆä¸å¸¸ç”¨ï¼‰ æŽ§åˆ¶å°æ˜¾ç¤º: 1â€‹````` 19/01/18 12:27:31 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started19/01/18 12:27:31 INFO node.Application: Starting Sink k119/01/18 12:27:31 INFO node.Application: Starting Source r119/01/18 12:27:31 INFO source.NetcatSource: Source starting19/01/18 12:27:31 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/127.0.0.1:44444]123456789101112131415161718* (åœ¨ä¼šè¯2ç«¯)&gt; åœ¨node00èŠ‚ç‚¹çš„æŽ§åˆ¶å°è¾“å…¥å‘½ä»¤ï¼š&gt;&gt; 1ã€åœ¨èŠ‚ç‚¹ä¸Šå®‰è£…telnetï¼š&gt;&gt; yum install -y telnet&gt;&gt; yum -y install telnet-server&gt;&gt; 2ã€å¯åŠ¨ï¼š&gt;&gt; telnet localhost 44444 &gt;&gt; `æ³¨æ„ï¼š`ï¼š&gt;&gt; a1.sources.r1.bind = localhost12345678910&gt;&gt; å‰ææ˜¯/etc/hostsä¸­å·²ç»é…ç½®&gt;&gt; å¦‚æžœæ­¤å¤„é…ç½®localhost é‚£ä¹ˆå¯åŠ¨æ—¶ï¼Œlocalhost æˆ–127.0.0.1éƒ½å¯ä»¥ï¼Œnode00å°±ä¸è¡Œ&gt;&gt; å¦‚æžœæ­¤å¤„é…ç½®node00é‚£ä¹ˆå¯åŠ¨æ—¶ï¼Œnode00æˆ–ipéƒ½å¯ä»¥ï¼Œlocalhostå°±ä¸è¡Œ&gt;&gt; 3ã€åœ¨æŽ§åˆ¶å°è¾“å…¥ä»»ä½•å†…å®¹;&gt;&gt; éƒ½ä¼šåœ¨ä¼šè¯1ç«¯æ˜¾ç¤ºï¼Œä¸”ä¼šè¯1ç«¯ï¼ˆctrl+cï¼‰é€€å‡ºæœåŠ¡ï¼Œä¼šè¯2ç«¯ä¹Ÿè‡ªåŠ¨ç»“æŸ yum list telnet* æŸ¥çœ‹telnetç›¸å…³çš„å®‰è£…åŒ… ç›´æŽ¥yum â€“y install telnet å°±OK yum -y install telnet-server å®‰è£…telnetæœåŠ¡ yum -y install telnet-client å®‰è£…telnetå®¢æˆ·ç«¯(å¤§éƒ¨åˆ†ç³»ç»Ÿé»˜è®¤å®‰è£…) 1234### 2ã€avroï¼ˆç›‘å¬è¿œç¨‹å‘é€æ–‡ä»¶ï¼Œåœ¨æœ¬åœ°æŽ§åˆ¶å°æ‰“å°ï¼‰#### ï¼ˆ1ï¼‰vim avro_logger #test avro sources ##ä½¿ç”¨avroæ–¹å¼åœ¨æŸèŠ‚ç‚¹ä¸Šå°†æ–‡ä»¶å‘é€åˆ°æœ¬æœåŠ¡å™¨ä¸Šä¸”é€šè¿‡loggeræ–¹å¼æ˜¾ç¤º ##å½“å‰flumeèŠ‚ç‚¹æ‰§è¡Œï¼š #flume-ng agent â€“conf ./ â€“conf-file avro_loggers â€“name a1 -Dflume.root.logger=INFO,console ##å…¶ä»–flumeèŠ‚ç‚¹æ‰§è¡Œï¼š #flume-ng avro-client â€“conf ./ -H 192.168.198.128 -p 55555 -F ./logs a1.sources=r1a1.channels=c1a1.sinks=k1 a1.sources.r1.type = avroa1.sources.r1.bind=192.168.198.128a1.sources.r1.port=55555 a1.sinks.k1.type=logger a1.channels.c1.type = memorya1.channels.c1.capacity=1000a1.channels.c1.transactionCapacity = 100 a1.sources.r1.channels=c1a1.sinks.k1.channel=c1123456789101112131415161718å®žçŽ°åŠŸèƒ½ï¼š&gt; ä½¿ç”¨avroæ–¹å¼åœ¨æŸèŠ‚ç‚¹ä¸Šå°†æ–‡ä»¶å‘é€åˆ°æœ¬æœåŠ¡å™¨ä¸Šä¸”é€šè¿‡loggeræ–¹å¼æ˜¾ç¤º#### ï¼ˆ2ï¼‰å‘½ä»¤æ“ä½œ##### `å¯åŠ¨` ï¼ˆåœ¨ä¼šè¯1ç«¯ï¼‰åœ¨node00ä¸Š* ##å½“å‰flumeèŠ‚ç‚¹æ‰§è¡Œï¼ˆé…ç½®æ–‡ä»¶åœ¨å½“å‰ç›®å½•ï¼‰ï¼š* &gt; flume-ng agent --conf ./ --conf-file avro_logger --name a1 -Dflume.root.logger=INFO,console`æ˜¾ç¤ºï¼š` 19/01/18 13:53:16 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started19/01/18 13:53:16 INFO node.Application: Starting Sink k119/01/18 13:53:16 INFO node.Application: Starting Source r119/01/18 13:53:16 INFO source.AvroSource: Starting Avro source r1: { bindAddress: 192.168.198.128, port: 55555 }â€¦19/01/18 13:53:17 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SOURCE, name: r1: Successfully registered new MBean.19/01/18 13:53:17 INFO instrumentation.MonitoredCounterGroup: Component type: SOURCE, name: r1 started19/01/18 13:53:17 INFO source.AvroSource: Avro source r1 started. 12345678910##### å‘é€(åœ¨ä¼šè¯2ç«¯)åœ¨node00ä¸Šå‘é€æ–‡ä»¶åˆ°node00`å¯åŠ¨`##å¯åœ¨æœ¬åœ°å’Œå…¶ä»–flumeèŠ‚ç‚¹æ‰§è¡Œï¼ˆé…ç½®æ–‡ä»¶åœ¨å½“å‰ç›®å½•ï¼‰ï¼š flume-ng avro-client â€“conf ./ -H 192.168.198.128 -p 55555 -F ./flume.log12(åœ¨ä¼šè¯1ç«¯) 19/01/18 14:12:57 INFO sink.LoggerSink: Event: { headers:{} body: 68 65 6C 6C 6F 20 62 69 67 64 61 74 61 hello bigdata }12345678910æ—¶åˆ»ç›‘å¬ä¼ è¾“æ–‡ä»¶çš„å†…å®¹`æ³¨æ„`&gt; è¯¥è¿‡ç¨‹ä¹Ÿå¯åº”ç”¨äºŽä¸åŒèŠ‚ç‚¹ä¹‹é—´### 3ã€execï¼ˆç›‘å¬æŸä¸€å‘½ä»¤ï¼Œåœ¨æœ¬åœ°æŽ§åˆ¶å°æ‰“å°ï¼‰#### ï¼ˆ1ï¼‰vim exec_logger #å•èŠ‚ç‚¹flumeé…ç½® example.conf: A single-node Flume configuration#ç»™agentä¸‰å¤§ç»“æž„å‘½å Name the components on this agenta1.sources = r1a1.sinks = k1a1.channels = c1 #æè¿°sourceçš„é…ç½®ï¼šç±»åž‹ã€å‘½ä»¤ï¼ˆç›‘å¬/root/flume.logæ–‡ä»¶ï¼‰ Describe/configure the sourcea1.sources.r1.type = execa1.sources.r1.command = tail -F /root/flume.log #æè¿°sinkçš„é…ç½®ï¼šç±»åž‹ Describe the sinka1.sinks.k1.type = logger #åœ¨å†…å­˜ä¸­ä½¿ç”¨ä¸€ä¸ªchannelç¼“å­˜äº‹ä»¶ Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100 #å°†sourceå’Œsinkç»‘å®šåˆ°channelä¸Š Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 1234567891011121314151617181920212223242526ï¼ˆxshellä¼šè¯1ï¼šï¼‰&gt; åœ¨node00ä¸Šï¼š`å¯åŠ¨`&gt;&gt; åœ¨exec_loggeræ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹&gt;&gt; å‘½ä»¤ï¼šflume-ng agent --conf-file exec_logger --name a1 -Dflume.root.logger=INFO,console&gt;&gt; r1 å¯åŠ¨&gt; ï¼ˆå¤åˆ¶ä¼šè¯ï¼šä¼šè¯2ï¼‰&gt;&gt; åœ¨node00ä¸Šï¼š&gt;&gt; åœ¨rootç›®å½•ä¸‹&gt;&gt; å‘½ä»¤ï¼šecho hello bigdata &gt;&gt;flume.log&gt; ä¹‹åŽåœ¨ä¼šè¯2ä¸Š&gt;&gt; `loggeræœ¬åœ°æŽ§åˆ¶å°æ‰“å°ï¼š`&gt;&gt; 19/01/18 12:03:23 INFO sink.LoggerSink:Event:{ headers:{} body: 68 65 6C 6C 6F 20 62 69 67 64 61 74 61 hello bigdata }123456### 4ã€netcatâ€“hdfs(ç›‘å¬æ•°æ®ï¼Œä¼ åˆ°hdfsä¸Š)#### ï¼ˆ1ï¼‰vim netcat_hdfs a1 which ones we want to activate.a1.channels = c1a1.sources = r1a1.sinks = k1 a1.sources.r1.type = netcata1.sources.r1.bind = node00a1.sources.r1.port = 41414 a1.sinks.k1.type = hdfsa1.sinks.k1.hdfs.path = hdfs://Sunrise/myflume/%y-%m-%da1.sinks.k1.hdfs.useLocalTimeStamp=true Define a memory channel called c1 on a1a1.channels.c1.type = memory #é»˜è®¤å€¼ï¼Œå¯çœ #a1.channels.c1.capacity = 1000 #a1.channels.c1.transactionCapacity = 100 Define an Avro source called r1 on a1 and tell ita1.sources.r1.channels = c1a1.sinks.k1.channel = c112345678910111213141516#### (2)æ“ä½œåœ¨node00çš„ä¼šè¯1ä¸Šå¯åŠ¨&gt; åœ¨node00ä¸Šï¼š&gt;&gt; åœ¨netcat_hdfsæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹&gt;&gt; å‘½ä»¤ï¼šflume-ng agent --conf-file netcat_hdfs --name a1 -Dflume.root.logger=INFO,consoleæ˜¾ç¤ºï¼š 19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started19/01/18 14:34:44 INFO node.Application: Starting Sink k119/01/18 14:34:44 INFO node.Application: Starting Source r119/01/18 14:34:44 INFO source.NetcatSource: Source starting19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SINK, name: k1: Successfully registered new MBean.19/01/18 14:34:44 INFO instrumentation.MonitoredCounterGroup: Component type: SINK, name: k1 started19/01/18 14:34:44 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/192.168.198.128:41414] 12345678910åœ¨node00çš„ä¼šè¯2ä¸Šå¯åŠ¨&gt; telnet node00 41414æ˜¾ç¤º Trying 192.168.198.128â€¦Connected to node00.Escape character is â€˜^]â€™. 1234è¾“å…¥ä»»æ„å†…å®¹åœ¨node00ä¼šè¯1ç«¯ä¼šæ˜¾ç¤º 19/01/18 14:36:50 INFO hdfs.HDFSSequenceFile: writeFormat = Writable, UseRawLocalFileSystem = false19/01/18 14:36:51 INFO hdfs.BucketWriter: Creating hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp19/01/18 14:37:29 INFO hdfs.BucketWriter: Closing hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp19/01/18 14:37:29 INFO hdfs.BucketWriter: Renaming hdfs://Sunrise/myflume/19-01-18/FlumeData.1547822210259.tmp to hdfs://Sunrise/myflume/19-01-18/FlumeData.154782221025919/01/18 14:37:29 INFO hdfs.HDFSEventSink: Writer callback called. 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758åœ¨HDFåˆ†å¸ƒå¼ç³»ç»Ÿä¸Šä¼šæ˜¾ç¤ºï¼Œç”Ÿæˆçš„æ–‡ä»¶![](https://ws1.sinaimg.cn/large/005zftzDgy1fzb4acaz5fj30u10blmzc.jpg)![](https://ws1.sinaimg.cn/large/005zftzDgy1fzb4bsv8d2j30wd08k74i.jpg)`æ³¨æ„ï¼š`è¿™ç§æƒ…å†µä¼šåœ¨hdfsä¸Šç”Ÿæˆå¾ˆå¤šå°æ–‡ä»¶ï¼Œ[åœ¨å®˜ç½‘](http://flume.apache.org/releases/content/1.8.0/FlumeUserGuide.html)HDFS Sinkï¼š[**](http://flume.apache.org/releases/content/1.8.0/FlumeUserGuide.html#hdfs-sink)æœ‰å¾ˆå¤šå…³äºŽæ–‡ä»¶ç”Ÿæˆè¿‡ç¨‹ä¸­çš„é…ç½®| Name | Default | Description || ---------------------- | ------------ | ------------------------------------------------------------ || **channel** | â€“ | || **type** | â€“ | The component type name, needs to be `hdfs` || **hdfs.path** | â€“ | HDFS directory path (eg hdfs://namenode/flume/webdata/) || hdfs.filePrefix | FlumeData | Name prefixed to files created by Flume in hdfs directory || hdfs.fileSuffix | â€“ | Suffix to append to file (eg `.avro` - *NOTE: period is not automatically added*) || hdfs.inUsePrefix | â€“ | Prefix that is used for temporal files that flume actively writes into || hdfs.inUseSuffix | `.tmp` | Suffix that is used for temporal files that flume actively writes into || hdfs.rollInterval | 30 | Number of seconds to wait before rolling current file (0 = never roll based on time interval) || hdfs.rollSize | 1024 | File size to trigger roll, in bytes (0: never roll based on file size) || hdfs.rollCount | 10 | Number of events written to file before it rolled (0 = never roll based on number of events) || hdfs.idleTimeout | 0 | Timeout after which inactive files get closed (0 = disable automatic closing of idle files) || hdfs.batchSize | 100 | number of events written to file before it is flushed to HDFS || hdfs.codeC | â€“ | Compression codec. one of following : gzip, bzip2, lzo, lzop, snappy || hdfs.fileType | SequenceFile | File format: currently `SequenceFile`, `DataStream` or `CompressedStream` (1)DataStream will not compress output file and please donâ€™t set codeC (2)CompressedStream requires set hdfs.codeC with an available codeC || hdfs.maxOpenFiles | 5000 | Allow only this number of open files. If this number is exceeded, the oldest file is closed. || hdfs.minBlockReplicas | â€“ | Specify minimum number of replicas per HDFS block. If not specified, it comes from the default Hadoop config in the classpath. || hdfs.writeFormat | Writable | Format for sequence file records. One of `Text` or `Writable`. Set to `Text` before creating data files with Flume, otherwise those files cannot be read by either Apache Impala (incubating) or Apache Hive. || hdfs.callTimeout | 10000 | Number of milliseconds allowed for HDFS operations, such as open, write, flush, close. This number should be increased if many HDFS timeout operations are occurring. || hdfs.threadsPoolSize | 10 | Number of threads per HDFS sink for HDFS IO ops (open, write, etc.) || hdfs.rollTimerPoolSize | 1 | Number of threads per HDFS sink for scheduling timed file rolling || hdfs.kerberosPrincipal | â€“ | Kerberos user principal for accessing secure HDFS || hdfs.kerberosKeytab | â€“ | Kerberos keytab for accessing secure HDFS || hdfs.proxyUser | | || hdfs.round | false | Should the timestamp be rounded down (if true, affects all time based escape sequences except %t) || hdfs.roundValue | 1 | Rounded down to the highest multiple of this (in the unit configured using `hdfs.roundUnit`), less than current time. || hdfs.roundUnit | second | The unit of the round down value - `second`, `minute` or `hour`. || hdfs.timeZone | Local Time | Name of the timezone that should be used for resolving the directory path, e.g. America/Los_Angeles. || hdfs.useLocalTimeStamp | false | Use the local time (instead of the timestamp from the event header) while replacing the escape sequences. || hdfs.closeTries | 0 | Number of times the sink must try renaming a file, after initiating a close attempt. If set to 1, this sink will not re-try a failed rename (due to, for example, NameNode or DataNode failure), and may leave the file in an open state with a .tmp extension. If set to 0, the sink will try to rename the file until the file is eventually renamed (there is no limit on the number of times it would try). The file may still remain open if the close call fails but the data will be intact and in this case, the file will be closed only after a Flume restart. || hdfs.retryInterval | 180 | Time in seconds between consecutive attempts to close a file. Each close call costs multiple RPC round-trips to the Namenode, so setting this too low can cause a lot of load on the name node. If set to 0 or less, the sink will not attempt to close the file if the first attempt fails, and may leave the file open or with a â€.tmpâ€ extension. || serializer | `TEXT` | Other possible options include `avro_event` or the fully-qualified class name of an implementation of the `EventSerializer.Builder` interface. |netcat-hdfs ï¼ˆé…ç½®æ–¹å¼äºŒï¼‰ a1 which ones we want to activate.a1.channels = c1a1.sources = r1a1.sinks = k1 a1.sources.r1.type = avroa1.sources.r1.bind=node01a1.sources.r1.port=55555 a1.sinks.k1.type = hdfsa1.sinks.k1.hdfs.path = hdfs://shsxt/hdfsflume Define a memory channel called c1 on a1a1.channels.c1.type = memorya1.channels.c1.capacity=1000a1.channels.c1.transactionCapacity = 100 Define an Avro source called r1 on a1 and tell ita1.sources.r1.channels = c1a1.sinks.k1.channel = c1123456### 5ã€ç»“åˆç‰ˆï¼ˆnetcat-avroï¼‰#### ï¼ˆ1ï¼‰vim netcat2_loggerï¼ˆnode00ï¼‰ example.conf: A single-node Flume configuration#flume-ng agent â€“conf ./ â€“conf-file netcat2_logger â€“name a1 -Dflume.root.logger=INFO,console #flume-ng â€“conf conf â€“conf-file /root/flume_test/netcat_hdfs -n a1 -Dflume.root.logger=INFO,console #telnet 192.168.235.15 44444 Name the components on this agent a1.sources = r1 a1.sinks = k1 a1.channels = c1 Describe/configure the source a1.sources.r1.type = netcat a1.sources.r1.bind = node00 a1.sources.r1.port = 44444 Describe the sink a1.sinks.k1.type = avro a1.sinks.k1.hostname = node01 a1.sinks.k1.port = 60000 Use a channel which buffers events in memory a1.channels.c1.type = memory a1.channels.c1.capacity = 1000 a1.channels.c1.transactionCapacity = 100 Bind the source and sink to the channel a1.sources.r1.channels = c1 a1.sinks.k1.channel = c1 #â€”â€”â€”â€”â€”â€”â€”â€”â€” #flume-ng agent â€“conf-file etect2_logger â€“name a1 -#Dflume.root.logger=INFO,console #flume-ng agent â€“conf conf â€“conf-file netcat_logger â€“name a1 -#Dflume.root.logger=INFO,console12ï¼ˆnode01ï¼‰ #flume-ng agent â€“conf ./ â€“conf-file avro2 -n a1a1.sources = r1a1.sinks = k1a1.channels = c1 a1.sources.r1.type = avroa1.sources.r1.bind = node01a1.sources.r1.port = 60000 a1.sinks.k1.type = logger Use a channel which buffers events in memorya1.channels.c1.type = memorya1.channels.c1.capacity = 1000a1.channels.c1.transactionCapacity = 100 Bind the source and sink to the channela1.sources.r1.channels = c1a1.sinks.k1.channel = c1 1234567891011121314(2)æ“ä½œ&gt; å…ˆå¯åŠ¨åŽé¢çš„flumeèŠ‚ç‚¹node01 ï¼Œåœ¨å¯åŠ¨node00ï¼Œæœ€åŽå¯åŠ¨node02åœ¨node01ä¸Š`å¯åŠ¨`&gt; flume-ng &gt;&gt; --conf conf --conf-file avro2 -n a1 -Dflume.root.logger=INFO,consoleæ˜¾ç¤º 19/01/18 23:22:27 INFO node.Application: Starting Channel c119/01/18 23:22:28 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: CHANNEL, name: c1: Successfully registered new MBean.19/01/18 23:22:28 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: c1 started19/01/18 23:22:28 INFO node.Application: Starting Sink k119/01/18 23:22:28 INFO node.Application: Starting Source r119/01/18 23:22:28 INFO source.AvroSource: Starting Avro source r1: { bindAddress: node01, port: 60000 }â€¦19/01/18 23:22:30 INFO instrumentation.MonitoredCounterGroup: Monitored counter group for type: SOURCE, name: r1: Successfully registered new MBean.19/01/18 23:22:30 INFO instrumentation.MonitoredCounterGroup: Component type: SOURCE, name: r1 started19/01/18 23:22:30 INFO source.AvroSource: Avro source r1 started. 1234567891011121314151617181920212223242526åœ¨node00ä¸Š`å¯åŠ¨`&gt; flume-ng agent&gt;&gt; --conf ./ --conf-file netcat2_logger --name a1 -Dflume.root.logger=INFO,consoleåœ¨node02ä¸Š`å¯åŠ¨`&gt; telnet node00 44444ç„¶åŽè¾“å…¥æ•°æ®æ–‡ä»¶æœ€åŽåœ¨node01èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯ 19/01/18 23:33:01 INFO sink.LoggerSink: Event: { headers:{} body: 68 65 6C 6C 6F 20 77 6F 72 6C 64 0D hello world. } ` flume-ng agent â€“conf-file flumeproject â€“name a1 -Dflume.root.logger=INFO,console]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>flume</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HBaseæ€§èƒ½ä¼˜åŒ–]]></title>
    <url>%2F2019%2F01%2F17%2FHBase%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[HBaseæ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼ˆä¸€ï¼‰ã€è¡¨çš„è®¾è®¡ä¸€ã€Pre-Creating Regions é¢„åˆ†åŒº è§£å†³æµ·é‡å¯¼å…¥æ•°æ®æ—¶çš„çƒ­ç‚¹é—®é¢˜ èƒŒæ™¯ï¼š åœ¨åˆ›å»ºHBaseè¡¨çš„æ—¶å€™é»˜è®¤ä¸€å¼ è¡¨åªæœ‰ä¸€ä¸ªregionï¼Œ æ‰€æœ‰çš„putæ“ä½œéƒ½ä¼šå¾€è¿™ä¸€ä¸ªregionä¸­å¡«å……æ•°æ®ï¼Œ å½“è¿™ä¸€ä¸ªregionè¿‡å¤§æ—¶å°±ä¼šè¿›è¡Œsplitã€‚ å¦‚æžœåœ¨åˆ›å»ºHBaseçš„æ—¶å€™å°±è¿›è¡Œé¢„åˆ†åŒº åˆ™ä¼šå‡å°‘å½“æ•°æ®é‡çŒ›å¢žæ—¶ç”±äºŽregion splitå¸¦æ¥çš„èµ„æºæ¶ˆè€—ã€‚ æ³¨æ„ï¼š æ¯ä¸ªregionéƒ½æœ‰ä¸€ä¸ªstartKeyå’Œä¸€ä¸ªendKeyæ¥è¡¨ç¤ºè¯¥regionå­˜å‚¨çš„rowKeyèŒƒå›´ã€‚ 1&gt; create &apos;t1&apos;, &apos;cf&apos;, SPLITS =&gt; [&apos;20150501000000000&apos;, &apos;20150515000000000&apos;, &apos;20150601000000000&apos;] æˆ–è€… 123456&gt; create &apos;t2&apos;, &apos;cf&apos;, SPLITS_FILE =&gt; &apos;/home/hadoop/splitfile.txt&apos; /home/hadoop/splitfile.txtä¸­å­˜å‚¨å†…å®¹å¦‚ä¸‹ï¼š 201505010000000002015051500000000020150601000000000 äºŒã€row key HBaseä¸­row keyç”¨æ¥æ£€ç´¢è¡¨ä¸­çš„è®°å½•ï¼Œæ”¯æŒä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š Â· é€šè¿‡å•ä¸ªrow keyè®¿é—®ï¼šå³æŒ‰ç…§æŸä¸ªrow keyé”®å€¼è¿›è¡Œgetæ“ä½œï¼› Â· é€šè¿‡row keyçš„rangeè¿›è¡Œscanï¼šå³é€šè¿‡è®¾ç½®startRowKeyå’ŒendRowKeyï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…è¿›è¡Œæ‰«æï¼›è¿‡æ»¤å™¨ Â· å…¨è¡¨æ‰«æï¼šå³ç›´æŽ¥æ‰«ææ•´å¼ è¡¨ä¸­æ‰€æœ‰è¡Œè®°å½•ã€‚ ï¼ˆäºŒï¼‰ã€å†™è¡¨æ“ä½œä¸€ã€å¤šHTableå®¢æˆ·ç«¯å¹¶å‘å†™ äºŒã€HTableå‚æ•°è®¾ç½® ä¸‰ã€æ‰¹é‡å†™ å››ã€å¤šçº¿ç¨‹å¹¶å‘å†™ ï¼ˆä¸‰ï¼‰ã€è¯»è¡¨æ“ä½œä¸€ã€å¤šHTableå®¢æˆ·ç«¯å¹¶å‘è¯» äºŒã€HTableå‚æ•°è®¾ç½® ä¸‰ã€æ‰¹é‡è¯» å››ã€å¤šçº¿ç¨‹å¹¶å‘è¯» äº”ã€ç¼“å­˜æŸ¥è¯¢ç»“æžœ å…­ã€ Blockcache]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>HBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HBaseå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F15%2FHBase%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[éžå…³ç³»åž‹æ•°æ®åº“ å®˜ç½‘ ä¸€ã€å¯¹æ•°æ®åº“çš„ åŸºæœ¬äº†è§£ 1ã€ç®€ä»‹ åŸºäºŽHadoop çš„åˆ†å¸ƒå¼æ•°æ®åº“ ç‰¹ç‚¹ï¼š 1ã€é«˜å¯é æ€§ 2ã€é«˜æ€§èƒ½ ï¼ˆä»¥ä¸Šä¸¤ç‚¹ï¼šåŸºäºŽåˆ†å¸ƒå¼çš„ç‰¹ç‚¹ï¼‰ 3ã€é¢å‘åˆ— ï¼ˆä»¥ï¼ˆK,Vï¼‰å­˜å‚¨ï¼Œæœ‰å”¯ä¸€æ ‡è®°çš„rowkeyï¼ŒvalueåŒ…å«æ˜¯æ•°æ®åº“ä¸­çš„åˆ—å€¼ï¼‰ 4ã€å¯ä¼¸ç¼© ï¼ˆæ­å»ºåœ¨é›†ç¾¤ä¸Šï¼‰ 5ã€å®žæ—¶è¯»å†™ ï¼ˆç”¨æ—¶é—´æˆ³å”¯ä¸€æ ‡è®°æ¯ä¸€ç‰ˆæœ¬çš„æ•°æ®è®°å½•ï¼‰ 2ã€å·¥ä½œç»“æž„ 1ã€åˆ©ç”¨Hadoopçš„HDFSä½œä¸ºå…¶æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ 2,åˆ©ç”¨Hadoopçš„MapReduceæ¥å¤„ç†HBaseä¸­çš„æµ·é‡æ•°æ® 3,åˆ©ç”¨Zookeeperä½œä¸ºå…¶åˆ†å¸ƒå¼ååŒæœåŠ¡ 4,ä¸»è¦ç”¨æ¥å­˜å‚¨éžç»“æž„åŒ–å’ŒåŠç»“æž„åŒ–çš„æ¾æ•£æ•°æ®ï¼ˆNoSQLéžå…³ç³»åž‹æ•°æ®åº“æœ‰redisã€MongoDBç­‰ 3ã€å…³ç³»åž‹æ•°æ®åº“ 1ã€å®šä¹‰ å…³ç³»æ¨¡åž‹æŒ‡çš„å°±æ˜¯äºŒç»´è¡¨æ ¼æ¨¡åž‹ï¼› è€Œä¸€ä¸ªå…³ç³»åž‹æ•°æ®åº“å°±æ˜¯ç”±äºŒç»´è¡¨åŠå…¶ä¹‹é—´çš„è”ç³»æ‰€ç»„æˆçš„ä¸€ä¸ªæ•°æ®ç»„ç»‡ 2ã€ä¸‰å¤§ä¼˜ç‚¹ å®¹æ˜“ç†è§£ ä½¿ç”¨æ–¹ä¾¿ æ˜“äºŽç»´æŠ¤ 3ã€ä¸‰å¤§ç“¶é¢ˆ é«˜å¹¶å‘è¯»å†™éœ€æ±‚ ç¡¬ç›˜I/Oæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ç“¶é¢ˆï¼Œå¹¶ä¸”å¾ˆéš¾èƒ½åšåˆ°æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚ æµ·é‡æ•°æ®çš„è¯»å†™æ€§èƒ½ä½Ž åœ¨ä¸€å¼ åŒ…å«æµ·é‡æ•°æ®çš„è¡¨ä¸­æŸ¥è¯¢ï¼Œæ•ˆçŽ‡æ˜¯éžå¸¸ä½Žçš„ã€‚ â€‹ æ‰©å±•æ€§å’Œå¯ç”¨æ€§å·® ä¸°å¯Œçš„å®Œæ•´æ€§ä½¿å¾—æ¨ªå‘æ‰©å±•æŠŠéš¾åº¦åŠ å¤§äº† 4ã€éžå…³ç³»åž‹æ•°æ®åº“ 1ã€å­˜å‚¨æ ¼å¼ï¼škey valueé”®å€¼å¯¹ï¼Œæ–‡æ¡£ï¼Œå›¾ç‰‡ç­‰ç­‰ ç»“æž„ä¸å›ºå®š 2ã€å¯ä»¥å‡å°‘ä¸€äº›æ—¶é—´å’Œç©ºé—´çš„å¼€é”€ï¼Œä»…éœ€è¦æ ¹æ®idå–å‡ºç›¸åº”çš„valueå°±å¯ä»¥å®ŒæˆæŸ¥è¯¢ã€‚ 3ã€ä¸€èˆ¬ä¸æ”¯æŒACIDç‰¹æ€§ï¼Œæ— éœ€ç»è¿‡SQLè§£æžï¼Œè¯»å†™æ€§èƒ½é«˜ 4ã€ä¸æä¾›whereå­—æ®µæ¡ä»¶è¿‡æ»¤ 5ã€éš¾ä»¥ä½“çŽ°è®¾è®¡çš„å®Œæ•´æ€§ï¼Œåªé€‚åˆå­˜å‚¨ä¸€äº›è¾ƒä¸ºç®€å•çš„æ•°æ® äºŒã€å¯¹HBaseçš„åŸºæœ¬é‡Œäº†è§£1ã€æ•°æ®ç»“æž„ç»„æˆï¼ˆ 1ï¼‰Row key : å”¯ä¸€æ ‡è®°å†³å®šä¸€è¡Œæ•°æ®æŒ‰ç…§å­—å…¸æŽ’åºæœ€å¤§åªèƒ½å­˜å‚¨64KBçš„å­—èŠ‚æ•°æ®è®¾è®¡éžå¸¸å…³é”® ï¼ˆ2ï¼‰Column Familyåˆ—æ— &amp; qualifieråˆ— åˆ—æ—å¿…é¡»ä½œä¸ºè¡¨æ¨¡å¼(schema)å®šä¹‰çš„ä¸€éƒ¨åˆ†é¢„å…ˆç»™å‡ºï¼Œ è¡¨ä¸­çš„æ¯ä¸ªåˆ—éƒ½å½’å±žäºŽæŸä¸ªåˆ—æ—ï¼› æƒé™æŽ§åˆ¶ã€å­˜å‚¨ä»¥åŠè°ƒä¼˜éƒ½æ˜¯åœ¨åˆ—æ—å±‚é¢è¿›è¡Œçš„ï¼› åˆ—åä»¥åˆ—æ—ä½œä¸ºå‰ç¼€ï¼Œæ¯ä¸ªâ€œåˆ—æ—â€éƒ½å¯ä»¥æœ‰å¤šä¸ªåˆ—æˆå‘˜(column)ï¼› æ–°çš„åˆ—å¯ä»¥éšåŽæŒ‰éœ€ã€åŠ¨æ€åŠ å…¥ï¼› ï¼ˆ3ï¼‰Cellå•å…ƒæ ¼ ç”±è¡Œå’Œåˆ—çš„åæ ‡äº¤å‰å†³å®šï¼› å•å…ƒæ ¼æ˜¯æœ‰ç‰ˆæœ¬çš„ï¼ˆæœ‰æ—¶é—´æˆ³å†³å®šï¼‰ï¼› å•å…ƒæ ¼çš„å†…å®¹æ˜¯æœªè§£æžçš„å­—èŠ‚æ•°ç»„ï¼›cellä¸­çš„æ•°æ®æ˜¯æ²¡æœ‰ç±»åž‹çš„ï¼Œå…¨éƒ¨æ˜¯å­—èŠ‚ç å½¢å¼å­˜è´®ã€‚ ç”±{rowkeyï¼Œ column( = +)ï¼Œ version} å”¯ä¸€ç¡®å®šçš„å•å…ƒã€‚ ï¼ˆ4ï¼‰Timestampæ—¶é—´æˆ³ åœ¨HBaseæ¯ä¸ªcellå­˜å‚¨å•å…ƒå¯¹åŒä¸€ä»½æ•°æ®æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œ æ ¹æ®å”¯ä¸€çš„æ—¶é—´æˆ³æ¥åŒºåˆ†æ¯ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚ï¼Œ ä¸åŒç‰ˆæœ¬çš„æ•°æ®æŒ‰ç…§æ—¶é—´å€’åºæŽ’åºï¼Œæœ€æ–°çš„æ•°æ®ç‰ˆæœ¬æŽ’åœ¨æœ€å‰é¢ æ—¶é—´æˆ³çš„ç±»åž‹æ˜¯64ä½æ•´åž‹ã€‚æ—¶é—´æˆ³å¯ä»¥ç”±HBase(åœ¨æ•°æ®å†™å…¥æ—¶è‡ªåŠ¨)èµ‹å€¼ï¼Œç²¾ç¡®åˆ°æ¯«ç§’ æ—¶é—´æˆ³ã€‚ä¹Ÿå¯ä»¥ç”±å®¢æˆ·æ˜¾å¼èµ‹å€¼ï¼Œä½†å¿…é¡»å”¯ä¸€æ€§ ï¼ˆ5ï¼‰HLog(WAL log) HLogæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„Hadoop SequenceFile HLog Sequence Fileçš„Keyæ˜¯HLogKeyå¯¹è±¡ â€‹ **HLogKeyä¸­è®°å½•äº†å†™å…¥æ•°æ®çš„å½’å±žä¿¡æ¯ï¼ŒåŒ…æ‹¬tableå’Œregionåå­—ï¼Œsequence numberï¼ˆèµ·å§‹å€¼ä¸º0æˆ–æ˜¯æœ€è¿‘ä¸€æ¬¡å­˜å…¥æ–‡ä»¶ç³»ç»Ÿä¸­sequence numberï¼‰å’Œtimestampï¼ˆå†™å…¥æ—¶é—´ï¼‰ HLog SequeceFileçš„Valueæ˜¯HBaseçš„KeyValueå¯¹è±¡ï¼Œå³å¯¹åº”HFileä¸­çš„KeyValue â€‹ **å­˜å‚¨hbaseè¡¨çš„æ“ä½œè®°å½•ï¼ŒKVæ•°æ®ä¿¡æ¯ 2ã€ä½“ç³»æž¶æž„ ï¼ˆ1ï¼‰Client åŒ…å«è®¿é—®HBaseçš„æŽ¥å£å¹¶ç»´æŠ¤cacheæ¥åŠ å¿«å¯¹HBaseçš„è®¿é—® ï¼ˆ2ï¼‰Zookeeper ä¿è¯ä»»ä½•æ—¶å€™ï¼Œé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªmasterï¼› å­˜è´®æ‰€æœ‰Regionçš„å¯»å€å…¥å£ã€‚ å®žæ—¶ç›‘æŽ§Region serverçš„ä¸Šçº¿å’Œä¸‹çº¿ä¿¡æ¯ã€‚å¹¶å®žæ—¶é€šçŸ¥Master å­˜å‚¨HBaseçš„schemaå’Œtableå…ƒæ•°æ® ï¼ˆ3ï¼‰Master ä¸ºRegion serveråˆ†é…regionï¼› è´Ÿè´£Region serverçš„è´Ÿè½½å‡è¡¡ï¼› å‘çŽ°å¤±æ•ˆçš„Region serverå¹¶å°†å…¶ä¸Šçš„regioné‡æ–°åˆ†é…ï¼› ç®¡ç†ç”¨æˆ·å¯¹tableçš„å¢žåˆ æ”¹æ“ä½œï¼› ï¼ˆ4ï¼‰RegionServer ç»´æŠ¤regionï¼Œå¤„ç†å¯¹è¿™äº›regionçš„IOè¯·æ±‚ è´Ÿè´£åˆ‡åˆ†åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å˜å¾—è¿‡å¤§çš„region ï¼ˆ5ï¼‰Region ä¿å­˜ä¸€ä¸ªè¡¨é‡Œé¢æŸæ®µè¿žç»­çš„æ•°æ®ï¼Œæ¯ä¸ªè¡¨ä¸€å¼€å§‹åªæœ‰ä¸€ä¸ªregionï¼› éšç€æ•°æ®ä¸æ–­æ’å…¥è¡¨ï¼Œregionä¸æ–­å¢žå¤§ï¼Œå½“å¢žå¤§åˆ°ä¸€ä¸ªé˜€å€¼çš„æ—¶å€™ï¼Œregionå°±ä¼šç­‰åˆ†ä¼šä¸¤ä¸ªæ–°çš„regionï¼ˆè£‚å˜ï¼‰ ï¼ˆHBaseè‡ªåŠ¨æŠŠè¡¨æ°´å¹³åˆ’åˆ†æˆå¤šä¸ªåŒºåŸŸ(region)ï¼‰ å½“tableä¸­çš„è¡Œä¸æ–­å¢žå¤šï¼Œå°±ä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„regionã€‚è¿™æ ·ä¸€å¼ å®Œæ•´çš„è¡¨è¢«ä¿å­˜åœ¨å¤šä¸ªRegionserverä¸Š ï¼ˆ6ï¼‰Memstoreä¸Žstorefile ä¸€ä¸ªregionç”±2-3storeç»„æˆï¼Œä¸€ä¸ªstoreå¯¹åº”ä¸€ä¸ªCFï¼ˆåˆ—æ—ï¼‰ storeåŒ…æ‹¬ä½äºŽå†…å­˜ä¸­çš„memstoreå’Œä½äºŽç£ç›˜çš„storefileã€‚ å†™æ“ä½œå…ˆå†™å…¥memstoreï¼Œå½“memstoreä¸­çš„æ•°æ®è¾¾åˆ°æŸä¸ªé˜ˆå€¼ï¼Œhregionserverä¼šå¯åŠ¨flashcacheè¿›ç¨‹å†™å…¥storefileï¼Œæ¯æ¬¡å†™å…¥å½¢æˆå•ç‹¬çš„ä¸€ä¸ªstorefileï¼› å½“storefileæ–‡ä»¶çš„æ•°é‡å¢žé•¿åˆ°ä¸€å®šé˜ˆå€¼åŽï¼Œç³»ç»Ÿä¼šè¿›è¡Œåˆå¹¶ï¼ˆminorã€majorcompactionï¼‰ï¼Œåœ¨åˆå¹¶è¿‡ç¨‹ä¸­ä¼šè¿›è¡Œç‰ˆæœ¬åˆå¹¶å’Œåˆ é™¤å·¥ä½œï¼ˆmajarï¼‰ï¼Œå½¢æˆæ›´å¤§çš„storefile å½“ä¸€ä¸ªregionæ‰€æœ‰storefileçš„å¤§å°å’Œæ•°é‡è¶…è¿‡ä¸€å®šé˜ˆå€¼åŽï¼Œä¼šæŠŠå½“å‰çš„regionåˆ†å‰²ä¸ºä¸¤ä¸ªï¼Œå¹¶ç”±hmasteråˆ†é…åˆ°ç›¸åº”çš„regionserveræœåŠ¡å™¨ï¼Œå®žçŽ°è´Ÿè½½å‡è¡¡ å®¢æˆ·ç«¯æ£€ç´¢æ•°æ®ï¼Œå…ˆåœ¨memstoreæ‰¾ï¼Œæ‰¾ä¸åˆ°å†æ‰¾storefile HRegionæ˜¯HBaseä¸­åˆ†å¸ƒå¼å­˜å‚¨å’Œè´Ÿè½½å‡è¡¡çš„æœ€å°å•å…ƒã€‚æœ€å°å•å…ƒå°±è¡¨ç¤ºä¸åŒçš„HRegionå¯ä»¥åˆ†å¸ƒåœ¨ä¸åŒçš„HRegion serverä¸Šã€‚ æ¯ä¸ªStroreåˆç”±ä¸€ä¸ªmemStoreå’Œ0è‡³å¤šä¸ªStoreFileç»„æˆ,StoreFileä»¥HFileæ ¼å¼ä¿å­˜åœ¨HDFSä¸Š(HFile)ã€‚ ä¸‰ã€Hbase å®‰è£…éƒ¨ç½²å®Œå…¨åˆ†å¸ƒå¼æ­å»º 1ã€å®‰è£…åŒ…å‡†å¤‡ Hbaseï¼ˆæœ¬æ–‡ä½¿ç”¨0.98ç‰ˆæœ¬ï¼‰ å°†tarä¸Šä¼ è‡³Linuxç³»ç»Ÿï¼Œè¿›è¡Œè§£åŽ‹å®‰è£… 2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶hbase-env.shï¼ˆåœ¨Hbaseçš„è§£åŽ‹ç›®å½•çš„confç›®å½•ä¸­ï¼‰ ä¿®æ·»åŠ JAVA_HOMEçŽ¯å¢ƒå˜é‡ 123# The java implementation to use. Java 1.7+ required.# export JAVA_HOME=/usr/java/jdk1.6.0/export JAVA_HOME=/usr/soft/jdk1.8.0_191 ä¸ä½¿ç”¨HBaseçš„é»˜è®¤zookeeperé…ç½®ï¼Œï¼ˆä½¿ç”¨è‡ªå·±çš„ï¼‰ï¼š 12# Tell HBase whether it should manage it&apos;s own instance of Zookeeper or not. export HBASE_MANAGES_ZK=false 3ã€ä¿®æ”¹é…ç½®hbase-site.xmlï¼ˆåœ¨Hbaseçš„è§£åŽ‹ç›®å½•çš„confç›®å½•ä¸­ï¼‰ 123456789101112131415161718192021&lt;configuration&gt;&lt;property&gt;&lt;name&gt;hbase.rootdir&lt;/name&gt; &lt;!--Hdfsé…ç½®æ—¶çš„é›†ç¾¤å--&gt;&lt;value&gt;hdfs://Sunrise:8020/hbase&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hbase.cluster.distributed&lt;/name&gt;&lt;value&gt;true&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;!--zookeeperçš„ä¸‰å°èŠ‚ç‚¹--&gt;&lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;&lt;value&gt;node00,node01,node02&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;!--é…ç½®httpè®¿é—®çš„port---&gt;&lt;name&gt;hbase.master.info.port&lt;/name&gt;&lt;value&gt;60010&lt;/value&gt;&lt;/property&gt;&lt;/configuration&gt; æ³¨æ„ï¼šï¼ˆä¼šå‡ºbugçš„åœ°æ–¹ï¼‰ï¼š 1ã€é—®é¢˜æè¿°ï¼š HBaseå¯åŠ¨æ—¶ï¼Œè­¦å‘Šï¼šJava HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=128m; support was removed in 8.0 è§£å†³æ–¹æ¡ˆï¼š åŽŸå› ï¼šç”±äºŽä½¿ç”¨äº†JDK8 ï¼Œéœ€è¦åœ¨HBaseçš„é…ç½®æ–‡ä»¶ä¸­hbase-env.shï¼Œæ³¨é‡ŠæŽ‰ä¸¤è¡Œã€‚ 123# Configure PermSize. Only needed in JDK7. You can safely remove it for JDK8+#export HBASE_MASTER_OPTS=&quot;$HBASE_MASTER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m -XX:ReservedCodeCacheSize=256m&quot;#export HBASE_REGIONSERVER_OPTS=&quot;$HBASE_REGIONSERVER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m -XX:ReservedCodeCacheSize=256m&quot; é‡æ–°å¯åŠ¨HBaseã€‚ 2ã€é—®é¢˜æè¿°ï¼š é…ç½®å¥½HBaseåŽï¼Œå„é¡¹æœåŠ¡æ­£å¸¸ï¼Œä½†æƒ³ä»Žæµè§ˆå™¨é€šè¿‡ç«¯å£60010çœ‹ä¸‹èŠ‚ç‚¹æƒ…å†µï¼Œä½†æ˜¯æç¤ºæ‹’ç»è®¿é—® æ£€æµ‹ï¼šåœ¨æœåŠ¡å™¨ä¸Šnetstat -natl|grep 60010 å‘çŽ°å¹¶æ²¡æœ‰60010ç«¯å£ åŽŸå› ï¼šHBase 1.0 ä¹‹åŽçš„ç‰ˆæœ¬éƒ½éœ€è¦åœ¨hbase-site.xmlä¸­é…ç½®ç«¯å£ï¼Œå¦‚ä¸‹ 1234&lt;property&gt; &lt;name&gt;hbase.master.info.port&lt;/name&gt; &lt;value&gt;60010&lt;/value&gt;&lt;/property&gt; é‡æ–°å¯åŠ¨HBase,åœ¨æµè§ˆå™¨å†æ¬¡è®¿é—®ï¼Œå°±okäº† 4ã€æ·»åŠ é…ç½®regionservers æ–‡ä»¶ï¼ˆåœ¨Hbaseçš„è§£åŽ‹ç›®å½•çš„confç›®å½•ä¸­ï¼‰ æ·»åŠ é…ç½®çš„regionservers çš„ä¸»æœºå regionservers 123node00node01node02 5ã€æ·»åŠ é…ç½®backup-masters æ·»åŠ é…ç½®çš„masterå¤‡ä»½çš„ä¸»æœºåï¼ˆåœ¨Hbaseçš„è§£åŽ‹ç›®å½•çš„confç›®å½•ä¸­ï¼‰ backup-masters 1node02 6ã€å°†Hadoopå®‰è£…è§£åŽ‹ç›®å½•/etc/hadoopç›®å½•ä¸‹çš„hdfs-site.xmlæ–‡ä»¶ æ‹·è´åˆ°Hbaseçš„è§£åŽ‹ç›®å½•çš„confç›®å½•ä¸­ 7ã€é…ç½®çŽ¯å¢ƒå˜é‡ ~/.bash_profile 123456789101112JAVA_HOME=/usr/soft/jdk1.8.0_191export PATH=$PATH:$JAVA_HOME/binHADOOP_HOME=/usr/soft/hadoop-2.6.5export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbinZOOKEEPER_HOME=/usr/soft/zookeeper-3.4.13export PATH=$PATH:$ZOOKEEPER_HOME/binHIVE_HOME=/usr/soft/apache-hive-1.2.1-binexport PATH=$PATH:$HIVE_HOME/binSQOOP_HOME=/usr/soft/sqoop-1.4.6export PATH=$PATH:$SQOOP_HOME/binHBASE_HOME=/usr/soft/hbase-1.2.9export PATH=$PATH:$HBASE_HOME/bin source ~/.bash_profile 8ã€å°†å¦‚ä¸Šé…ç½®è¿œç¨‹å‘é€è‡³å…¶ä»–èŠ‚ç‚¹ï¼ˆHbase ã€ ./bash_profileï¼‰ 9ã€å„ä¸ªèŠ‚ç‚¹æ³¨æ„è¦åšæ—¶é—´åŒæ­¥ 1ntpdate cn.ntp.org.cn 10ã€å¯åŠ¨HDFSé›†ç¾¤ï¼š 12zkServer.sh startstart-hdfs.sh 11ã€å¯åŠ¨ï¼šstart-hbase.sh 12345starting master, logging to /usr/soft/hbase-1.2.9/bin/../logs/hbase-root-master-node00.outnode02: starting regionserver, logging to /usr/soft/hbase-1.2.9/bin/../logs/hbase-root-regionserver-node02.outnode01: starting regionserver, logging to /usr/soft/hbase-1.2.9/bin/../logs/hbase-root-regionserver-node01.outnode00: starting regionserver, logging to /usr/soft/hbase-1.2.9/bin/../logs/hbase-root-regionserver-node00.outnode02: starting master, logging to /usr/soft/hbase-1.2.9/bin/../logs/hbase-root-master-node02.out 12ã€æŸ¥çœ‹è¿›ç¨‹ï¼šjps 13ã€æµè§ˆå™¨è®¿é—®ï¼šnode00:60010 14ã€å…³é—­ï¼šstop-hbase.sh å››ã€é€šè¿‡hbase shellå‘½ä»¤è¿›å…¥HBase å‘½ä»¤è¡ŒæŽ¥å£é€šè¿‡helpå¯æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤çš„æ”¯æŒä»¥åŠå¸®åŠ©æ‰‹å†Œ å¸®åŠ©åˆ›å»º hbase(main):007:0&gt; help create åç§° Shellå‘½ä»¤ ä¸¾ä¾‹ åˆ›å»ºè¡¨ create â€˜è¡¨åâ€™, â€˜åˆ—æ—å1â€™[,â€¦] create â€˜t1â€™ï¼Œâ€˜cf1â€™ åˆ—å‡ºæ‰€æœ‰è¡¨ list list æ·»åŠ è®°å½• put â€˜è¡¨åâ€™, â€˜RowKeyâ€™, â€˜åˆ—æ—åç§°:åˆ—åâ€™, â€˜å€¼â€™ put â€˜t1â€™,â€˜rk_00101â€™,â€˜cf1:nameâ€™,â€˜zsâ€™ æŸ¥çœ‹è®°å½• get â€˜è¡¨åâ€™, â€˜RowKeyâ€™, â€˜åˆ—æ—åç§°:åˆ—åâ€™ get â€˜t1â€™,â€˜rk_00101â€™ get â€˜t1â€™,â€˜rk_00101â€™,â€˜cf1:nameâ€™ æŸ¥çœ‹è¡¨ä¸­ è®°å½•æ€»æ•° count â€˜è¡¨åâ€™ count â€˜t1â€™ åˆ é™¤è®°å½• delete â€˜è¡¨åâ€™ , â€˜RowKeyâ€™, â€˜åˆ—æ—åç§°:åˆ—åâ€™ delete â€˜t1â€™,â€˜rk_00101â€™,â€˜cf1:nameâ€™ åˆ é™¤ä¸€å¼ è¡¨ å…ˆè¦å±è”½è¯¥è¡¨ï¼Œæ‰èƒ½å¯¹è¯¥è¡¨è¿›è¡Œåˆ é™¤ã€‚ ç¬¬ä¸€æ­¥ disable â€˜è¡¨åç§°â€™ ç¬¬äºŒæ­¥ drop â€˜è¡¨åç§°â€™ disable â€˜t1â€™ drop â€˜t1â€™ æŸ¥çœ‹æ‰€æœ‰ è®°å½• scan â€˜è¡¨å â€˜ scan â€˜t1â€™ create â€˜t2â€™, {NAME =&gt; â€˜cf1â€™, VERSIONS =&gt; 2}, METADATA =&gt; { â€˜mykeyâ€™ =&gt; â€˜myvalueâ€™ } æŸ¥çœ‹æœªåŠ å·¥çš„æ•°æ®ä¸­æŒ‡å®šç‰ˆæœ¬è®°å½• scan â€˜t1â€™, {RAW =&gt; true, VERSIONS =&gt; 3} raw æœªåŠ å·¥çš„ 3 æŸ¥çœ‹ä¿å­˜ ç‰ˆæœ¬è®°å½• scan â€˜t1â€™, {VERSIONS =&gt; 2} 2 äº”ã€HBaseä¼˜åŒ–è¯¦è§HBaseæ€§èƒ½ä¼˜åŒ–æ–‡æ¡£]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>HBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hiveä¼˜åŒ–]]></title>
    <url>%2F2019%2F01%2F14%2FHive%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[ä¸€ã€æ ¸å¿ƒæ€æƒ³ï¼š æŠŠHive SQL å½“åšMapReduceç¨‹åºè¿›è¡Œä¼˜åŒ– æ³¨æ„ï¼šä»¥ä¸‹ä¸èƒ½HQLè½¬åŒ–ä¸ºMapreduceä»»åŠ¡è¿è¡Œ â€”select ä»…æŸ¥è¯¢æœ¬è¡¨å­—æ®µ â€”where ä»…å¯¹æœ¬è¡¨å­—æ®µåšæ¡ä»¶è¿‡æ»¤ äºŒã€explain ç”¨ä»¥æ˜¾ç¤ºä»»åŠ¡æ‰§è¡Œè®¡åˆ’ æ ¼å¼ï¼š EXPLAIN [EXTENDED|DEPENDENCY|AUTHORIZATION] query è¯­æ³•è§£é‡Š ä»Žè¯­æ³•ç»„æˆå¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸€ä¸ªâ€œexplain â€+ä¸‰ä¸ªå¯é€‰å‚æ•°+æŸ¥è¯¢è¯­å¥ã€‚å¤§å®¶å¯ä»¥ç§¯æžå°è¯•ä¸€ä¸‹ï¼ŒåŽé¢ä¸¤ä¸ªæ˜¾ç¤ºå†…å®¹å¾ˆç®€å•çš„ï¼Œæˆ‘ä»‹ç»ä¸€ä¸‹ç¬¬ä¸€ä¸ª extended è¿™ä¸ªå¯ä»¥æ˜¾ç¤ºhqlè¯­å¥çš„è¯­æ³•æ ‘ å…¶æ¬¡ï¼Œæ‰§è¡Œè®¡åˆ’ä¸€å…±æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼š è¿™ä¸ªè¯­å¥çš„æŠ½è±¡è¯­æ³•æ ‘ è¿™ä¸ªè®¡åˆ’ä¸åŒé˜¶æ®µä¹‹é—´çš„ä¾èµ–å…³ç³» å¯¹äºŽæ¯ä¸ªé˜¶æ®µçš„è¯¦ç»†æè¿° ä¾‹å­ï¼š 12&gt; hive&gt; explain select * from log;&gt; æ‹“å±•è¯¾ä¸‹æŸ¥è¯¢MySQlçš„æ‰§è¡Œè®¡åˆ’ã€‚ ä¸‰ã€Hiveè¿è¡Œæ–¹å¼é›†ç¾¤æ¨¡å¼ï¼š12æ‰§è¡Œhqlï¼šhive&gt; select count(*) from log; ç»“è®ºï¼š å‡½æ•°ï¼ˆå¦‚countï¼‰æ˜¯åœ¨reduceé˜¶æ®µè¿›è¡Œé»˜è®¤æäº¤åˆ°yarnæ‰€åœ¨çš„èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œ ä¼˜åŒ–ä¸€:è®¾ç½® æœ¬åœ°æ¨¡å¼ï¼ˆè¿è¡Œé€Ÿåº¦åŠ å¿«ã€‚ä½†å¯¹åŠ è½½æ–‡ä»¶æœ‰é™åˆ¶ï¼‰ 1234hive&gt;set hive.exec.mode.local.auto=true;æŸ¥çœ‹ï¼šhive&gt;set hive.exec.mode.local.auto ä½†æ˜¯å¦‚æžœåŠ è½½æ–‡ä»¶çš„æœ€å¤§å€¼å¤§äºŽé…ç½®ï¼ˆé»˜è®¤é…ç½®ä¸º100Mï¼‰ï¼Œä»ä¼šä½¿ç”¨é›†ç¾¤æ¨¡å¼è¿è¡Œï¼ˆåœ¨yarnæ‰€åœ¨çš„èŠ‚ç‚¹ï¼‰ 12345æŸ¥çœ‹æœ€å¤§åŠ è½½æ–‡ä»¶hive&gt; set hive.exec.mode.local.auto.inputbytes.max;æ˜¾ç¤ºï¼šhive.exec.mode.local.auto.inputbytes.max=134217728 ä¼˜åŒ–äºŒï¼šè®¾ç½® ä¸¥æ ¼æ¨¡å¼ 123é€šè¿‡è®¾ç½®ä»¥ä¸‹å‚æ•°å¼€å¯ä¸¥æ ¼æ¨¡å¼[é˜²æ­¢è¯¯æ“ä½œ]ï¼šhive&gt; set hive.mapred.mode=strict;ï¼ˆé»˜è®¤ä¸ºï¼šnonstrictéžä¸¥æ ¼æ¨¡å¼ï¼‰ ä½†æ˜¯å­˜åœ¨æŸ¥è¯¢é™åˆ¶ 1ã€å¯¹åˆ†åŒºè¡¨æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»æ·»åŠ whereå¯¹äºŽåˆ†åŒºå­—æ®µçš„æ¡ä»¶è¿‡æ»¤ï¼› 12&gt; hive&gt; select * from day_table where dt='2019-01-13';&gt; 2ã€order byè¯­å¥å¿…é¡»åŒ…å«limitè¾“å‡ºé™åˆ¶ï¼› 12345&gt; hive&gt; select * from log order by id limit 1;&gt; è¿™é‡Œçš„1ï¼Œ è¡¨ç¤ºæ˜¾ç¤ºå‰å¤šå°‘æ¡è®°å½•ï¼Œåªèƒ½è®¾ä¸€ä¸ªæ•°å­—&gt; å’ŒMysqlï¼ˆå¯ä»¥ä»Ž0 å¼€å§‹ï¼‰ä¸åŒçš„æ˜¯ï¼Œå®ƒåªèƒ½ä»Ž1å¼€å§‹&gt; mysqlå¯ä»¥æœ‰ä¸¤ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºä»Žç¬¬å‡ æ¡å¼€å§‹ï¼Œæ˜¾ç¤ºå‡ æ¡&gt; 3ã€é™åˆ¶æ‰§è¡Œç¬›å¡å°”ç§¯çš„æŸ¥è¯¢ imit å››ã€HiveæŽ’åº1ã€Order Byâ€” å¯¹äºŽæŸ¥è¯¢ç»“æžœåšå…¨å±€æŽ’åºï¼Œåªå…è®¸æœ‰ä¸€ä¸ªreduceå¤„ç†ï¼ˆå½“æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œreduceæ•°é‡æœ‰é™ï¼Œåº”æ…Žç”¨ã€‚ â€‹ ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¿…é¡»ç»“åˆlimitæ¥ä½¿ç”¨ï¼‰ 1select * from log order by idï¼› 2ã€Sort Byâ€“ å¯¹äºŽå•ä¸ªreduceçš„æ•°æ®è¿›è¡ŒæŽ’åº â€“å±€éƒ¨ï¼ˆå•ä¸ªreduceï¼‰æœ‰åºï¼Œå…¨å±€æ— åº 1å¯ä»¥é€šè¿‡è®¾ç½®mapred.reduce.tasksçš„å€¼æ¥æŽ§åˆ¶reduceçš„æ•°ï¼Œç„¶åŽå¯¹reduceè¾“å‡ºçš„ç»“æžœåšäºŒæ¬¡æŽ’åº æ¡ˆä¾‹ 1select * from log sort by id; (ç»“æžœæ— åº) æ˜¾ç¤º Time taken: 147.077 seconds, Fetched: 7 row(s) 3ã€Distribute Byâ€“ åˆ†åŒºæŽ’åºï¼Œç»å¸¸å’Œ Sort By ç»“åˆä½¿ç”¨ å…¨å±€æœ‰åºï¼Œå±€éƒ¨æ— åº 1select * from log distribute by id; ï¼ˆç»“æžœæ— åºï¼‰ Time taken: 144.708 seconds, Fetched: 7 row(s) æ³¨æ„ï¼šhiveè¦æ±‚DISTRIBUTE BYè¯­å¥å‡ºçŽ°åœ¨SORT BYè¯­å¥ä¹‹å‰ 1Distribute Byå¯ä»¥å°†Mapé˜¶æ®µè¾“å‡ºçš„æ•°æ®æŒ‰æŒ‡å®šçš„å­—æ®µåˆ’åˆ†åˆ°ä¸åŒçš„reduceæ–‡ä»¶ä¸­ï¼Œç„¶åŽï¼Œsort by å¯¹reduceé˜¶æ®µçš„è¾“å‡ºæ•°æ®åšæŽ’åºã€‚ æ¡ˆä¾‹: 1select * from log distribute by id sort by id asc; ï¼ˆç»“æžœæ— åºï¼‰ 1select * from (select * from log distribute by id) a sort by a.id ;s æ”¹è‰¯ 123select a.* from (select * from log cluster by id ) a order by a.id limit 9 ; (ç»“æžœæœ‰åº)9 åœ¨è¿™é‡Œæ˜¯è¡¨ä¸­æ•°æ®è®°å½•çš„æ€»æ¡æ•° æ˜¾ç¤ºï¼š Time taken: 234.593 seconds, Fetched: 7 row(s) 1select * from log order by id limit 9; ï¼ˆç»“æžœæœ‰åºï¼‰ æ˜¾ç¤ºï¼š Time taken: 102.065 seconds, Fetched: 7 row(s) 4ã€Cluster Byâ€“ ç›¸å½“äºŽ Sort By + Distribute Byï¼ˆCluster Byä¸èƒ½é€šè¿‡ascã€descçš„æ–¹å¼æŒ‡å®šæŽ’åºè§„åˆ™ï¼›å¯é€šè¿‡ distribute by column sort by column asc|desc çš„æ–¹å¼ï¼‰ 1select * from log cluster by idï¼› ï¼ˆç»“æžœæ— åºï¼‰ äº”ã€Hive Join ï¼ˆé‡éš¾ç‚¹ï¼‰1ã€Join è¿žæŽ¥æ—¶ï¼Œå°†å°è¡¨ï¼ˆé©±åŠ¨è¡¨ï¼‰æ”¾åœ¨joinçš„å·¦è¾¹2ã€Map Join ï¼š å› ä¸ºMap Join æ˜¯åœ¨Mapç«¯ä¸”åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å¯åŠ¨Reduceä»»åŠ¡ï¼Œä¹Ÿæ²¡æœ‰shuffleé˜¶æ®µï¼Œä»Žè€Œåœ¨ä¸€å®šç¨‹åº¦ä¸ŠèŠ‚çœèµ„æºï¼Œæé«˜Joinæ•ˆçŽ‡ã€‚ æ–¹å¼ï¼šï¼ˆä¸¤ç§ï¼‰1ã€SQLæ–¹å¼ï¼šâ€‹ åœ¨HQlè¯­å¥ä¸­æ·»åŠ MapJoinæ ‡è®°ï¼ˆmapjoinï¼‰(å°†å°è¡¨åŠ å…¥åˆ°å†…å­˜ï¼Œæ³¨æ„å°è¡¨çš„å¤§å°) â€‹ è¯­æ³•ï¼š 12SELECT /*+ MAPJOIN(smallTable) */ smallTable.key, bigTable.value FROM smallTable JOIN bigTable ON smallTable.key = bigTable.key; æ¡ˆä¾‹ï¼š 12SELECT /*+ MAPJOIN(log1) */ log.id,log1.name FROM log JOIN log1 ON log.id = log1.id; 2ã€è‡ªåŠ¨çš„MapJoinâ€‹ é€šè¿‡ä¿®æ”¹ä»¥ä¸‹é…ç½®å¯ç”¨è‡ªåŠ¨çš„mapjoinï¼š 1hive&gt; set hive.auto.convert.join = true; â€‹ ï¼ˆ è¯¥å‚æ•°ä¸ºtrueæ—¶ï¼ŒHiveè‡ªåŠ¨å¯¹å·¦è¾¹çš„è¡¨ç»Ÿè®¡æ•°æ®é‡ï¼Œå¦‚æžœæ˜¯å°è¡¨å°±åŠ å…¥å†…å­˜ï¼Œå³å¯¹å°è¡¨ä½¿ç”¨Map joinï¼‰å…¶ä»–ç›¸å…³é…ç½®å‚æ•°ï¼š 1hive&gt; set hive.mapjoin.smalltable.filesize; ï¼ˆé»˜è®¤ï¼šå¤§è¡¨å°è¡¨åˆ¤æ–­çš„é˜ˆå€¼25MBå·¦å³ï¼Œå¦‚æžœè¡¨çš„å¤§å°å°äºŽè¯¥å€¼åˆ™ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­è¿è¡Œï¼Œå¯è‡ªå®šä¹‰ï¼‰ 1hive&gt; set hive.ignore.mapjoin.hint; ï¼ˆé»˜è®¤å€¼ï¼štrueï¼›æ˜¯å¦å¿½ç•¥mapjoin hint å³mapjoinæ ‡è®°ï¼›å¦‚æžœä¸ºfalseï¼Œè¿™åˆ™éœ€è¦æ·»åŠ -MapJoinæ ‡è®°ï¼Œmapjoinï¼ˆsmalltableï¼‰ï¼‰ 1hive&gt; set hive.auto.convert.join.noconditionaltask; ï¼ˆé»˜è®¤å€¼ï¼štrueï¼›å°†æ™®é€šçš„joinè½¬åŒ–ä¸ºæ™®é€šçš„mapjoinæ—¶ï¼Œæ˜¯å¦å°†å¤šä¸ªmapjoinè½¬åŒ–ä¸ºä¸€ä¸ªmapjoinï¼‰ 1hive&gt; set hive.auto.convert.join.noconditionaltask.size; ï¼ˆé»˜è®¤ï¼š10Mï¼›å°†å¤šä¸ªmapjoinè½¬åŒ–ä¸ºä¸€ä¸ªmapjoinæ—¶ï¼Œå…¶è¡¨çš„æœ€å¤§å€¼ä¸º10Mï¼Œå¯è‡ªå®šä¹‰ï¼‰ å…­ã€Map-Sideèšåˆ ç›¸å½“äºŽèšåˆå‡½æ•°ï¼šcountï¼ˆï¼‰ è®¾ç½®å‚æ•°ï¼Œå¼€å¯åœ¨Mapç«¯çš„èšåˆ 1set hive.map.aggr=true; ç›¸å…³é…ç½®å‚æ•°ï¼š 1set hive.groupby.mapaggr.checkintervalï¼› ï¼ˆé»˜è®¤ä¸ºï¼š100000ï¼Œè¡¨ç¤º mapç«¯group byæ‰§è¡Œèšåˆæ—¶å¤„ç†çš„å¤šå°‘è¡Œæ•°æ®ï¼‰ 1set hive.map.aggr.hash.min.reductionï¼› ï¼ˆé»˜è®¤ä¸ºï¼š0.5ï¼Œè¿›è¡Œèšåˆçš„æœ€å°æ¯”ä¾‹ï¼Œé¢„å…ˆå–100000æ¡æ•°æ®èšåˆ,å¦‚æžœèšåˆåŽçš„æ¡æ•°/100000&gt;0.5ï¼Œåˆ™ä¸å†èšåˆï¼‰ 1set hive.map.aggr.hash.percentmemory; ï¼ˆé»˜è®¤ï¼š 0.5 ï¼Œmapç«¯èšåˆä½¿ç”¨çš„å†…å­˜çš„æœ€å¤§å€¼ï¼‰ 1set hive.map.aggr.hash.force.flush.memory.threshold; ï¼ˆé»˜è®¤ä¸ºï¼š0.9ï¼Œmapç«¯åšèšåˆæ“ä½œæ˜¯hashè¡¨çš„æœ€å¤§å¯ç”¨å†…å®¹ï¼Œå¤§äºŽè¯¥å€¼åˆ™ä¼šè§¦å‘flush 1set hive.groupby.skewindataï¼› ï¼ˆé»˜è®¤ä¸ºï¼šfalseï¼Œæ˜¯å¦å¯¹GroupByäº§ç”Ÿçš„æ•°æ®å€¾æ–œåšä¼˜åŒ–ï¼‰ é™„åŠ ï¼š æ•°æ®å€¾æ–œé—®é¢˜è§£å†³ï¼šå¤šç§æ–¹å¼ï¼ˆä½¿ç”¨MapJoinã€ä½¿ç”¨MapSideï¼‰ å‚è€ƒ http://www.sohu.com/a/224276626_543508 ä¸ƒã€æŽ§åˆ¶Hiveä¸­Mapå’ŒReduceçš„æ•°é‡1ã€Mapæ•°é‡ç›¸å…³çš„å‚æ•°1set mapred.max.split.size; ï¼ˆé»˜è®¤ä¸ºï¼š256Mï¼Œä¸€ä¸ªsplitçš„æœ€å¤§å€¼ï¼Œå³æ¯ä¸ªmapå¤„ç†æ–‡ä»¶çš„æœ€å¤§å€¼ï¼‰ 1set mapred.min.split.size.per.node; (ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæœ€å°splitæ•°ï¼š1ä¸ª) 1set mapred.min.split.size.per.rack; (ä¸€ä¸ªæœºæž¶ä¸Šæœ€å°splitæ•°ï¼š1ä¸ª) 2ã€Reduceæ•°é‡ç›¸å…³çš„å‚æ•°1set mapred.reduce.tasks; (é»˜è®¤ä¸ºï¼š-1ï¼Œå¼ºåˆ¶æŒ‡å®šreduceä»»åŠ¡çš„æ•°é‡ã€‚-1ï¼Œæ˜¯æœªå®šä¹‰ï¼Œä¸å‘æŒ¥ä½œç”¨ã€‚å¦‚æžœæŒ‡å®šäº†ï¼Œå°±ä¼šæŒ‰æŒ‡å®šçš„æ•°é‡æ‰§è¡Œ) 1set hive.exec.reducers.bytes.per.reducer; ï¼ˆé»˜è®¤ä¸ºï¼š256M ï¼Œæ¯ä¸ªreduceä»»åŠ¡å¤„ç†çš„æ•°æ®é‡ï¼‰ 1set hive.exec.reducers.max; ï¼ˆé»˜è®¤ä¸ºï¼š1009ä¸ªï¼Œæ¯ä¸ªä»»åŠ¡æœ€å¤§çš„reduceæ•° [Mapæ•°é‡ &gt;= Reduceæ•°é‡ ]ï¼‰ å…«ã€Hive - JVMé‡ç”¨é€‚ç”¨åœºæ™¯ï¼š1ã€å°æ–‡ä»¶ä¸ªæ•°è¿‡å¤š2ã€taskä¸ªæ•°è¿‡å¤š åŽŸç†ï¼š hadoopé»˜è®¤é…ç½®æ˜¯ä½¿ç”¨æ´¾ç”ŸJVMæ¥æ‰§è¡Œmapå’Œreduceä»»åŠ¡çš„ï¼ŒJVMé‡ç”¨å¯ä»¥ä½¿å¾—JVMå®žä¾‹åœ¨åŒä¸€ä¸ªJOBä¸­é‡æ–°ä½¿ç”¨Næ¬¡ 1set mapred.job.reuse.jvm.num.tasks; (é»˜è®¤æ˜¯1ï¼Œè¡¨ç¤ºä¸€ä¸ªJVMä¸Šæœ€å¤šå¯ä»¥é¡ºåºæ‰§è¡Œçš„taskæ•°ç›®ï¼ˆå±žäºŽåŒä¸€ä¸ªJobï¼‰æ˜¯1ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªtaskå¯ä¸€ä¸ªJVM) ç¼ºç‚¹ï¼š è®¾ç½®å¼€å¯ä¹‹åŽï¼Œtaskæ’æ§½ä¼šä¸€ç›´å ç”¨èµ„æºï¼Œä¸è®ºæ˜¯å¦æœ‰taskè¿è¡Œï¼Œç›´åˆ°æ‰€æœ‰çš„taskå³æ•´ä¸ªjobå…¨éƒ¨æ‰§è¡Œå®Œæˆæ—¶ï¼Œæ‰ä¼šé‡Šæ”¾æ‰€æœ‰çš„taskæ’æ§½èµ„æºï¼]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginxå…¥é—¨å­¦ä¹ ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2019%2F01%2F12%2FNginx%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E7%AC%AC%E4%B8%80%E5%9B%9E%E5%90%88%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Nginx[^å¼€å‘è€…]: ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘ [TOC] ä¸€ã€äº§ç”ŸèƒŒæ™¯1.å·¨å¤§æµé‡â€”æµ·é‡çš„å¹¶å‘è®¿é—® 2.å•å°æœåŠ¡å™¨èµ„æºå’Œèƒ½åŠ›æœ‰é™ å¼•å‘æœåŠ¡å™¨å®•æœºè€Œæ— æ³•æä¾›æœåŠ¡ äºŒã€è´Ÿè½½å‡è¡¡(Load Balance)1ã€é«˜å¹¶å‘ï¼ˆ1ï¼‰ã€é«˜ï¼ˆå¤§é‡çš„ï¼‰ ï¼ˆ2ï¼‰ã€å¹¶å‘å°±æ˜¯å¯ä»¥ä½¿ç”¨å¤šä¸ªçº¿ç¨‹æˆ–è€…å¤šä¸ªè¿›ç¨‹ï¼ŒåŒæ—¶å¤„ç†ï¼ˆå°±æ˜¯å¹¶å‘ï¼‰ä¸åŒçš„æ“ä½œ ï¼ˆ3ï¼‰ã€ç®€è€Œè¨€ä¹‹å°±æ˜¯æ¯ç§’å†…æœ‰å¤šå°‘ä¸ªè¯·æ±‚åŒæ—¶è®¿é—®ã€‚ 2ã€è´Ÿè½½å‡è¡¡ï¼ˆ1ï¼‰ã€å°†è¯·æ±‚/æ•°æ®ã€å‡åŒ€ã€‘åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šæ‰§è¡Œ ï¼ˆ2ï¼‰ã€å…³é”®åœ¨äºŽã€å‡åŒ€ã€‘,ä¹Ÿæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿæž¶æž„è®¾è®¡ä¸­å¿…é¡»è€ƒè™‘çš„å› ç´ ä¹‹ä¸€ã€‚ 3ã€äº’è”ç½‘åˆ†å¸ƒå¼æž¶æž„å¸¸è§ï¼Œåˆ†ä¸ºå®¢æˆ·ç«¯å±‚ã€åå‘ä»£ç†nginxå±‚ã€ç«™ç‚¹å±‚ã€æœåŠ¡å±‚ã€æ•°æ®å±‚ã€‚åªéœ€è¦å®žçŽ°â€œå°†è¯·æ±‚/æ•°æ® å‡åŒ€åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šæ‰§è¡Œâ€ï¼Œå°±èƒ½å®žçŽ°è´Ÿè½½å‡è¡¡ã€‚ ä¸‰ã€å¯¹Nginxçš„åŸºæœ¬äº†è§£1ã€ä»€ä¹ˆæ˜¯Nginxï¼Ÿ1ä¸€æ¬¾è½»é‡çº§çš„Web æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨ã€åŽé¢æœ‰ä»‹ç»ã€‘åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ã€‚ â€‹ ç‰¹ç‚¹ 12*æ˜¯å æœ‰å†…å­˜å°‘ï¼ŒCPUã€å†…å­˜ç­‰èµ„æºæ¶ˆè€—å´éžå¸¸ä½Žï¼Œ*è¿è¡Œéžå¸¸ç¨³å®šå¹¶å‘èƒ½åŠ›å¼ºï¼Œnginxçš„å¹¶å‘èƒ½åŠ›ç¡®å®žåœ¨åŒç±»åž‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨çŽ°éžå¸¸å¥½ã€‚ 2ã€Nginx VS Apacheï¼ˆ1ï¼‰ã€nginxç›¸å¯¹äºŽapacheçš„ä¼˜ç‚¹ï¼š1234*è½»é‡çº§ï¼ŒåŒæ ·èµ·web æœåŠ¡ï¼Œæ¯”apache å ç”¨æ›´å°‘çš„å†…å­˜åŠèµ„æºé«˜å¹¶å‘ï¼Œ*nginx å¤„ç†è¯·æ±‚æ˜¯å¼‚æ­¥éžé˜»å¡žï¼ˆå¦‚å‰ç«¯ajaxï¼‰çš„ï¼Œè€Œapache åˆ™æ˜¯é˜»å¡žåž‹çš„ï¼Œ*åœ¨é«˜å¹¶å‘ä¸‹nginxèƒ½ä¿æŒä½Žèµ„æºä½Žæ¶ˆè€—é«˜æ€§èƒ½é«˜åº¦æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œç¼–å†™æ¨¡å—ç›¸å¯¹ç®€å•*Nginx é…ç½®ç®€æ´, Apache å¤æ‚ ï¼ˆ2ï¼‰ã€apache ç›¸å¯¹äºŽnginx çš„ä¼˜ç‚¹ï¼š12* Rewriteé‡å†™ ï¼Œæ¯”nginx çš„rewrite å¼ºå¤§æ¨¡å—è¶…å¤šï¼Œ*åŸºæœ¬æƒ³åˆ°çš„éƒ½å¯ä»¥æ‰¾åˆ°å°‘bug ï¼Œnginx çš„bug ç›¸å¯¹è¾ƒå¤šã€‚ï¼ˆå‡ºèº«å¥½èµ·æ­¥é«˜ï¼‰ å››ã€å®‰è£…Nginxè¿™é‡Œä»¥å®‰è£…tengineä¸ºä¾‹ 1ã€å®‰è£…ä¹‹å‰å‡†å¤‡é…ç½®ä¾èµ– gcc openssl-devel pcre-devel zlib-devel å®‰è£…ï¼š yum install gcc openssl-devel pcre-devel zlib-devel -y 2ã€ä¸‹è½½ï¼ˆç›®å‰æœ€æ–°ç‰ˆï¼‰ï¼štengine-2.2.3.tar 3ã€ è§£åŽ‹ç¼© tar -zvxf tengine-2.2.3.tar 4ã€å®‰è£…Nginx åœ¨Nginxè§£åŽ‹çš„ç›®å½•ä¸‹è¿è¡Œï¼š ./configure make &amp;&amp; make install é»˜è®¤å®‰è£…ç›®å½•ï¼š/usr/local/nginx 5ã€é…ç½®Nginxä¸ºç³»ç»ŸæœåŠ¡ï¼Œä»¥æ–¹ä¾¿ç®¡ç†ï¼ˆ1ï¼‰ã€åœ¨/etc/rc.d/init.d/ç›®å½•ä¸­å»ºç«‹æ–‡æœ¬æ–‡ä»¶nginxï¼ˆ2ï¼‰ã€åœ¨æ–‡ä»¶ä¸­ç²˜è´´ä¸‹é¢çš„å†…å®¹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126#!/bin/sh## nginx - this script starts and stops the nginx daemon## chkconfig: - 85 15 # description: Nginx is an HTTP(S) server, HTTP(S) reverse \# proxy and IMAP/POP3 proxy server# processname: nginx# config: /etc/nginx/nginx.conf# config: /etc/sysconfig/nginx# pidfile: /var/run/nginx.pid # Source function library.. /etc/rc.d/init.d/functions # Source networking configuration.. /etc/sysconfig/network # Check that networking is up.[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0 nginx=&quot;/usr/local/nginx/sbin/nginx&quot;prog=$(basename $nginx) NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot; [ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx lockfile=/var/lock/subsys/nginx make_dirs() &#123; # make required directories user=`nginx -V 2&gt;&amp;1 | grep &quot;configure arguments:&quot; | sed &apos;s/[^*]*--user=\([^ ]*\).*/\1/g&apos; -` options=`$nginx -V 2&gt;&amp;1 | grep &apos;configure arguments:&apos;` for opt in $options; do if [ `echo $opt | grep &apos;.*-temp-path&apos;` ]; then value=`echo $opt | cut -d &quot;=&quot; -f 2` if [ ! -d &quot;$value&quot; ]; then # echo &quot;creating&quot; $value mkdir -p $value &amp;&amp; chown -R $user $value fi fi done&#125; start() &#123; [ -x $nginx ] || exit 5 [ -f $NGINX_CONF_FILE ] || exit 6 make_dirs echo -n $&quot;Starting $prog: &quot; daemon $nginx -c $NGINX_CONF_FILE retval=$? echo [ $retval -eq 0 ] &amp;&amp; touch $lockfile return $retval&#125; stop() &#123; echo -n $&quot;Stopping $prog: &quot; killproc $prog -QUIT retval=$? echo [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile return $retval&#125; restart() &#123; configtest || return $? stop sleep 1 start&#125; reload() &#123; configtest || return $? echo -n $&quot;Reloading $prog: &quot; killproc $nginx -HUP RETVAL=$? echo&#125; force_reload() &#123; restart&#125; configtest() &#123; $nginx -t -c $NGINX_CONF_FILE&#125; rh_status() &#123; status $prog&#125; rh_status_q() &#123; rh_status &gt;/dev/null 2&gt;&amp;1&#125; case &quot;$1&quot; in start) rh_status_q &amp;&amp; exit 0 $1 ;; stop) rh_status_q || exit 0 $1 ;; restart|configtest) $1 ;; reload) rh_status_q || exit 7 $1 ;; force-reload) force_reload ;; status) rh_status ;; condrestart|try-restart) rh_status_q || exit 0 ;; *) echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot; exit 2esac ï¼ˆ3ï¼‰ã€ä¿®æ”¹nginxæ–‡ä»¶çš„æ‰§è¡Œæƒé™ chmod +x nginx ï¼ˆ4ï¼‰ã€æ·»åŠ è¯¥æ–‡ä»¶åˆ°ç³»ç»ŸæœåŠ¡ä¸­åŽ» chkconfig â€“add nginx æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ chkconfig â€“list nginx å¯åŠ¨ï¼Œåœæ­¢ï¼Œé‡æ–°è£…è½½ service nginx start|stop äº”ã€Nginxé…ç½®1ã€æŸ¥çœ‹é…ç½® cd /usr/local/nginx/conf vim nginx.conf 2ã€é…ç½®è§£æž12345678910111213141516171819202122232425262728293031323334#è¿›ç¨‹æ•°ï¼Œå»ºè®®è®¾ç½®å’ŒCPUä¸ªæ•°ä¸€æ ·æˆ–2å€worker_processes 2;#æ—¥å¿—çº§åˆ«error_log logs/error.log warning;(é»˜è®¤errorçº§åˆ«)# nginx å¯åŠ¨åŽçš„pid å­˜æ”¾ä½ç½®#pid logs/nginx.pid;events &#123; #é…ç½®æ¯ä¸ªè¿›ç¨‹çš„è¿žæŽ¥æ•°ï¼Œæ€»çš„è¿žæŽ¥æ•°= worker_processes * worker_connections #é»˜è®¤1024 worker_connections 10240;&#125;http &#123; include mime.types; default_type application/octet-stream; sendfile on;#è¿žæŽ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’keepalive_timeout 65; server &#123; listen 80; server_name localhost #é»˜è®¤è¯·æ±‚ location / &#123; root html; #å®šä¹‰æœåŠ¡å™¨çš„é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ä½ç½® index index.php index.html index.htm; #å®šä¹‰é¦–é¡µç´¢å¼•æ–‡ä»¶çš„åç§° &#125; #å®šä¹‰é”™è¯¯æç¤ºé¡µé¢ error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; 3ã€è´Ÿè½½å‡è¡¡é…ç½®1ï¼‰å®‰è£…Tomcatï¼Œå‚è€ƒ Tomcaté…ç½® 2ï¼‰å¤šè´Ÿè½½å‡æ‰§è¡Œä¸€ä¸‹æ“ä½œï¼š å¤šè´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€æŒ‡å®šè™šæ‹Ÿæœºå™¨ open node01 node01 ä¸ºæŒ‡å®šè™šæ‹Ÿæœºå™¨çš„åˆ«åï¼Œåœ¨hostsæ–‡ä»¶ä¸­é…ç½®çš„ å¯åŠ¨Tomcat åœ¨Tomcatè§£åŽ‹çš„ç›®å½•ä¸‹ ./startup.sh æ³¨æ„ï¼š è®°å¾—å…³é—­è™šæ‹Ÿæœºå™¨çš„é˜²ç«å¢™ service iptables stop æµè§ˆå™¨è®¿é—® è™šæ‹Ÿæœºå™¨IPåœ°å€ï¼š8080 é»˜è®¤è´Ÿè½½å‡è¡¡é…ç½® 123456789101112131415161718192021&gt; http &#123; &gt; upstream shsxt&#123; &gt; # ä»¥ä¸‹å‡ä¸ºå®žé™…æ‰§è¡ŒæœåŠ¡çš„æœåŠ¡å™¨&gt; #åªæœ‰å½“hostsæ–‡ä»¶ä¸­ç»™ipåœ°å€é…ç½®äº†åˆ«åï¼Œè¿™é‡ŒserveråŽé¢æ‰èƒ½ç”¨åˆ«åï¼Œ&gt; #å¦åˆ™è·ŸIPåœ°å€&gt; server node01; &gt; server node02; &gt; server node03; &gt; &#125; &gt; &gt; server &#123; &gt; #æŒ‡å®šè®¿é—®ç«¯å£ä¸º80 ï¼Œé‚£ä¹ˆTomcatæœåŠ¡å™¨ç«¯çš„portä¹Ÿè¦æ”¹ä¸º80&gt; listen 80; &gt; server_name localhost;&gt; location / &#123;&gt; proxy_pass http://shsxt; &gt; # shsxt æ˜¯æŒ‡å®šçš„ä»£ç†æœåŠ¡å™¨&gt; &#125;&gt; &#125; &gt; &#125;&gt; æŸ¥çœ‹ä½¿ç”¨ 80ç«¯å£çš„ç¨‹åº netstat -anp |grep 80 é…ç½®æ–‡ä»¶ç¼–è¾‘ç»“æŸåŽï¼Œå¯åŠ¨nginxæœåŠ¡ service nginx start ï¼ˆ1ï¼‰ã€è½®è¯¢è´Ÿè½½å‡è¡¡ï¼ˆé»˜è®¤ï¼‰1- å¯¹åº”ç”¨ç¨‹åºæœåŠ¡å™¨çš„è¯·æ±‚ä»¥å¾ªçŽ¯æ–¹å¼åˆ†å‘ ï¼ˆ2ï¼‰ã€åŠ æƒè´Ÿè½½å‡è¡¡ é€šè¿‡ä½¿ç”¨æœåŠ¡å™¨æƒé‡ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥å½±å“nginxè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œ è°çš„æƒé‡è¶Šå¤§ï¼Œåˆ†å‘åˆ°çš„è¯·æ±‚å°±è¶Šå¤šã€‚ æƒé‡æ€»æ•°ï¼š10 åœ¨nginx.confæ–‡ä»¶ä¸­ä¿®æ”¹ï¼š 12345upstream shsxt &#123; server srv1.example.com weight=3;//åŸŸåä¸ºåœ¨/etc/hostsæ–‡ä»¶ä¸­å–çš„åˆ«å server srv2.example.com; server srv3.example.com; &#125; é…ç½®ä¿®æ”¹ä¹‹åŽï¼Œé‡å¯ service nginx restart ï¼ˆ3ï¼‰ã€æœ€å°‘è¿žæŽ¥è´Ÿè½½å¹³è¡¡ åœ¨è¿žæŽ¥è´Ÿè½½æœ€å°‘çš„æƒ…å†µä¸‹ï¼Œnginxä¼šå°½é‡é¿å…å°†è¿‡å¤šçš„è¯·æ±‚åˆ†å‘ç»™ç¹å¿™çš„åº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼Œ è€Œæ˜¯å°†æ–°è¯·æ±‚åˆ†å‘ç»™ä¸å¤ªç¹å¿™çš„æœåŠ¡å™¨ï¼Œé¿å…æœåŠ¡å™¨è¿‡è½½ã€‚ åœ¨nginx.confæ–‡ä»¶ä¸­ä¿®æ”¹ï¼š 123456upstream shsxt &#123; least_conn; server srv1.example.com; server srv2.example.com; server srv3.example.com; &#125; ï¼ˆ4ï¼‰ã€ä¼šè¯æŒä¹…æ€§â€”â€”ip-hashè´Ÿè½½å¹³è¡¡æœºåˆ¶ç‰¹ç‚¹ï¼šä¿è¯ç›¸åŒçš„å®¢æˆ·ç«¯æ€»æ˜¯å®šå‘åˆ°ç›¸åŒçš„æœåŠ¡; (æ­¤æ–¹æ³•å¯ç¡®ä¿æ¥è‡ªåŒä¸€å®¢æˆ·ç«¯çš„è¯·æ±‚å°†å§‹ç»ˆå®šå‘åˆ°åŒä¸€å°æœåŠ¡å™¨ï¼Œé™¤éžæ­¤æœåŠ¡å™¨ä¸å¯ç”¨ã€‚) åœ¨nginx.confæ–‡ä»¶ä¸­ä¿®æ”¹ï¼š 123456upstream shsxt&#123; ip_hash; server ï¼ˆIPåœ°å€|åˆ«åï¼‰; server ï¼ˆIPåœ°å€|åˆ«åï¼‰; server ï¼ˆIPåœ°å€|åˆ«åï¼‰;&#125; (5)ã€Nginxçš„è®¿é—®æŽ§åˆ¶ Nginxè¿˜å¯ä»¥å¯¹IPçš„è®¿é—®è¿›è¡ŒæŽ§åˆ¶ï¼Œallowä»£è¡¨å…è®¸ï¼Œdenyä»£è¡¨ç¦æ­¢. 12345678location / &#123;deny 192.168.2.180;allow 192.168.78.0/24;allow 10.1.1.0/16;allow 192.168.1.0/32;deny all;proxy_pass http://shsxt;&#125; 12345ä»Žä¸Šåˆ°ä¸‹çš„é¡ºåºï¼ŒåŒ¹é…åˆ°äº†ä¾¿è·³å‡ºã€‚å¦‚ä¸Šçš„ä¾‹å­å…ˆç¦æ­¢äº†1ä¸ªï¼ŒæŽ¥ä¸‹æ¥å…è®¸äº†3ä¸ªç½‘æ®µï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ªipv6ï¼Œæœ€åŽæœªåŒ¹é…çš„IPå…¨éƒ¨ç¦æ­¢è®¿é—®]]></content>
      <categories>
        <category>è´Ÿè½½å‡è¡¡</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux å…¥é—¨å­¦ä¹ ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2019%2F01%2F11%2FLinux%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%2B%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0(%E7%AC%AC%E4%B8%80%E5%9B%9E%E5%90%88)%2F</url>
    <content type="text"><![CDATA[Linuxç½‘ç»œé…ç½®+å¸¸ç”¨å‘½ä»¤å­¦ä¹ [TOC] ä¸€ã€ Linuxæ¦‚è¿°1.1. ç®€ä»‹imgLinuxæ˜¯ä¸€ä¸ªè‡ªç”±çš„ï¼Œå…è´¹çš„ï¼Œæºç å¼€æ”¾çš„æ“ä½œç³»ç»Ÿã€‚ä¹Ÿæ˜¯å¼€æºè½¯ä»¶ä¸­æœ€è‘—åçš„ä¾‹å­ã€‚å…¶æœ€ä¸»è¦çš„ç›®çš„å°±æ˜¯ä¸ºäº†å»ºç«‹ä¸å—ä»»ä½•å•†å“åŒ–è½¯ä»¶ç‰ˆæƒåˆ¶çº¦çš„ï¼Œå…¨ä¸–ç•Œéƒ½èƒ½ä½¿ç”¨çš„ç±»Unixå…¼å®¹äº§å“.è€Œæˆ‘ä»¬å°†æœåŠ¡å™¨éƒ¨ç½²åœ¨Linuxå°†ä¼šæ›´åŠ çš„ç¨³å®šã€å®‰å…¨ã€é«˜æ•ˆä»¥åŠå‡ºè‰²çš„æ€§èƒ½è¿™æ—¶windowsæ— æ³•æ¯”çš„ã€‚ 1.2.Linuxä½œè€…img æž—çº³æ–¯Â·æœ¬çº³ç¬¬å…‹ç‰¹Â·æ‰˜ç“¦å…¹ï¼ˆLinus Benedict Torvalds, 1969å¹´~ ï¼‰ï¼Œè‘—åçš„ç”µè„‘ç¨‹åºå‘˜ã€é»‘å®¢ã€‚Linuxå†…æ ¸çš„å‘æ˜ŽäººåŠè¯¥è®¡åˆ’çš„åˆä½œè€…ã€‚æ‰˜ç“¦å…¹åˆ©ç”¨ä¸ªäººæ—¶é—´åŠå™¨æåˆ›é€ å‡ºäº†è¿™å¥—å½“ä»Šå…¨çƒæœ€æµè¡Œçš„æ“ä½œç³»ç»Ÿï¼ˆä½œä¸šç³»ç»Ÿï¼‰å†…æ ¸ä¹‹ä¸€ã€‚çŽ°å—è˜äºŽå¼€æ”¾æºä»£ç å¼€å‘å®žéªŒå®¤ï¼ˆOSDLï¼šOpen Source Development Labs, Incï¼‰ï¼Œå…¨åŠ›å¼€å‘Linuxå†…æ ¸ã€‚ 1.3.Linux å‘è¡Œç‰ˆå‘è¡Œç‰ˆæ˜¯åŸºäºŽ Linux å†…æ ¸çš„ä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚å®ƒå¸¦æœ‰ç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„è½¯ä»¶é›†åˆã€‚æ›´å¤šçš„ï¼Œå®ƒè¿˜åŒ…å«ç³»ç»Ÿç®¡ç†åŒ…ã€‚ç›®å‰æœ‰è®¸å¤š Linux å‘è¡Œç‰ˆã€‚å› ä¸ºæˆ‘ä»¬ä¸èƒ½æ•°æ¸…ç›®å‰æ‰€æœ‰çš„ Linux å‘è¡Œç‰ˆï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸€äº›æœ‰åçš„ç‰ˆæœ¬ï¼š Ubuntuã€Fedoraã€Opensuseã€Red hat Linux å’Œ Debian ç­‰æ˜¯å‡ ä¸ªéžå¸¸å—æ¬¢è¿Žçš„ Linux å‘è¡Œç‰ˆã€‚ img C**entos** img img Ubuntu imgimg Rehat img img 1.4.Linuxçš„ç‰¹ç‚¹å¼€æ”¾æ€§ï¼Œå¤šç”¨æˆ·ï¼Œå¤šä»»åŠ¡ï¼Œä¸°å¯Œçš„ç½‘ç»œåŠŸèƒ½ï¼Œå¯é çš„ç³»ç»Ÿå®‰å…¨ï¼Œè‰¯å¥½çš„å¯ç§»æ¤æ€§ï¼Œå…·æœ‰æ ‡å‡†å…¼å®¹æ€§ äºŒã€çŽ¯å¢ƒå‡†å¤‡2.1. Vmware2.1.1 Vmwareç®€ä»‹å¤§å¤šæ•°æœåŠ¡å™¨çš„å®¹é‡ï¼ˆCPU,å†…å­˜ï¼Œç£ç›˜ç­‰ï¼‰åˆ©ç”¨çŽ‡ä¸è¶³ 30%ï¼Œè¿™ä¸ä»…å¯¼è‡´äº†èµ„æºæµªè´¹ï¼Œä¹ŸåŠ å¤§äº†æœåŠ¡å™¨çš„æ•°é‡ã€‚å®žçŽ°æœåŠ¡å™¨è™šæ‹ŸåŒ–åŽï¼Œå¤šä¸ªæ“ä½œç³»ç»Ÿå¯ä»¥ä½œä¸ºè™šæ‹Ÿæœºåœ¨å•å°ç‰©ç†æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ¯ä¸ªæ“ä½œç³»ç»Ÿéƒ½å¯ä»¥è®¿é—®åº•å±‚æœåŠ¡å™¨çš„è®¡ç®—èµ„æºï¼Œä»Žè€Œè§£å†³æ•ˆçŽ‡ä½Žä¸‹é—®é¢˜ã€‚ Vmwareè™šæ‹ŸæœºåŒ–æŠ€æœ¯ç”±æ­¤è¯žç”Ÿï¼Œå®ƒå¯ä»¥å°†ä¸€å°æœåŠ¡å™¨è™šæ‹ŸåŒ–å‡ºå¤šå°è™šæ‹Ÿæœºï¼Œä¾›å¤šäººåŒæ—¶ä½¿ç”¨ï¼Œæé«˜èµ„æºåˆ©ç”¨çŽ‡ã€‚ 2.1.2 Vmware workstationå®‰è£…è¯¦ç»†è§vmwareå®‰è£…æ–‡æ¡£ 2.2. linuxå®‰è£…è¯¦ç»†è§Linuxå®‰è£…æ–‡æ¡£ 2.3.ç½‘ç»œé…ç½®2.3.1 æŸ¥çœ‹ç½‘å…³img img 2.3.2 é…ç½®é™æ€IP(NATæ¨¡å¼)1.ç¼–è¾‘é…ç½®æ–‡ä»¶,æ·»åŠ ä¿®æ”¹ä»¥ä¸‹å†…å®¹ vi /etc/sysconfig/network-scripts/ifcfg-eth0 æŒ‰i è¿›å…¥æ–‡æœ¬ç¼–è¾‘æ¨¡å¼ï¼Œå‡ºçŽ°æ¸¸æ ‡ï¼Œå·¦ä¸‹è§’ä¼šå‡ºçŽ°INSERT,å³å¯ä»¥ç¼–è¾‘ img åº”åŒ…å«ä»¥ä¸‹é…ç½®ï¼Œé™¤æ­¤ä¹‹å¤–çš„å¯ä»¥åˆ é™¤æŽ‰ã€‚ 123456789101112131415DEVICE=eth0 #ç½‘å¡è®¾å¤‡å,è¯·å‹¿ä¿®æ”¹åå­—TYPE=Ethernet #ç½‘ç»œç±»åž‹ï¼Œä»¥å¤ªç½‘BOOTPROTO=static #å¯ç”¨é™æ€IPåœ°å€ONBOOT=yes #å¼€å¯è‡ªåŠ¨å¯ç”¨ç½‘ç»œè¿žæŽ¥ IPADDR=192.168.78.100 #è®¾ç½®IPåœ°å€NETMASK=255.255.255.0 #è®¾ç½®å­ç½‘æŽ©ç GATEWAY=192.168.78.2 #è®¾ç½®ç½‘å…³DNS1=114.114.114.114 #è®¾ç½®å¤‡DNS æŒ‰ESCé€€å‡ºç¼–è¾‘æ¨¡å¼ :wq #ä¿å­˜é€€å‡º 2.ä¿®æ”¹å®ŒåŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ service network restart #é‡å¯ç½‘ç»œè¿žæŽ¥ ifconfig #æŸ¥çœ‹IPåœ°å€ 3.éªŒè¯æ˜¯å¦é…ç½®æˆåŠŸ: è™šæ‹Ÿæœºèƒ½pingé€šè™šæ‹Ÿç½‘å…³ img è™šæ‹Ÿæœºä¸Žç‰©ç†æœºï¼ˆç¬”è®°æœ¬ï¼‰ç›¸äº’å¯pingé€š img è™šæ‹Ÿæœºä¸Žå…¬ç½‘ä¸Šçš„ç™¾åº¦ç½‘å€ç›¸äº’å¯pingé€šï¼ˆæ­¤æ­¥pingé€šï¼Œæ‰è¯´æ˜Žç½‘ç»œé…ç½®æˆåŠŸï¼ŒCtrlé”®+Cåœæ­¢ï¼‰ å‘½ä»¤ï¼šping www.baidu.com æ³¨æ„ï¼š a.ä¿è¯VMwareçš„è™šæ‹Ÿç½‘å¡æ²¡æœ‰è¢«ç¦ç”¨img b.ç½‘å…³IPä¸èƒ½è¢«å ç”¨ 2.4.XShellå®‰è£…ä¸Žä½¿ç”¨2.4.1å®‰è£…æ­¥éª¤é™¤äº†å®‰è£…è·¯å¾„éœ€è¦ä¿®æ”¹ï¼Œå…¶ä»–ä¸€ç›´ä¸‹ä¸€æ­¥ã€‚ 2.4.2 è¿žæŽ¥è™šæ‹Ÿæœº æ‰“å¼€xshellè½¯ä»¶æ–°å»ºä¸€ä¸ªä¼šè¯ img å¡«å†™æ‰€è¦è¿žæŽ¥çš„è™šæ‹ŸæœºIPï¼Œä¼šè¯åç§°å¯æ”¹å¯ä¸æ”¹ï¼Œç‚¹å‡»ç¡®å®šã€‚ img 3.è¿žæŽ¥è™šæ‹Ÿæœºã€‚ img 4ï¼Žè¾“å…¥rootç”¨æˆ·åï¼Œå¯ä»¥å‹¾é€‰â€è®°ä½ç”¨æˆ·åâ€ img 5.å¡«å†™å¯†ç ï¼Œå¯ä»¥å‹¾é€‰â€œè®°ä½å¯†ç â€ img 6.ç™»å½•æˆåŠŸã€‚ img ä¸‰ã€æ–‡ä»¶ç³»ç»ŸLinuxæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æ˜¯æ•°æ®çš„é›†åˆï¼Œæ–‡ä»¶ç³»ç»Ÿä¸ä»…åŒ…å«ç€æ–‡ä»¶ä¸­çš„æ•°æ®è€Œä¸”è¿˜æœ‰æ–‡ä»¶ç³»ç»Ÿçš„ç»“æž„ï¼Œæ‰€æœ‰Linux ç”¨æˆ·å’Œç¨‹åºçœ‹åˆ°çš„æ–‡ä»¶ã€ç›®å½•ã€è½¯è¿žæŽ¥åŠæ–‡ä»¶ä¿æŠ¤ä¿¡æ¯ç­‰éƒ½å­˜å‚¨åœ¨å…¶ä¸­ã€‚ Linuxç›®å½•ç»“æž„ï¼š img bin å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(ls,cat,mkdirç­‰) boot å­˜æ”¾ç”¨äºŽç³»ç»Ÿå¼•å¯¼æ—¶ä½¿ç”¨çš„å„ç§æ–‡ä»¶ dev ç”¨äºŽå­˜æ”¾è®¾å¤‡æ–‡ä»¶ etc å­˜æ”¾ç³»ç»Ÿé…ç½®æ–‡ä»¶ home å­˜æ”¾æ‰€æœ‰ç”¨æˆ·æ–‡ä»¶çš„æ ¹ç›®å½• lib å­˜æ”¾è·Ÿæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç¨‹åºè¿è¡Œæ‰€éœ€è¦çš„å…±äº«åº“åŠå†…æ ¸æ¨¡å— mnt ç³»ç»Ÿç®¡ç†å‘˜å®‰è£…ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿçš„å®‰è£…ç‚¹ opt é¢å¤–å®‰è£…çš„å¯é€‰åº”ç”¨ç¨‹åºåŒ…æ‰€æ”¾ç½®çš„ä½ç½® proc è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå­˜æ”¾å½“å‰å†…å­˜çš„æ˜ å°„ root è¶…çº§ç”¨æˆ·ç›®å½• sbin å­˜æ”¾äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæœ‰rootæ‰èƒ½è®¿é—® tmp ç”¨äºŽå­˜æ”¾å„ç§ä¸´æ—¶æ–‡ä»¶ usr ç”¨äºŽå­˜æ”¾ç³»ç»Ÿåº”ç”¨ç¨‹åºï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•/usr/local æœ¬åœ°ç®¡ç†å‘˜è½¯ä»¶å®‰è£…ç›®å½• var ç”¨äºŽå­˜æ”¾è¿è¡Œæ—¶éœ€è¦æ”¹å˜æ•°æ®çš„æ–‡ä»¶ 3.1ç›®å½•æ“ä½œ3.1.1**åˆ‡æ¢ç›®å½•å‘½ä»¤ï¼šcd + ç›®å½•çš„è·¯å¾„ æŸ¥çœ‹å½“å‰ç›®å½•çš„å®Œæ•´è·¯å¾„ ï¼špwd img å‘½ä»¤ cd .. è¿”å›žåˆ°çˆ¶ç›®å½• img 3.1.2**æ–°å»ºç›®å½•å‘½ä»¤ï¼šmkdir+ ç›®å½•åå­— æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‹¥æœ‰çš„å­ç›®å½•å’Œæ–‡ä»¶: ls img 3.1.3 æ‹·è´ç›®å½•cp source dest -r img 3.1.4åˆ é™¤ç›®å½•rmdir directory img æ³¨æ„ï¼šrmdiråªèƒ½åˆ é™¤ç©ºç›®å½•,è‹¥è¦åˆ é™¤éžç©ºç›®å½•åˆ™ç”¨rmå‘½ä»¤ rm -rf dir 3.1.5ç§»åŠ¨/æ›´æ”¹ ç›®å½•â€‹ ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼šmv + ç›®å½•/æ–‡ä»¶åå­— + å…¶ä»–è·¯å¾„ â€‹ mv test / å°†testç›®å½•ç§»åŠ¨åˆ° æ ¹ç›®å½•/ ä¸‹ â€‹ img â€‹ æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„åå­—ï¼šmv + æ—§ç›®å½•åå­— + æ–°ç›®å½•åå­—ã€‚ â€‹ img 3.2.æ–‡ä»¶æ“ä½œ3.2.1æ–°å»ºæ–‡ä»¶ï¼šï¼ˆä¸€åˆ‡çš†æ–‡ä»¶ï¼‰touch web.log åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ã€‚ img 3.2.2 å¤åˆ¶æ–‡â€‹ cp web.log web_cp.log img å¤åˆ¶æ–‡ä»¶ï¼ŒåŠ ä¸ª-r å‚æ•°ï¼Œä»£è¡¨éåŽ†å¤åˆ¶ï¼Œæ­¤æ—¶å¯ç”¨äºŽå¤åˆ¶ä¸€ä¸ªç›®å½•ã€‚ 3.2.3åˆ é™¤æ–‡ä»¶rm web_cp.log img æ­¤æ—¶éœ€è¦æ‰‹åŠ¨è¾“å…¥y ï¼Œä»£è¡¨ç¡®è®¤åˆ é™¤ã€‚å¯åŠ  â€“få‚æ•°ï¼Œç›´æŽ¥åˆ é™¤ï¼Œæ— éœ€ç¡®è®¤ã€‚å½“éœ€è¦ä¸€ä¸ªç›®å½•ä¸‹æ‰€æœ‰ä¸œè¥¿æ—¶ï¼ŒåŠ -rå‚æ•°ï¼Œä»£è¡¨éåŽ†åˆ é™¤ã€‚ rm -f web.log img 3.2.4**æŸ¥çœ‹3.2.4.1**æŸ¥çœ‹ç›®å½•ä¸‹çš„ä¸œè¥¿â€‹ ls / ll å‘½ä»¤ ls -l ç­‰ä»·äºŽ ll img æŸ¥çœ‹ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸œè¥¿ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰ å‘½ä»¤ï¼šls â€“al ç­‰ä»·äºŽ ll â€“a img 3.2.4.2æŸ¥çœ‹æ–‡ä»¶å†…å®¹cat filename: ä¸€æ¬¡æ€§æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ img æ³¨æ„ï¼šå½“æ–‡ä»¶è¾ƒå¤§æ—¶ï¼Œæ–‡æœ¬åœ¨å±å¹•ä¸Šè¿…é€Ÿé—ªè¿‡ï¼ˆæ»šå±ï¼‰ï¼Œç”¨æˆ·å¾€å¾€çœ‹ä¸æ¸…æ‰€æ˜¾ç¤ºçš„å†…å®¹ã€‚ å› æ­¤ï¼Œä¸€èˆ¬ç”¨moreç­‰å‘½ä»¤åˆ†å±æ˜¾ç¤º. more filename è¯¥å‘½ä»¤ä¸€æ¬¡æ˜¾ç¤ºä¸€å±æ–‡æœ¬ï¼Œæ»¡å±åŽåœä¸‹æ¥ï¼Œå¹¶ä¸”åœ¨å±å¹•çš„åº•éƒ¨å‡ºçŽ°ä¸€ä¸ªæç¤ºä¿¡æ¯ï¼Œç»™å‡ºè‡³ä»Šå·±æ˜¾ç¤ºçš„è¯¥æ–‡ä»¶çš„ç™¾åˆ†æ¯”ã€‚ æŒ‰Spaceé”®ï¼Œæ˜¾ç¤ºæ–‡æœ¬çš„ä¸‹ä¸€å±å†…å®¹ã€‚æŒ‰Enteré”®ï¼Œåªæ˜¾ç¤ºæ–‡æœ¬çš„ä¸‹ä¸€è¡Œå†…å®¹ã€‚ æŒ‰Bé”®ï¼Œæ˜¾ç¤ºä¸Šä¸€å±å†…å®¹ã€‚ æŒ‰Qé”®ï¼Œé€€å‡ºã€‚ å‘½ä»¤ï¼šmore /etc/profile img æ˜¾ç¤ºçš„å†…å®¹ï¼š img â€‹ lesså‘½ä»¤ ä¸Ž moreå‘½ä»¤ éžå¸¸ç±»ä¼¼ less filename: â€‹ h æ˜¾ç¤ºå¸®åŠ©ç•Œé¢ Q é€€å‡ºless å‘½ä»¤ u å‘åŽæ»šåŠ¨åŠé¡µ d å‘å‰ç¿»åŠé¡µ ç©ºæ ¼é”® æ»šåŠ¨ä¸€é¡µ b å‘åŽç¿»ä¸€é¡µ å›žè½¦é”® æ»šåŠ¨ä¸€è¡Œ [pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ [pageup]ï¼š å‘ä¸Šç¿»åŠ¨ä¸€é¡µ ä»¥åŠä¸Šä¸‹é”®ï¼Œå‘ä¸Šä¸€è¡Œï¼Œå‘ä¸‹ä¸€è¡Œ 3.2.4.3ä»Žå¤´æ‰“å°**æ–‡ä»¶å†…å®¹â€‹ head -10 filename æ‰“å°æ–‡ä»¶1åˆ°10è¡Œ img 3.2.4.4ä»Žå°¾éƒ¨æ‰“å°æ–‡ä»¶å†…å®¹ tail -10 filename æ‰“å°æ–‡ä»¶æœ€åŽ10è¡Œ img æ³¨æ„ï¼štail è¿˜ç»å¸¸å¯ä»¥æ‹¿æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹å˜åŒ– åŠ -få‚æ•°ï¼Œtail â€“f filename 3.2.5æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•â€‹ find pathname â€“name filename â€‹ ä¾‹å­ï¼šfind / -name profile â€‹ è¯¥å‘½ä»¤è¡¨ç¤ºä¸ºï¼Œåœ¨/ç›®å½•ä¸‹æŸ¥æ‰¾ åå­—ä¸ºprofileçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œæœ€åŽåˆ—å‡ºå®ƒçš„ç»å¯¹è·¯å¾„ â€‹ img â€‹ æœ€åŽå‘çŽ°ï¼Œlinuxç³»ç»Ÿæ ¹ç›®å½•/ ä¸‹ ä¸€å…±æœ‰ä¸¤ä¸ªåå­—ä¸ºprofileï¼Œ â€‹ å…¶ä¸­/etc/profileæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œ/etc/lvm/profileä¸ºç›®å½• è¿˜å¯ä»¥æŒ‰æ­£åˆ™è¡¨è¾¾å¼æ¥æŸ¥æ‰¾ï¼Œä¸”pathnameè¶Šç²¾ç¡®ï¼ŒæŸ¥æ‰¾çš„èŒƒå›´è¶Šå°ï¼Œé€Ÿåº¦è¶Šå¿«ã€‚ â€‹ find /etc -name pro* æ³¨æ„ï¼šï¼ˆå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œå…¶æŸ¥æ‰¾çš„ç›®å½•å¿…é¡»æ˜¯æ‰€åœ¨ç›®å½•çš„çˆ¶çº§ç›®å½•ï¼‰ â€‹ è¯¥å‘½ä»¤è¡¨ç¤ºä¸ºï¼šåœ¨/etcç›®å½•ä¸‹æŸ¥æ‰¾ä»¥proå¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚ img å››ã€æ–‡æœ¬ç¼–è¾‘4.1.viç¼–è¾‘æ¨¡å¼ vi filename :æ‰“å¼€æˆ–æ–°å»ºæ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬ä¸€è¡Œé¦– vi +n filename ï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬nè¡Œé¦– vi + filename ï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽæœ€åŽä¸€è¡Œé¦– vi +/pattern filenameï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬ä¸€ä¸ªä¸Ž patternåŒ¹é…çš„ä¸²å¤„ â€¢ q!ï¼šä¸ä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºvi â€“ åœ¨VIçš„å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥â€œ:set nuâ€ï¼Œå°±æœ‰è¡Œå·äº†ã€‚ â€“ åœ¨VIçš„å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥â€œ:set nonuâ€ï¼Œå–æ¶ˆè¡Œå·ã€‚ ä¸€èˆ¬æ¨¡å¼ â€¢ yy å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ(å¸¸ç”¨) â€¢ nyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œçš„å‘ä¸‹nè¡Œï¼Œä¾‹å¦‚ï¼Œ 20yyåˆ™æ˜¯å¤åˆ¶20è¡Œ(å¸¸ç”¨) ï¼ˆä¸åŒï¼šåœ¨æˆ‘çš„xshellä¸­æ˜¯ yynå®žçŽ°å¤åˆ¶æ‰€åœ¨è¡Œçš„å‘ä¸‹nè¡Œï¼‰ â€¢ p,P pä¸ºå¤åˆ¶çš„æ•°æ®ç²˜è´´åœ¨å…‰æ ‡ä¸‹ä¸€è¡Œï¼Œ Påˆ™ä¸ºç²˜è´´åœ¨å…‰æ ‡ä¸Šä¸€è¡Œ(å¸¸ç”¨) G:å…‰æ ‡ç§»è‡³ç¬¬æœ€åŽä¸€è¡Œ nGï¼šå…‰æ ‡ç§»åŠ¨è‡³ç¬¬Nè¡Œè¡Œé¦– nï¼ˆshiftï¼‰+ï¼šå…‰æ ‡ä¸‹ç§»nè¡Œ ï¼ˆnB|nb:å…‰æ ‡å‘ä¸Šç§»åŠ¨nè¡Œï¼‰ n-ï¼šå…‰æ ‡ä¸Šç§»nè¡Œ H ï¼šå…‰æ ‡ç§»è‡³å±å¹•é¡¶è¡Œ M ï¼šå…‰æ ‡ç§»è‡³å±å¹•ä¸­é—´è¡Œ L ï¼šå…‰æ ‡ç§»è‡³å±å¹•æœ€åŽè¡Œ â€¢ ddï¼šåˆ é™¤ è¡Œ xæˆ–Xï¼šåˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œxåˆ é™¤å…‰æ ‡åŽçš„ï¼Œè€ŒXåˆ é™¤å…‰æ ‡å‰çš„ â€¢ u æ¢å¤å‰ä¸€ä¸ªåŠ¨ä½œ(å¸¸ç”¨) åˆ é™¤ç¬¬Nè¡Œåˆ°ç¬¬Mè¡Œï¼š :N,Md 4.2.vimVimæ˜¯ä»Ž vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€è¯­æ³•é«˜äº®ã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨. å®‰è£…vim è½¯ä»¶ yum install vim img æŒ‰yç¡®è®¤, è¿™ä¸­é—´ä¸€å…±è¦æŒ‰ä¸¤æ¬¡ç¡®è®¤ img å¯ä»¥åœ¨ä¹¦å†™å‘½ä»¤æ—¶å°±åŠ y,è¿™æ ·å°±ä¸ç”¨é€ä¸€ç¡®è®¤ã€‚ yum install vim -y ç”¨vim æ‰“å¼€/etc/profile æ–‡ä»¶ï¼Œä¼šå‘çŽ°ç¼–è¾‘å™¨å¯¹æ–‡æœ¬çš„å†…å®¹è¿›è¡Œäº†é«˜äº®ï¼Œä½¿æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹å¯è¯»æ€§å¤§å¤§åŠ å¼º å‘½ä»¤ï¼švim /etc/profile img äº”ã€æ–‡ä»¶ä¼ è¾“5.1.è¿œç¨‹æ‹·è´5.1.1å°†æœ¬åœ°æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹æœºå™¨ ä¸¾ä¾‹ï¼š 123456789101112&gt; æ–¹å¼ä¸€ï¼š&gt; scp -rf /etc/profile root@192.168.198.128:/etc/&gt; &gt; æ–¹å¼äºŒ:&gt; scp -r /etc/profile root@node01 /etc/ &gt; &gt; æ–¹å¼ä¸‰ï¼š&gt; scp -r /etc/profile node01:/etc/&gt; &gt; æ–¹å¼å››ï¼š&gt; scp -r /ec/profile node01:&apos;pwd&apos;&gt; scp ï¼šè¿œç¨‹ä¼ è¾“æ–‡ä»¶å‘½ä»¤ -r ï¼š- æŒ‡çš„æ˜¯åŽé¢è·Ÿçš„æ˜¯å‚æ•° r æŒ‡çš„æ˜¯éåŽ†æŒ‡å®šæ–‡ä»¶ f æŒ‡çš„æ˜¯ä¸ç”¨è¯¢é—® /etc/profile : æ˜¯æŒ‡å®šä¼ è¾“çš„æ–‡ä»¶ rootï¼š è¿œç¨‹æœºå™¨çš„è´¦æˆ·å @ è¿œç¨‹æœºå™¨çš„IPåœ°å€ ï¼š /etc/ è¿œç¨‹æœºå™¨ä¸ŠæŒ‡å®šçš„ç›®å½• node01ï¼šè¿œç¨‹æœºå™¨çš„åˆ«å â€˜pwdâ€™ï¼š æœ¬åœ°è¦è¿œç¨‹ä¼ è¾“æ–‡ä»¶æ‰€åœ¨çš„ç›®å½• scp local_file remote_username@remote_ip:remote_folder img ç¬¬ä¸€æ¬¡è¿œç¨‹æ‹·è´æ—¶ï¼Œéœ€è¦åœ¨ç®­å¤´1åˆè¾“å…¥yesç¡®è®¤ä¸€ä¸‹ï¼ŒéªŒè¯ä¸€ä¸‹è¿œç¨‹ä¸»æœºã€‚ç„¶åŽåœ¨ç®­å¤´2å¤„è¾“å…¥ä¸€ä¸‹è¿œç¨‹ä¸»æœºçš„å¯†ç ã€‚ 5.1.2å°†æœ¬åœ°ç›®å½•å¤åˆ¶åˆ°è¿œç¨‹æœºå™¨scp -r local_folder remote_username@remote_ip:remote_folder img åœ¨testç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyfileæ–‡ä»¶ï¼Œç„¶åŽå°†testç›®å½•è¿œç¨‹æ‹·è´åˆ°192è™šæ‹Ÿæœºçš„æ ¹ç›®å½•ä¸‹ã€‚ 5.2.ä¸Šä¼ â€‹ éœ€å…ˆå®‰è£…å¥½lrzsz : yum install lrzsz -y å®‰è£…å¥½åŽï¼Œè¾“å…¥ä¸Šä¼ çš„å‘½ä»¤rz,å¼¹å‡ºä¸€ä¸‹ç•Œé¢ï¼š img é€‰æ‹©ä¸€ä¸ªwindowsç³»ç»Ÿé‡Œçš„æ–‡ä»¶ä¸Šä¼ è‡³è™šæ‹Ÿæœºçš„å½“å‰ç›®å½•ä¸‹,ç„¶åŽllå‘½ä»¤ï¼ŒæŸ¥çœ‹ç»“æžœ img 5.3.ä¸‹è½½ ä¸‹è½½å‘½ä»¤ä¸ºszï¼Œszå‘½ä»¤åªèƒ½ä¸‹è½½æ–‡ä»¶ï¼Œä¸èƒ½æ˜¯ç›®å½•ï¼Œå¯å…ˆå°†ç›®å½•åŽ‹ç¼©æˆä¸€ä¸ªåŒ…ï¼Œå†ä¸‹è½½è‡³windowsç³»ç»Ÿã€‚ä¸‹è½½å®Œä¹‹åŽï¼ŒæŒ‰ctrl+cç»“æŸã€‚ img 5.4 Xftpçš„å®‰è£…ä¸Žä½¿ç”¨â€‹ é™¤äº†å¯ä»¥ç”¨rz szå‘½ä»¤è¿›è¡Œæœ¬åœ°windowsç³»ç»Ÿå’Œè™šæ‹Ÿæœºä¹‹é—´çš„æ–‡ä»¶ä¼ è¾“ï¼Œè¿˜å¯ä»¥ä½¿ç”¨XFTPè½¯ä»¶ã€‚ å…­ã€ç½‘ç»œæŒ‡ä»¤6.1.æŸ¥çœ‹ç½‘ç»œé…ç½®ä¿¡æ¯å‘½ä»¤:ifconfig img ç®­å¤´1æŒ‡å‘çš„æ˜¯æœ¬æœºIPï¼Œç®­å¤´2ä¸ºå¹¿æ’­åœ°å€ï¼Œç®­å¤´3ä½å­ç½‘æŽ©ç ã€‚ 6.2.æµ‹è¯•ä¸Žç›®æ ‡ä¸»æœºçš„è¿žé€šæ€§å‘½ä»¤ï¼šping remote_ipï¼ˆå¯ä»¥pingé€šWindowsç³»ç»Ÿçš„IPï¼‰ img è¾“å…¥ping 192.168.78.192ä»£è¡¨æµ‹è¯•æœ¬æœºå’Œ192ä¸»æœºçš„ç½‘ç»œæƒ…å†µï¼Œ ç®­å¤´1è¡¨ç¤ºä¸€å…±æŽ¥æ”¶åˆ°äº†3ä¸ªåŒ…ï¼Œç®­å¤´2è¡¨ç¤ºä¸¢åŒ…çŽ‡ä¸º0ï¼Œè¡¨ç¤ºä¸¤è€…ä¹‹é—´çš„ç½‘ç»œé¡ºç•…ã€‚ æ³¨æ„ï¼šlinuxç³»ç»Ÿçš„pingå‘½ä»¤ä¼šä¸€ç›´å‘é€æ•°æ®åŒ…ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œé™¤éžè®¤ä¸ºçš„æŒ‰ctrl + cåœæ­¢æŽ‰ï¼Œ â€‹ windowsç³»ç»Ÿé»˜è®¤åªä¼šå‘4ä¸ªåŒ…è¿›è¡Œæµ‹è¯•ï¼Œä»¥ä¸‹ä¸ºwindowsçš„doså‘½ä»¤ã€‚ img 6.3.æ˜¾ç¤ºå„ç§ç½‘ç»œç›¸å…³ä¿¡æ¯â€‹ å‘½ä»¤ï¼šnetstat â€“a n p t -a (all)æ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºLISTENç›¸å…³-t (tcp)ä»…æ˜¾ç¤ºtcpç›¸å…³é€‰é¡¹-u (udp)ä»…æ˜¾ç¤ºudpç›¸å…³é€‰é¡¹-n æ‹’ç»æ˜¾ç¤ºåˆ«åï¼Œèƒ½æ˜¾ç¤ºæ•°å­—çš„å…¨éƒ¨è½¬åŒ–æˆæ•°å­—ã€‚-l ä»…åˆ—å‡ºæœ‰åœ¨ Listen (ç›‘å¬) çš„æœå‹™çŠ¶æ€ -p æ˜¾ç¤ºå»ºç«‹ç›¸å…³é“¾æŽ¥çš„ç¨‹åºå-r æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯ï¼Œè·¯ç”±è¡¨-e æ˜¾ç¤ºæ‰©å±•ä¿¡æ¯ï¼Œä¾‹å¦‚uidç­‰-s æŒ‰å„ä¸ªåè®®è¿›è¡Œç»Ÿè®¡-c æ¯éš”ä¸€ä¸ªå›ºå®šæ—¶é—´ï¼Œæ‰§è¡Œè¯¥netstatå‘½ä»¤ã€‚ æç¤ºï¼šLISTENå’ŒLISTENINGçš„çŠ¶æ€åªæœ‰ç”¨-aæˆ–è€…-læ‰èƒ½çœ‹åˆ° img ä¸ƒã€ç³»ç»Ÿé…ç½®7.1 ä¸»æœºåé…ç½® è‹¥è¦ä¿®æ”¹ä¸»æœºåå­—ï¼Œå¯åœ¨/etc/sysconfig/networkæ–‡ä»¶é‡Œä¿®æ”¹. vim /etc/sysconfig/network â€‹ img æœºå™¨é‡å¯æ‰èƒ½ç”Ÿæ•ˆ 7.2 DNSé…ç½® /etc/resolv.conf ä¸ºDNSæœåŠ¡å™¨çš„åœ°å€æ–‡ä»¶ img 7.3 çŽ¯å¢ƒå˜é‡Linuxç³»ç»Ÿçš„çŽ¯å¢ƒå˜é‡æ˜¯åœ¨/etc/profileæ–‡ä»¶é‡Œé…ç½®ã€‚ é¦–å…ˆè€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å…ˆå‰æ•²çš„yum, service,date,useraddç­‰ç­‰ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ï¼Œç³»ç»Ÿæ€Žä¹ˆçŸ¥é“è¿™äº›å‘½ä»¤å¯¹åº”çš„ç¨‹åºæ˜¯æ”¾åœ¨å“ªé‡Œçš„å‘¢ï¼Ÿ è¿™æ˜¯ç”±äºŽæ— è®ºæ˜¯windowsç³»ç»Ÿè¿˜æ˜¯linuxç³»ç»Ÿï¼Œéƒ½æœ‰ä¸€ä¸ªå«åšpathçš„ç³»ç»ŸçŽ¯å¢ƒå˜é‡ï¼Œå½“æˆ‘ä»¬åœ¨æ•²å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šåˆ°pathå¯¹åº”çš„ç›®å½•ä¸‹å¯»æ‰¾ï¼Œæ‰¾åˆ°çš„è¯å°±ä¼šæ‰§è¡Œï¼Œæ‰¾ä¸åˆ°å°±ä¼šæŠ¥æ²¡æœ‰è¿™ä¸ªå‘½ä»¤ã€‚å¦‚ä¸‹å›¾ï¼š img æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ï¼Œç³»ç»Ÿä¸€å…±åœ¨å“ªäº›ç›®å½•é‡Œå¯»æ‰¾å‘½ä»¤å¯¹åº”çš„ç¨‹åºã€‚ å‘½ä»¤ï¼šecho $PATH img å¯ä»¥çœ‹åˆ°pathé‡Œæœ‰å¾ˆå¤šè·¯å¾„ï¼Œè·¯å¾„ä¹‹é—´æœ‰å†’å·éš”å¼€ã€‚å½“ç”¨æˆ·æ•²å‘½ä»¤æ—¶ï¼Œç³»ç»Ÿä¼šä»Žå·¦å¾€å³ä¾æ¬¡å¯»æ‰¾å¯¹åº”çš„ç¨‹åºï¼Œæœ‰çš„è¯åˆ™è¿è¡Œè¯¥ç¨‹åºï¼Œæ²¡æœ‰çš„å°±æŠ¥é”™ï¼Œcommand not found. é‚£å¦‚æžœæˆ‘å†™äº†ä¸€ä¸ªè„šæœ¬ï¼ˆè„šæœ¬åŽé¢ä¼šä¸“é—¨è®²ï¼‰ï¼Œæˆ‘è¯¥æ€Žæ ·è¿è¡Œå®ƒå‘¢ï¼Ÿ img img å¯¹test.shæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œchmod 700 test.sh img è¿è¡Œæ–¹æ³•æœ‰ä¸‰ç§ï¼š ä¸€ç§æ˜¯åˆ°è„šæœ¬çš„ç›®å½•ä¸‹æ‰§è¡Œï¼š è¿è¡Œå‘½ä»¤ ï¼š ./test.sh ,ä»£è¡¨æ‰§è¡Œå½“å‰ç›®å½•é‡Œçš„è„šæœ¬test.sh img ä¸€ç§æ˜¯æ•²è„šæœ¬çš„ç»å¯¹è·¯å¾„ï¼š/usr/test/test.sh img ä»¥ä¸Šä¸¤ç§è¿è¡Œæ–¹å¼éƒ½ä¸æ˜¯å¾ˆç®€ä¾¿ï¼Œå› ä¸ºå…ˆå‰æˆ‘ä»¬æ‰§è¡Œyum serviceå‘½ä»¤ç­‰ï¼Œéƒ½æ˜¯ç›´æŽ¥æ•²å¯¹åº”çš„å‘½ä»¤çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å‚ç…§è¿™æ ·å­åšï¼Œåªè¦æˆ‘ä»¬é…ä¸€ä¸ªçŽ¯å¢ƒå˜é‡å°±å¥½ã€‚ ç¼–è¾‘ï¼š vim /etc/profile å°†test.shæ‰€åœ¨ç›®å½•æ·»åŠ åˆ°PATHé‡Œå°±OKï¼Œæˆ‘è¿™é‡Œtest.shæ˜¯åœ¨/usr/testç›®å½•ï¼ˆé€šè¿‡pwdæŸ¥çœ‹ï¼‰ä¸‹ã€‚ img ç¼–è¾‘å®Œä¹‹åŽï¼Œæ‰§è¡Œsource /etc/profileå‘½ä»¤ï¼Œé‡æ–°åŠ è½½çŽ¯å¢ƒå˜é‡ï¼Œæ­¤æ—¶ä¼šå‘çŽ°PATHè·¯å¾„å¤šäº†ä¸€ä¸ª/usr/testã€‚ img â€‹ æœ€åŽéªŒè¯ä¸€ä¸‹ï¼Œç›´æŽ¥æ‰§è¡Œtest.sh â€‹ img å…«ã€æœåŠ¡æ“ä½œ8.1 åˆ—å‡ºæ‰€æœ‰æœåŠ¡å‘½ä»¤ï¼šchkconfig æŸ¥è¯¢æ“ä½œç³»ç»Ÿåœ¨æ¯ä¸€ä¸ªæ‰§è¡Œç­‰çº§ä¸­ä¼šæ‰§è¡Œå“ªäº›ç³»ç»ŸæœåŠ¡ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç±»å¸¸é©»æœåŠ¡ã€‚ img å„æ•°å­—ä»£è¡¨çš„ç³»ç»Ÿåˆå§‹åŒ–çº§åˆ«å«ä¹‰ï¼š â€‹ 0ï¼šåœæœºçŠ¶æ€ 1ï¼šå•ç”¨æˆ·æ¨¡å¼ï¼Œrootè´¦æˆ·è¿›è¡Œæ“ä½œ 2ï¼šå¤šç”¨æˆ·ï¼Œä¸èƒ½ä½¿ç”¨net file systemï¼Œä¸€èˆ¬å¾ˆå°‘ç”¨ 3ï¼šå®Œå…¨å¤šç”¨æˆ·ï¼Œä¸€éƒ¨åˆ†å¯åŠ¨ï¼Œä¸€éƒ¨åˆ†ä¸å¯åŠ¨ï¼Œå‘½ä»¤è¡Œç•Œé¢ 4ï¼šæœªä½¿ç”¨ã€æœªå®šä¹‰çš„ä¿ç•™æ¨¡å¼ 5ï¼šå›¾å½¢åŒ–ï¼Œ3çº§åˆ«ä¸­å¯åŠ¨çš„è¿›ç¨‹éƒ½å¯åŠ¨ï¼Œå¹¶ä¸”ä¼šå¯åŠ¨ä¸€éƒ¨åˆ†å›¾å½¢ç•Œé¢è¿›ç¨‹ã€‚ 6ï¼šåœæ­¢æ‰€æœ‰è¿›ç¨‹ï¼Œå¸è½½æ–‡ä»¶ç³»ç»Ÿï¼Œé‡æ–°å¯åŠ¨(reboot) è¿™äº›çº§åˆ«ä¸­1ã€2ã€4å¾ˆå°‘ç”¨ï¼Œç›¸å¯¹è€Œè¨€0ã€3ã€5ã€6ç”¨çš„ä¼šè¾ƒå¤šã€‚3çº§åˆ«å’Œ5çº§åˆ«é™¤äº†æ¡Œé¢ç›¸å…³çš„è¿›ç¨‹å¤–æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä¸ºäº†å‡å°‘èµ„æºå ç”¨ï¼ŒæŽ¨èéƒ½ç”¨3çº§åˆ«. æ³¨æ„ ï¼šlinuxé»˜è®¤çº§åˆ«ä¸º3ï¼Œä¸è¦æŠŠ/etc/inittab ä¸­initdefault è®¾ç½®ä¸º0 å’Œ 6 8.2 æœåŠ¡æ“ä½œservice æœåŠ¡å start/stop/status/restart ä¾‹å­ï¼šå¯¹é˜²ç«å¢™æœåŠ¡è¿›è¡Œæ“ä½œï¼Œé˜²ç«å¢™çš„æœåŠ¡åä¸ºï¼šiptables. â€‹ æŸ¥çœ‹é˜²ç«å¢™æœåŠ¡è¿è¡ŒçŠ¶æ€ã€‚ img å…³é—­é˜²ç«å¢™. img å¼€å¯é˜²ç«å¢™ img 8.3 å…³é—­é˜²ç«å¢™service iptables start/stop/status æ³¨ï¼šå­¦ä¹ æœŸé—´ç›´æŽ¥æŠŠé˜²ç«å¢™å…³æŽ‰å°±æ˜¯ï¼Œå·¥ä½œæœŸé—´ä¹Ÿæ˜¯è¿ç»´äººå‘˜æ¥è´Ÿè´£é˜²ç«å¢™çš„ã€‚ æ°¸ä¹…å¼€å¯/å…³é—­é˜²ç«å¢™ chkconfig iptables on/off 8.4 æœåŠ¡åˆæ‰§è¡Œç­‰çº§æ›´æ”¹chkconfig â€“level 2345 name off|on â€‹ ï¼ˆæœåŠ¡åï¼‰ img è‹¥ä¸åŠ çº§åˆ«ï¼Œé»˜è®¤æ˜¯2345çº§åˆ« å‘½ä»¤ï¼šchkconfig name on|off â€‹ ï¼ˆæœåŠ¡åï¼‰ ä¹ã€linuxè¿›ç¨‹æ“ä½œ9.1 æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹å‘½ä»¤ï¼š ps -aux â€‹ -a åˆ—å‡ºæ‰€æœ‰ â€‹ -u åˆ—å‡ºç”¨æˆ· â€‹ -x è¯¦ç»†åˆ—å‡ºï¼Œå¦‚cpuã€å†…å­˜ç­‰ e â€‹ -f img å‘½ä»¤ï¼š ps - ef | grep ssh æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹é‡ŒCMDæ˜¯ssh çš„è¿›ç¨‹ä¿¡æ¯ã€‚ img å…¶ä¸­ç®­å¤´æ‰€æŒ‡çš„æ˜¯sshdæœåŠ¡è¿›ç¨‹çš„è¿›ç¨‹å·ï¼ˆPIDï¼‰ 9.2 æ€æ­»è¿›ç¨‹Kill ç”¨æ³• kill pid -9ï¼šå¼ºåˆ¶æ€æ­» ps å‘½ä»¤å…ˆæŸ¥å‡ºå¯¹åº”ç¨‹åºçš„PIDæˆ–PPID ï¼Œç„¶åŽæ€æ­»æŽ‰è¿›ç¨‹ã€‚ img åã€ å…¶ä»–å¸¸ç”¨å‘½ä»¤10.1 yumyumæ˜¯ä¸€ä¸ªåœ¨Fedoraå’ŒRedHatä»¥åŠCentOSä¸­çš„Shellå‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚åŸºäºŽRPMåŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»ŽæŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚ ç”±äºŽcentosç³»ç»Ÿçš„yumé»˜è®¤æ˜¯åˆ°å›½å¤–ç½‘ç«™ä¸‹è½½ï¼Œæœ‰æ—¶ä¸‹è½½é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œæ•…æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªyumçš„ä¸‹è½½æºï¼Œè¿™é‡Œæˆ‘ä»¬æ¢ä¸€ä¸ªå›½å†…çš„ä¸‹è½½æº é˜¿é‡Œäº‘é•œåƒã€‚ ç¬¬ä¸€æ­¥ï¼šå¤‡ä»½ä½ çš„åŽŸé•œåƒæ–‡ä»¶ï¼Œä»¥å…å‡ºé”™åŽå¯ä»¥æ¢å¤ã€‚ cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup img ç¬¬äºŒæ­¥ï¼šä¸‹è½½æ–°çš„CentOS-Base.repåˆ°/etc/yum.repos.d/ wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo img ä¸‹è½½å®Œä¹‹åŽï¼Œvim /etc/yum.repos.d/CentOS-Base.repo æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ã€‚ img ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œyum makecacheç”Ÿæˆç¼“å­˜ img æŸ¥çœ‹å½“å‰æº yum list | head -50 10.2 wgetwget æ˜¯ä¸€ä¸ªä»Žç½‘ç»œä¸Šè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶çš„è‡ªç”±å·¥å…·ï¼Œæ”¯æŒé€šè¿‡ HTTPã€HTTPSã€FTP ä¸‰ä¸ªæœ€å¸¸è§çš„ TCP/IPåè®® ä¸‹è½½ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ HTTP ä»£ç† éœ€å…ˆå®‰è£… yum install wget â€“y wgetç”¨æ³•:wget [option] ç½‘å€ -O æŒ‡å®šä¸‹è½½ä¿å­˜çš„è·¯å¾„ img img wget å·¥å…·è¿˜å¯ä»¥ç”¨æ¥åšä¸€äº›ç®€å•çš„çˆ¬è™«ï¼Œè¿™é‡Œä¸æ˜¯æˆ‘ä»¬çš„å­¦ä¹ é‡ç‚¹ï¼Œå¦‚æžœæƒ³åšçˆ¬è™«ï¼Œå¯ä»¥ç”¨javaæˆ–pythonè¯­è¨€æ¥åšã€‚ img 10.3 tartar â€‹ -z gzipè¿›è¡Œè§£åŽ‹æˆ–åŽ‹ç¼©ï¼Œå¸¦.gzéœ€è¦åŠ ï¼ŒåŽ‹ç¼©å‡ºæ¥.gzä¹Ÿéœ€è¦åŠ  â€‹ -x è§£åŽ‹ â€‹ -c åŽ‹ç¼© â€‹ -f ç›®æ ‡æ–‡ä»¶ï¼ŒåŽ‹ç¼©æ–‡ä»¶æ–°å‘½åæˆ–è§£åŽ‹æ–‡ä»¶å â€‹ -v è§£åŽ‹ç¼©è¿‡ç¨‹ä¿¡æ¯æ‰“å° è§£åŽ‹å‘½ä»¤ï¼štar -zvxf xxxx.tar.gz ä¾‹å­ï¼šå…ˆç”¨rzå‘½ä»¤æˆ–wscpä¸Šä¼ ä¸€ä¸ªtaråŒ…ï¼Œç„¶åŽè§£åŽ‹ã€‚ img img è§£åŽ‹åŽï¼š img åŽ‹ç¼©å‘½ä»¤ï¼štar -zcf åŽ‹ç¼©åŒ…å‘½å åŽ‹ç¼©ç›®æ ‡ ä¾‹å­ï¼štar -zcf tomcat.tar.gz apache-tomcat-7.0.61 å°† apache-tomcat-7.0.61 ç›®å½•åŽ‹ç¼©æˆtomcat.tar.gzåŒ…ã€‚ img åä¸€ã€JDKéƒ¨ç½²11.1 å®˜ç½‘ä¸‹è½½http://www.oracle.com/technetwork/java/javase/downloads/index.html img img 11.2 ä¸Šä¼ å¹¶è§£åŽ‹ç”¨xftpå°†jdkåŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿé‡Œï¼Œæˆ‘è¿™é‡Œä¸Šä¼ åˆ°/usr/softç›®å½•ä¸‹ã€‚ ç„¶åŽè§£åŽ‹: tar -zxf jdk-7u80-linux-x64.tar.gz img 11.3é…ç½®çŽ¯å¢ƒå˜é‡é…ç½®å…¨å±€JAVA_HOMEï¼Œå¹¶åœ¨PATHè·¯å¾„é‡ŒåŠ å…¥java_home/bin. æ³¨æ„ï¼šæ–°çš„pathè·¯å¾„å¿…é¡»è¦åŒ…å«æ—§çš„PATHè·¯å¾„ï¼Œä¸”æ¯ä¸ªè·¯å¾„ä¹‹é—´ä»¥å†’å·éš”å¼€ï¼Œè€Œä¸æ˜¯åˆ†å· vim /etc/profile JAVA_HOME= /usr/soft/jdk1.7.0_75 PATH=$PATH:$JAVA_HOME/bin img é‡æ–°åŠ è½½çŽ¯å¢ƒå˜é‡ï¼šsource /etc/profile img 11.4 éªŒè¯java -version img å¦‚å‡ºçŽ°ä¸Šå›¾ï¼Œåˆ™è¡¨ç¤ºjavaçŽ¯å¢ƒå˜é‡é…ç½®æˆåŠŸã€‚ åäºŒã€éƒ¨ç½²Tomcat12.1 å®˜ç½‘ä¸‹è½½ä¸‹è½½tomcat http://tomcat.apache.org/ 12**.2 ä¸Šä¼ å¹¶è§£åŽ‹**æˆ‘è¿™é‡Œä¸Šä¼ è‡³/usr/softç›®å½•ä¸‹ï¼Œç„¶åŽè§£åŽ‹ã€‚ img 12.3 å¯åŠ¨tomcatåœ¨tomcatçš„binç›®å½•ä¸‹æœ‰ä¸ªstartup.sh è„šæœ¬å¯ä»¥ç›´æŽ¥å¯åŠ¨tomcatæœåŠ¡ img å…³é—­tomcatæœåŠ¡ï¼Œå¯ä»¥ç”¨shutdown.shå‘½ä»¤ã€‚ æˆ–è€…ps -ef | grep tomcat æŸ¥çœ‹å‡ºtomcatè¿›ç¨‹å·åŽï¼Œç”¨killå‘½ä»¤ã€‚ 12.4 jpsjpsæ˜¯JDK 1.5æä¾›çš„ä¸€ä¸ªæ˜¾ç¤ºå½“å‰æ‰€æœ‰javaè¿›ç¨‹pidçš„å‘½ä»¤ï¼Œç®€å•å®žç”¨ï¼Œéžå¸¸é€‚åˆåœ¨linux/unixå¹³å°ä¸Šç®€å•å¯Ÿçœ‹å½“å‰javaè¿›ç¨‹çš„ä¸€äº›ç®€å•æƒ…å†µã€‚ img å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œjpså‘½ä»¤æ˜¾ç¤ºå‡ºäº†ï¼Œç³»ç»Ÿå½“å‰è¿è¡Œåœ¨jvmä¸Šçš„è¿›ç¨‹æƒ…å†µã€‚å…¶ä¸­Bootstrapæ˜¯tomcatçš„è¿›ç¨‹åå­—ï¼Œ1996æ˜¯tomcatçš„PID 13.5éªŒè¯å…ˆæŠŠé˜²ç«å¢™å…³äº†ï¼ˆservice iptables stopï¼‰ï¼Œç„¶åŽè®¿é—®è™šæ‹ŸæœºIPçš„8080ç«¯å£ img]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ç³»ç»Ÿå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux å…¥é—¨å­¦ä¹ ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2019%2F01%2F11%2FLinux%20%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E7%AC%AC%E4%BA%8C%E5%9B%9E%E5%90%88%EF%BC%89%2F</url>
    <content type="text"><![CDATA[2018å¹´12æœˆ18æ—¥ å‘¨äºŒ æ™´ ä»Šæ—¥å­¦ä¹ è¦ç‚¹ï¼š [TOC] LinuxåŽåŠç¨‹ä¸€ã€Linuxç³»ç»Ÿé…ç½®1.ä¸»æœºåé…ç½®ï¼š vim /etc/sysconfig/network 1545214876278 é…ç½®å®Œæˆä¹‹åŽéœ€è¦é‡å¯æœºå™¨æ‰èƒ½ç”Ÿæ•ˆ reboot 2.DNSé…ç½® æŸ¥çœ‹DNSæœåŠ¡å™¨çš„åœ°å€cat /etc/resolv.conf ä¿®æ”¹DNSæœåŠ¡å™¨åœ°å€æ–¹å¼ä¸€ï¼švim /etc/sysconfig/network.scripts/ifconfig-eth0 â€‹ åœ¨é…ç½®ç½‘å…³æ—¶ï¼Œé…ç½®DNS1=114.114.114.114ï¼ˆä¸æŽ¨èï¼Œæ±Ÿè‹å—äº¬çš„IPï¼‰ æ–¹å¼äºŒï¼švim /etc/resolv.conf ï¼ˆç”¨æœ¬åœ°ç½‘å…³è§£æžï¼‰ â€‹ nameserver 192.168.198.0 ( æ­¤ä¸ºè™šæ‹Ÿæœºä¸­çš„ç½‘å…³åœ°å€) 3.çŽ¯å¢ƒå˜é‡ é…ç½®ç³»ç»ŸçŽ¯å¢ƒå˜é‡ï¼Œä½¿å¾—æŸäº›å‘½ä»¤åœ¨æ‰§è¡Œæ—¶ï¼Œç³»ç»Ÿå¯ä»¥æ‰¾åˆ°å‘½ä»¤å¯¹åº”çš„æ‰§è¡Œç¨‹åºï¼Œå‘½ä»¤æ‰èƒ½æ­£å¸¸æ‰§è¡Œã€‚ æŸ¥çœ‹ç³»ç»Ÿä¸€å…±åœ¨å“ªäº›ç›®å½•é‡Œå¯»æ‰¾å‘½ä»¤å¯¹åº”çš„ç¨‹åº å‘½ä»¤ï¼šecho $PATH 1545215894631 æ³¨æ„ï¼šè·¯å¾„ä¹‹é—´æœ‰å†’å·éš”å¼€ï¼Œç³»ç»Ÿä¼šä»Žå·¦å¾€å³ä¾æ¬¡å¯»æ‰¾å¯¹åº”çš„ç¨‹åº â€‹ ä¸€èˆ¬å‘½ä»¤ä¼šå­˜æ”¾åœ¨ binç›®å½•ï¼Œæˆ–sbinç›®å½• é…ç½®å…¨å±€çŽ¯å¢ƒå˜é‡ï¼š vim /etc/profile åœ¨æ–‡ä»¶ä¸­ï¼š PATH=$PATH:(å‘½ä»¤æ‰€åœ¨ç›®å½•) é€€å‡ºæ–‡ä»¶ç¼–è¾‘åŽï¼š source /etc/profile (é‡æ–°åŠ è½½èµ„æºï¼Œæœ‰çš„å¯èƒ½éœ€è¦é‡å¯æœºå™¨ï¼Œè¿™ä¸é€‚ç”¨äºŽå®žé™…çŠ¶å†µ) é…ç½®å±€éƒ¨çŽ¯å¢ƒå˜é‡ï¼šï¼ˆæŽ¨èï¼Œé™å½“å‰ç™»å½•ç”¨æˆ·ä½¿ç”¨ï¼‰ æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶(rootç›®å½•ä¸‹) ls -a (å‘çŽ°éšè—æ–‡ä»¶ .bash.profile) vim ~/ bash_profile åœ¨æ–‡ä»¶ä¸­ï¼š export PATH =$PATH:(å‘½ä»¤æ‰€åœ¨ç›®å½•) 4.æ‹å¿«ç…§ï¼ˆä¿å­˜å½“æ—¶è®¡ç®—æœºæ‰€å‡ºçŠ¶æ€çš„å„ç§é…ç½®å’Œèµ„æºï¼Œé€‚åº¦ä½¿ç”¨ï¼‰ é€‰ä¸­æŒ‡å®šè™šæ‹Ÿè®¡ç®—æœºâ€”â€”é¼ æ ‡å³å‡»â€”â€“é€‰ä¸­â€œå¿«ç…§â€ â€”â€”â€œæ‹æ‘„å¿«ç…§â€˜â€”-åœ¨é¡µé¢ä¸­æ‰¾åˆ°â€æ‹æ‘„å¿«ç…§â€œï¼Œå¹¶æ·»åŠ åç§°å’Œæè¿° ä¹Ÿå¯ä»¥åˆ é™¤ï¼Œæ‰¾åˆ°é¡µé¢ä¸­çš„åˆ é™¤æŒ‰é’® äºŒã€æœåŠ¡æ“ä½œ1ã€æŸ¥è¯¢æ“ä½œç³»ç»Ÿåœ¨æ¯ä¸€ä¸ªæ‰§è¡Œç­‰çº§ä¸­ä¼šæ‰§è¡Œå“ªäº›ç³»ç»ŸæœåŠ¡ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç±»å¸¸é©»æœåŠ¡ã€‚ å‘½ä»¤ï¼šchkconfig 1545219619458 12345678å„æ•°å­—ä»£è¡¨çš„ç³»ç»Ÿåˆå§‹åŒ–çº§åˆ«ï¼š 0ï¼šåœæœºçŠ¶æ€ 1ï¼šå•ç”¨æˆ·æ¨¡å¼ï¼Œrootè´¦æˆ·è¿›è¡Œæ“ä½œ 2ï¼šå¤šç”¨æˆ·ï¼Œä¸èƒ½ä½¿ç”¨net file systemï¼Œä¸€èˆ¬å¾ˆå°‘ç”¨ 3ï¼šå®Œå…¨å¤šç”¨æˆ·ï¼Œä¸€éƒ¨åˆ†å¯åŠ¨ï¼Œä¸€éƒ¨åˆ†ä¸å¯åŠ¨ï¼Œå‘½ä»¤è¡Œç•Œé¢ 4ï¼šæœªä½¿ç”¨ã€æœªå®šä¹‰çš„ä¿ç•™æ¨¡å¼ 5ï¼šå›¾å½¢åŒ–ï¼Œ3çº§åˆ«ä¸­å¯åŠ¨çš„è¿›ç¨‹éƒ½å¯åŠ¨ï¼Œå¹¶ä¸”ä¼šå¯åŠ¨ä¸€éƒ¨åˆ†å›¾å½¢ç•Œé¢è¿›ç¨‹ã€‚ 6ï¼šåœæ­¢æ‰€æœ‰è¿›ç¨‹ï¼Œå¸è½½æ–‡ä»¶ç³»ç»Ÿï¼Œé‡æ–°å¯åŠ¨(reboot) 1ã€2ã€4å¾ˆå°‘ç”¨ï¼Œ0ã€3ã€5ã€6å¸¸ç”¨ï¼Œ3çº§åˆ«å’Œ5çº§åˆ«é™¤äº†æ¡Œé¢ç›¸å…³çš„è¿›ç¨‹å¤–æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒæŽ¨èéƒ½ç”¨3çº§åˆ«ï¼› linuxé»˜è®¤çº§åˆ«ä¸º3ï¼› ä¸è¦æŠŠ /etc/inittab ä¸­ initdefault è®¾ç½®ä¸º0 å’Œ 6ï¼› 2ã€æœåŠ¡æ“ä½œ service æœåŠ¡å start/stop/status/restart ä¸¾ä¾‹ï¼šå¯¹é˜²ç«å¢™æœåŠ¡è¿›è¡Œæ“ä½œ é˜²ç«å¢™çš„æœåŠ¡åä¸ºï¼šiptables æŸ¥çœ‹é˜²ç«å¢™æœåŠ¡è¿è¡ŒçŠ¶æ€ service iptables status å…³é—­é˜²ç«å¢™ service iptables stop å¼€å¯é˜²ç«å¢™ service iptables start æ°¸ä¹…å¼€å¯/å…³é—­é˜²ç«å¢™ chkconfig iptables on/off 3ã€æœåŠ¡åˆæ‰§è¡Œç­‰çº§æ›´æ”¹ chkconfig â€“level 2345 name off|onâ€‹ ï¼ˆ æœåŠ¡åï¼‰ ä¸¾ä¾‹ï¼šé˜²ç«å¢™ chkconfig â€“level 2345 iptables off è‹¥ä¸åŠ çº§åˆ«ï¼Œé»˜è®¤æ˜¯2345çº§åˆ« å‘½ä»¤ï¼šchkconfig name on|offâ€‹ ï¼ˆæœåŠ¡åï¼‰ ä¸‰ã€linuxè¿›ç¨‹æ“ä½œ1ã€æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ å‘½ä»¤ï¼š ps -aux 12345 -a åˆ—å‡ºæ‰€æœ‰-u åˆ—å‡ºç”¨æˆ·-x è¯¦ç»†åˆ—å‡ºï¼Œå¦‚cpuã€å†…å­˜ç­‰ -e select all processes ç›¸å½“äºŽ-a -f does full-format listing å°†æ‰€æœ‰æ ¼å¼è¯¦ç»†åˆ—å‡ºæ¥ æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹é‡ŒCMDæ˜¯ssh çš„è¿›ç¨‹ä¿¡æ¯ï¼ˆåŒ…æ‹¬pid è¿›ç¨‹å·ï¼‰ å‘½ä»¤ï¼š ps - ef | grep ssh ï¼ˆ| ç®¡é“ç¬¦ ï¼šå‰ä¸€ä¸ªè¾“å‡ºï¼Œå˜ä¸ºåŽä¸€ä¸ªçš„è¾“å…¥ï¼‰ ä¸¾ä¾‹ï¼š ps -ef | grep redis 2ã€æ€æ­»è¿›ç¨‹kill å‘½ä»¤ï¼škill pid -9 å¼ºåˆ¶æ€æ­» ç”¨æ³•ï¼šç”¨ps å‘½ä»¤å…ˆæŸ¥å‡ºå¯¹åº”ç¨‹åºçš„PIDæˆ–PPID ï¼Œç„¶åŽç”¨killæ€æ­»æŽ‰è¿›ç¨‹ã€‚ å››ã€å…¶ä»–å¸¸ç”¨å‘½ä»¤1ã€yum åŸºäºŽRPMåŒ…ç®¡ç† èƒ½å¤Ÿä»ŽæŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£… è·Ÿæ¢yumä¸‹è½½æºï¼ˆé»˜è®¤æ˜¯åˆ°å›½å¤–ç½‘ç«™ä¸‹è½½ï¼‰ ç¬¬ä¸€æ­¥ï¼šå¤‡ä»½ä½ çš„åŽŸé•œåƒæ–‡ä»¶ï¼Œä»¥å…å‡ºé”™åŽå¯ä»¥æ¢å¤ cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup ç¬¬äºŒæ­¥ï¼šä¸‹è½½æ–°çš„CentOS-Base.repåˆ°/etc/yum.repos.d/ wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo ä¸‹è½½å®Œä¹‹åŽï¼ŒæŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ vim /etc/yum.repos.d/CentOS-Base.repo ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆç¼“å­˜ è¿è¡Œyum makecache æŸ¥çœ‹å½“å‰æº yum list | head -50 2ã€ wget ä¸€ä¸ªä»Žç½‘ç»œä¸Šè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶çš„è‡ªç”±å·¥å…· æ”¯æŒé€šè¿‡ HTTPã€HTTPSã€FTP ä¸‰ä¸ªæœ€å¸¸è§çš„ TCP/IPåè®®ï¼Œå¯ä»¥ä½¿ç”¨ HTTP ä»£ç† å®‰è£…ï¼š yum install wget â€“y ç”¨æ³•ï¼š wget [option] ç½‘å€ -O æŒ‡å®šä¸‹è½½ä¿å­˜çš„è·¯å¾„ ä¸¾ä¾‹ï¼š wget www.baidu.com -O baidu.html 3ã€tar12345 -z gzipè¿›è¡Œè§£åŽ‹æˆ–åŽ‹ç¼©ï¼Œå¸¦.gzéœ€è¦åŠ ï¼ŒåŽ‹ç¼©å‡ºæ¥.gzä¹Ÿéœ€è¦åŠ -x è§£åŽ‹-c åŽ‹ç¼©-f ç›®æ ‡æ–‡ä»¶ï¼ŒåŽ‹ç¼©æ–‡ä»¶æ–°å‘½åæˆ–è§£åŽ‹æ–‡ä»¶å-v è§£åŽ‹ç¼©è¿‡ç¨‹ä¿¡æ¯æ‰“å° è§£åŽ‹å‘½ä»¤ï¼štar -zvxf xxxx.tar.gz åŽ‹ç¼©å‘½ä»¤ï¼štar -zcf åŽ‹ç¼©åŒ…å‘½å åŽ‹ç¼©ç›®æ ‡ä¸¾ä¾‹ï¼š tar -zcf tomcat.tar.gz apache-tomcat-7.0.61å°† apache-tomcat-7.0.61 ç›®å½•åŽ‹ç¼©æˆtomcat.tar.gzåŒ… 4ã€manä½œç”¨ï¼šç”¨äºŽæŸ¥çœ‹æŒ‡å®šå‘½ä»¤çš„å…·ä½“è§£é‡Š å®‰è£… yum install man -y (ä¸‹è½½å¹¶å®‰è£…man å¹¶ç¡®è®¤) ä½¿ç”¨ man ps äº”ã€JDKéƒ¨ç½²1ã€å‡†å¤‡JDKå®‰è£…åŒ…ï¼šï¼ˆè¿™æ˜¯ä½¿ç”¨ .rpm æ ¼å¼çš„å®‰è£…åŒ…ï¼‰ å®˜ç½‘ä¸‹è½½ï¼šhttp://www.oracle.com/technetwork/java/javase/downloads/index.html äº‘ç›˜èµ„æºï¼š jdk-8u191-linux-x64.rpm ï¼š â€‹ æ ¹æ®ç”¨æˆ·å–œå¥½æ”¾åˆ°è™šæ‹Ÿæœºå™¨çš„æ–‡ä»¶ç›®å½•ä¸­ 2ã€è§£åŽ‹å¹¶å®‰è£…ï¼Œå±•ç¤ºç¼–è¯‘è¿‡ç¨‹ rpm -ivh jdk-8u191-linux-x64.rpm å®‰è£…æ”¾åˆ°äº† /usr ç›®å½•ä¸‹ï¼Œæœ‰/javaç›®å½• 3ã€é…ç½®çŽ¯å¢ƒå˜é‡ vim ~/.bash_profile åœ¨æ–‡ä»¶ä¸­ï¼š JAVA_HOME=(jdkæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„+jdkæ–‡ä»¶å) export PATH=$PATH:$JAVA_HOME/bin æ³¨æ„ï¼š æ–°çš„pathè·¯å¾„å¿…é¡»è¦åŒ…å«æ—§çš„PATHè·¯å¾„ï¼Œä¸”æ¯ä¸ªè·¯å¾„ä¹‹é—´ä»¥å†’å·éš”å¼€ï¼Œè€Œä¸æ˜¯åˆ†å· é…ç½®å®Œæˆï¼Œé€€å‡ºç¼–è¾‘æ¡†åŽ source ~/.hash_profile 4ã€æµ‹è¯•ï¼š java -version æˆ– echo $JAVA_HOME echo æ ‡å‡†è¾“å‡ºï¼Œæ‰“å° å…­ã€Tomcatéƒ¨ç½²1ã€å®˜ç½‘ä¸‹è½½http://tomcat.apache.org/ äº‘ç›˜èµ„æºï¼šapache-tomcat-7.0.61.tar 2ã€ä¸Šä¼ å¹¶è§£åŽ‹ tar -zvxf apache-tomcat-7.0.61.tar 3ã€å¯åŠ¨tomcatåœ¨tomcatçš„binç›®å½•ä¸‹æœ‰ä¸ªstartup.sh è„šæœ¬å¯ä»¥ç›´æŽ¥å¯åŠ¨tomcatæœåŠ¡ ./startup.sh 4ã€å…³é—­tomcatæœåŠ¡æ–¹å¼ä¸€ï¼šå¯ä»¥ç”¨shutdown.shå‘½ä»¤ æ–¹å¼äºŒï¼šps -ef | grep tomcat æŸ¥çœ‹å‡ºtomcatè¿›ç¨‹å·åŽï¼Œç”¨killå‘½ä»¤ 5ã€éªŒè¯å…ˆæŠŠé˜²ç«å¢™å…³äº†ï¼ˆservice iptables stopï¼‰ï¼Œç„¶åŽè®¿é—®è™šæ‹ŸæœºIPçš„8080ç«¯å£]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>ç³»ç»Ÿå­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxç³»ç»ŸCentOS 6]]></title>
    <url>%2F2019%2F01%2F11%2FLinux%E7%B3%BB%E7%BB%9FCentOS%206%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å®‰è£… èµ„æºå‡†å¤‡ï¼š CentOS-6.6-x86_64-minimal.isoï¼ˆç®€æ˜“è¿·ä½ ç‰ˆï¼‰ ï¼š CentOS-6.7-x86_64-bin-DVD1.isoï¼ˆå®Œæ•´ç‰ˆï¼‰ï¼š 1ã€ç‚¹å‡»æ–°å»ºè™šæ‹Ÿæœºimg 2ã€é€‰æ‹©å…¸åž‹ã€‚ï¼ˆä¸“ä¸šäººå£«ä½¿ç”¨çš„è¯å»ºè®®é€‰æ‹©é«˜çº§ï¼‰img 3. é€‰æ‹©ç¨åŽå®‰è£…æ“ä½œç³»ç»Ÿimg 4. é€‰æ‹©æ“ä½œç³»ç»Ÿç±»åž‹ï¼Œé€‰æ‹©linux,centos 64ä½img 5. é€‰æ‹©è™šæ‹Ÿæœºå®‰è£…ä½ç½®å’Œåç§°ã€‚img 6. æŒ‡å®šç£ç›˜å®¹é‡ï¼Œé»˜è®¤20GBã€‚img 7. é€‰æ‹©è‡ªå®šä¹‰ç¡¬ä»¶img 8. ç‚¹å‡»CD/DVD,ç„¶åŽé€‰æ‹©æ“ä½œç³»ç»Ÿçš„ISOæ˜ åƒæ–‡ä»¶ï¼Œé€‰æ‹©å®ŒåŽï¼Œç‚¹å‡»å…³é—­ã€‚img 9.ç‚¹å‡»å®Œæˆã€‚img äºŒã€é…ç½®è™šæ‹Ÿæœº1. å¯åŠ¨è™šæ‹Ÿæœºã€‚imgæ³¨æ„ï¼šå¦‚æžœå¯åŠ¨è™šæ‹Ÿæœºæ—¶ï¼Œå‘ç”Ÿä»¥ä¸‹é—®é¢˜ï¼Œè¯´æ˜Žæ˜¯ä½ çš„ç”µè„‘é»˜è®¤æœªå¼€å¯è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ img æ­¤æ—¶ä½ åº”è¯¥æŠŠæœºå™¨é‡å¯å¹¶è¿›å…¥biosç•Œé¢ï¼ˆä¸åŒçš„æœºå™¨è¿›å…¥biosç•Œé¢çš„å¿«æ·é”®ä¸åŒï¼Œä¸€èˆ¬ä¸ºF1~F10é”®ä¸­çš„æŸä¸ªé”®ï¼Œå¦‚æžœéƒ½ä¸è¡Œï¼Œå°±å¾—è‡ªå·±ç™¾åº¦ä¸€ä¸‹ä½ çš„æœºå™¨åž‹å·è¿›å…¥biosç•Œé¢çš„å¿«æ·æ–¹å¼ï¼‰ã€‚ â€‹ å½“è¿›å…¥biosç•Œé¢åŽï¼ŒæŠŠè™šæ‹ŸæœºåŒ–é€‰é¡¹ï¼ˆvirtualization technologyï¼‰æ‰“å¼€,é€šè¿‡å›žè½¦é”®ï¼ŒæŠŠdisabledæ”¹æˆenabled,ç„¶åŽä¿å­˜å¹¶é‡å¯æœºå™¨ã€‚æˆ‘è¿™è¾¹æ˜¯æŒ‰F10ï¼Œä¸åŒæœºå™¨å¯èƒ½ä¸ä¸€æ ·ï¼Œçœ‹å³ä¸‹è§’çš„æç¤ºä¿¡æ¯ã€‚ img 2.Test Media, å¦‚æžœä¸éœ€è¦çš„è¯ï¼Œç‚¹Skipimg 3ã€å•å‡»NextæŒ‰é’®ç»§ç»­img 4. é€‰æ‹©å®‰è£…æœŸé—´æ˜¾ç¤ºçš„è¯­è¨€img 5ã€é€‰æ‹©é”®ç›˜è¯­è¨€img 6ã€é€‰æ‹©å­˜å‚¨ä»‹è´¨çš„ç±»åˆ«ã€‚å¦‚æžœæ˜¯å°†CentOS 6å®‰è£…åˆ°æœ¬åœ°ç¡¬ç›˜ä¸Šï¼Œé€‰æ‹© Basic Storage Devicesï¼Œå¦‚æžœå®‰è£…åˆ°ç½‘ç»œå­˜å‚¨ä»‹è´¨å¦‚SANsä¸Šï¼Œé€‰æ‹© Specialized Storage Devices img 7.é€‰æ‹© yes,discard any dataimg 8. è®¾å®šä¸»æœºåç§°ï¼ˆhostnameï¼‰img 9. è®¾å®šæ—¶åŒºï¼Œé€‰æ‹© Asia/Shanghaiimg 10. è®¾å®šrootå¸æˆ·çš„å¯†ç å°½é‡ä½¿ç”¨è¾ƒå¤æ‚çš„å¯†ç å®‰è£…ï¼ˆæ ¹æ®å®žé™…æƒ…å†µï¼Œå¯†ç ç®€å•æ—¶ï¼Œä¼šæœ‰æç¤ºï¼Œç‚¹å‡»user anyway å°±è¡Œï¼‰ img 11. é€‰æ‹©å®‰è£…ç±»åž‹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹© â€œUse All Spaceâ€ img 12. é€‰æ‹© â€œWrite changes to diskâ€ï¼Œå°†åˆ†åŒºæ•°æ®å†™å…¥ç¡¬ç›˜img 13. å¼€å§‹å®‰è£…ï¼Œæ­¤æ—¶åªéœ€ç­‰å¾…å³å¯img 14. å®‰è£…å®Œç»“åŽï¼Œç‚¹å‡»RebootæŒ‰é’®img]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>CentOS 6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hiveå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F11%2FHive%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€Hiveæ˜¯ä»€ä¹ˆï¼Ÿ1ã€åŸºäºŽ Hadoop çš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…· å¯ä»¥å°†ç»“æž„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ hiveæ•°æ®åº“è¡¨ï¼› è¿™å¼ Hiveæ•°æ®åº“è¡¨ä¿å­˜ä¸äº†metadataå…ƒæ•°æ®ä¿¡æ¯ï¼Œè€Œæ˜¯å°†metadataå­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„MySQLï¼ˆå…³ç³»åž‹æ•°æ®åº“ï¼‰ä¸­ å¹¶æä¾›ç®€å•çš„ sql æŸ¥è¯¢åŠŸèƒ½ï¼› å¯ä»¥å°† sql è¯­å¥è½¬æ¢ä¸º MapReduce ä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚ 2ã€å¿«é€Ÿå®žçŽ°ç®€å•çš„MapReduce ç»Ÿè®¡çš„å·¥å…· æ–¹ä¾¿éžJavaç¼–ç¨‹è€…å¯¹HDFSçš„æ•°æ®åšmapreduceæ“ä½œï¼› å­¦ä¹ æˆæœ¬ä½Žï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æžã€‚ 3ã€ä»€ä¹ˆæ˜¯æ•°æ®ä»“åº“ï¼Ÿ Data Warehouse(DW æˆ–DWHï¼‰æ˜¯ä¸ºä¼ä¸šæ‰€æœ‰çº§åˆ«çš„å†³ç­–åˆ¶å®šè¿‡ç¨‹ï¼Œæä¾›æ‰€æœ‰ç±»åž‹æ•°æ®æ”¯æŒçš„æˆ˜ç•¥é›†åˆã€‚ å•ä¸ªæ•°æ®å­˜å‚¨ï¼Œå‡ºäºŽåˆ†æžæ€§æŠ¥å‘Šå’Œå†³ç­–æ”¯æŒç›®çš„è€Œåˆ›å»ºã€‚ ä¸ºéœ€è¦ä¸šåŠ¡æ™ºèƒ½çš„ä¼ä¸šï¼Œæä¾›æŒ‡å¯¼ä¸šåŠ¡æµç¨‹æ”¹è¿›ã€ç›‘è§†æ—¶é—´ã€æˆæœ¬ã€è´¨é‡ä»¥åŠæŽ§åˆ¶. æ•°æ®ä»“åº“æ˜¯ç”¨æ¥åšæŸ¥è¯¢åˆ†æžçš„æ•°æ®åº“ï¼ŒåŸºæœ¬ä¸ç”¨æ¥åšæ’å…¥ï¼Œä¿®æ”¹ï¼Œåˆ é™¤æ“ä½œã€‚ 4ã€æ•°æ®å¤„ç†çš„ä¸¤å¤§åˆ†ç±»oltp+olap è”æœºäº‹åŠ¡å¤„ç†OLTPï¼ˆon-line transaction processingï¼‰ OLTPæ˜¯ä¼ ç»Ÿçš„å…³ç³»åž‹æ•°æ®åº“çš„ä¸»è¦åº”ç”¨ï¼Œä¸»è¦æ˜¯åŸºæœ¬çš„ã€æ—¥å¸¸çš„äº‹åŠ¡å¤„ç†ï¼Œä¾‹å¦‚é“¶è¡Œäº¤æ˜“ã€‚ OLTPç³»ç»Ÿå¼ºè°ƒæ•°æ®åº“å†…å­˜æ•ˆçŽ‡ï¼Œå¼ºè°ƒå†…å­˜å„ç§æŒ‡æ ‡çš„å‘½ä»¤çŽ‡ï¼Œå¼ºè°ƒç»‘å®šå˜é‡ï¼Œå¼ºè°ƒå¹¶å‘æ“ä½œï¼› è”æœºåˆ†æžå¤„ç†OLAPï¼ˆOn-Line Analytical Processingï¼‰ OLAPæ˜¯æ•°æ®ä»“åº“ç³»ç»Ÿçš„ä¸»è¦åº”ç”¨ï¼Œæ”¯æŒå¤æ‚çš„åˆ†æžæ“ä½œï¼Œä¾§é‡å†³ç­–æ”¯æŒï¼Œå¹¶ä¸”æä¾›ç›´è§‚æ˜“æ‡‚çš„æŸ¥è¯¢ç»“æžœã€‚ OLAPç³»ç»Ÿåˆ™å¼ºè°ƒæ•°æ®åˆ†æžï¼Œå¼ºè°ƒSQLæ‰§è¡Œå¸‚åœºï¼Œå¼ºè°ƒç£ç›˜I/Oï¼Œå¼ºè°ƒåˆ†åŒºç­‰ã€‚ æ•°æ®æ–‡ä»¶æŒ‰ç»“æž„çš„åˆ†ç±» ç»“æž„åŒ–æ•°æ®ï¼šå…³ç³»åž‹ åŠç»“æž„åŒ–æ•°æ®ï¼šK-V æ¾æ•£åž‹ï¼š äºŒã€Hiveæž¶æž„åŽŸç†ç”¨æˆ·æŽ¥å£ä¸»è¦æœ‰ä¸‰ä¸ªï¼šCLIï¼ŒClient å’Œ WUIã€‚ ä¸‰ã€Hiveæ­å»ºåŠä¸‰ç§æ¨¡å¼1ã€Hiveçš„å®‰è£…é…ç½®ï¼šï¼ˆ1ï¼‰åŸºæœ¬çŽ¯å¢ƒï¼šHadoopé›†ç¾¤çŽ¯å¢ƒï¼ˆè‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼‰ Hiveæ˜¯ä¾èµ–äºŽhadoopç³»ç»Ÿçš„ï¼Œå› æ­¤åœ¨è¿è¡ŒHiveä¹‹å‰éœ€è¦ä¿è¯å·²ç»æ­å»ºå¥½hadoopé›†ç¾¤çŽ¯å¢ƒã€‚ ï¼ˆ2ï¼‰å®‰è£…ä¸€ä¸ªå…³ç³»åž‹æ•°æ®mysql å› ä¸ºHiveæ•°æ®ä»“åº“çš„å…ƒæ•°æ®ä¿¡æ¯æ˜¯å­˜æ”¾åœ¨æœ¬åœ°ç£ç›˜çš„å…³ç³»æ•°æ®åº“ä¸Šçš„ å®‰è£…æ­¥éª¤ï¼šè¯¦è§ â€œLinuxç³»ç»Ÿæ•°æ®åº“MySQLå®‰è£….mdâ€ ï¼ˆ3ï¼‰è§£åŽ‹å®‰è£…ï¼ˆæŒ‰éœ€åœ¨æŒ‡å®šèŠ‚ç‚¹ä¸Šï¼‰ è§£åŽ‹apache-hive-1.2.1-bin.tar.gz ï¼ˆ4ï¼‰è¿½åŠ é…ç½®çŽ¯å¢ƒå˜é‡ vim ~/.bash_profile 1234HIVE_HOME=Hiveçš„è§£åŽ‹è·¯å¾„HIVE_HOME=/usr/soft/apache-hive-1.2.1-binexport PATH=$PATH:$HIVE_HOME/bin ï¼ˆ5ï¼‰æ›¿æ¢å’Œæ·»åŠ ç›¸å…³jaråŒ… ä¿®æ”¹HADOOP_HOME/share/hadoop/yarn/libç›®å½•ä¸‹çš„jline-*.jar å°†å…¶æ›¿æ¢æˆHIVE_HOME/libä¸‹çš„jline-2.12.jarã€‚ â€“å°†å¦‚ä¸‹(hiveè¿žæŽ¥mysql)çš„jaråŒ…æ‹·è´åˆ°hiveè§£åŽ‹ç›®å½•çš„libç›®å½•ä¸‹ mysql-connector-java-5.1.32-bin.jar ï¼ˆ6ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆé€‰æ‹©3ç§æ¨¡å¼é‡Œå“ªä¸€ç§ï¼‰è§ä¸‰ç§å®‰è£…æ¨¡å¼ ï¼ˆ7ï¼‰å¯åŠ¨ hive 2ã€ä¸‰ç§æ¨¡å¼ ä¸‰ç§æ¨¡å¼ Aã€å†…åµŒæ¨¡å¼ï¼ˆå…ƒæ•°æ®ä¿å­˜åœ¨å†…åµŒçš„derbyä¸­ï¼Œå…è®¸ä¸€ä¸ªä¼šè¯é“¾æŽ¥ï¼Œå°è¯•å¤šä¸ªä¼šè¯é“¾æŽ¥æ—¶ä¼šæŠ¥é”™ï¼‰ã€äº†è§£ã€‘ Bã€æœ¬åœ°æ¨¡å¼ï¼ˆæœ¬åœ°å®‰è£…mysql æ›¿ä»£derbyå­˜å‚¨å…ƒæ•°æ®ï¼‰ã€é‡è¦ã€‘ Cã€è¿œç¨‹æ¨¡å¼ï¼ˆè¿œç¨‹å®‰è£…mysql æ›¿ä»£derbyå­˜å‚¨å…ƒæ•°æ®ï¼‰ã€é‡è¦ã€‘ ï¼ˆ1ï¼‰å†…åµŒDerbyå•ç”¨æˆ·æ¨¡å¼ï¼ˆäº†è§£ï¼‰ å…ƒæ•°æ®æ˜¯å†…åµŒåœ¨Derbyæ•°æ®åº“ä¸­çš„ï¼Œåªèƒ½å…è®¸ä¸€ä¸ªä¼šè¯è¿žæŽ¥ï¼Œæ•°æ®ä¼šå­˜æ”¾åˆ°HDFSä¸Šã€‚ å­˜å‚¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦hive-site.xml æ³¨ï¼šä½¿ç”¨ derbyå­˜å‚¨æ–¹å¼æ—¶ï¼Œè¿è¡Œ hive ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ª derby æ–‡ä»¶å’Œä¸€ä¸ªmetastore_db hive-site.xml ï¼š 1234567891011121314151617181920212223242526272829303132&lt;?xml version="1.0"?&gt;&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;&lt;configuration&gt;&lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;&lt;value&gt;jdbc:derby:;databaseName=metastore_db;create=true&lt;/value&gt; &lt;/property&gt;&lt;property&gt;&lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;&lt;value&gt;org.apache.derby.jdbc.EmbeddedDriver&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hive.metastore.local&lt;/name&gt;&lt;value&gt;true&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;&lt;value&gt;/user/hive/warehouse&lt;/value&gt;&lt;/property&gt;&lt;/configuration&gt; ï¼ˆ2ï¼‰æœ¬åœ°ç”¨æˆ·æ¨¡å¼ï¼ˆé‡è¦ï¼Œå¤šç”¨äºŽæœ¬åœ°å¼€å‘æµ‹è¯•ï¼‰ ä¸ŽåµŒå…¥å¼çš„åŒºåˆ« ä¸å†ä½¿ç”¨å†…åµŒçš„Derbyä½œä¸ºå…ƒæ•°æ®çš„å­˜å‚¨ä»‹è´¨ï¼Œè€Œæ˜¯ä½¿ç”¨å…¶ä»–æ•°æ®åº“æ¯”å¦‚MySQLæ¥å­˜å‚¨å…ƒæ•°æ®ä¸”æ˜¯ä¸€ä¸ªå¤šç”¨æˆ·çš„æ¨¡å¼ï¼Œè¿è¡Œå¤šä¸ªç”¨æˆ·clientè¿žæŽ¥åˆ°ä¸€ä¸ªæ•°æ®åº“ä¸­ã€‚è¿™ç§æ–¹å¼ä¸€èˆ¬ä½œä¸ºå…¬å¸å†…éƒ¨åŒæ—¶ä½¿ç”¨Hiveã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªå‰æï¼Œæ¯ä¸€ä¸ªç”¨æˆ·å¿…é¡»è¦æœ‰å¯¹MySQLçš„è®¿é—®æƒåˆ©ï¼Œå³æ¯ä¸€ä¸ªå®¢æˆ·ç«¯ä½¿ç”¨è€…éœ€è¦çŸ¥é“MySQLçš„ç”¨æˆ·åå’Œå¯†ç æ‰è¡Œã€‚ éœ€è¦åœ¨æœ¬åœ°è¿è¡Œä¸€ä¸ª mysql æœåŠ¡å™¨ åœ¨node00ä¸Šï¼ˆä¸ŽMySQLåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼‰è§£åŽ‹å®‰è£…Hive MySQL Hive : node00 éœ€è¦å°† mysql çš„ jar åŒ…ï¼ˆmysql-connector-java-5.1.32-bin.jarï¼‰æ‹·è´åˆ°$HIVE_HOME/lib ç›®å½•ä¸‹ hive-site.xml 12345678910111213141516171819202122232425262728&lt;?xml version="1.0"?&gt;&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive_local/warehouse&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://node00/hive_remote?createDatabaseIfNotExist=true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123456&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ï¼ˆ3ï¼‰è¿œç¨‹æ¨¡å¼ï¼ˆé‡è¦ï¼‰ remote ä¸€ä½“ å°†Hiveè§£åŽ‹å®‰è£…ä¸ŽMySQLä¸åŒçš„èŠ‚ç‚¹ä¸Š MySQL ï¼šnode00 Hive ï¼š node02 éœ€è¦åœ¨ HiveæœåŠ¡å™¨å¯åŠ¨ metaæœåŠ¡ hive-site.xml (hadoop 2.6.5) 12345678910111213141516171819202122232425262728&lt;?xml version="1.0"?&gt;&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive1/warehouse&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://node02:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123456&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; å¦‚æžœåœ¨hadoop5.XçŽ¯å¢ƒä¸‹è¿˜éœ€è¦æ·»åŠ  1234&lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://node01:9083&lt;/value&gt;&lt;/property&gt; æ³¨ï¼šè¿™é‡ŒæŠŠhiveçš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æ”¾åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šäº†ã€‚æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯ä»¥æ‹†å¼€ Remote åˆ†å¼€(å…¬å¸ä¼ä¸šç»å¸¸ç”¨) å°† hive-site.xml é…ç½®æ–‡ä»¶æ‹†ä¸ºå¦‚ä¸‹ä¸¤éƒ¨åˆ†ï¼ˆæ­¤æ—¶ä¸ä¸ŽMySQLåœ¨åŒä¸€å°èŠ‚ç‚¹ä¸Šï¼‰ MySql ï¼š node00 æœåŠ¡ç«¯ ï¼š node02 å®¢æˆ·ç«¯ ï¼š node01 1ï¼‰ã€æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ï¼ˆnode02ï¼‰ hive-site.xml 123456789101112131415161718192021222324&lt;?xml version="1.0"?&gt;&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;&lt;configuration&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive2/warehouse&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; &lt;value&gt;jdbc:mysql://node00:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt; &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt; &lt;value&gt;123456&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; 2ï¼‰ã€å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ï¼ˆnode01ï¼‰ hive-site.xml 1234567891011121314151617181920212223242526272829303132&lt;?xml version="1.0"?&gt;&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt; &lt;configuration&gt; &lt;property&gt; &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt; &lt;value&gt;/user/hive2/warehouse&lt;/value&gt; &lt;!--æ³¨æ„è¿™é‡Œçš„è·¯å¾„è¦å’ŒæœåŠ¡ç«¯ä¸€è‡´---&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.local&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.metastore.uris&lt;/name&gt; &lt;value&gt;thrift://node02:9083&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; æœåŠ¡ç«¯å¯åŠ¨ hive ç¨‹åº hive â€“service metastore å®¢æˆ·ç«¯ç›´æŽ¥ä½¿ç”¨ hive å‘½ä»¤å³å¯ Hiveå¸¸è§é—®é¢˜æ€»æ±‡ï¼šhttp://blog.csdn.net/freedomboy319/article/details/44828337 å››ã€HQLè¯¦è§£Hql å°±æ˜¯HiveQlè¯­å¥ 1ã€DDLè¯­å¥ï¼ˆæ•°æ®åº“å®šä¹‰è¯­è¨€ï¼‰ï¼ˆ1ï¼‰å…·ä½“å‚è§ï¼šhttps://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDLHiveçš„æ•°æ®å®šä¹‰è¯­è¨€ ï¼ˆLanguageManual DDL;)ï¼‰ é‡ç‚¹ hive çš„å»ºè¡¨è¯­å¥å’Œåˆ†åŒºã€‚ ï¼ˆ2ï¼‰åˆ›å»º/åˆ é™¤/ä¿®æ”¹/ä½¿ç”¨æ•°æ®åº“ åˆ›å»ºæ•°æ®åº“ ï¼ˆHiveæ­å»ºå®Œæ¯•åŽï¼Œä¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤çš„æ•°æ®åº“ï¼‰ æŸ¥çœ‹ show databasesï¼› CREATE (DATABASE|SCHEMA) [IF NOT EXISTS] database_name [COMMENT database_comment]; ä¸¾ä¾‹ï¼š create database attribute; create database attr; æ³¨æ„ï¼šåˆ›å»ºæ•°æ®æ—¶ï¼Œæ•°æ®åº“åä¸è¦å’Œç³»ç»Ÿå…³é”®å­—å†²çªï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼› å¦‚ä¸‹ï¼š 123456789101112131415161718192021å‘½ä»¤ï¼šhive&gt; create database out;æŠ¥é”™ï¼šFAILED: ParseException line 1:16 Failed to recognize predicate 'out'. Failed rule: 'identifier' in create database statementåŽŸå› ï¼šåœ¨Hive1.2.0ç‰ˆæœ¬å¼€å§‹å¢žåŠ äº†å¦‚ä¸‹é…ç½®é€‰é¡¹ï¼Œé»˜è®¤å€¼ä¸ºtrueï¼šhive.support.sql11.reserved.keywordsè¯¥é€‰é¡¹çš„ç›®çš„æ˜¯ï¼šæ˜¯å¦å¯ç”¨å¯¹SQL2011ä¿ç•™å…³é”®å­—çš„æ”¯æŒã€‚ å¯ç”¨åŽï¼Œå°†æ”¯æŒéƒ¨åˆ†SQL2011ä¿ç•™å…³é”®å­—ã€‚è§£å†³ï¼šæ³•ä¸€ï¼šå¼ƒç”¨è¿™ä¸ªå…³é”®å­—ï¼Œæ¢ä¸ªåå­—æ³•äºŒï¼šå¼ƒç”¨å¯¹ä¿ç•™å…³é”®å­—çš„æ”¯æŒåœ¨confä¸‹çš„hive-site.xmlé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹é…ç½®é€‰é¡¹ï¼š&lt;property&gt; &lt;name&gt;hive.support.sql11.reserved.keywords&lt;/name&gt; &lt;value&gt;false&lt;/value&gt;&lt;/property&gt; åˆ é™¤æ•°æ®åº“ DROP (DATABASE|SCHEMA) [IF EXISTS] database_name; ä¸¾ä¾‹ï¼š drop database attribute; ä¿®æ”¹æ•°æ®åº“(äº†è§£) ALTER (DATABASE|SCHEMA) database_name SET DBPROPERTIES (property_name=property_value, â€¦); ALTER (DATABASE|SCHEMA) database_name SET OWNER [USER|ROLE] user_or_role; ä½¿ç”¨æ•°æ®åº“ ï¼ˆè¿›å…¥æŸä¸€æ•°æ®åº“ã€‚å¦‚æžœæ²¡æœ‰è¿™æ­¥æ“ä½œï¼Œä¼šè¿›å…¥é»˜è®¤defaultæ•°æ®åº“ï¼‰ USE database_name; ä¸¾ä¾‹ï¼š use attrï¼› ï¼ˆ3ï¼‰åˆ›å»º/åˆ é™¤/è¡¨ï¼ˆé‡ç‚¹ï¼‰ åˆ›å»ºè¡¨ï¼ˆé‡è¦ï¼ï¼‰ æ•°æ®ç±»åž‹ï¼š data_type : primitive_type åŽŸå§‹æ•°æ®ç±»åž‹ | array_type æ•°ç»„ | map_type map | struct_type | union_type â€“ (Note: Available in Hive 0.7.0 and later) primitive_type : TINYINT | SMALLINT | INT | BIGINT | BOOLEAN | FLOAT | DOUBLE | DOUBLE PRECISION | STRING åŸºæœ¬å¯ä»¥æžå®šä¸€åˆ‡ | BINARY | TIMESTAMP | DECIMAL | DECIMAL(precision, scale) | DATE | VARCHAR | CHAR array_type : ARRAY &lt; data_type &gt; map_type : MAP &lt; primitive_type, data_type &gt; struct_type : STRUCT &lt; col_name : data_type [COMMENT col_comment], â€¦&gt; union_type : UNIONTYPE &lt; data_type, data_type, â€¦ &gt; 1ã€å‡†å¤‡æ•°æ® 1231,zshang,18,game-girl-book,stu_addr:beijing-work_addr:shanghai2,lishi,16,shop-boy-book,stu_addr:hunan-work_addr:shanghai3,wang2mazi,20,fangniu-eat,stu_addr:shanghai-work_addr:tianjing 2ã€åˆ›å»ºè¡¨ (å¦‚æžœæ²¡æœ‰æŒ‡å®šè¿›å…¥æŸä¸€æ•°æ®åº“ï¼Œå°±ä¼šåœ¨é»˜è®¤æ•°æ®åº“ä¸­åˆ›å»º) 1234567891011create table log( id int, name string, age int, likes array&lt;string&gt;, address map&lt;string,string&gt; ) row format delimited fields terminated by &apos;,&apos; COLLECTION ITEMS TERMINATED by &apos;-&apos; map keys terminated by &apos;:&apos; lines terminated by &apos;\n&apos;; å¯¼å…¥æ•°æ®ï¼ˆå±žäºŽDMLä½†æ˜¯ä¸ºäº†æ¼”ç¤ºéœ€è¦åœ¨æ­¤åº”ç”¨ï¼‰ 123456LOAD DATA [LOCAL] INPATH &apos;filepath&apos; [OVERWRITE] INTO TABLE tablename [PARTITION (partcol1=val1, partcol2=val2 ...)] [LOCAL]:ä»Žæœ¬åœ° | è‹¥æ— ï¼Œåˆ™ä¸ºä»ŽHDFS [OVERWRITE] ï¼š ä¼šè¦†ç›–Hiveè¡¨ä¸­çš„æ•°æ® | è‹¥æ— åˆ™ä¼šè¿½åŠ  [PARTITION....] ï¼š åˆ›å»ºåˆ†åŒº å°†log1æ–‡ä»¶ä¸­çš„æ•°æ®å¡«åŠ åˆ°logè¡¨ä¸­ ï¼ˆlog1ä¸­æ•°æ®çš„æ ¼å¼è¦å’Œlogè¡¨æ ¼å¼ä¿æŒä¸€è‡´ï¼Œå¦åˆ™ä¼šä¹±ï¼›è‹¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨é‡å‘½åï¼‰ æœ¬åœ°åŠ è½½ï¼ˆç›¸å½“äºŽå¤åˆ¶ï¼‰æ•°æ®åˆ°Hiveçš„åˆ¶å®šè¡¨ä¸­ 12&gt; LOAD DATA LOCAL INPATH &apos;/root/su/log1&apos; INTO TABLE log;&gt; HDFSåŠ è½½ï¼ˆç›¸å½“äºŽå‰ªåˆ‡ï¼‰æ•°æ®åˆ°Hiveçš„åˆ¶å®šè¡¨ä¸­ 12&gt; LOAD DATA INPATH &apos;/root/su/log1&apos; INTO TABLE log ;&gt; æŸ¥çœ‹è¡¨ä¸­æ•°æ® 1234567&gt; å¯¹æœ¬è¡¨æŸ¥è¯¢ä¸ä¼šäº§ç”ŸMapReduceä»»åŠ¡&gt; hive&gt; select * from log;&gt; ä½¿ç”¨å‡½æ•°æŸ¥è¯¢ä¼šäº§ç”ŸMapReduceä»»åŠ¡&gt; hive&gt; select count(*) from log;&gt; æŸ¥è¯¢è¡¨çš„å­—æ®µä¿¡æ¯&gt; hive&gt; desc log;&gt; ç¬¬ä¸€ä¸ªæŸ¥è¯¢ç»“æžœï¼š 12341 zshang 18 [&quot;game&quot;,&quot;girl&quot;,&quot;book&quot;] &#123;&quot;stu_addr&quot;:&quot;beijing&quot;,&quot;work_addr&quot;:&quot;shanghai&quot;&#125;1 zhaoliu 18 [&quot;game&quot;,&quot;girl&quot;,&quot;book&quot;] &#123;&quot;stu_addr&quot;:&quot;beijing&quot;,&quot;work_addr&quot;:&quot;shanghai&quot;&#125;2 lishi 16 [&quot;shop&quot;,&quot;boy&quot;,&quot;book&quot;] &#123;&quot;stu_addr&quot;:&quot;hunan&quot;,&quot;work_addr&quot;:&quot;shanghai&quot;&#125;3 wang2mazi 20 [&quot;fangniu&quot;,&quot;eat&quot;] &#123;&quot;stu_addr&quot;:&quot;shanghai&quot;,&quot;work_addr&quot;:&quot;tianjing&quot;&#125; ç¬¬äºŒä¸ªæŸ¥è¯¢ç»“æžœï¼š 14 é™„åŠ é¢˜ æŸ¥è¯¢è¡¨ä¸­likeså­—æ®µä¸­æœ‰girlçš„äºº 1hive&gt; select name from log2 where likes[1]=&quot;girl&quot;; æŸ¥è¯¢è¡¨ä¸­addresså­—æ®µæœ‰stu_addrä¸ºbeijingçš„äºº 1hive&gt; select name from log2 where address[&quot;stu_addr&quot;]=&quot;beijing&quot;; 3ã€åˆ é™¤è¡¨ 12&gt; DROP TABLE [IF EXISTS] table_name [PURGE];&gt; ä¸¾ä¾‹ï¼š ï¼ˆç”¨dropå‘½ä»¤åˆ é™¤è¡¨ï¼Œä¼šå°†è¡¨ä¸­æ•°æ®ä¸€å¹¶åˆ é™¤ï¼Œå…¶å¯¹åº”åœ¨MySQlä¸­çš„è¡¨çš„å…ƒæ•°æ®ä¿¡æ¯ä¹Ÿä¼šéšä¹‹åˆ é™¤ï¼› â€‹ ç”¨hdfså‘½ä»¤åˆ é™¤è¡¨å¯¹åº”çš„æ–‡ä»¶ç›®å½•ï¼Œè¡¨ä¸­æ•°æ®ä¹Ÿä¸€å¹¶åˆ é™¤ï¼Œä½†å…¶å…ƒæ•°æ®ä¿¡æ¯ä¾ç„¶ä¿å­˜åœ¨My SQLä¸Šï¼Œ â€‹ å†loadæ•°æ®ï¼Œå¯æ¢å¤è¯¥è¡¨ï¼‰ 12&gt; drop table log1ï¼›&gt; 123456&gt; hdfs dfs -rmr /user/hive_local/warehouse/attr.db/log1&gt; &gt; hive&gt; use attr;&gt; hive&gt; LOAD DATA LOCAL INPATH &apos;/root/su/log1&apos; INTO TABLE log1;&gt; &gt; åˆ›å»ºå¤–éƒ¨è¡¨ï¼ˆé‡è¦ï¼‰ å¤–éƒ¨å…³é”®å­—EXTERNALå…è®¸æ‚¨åˆ›å»ºä¸€ä¸ªè¡¨,å¹¶æä¾›ä¸€ä¸ªä½ç½®,ä»¥ä¾¿hiveä¸ä½¿ç”¨è¿™ä¸ªè¡¨çš„é»˜è®¤ä½ç½®ã€‚è¿™æ–¹ä¾¿å¦‚æžœä½ å·²ç»ç”Ÿæˆäº†æ•°æ®ï¼Œå½“åˆ é™¤ä¸€ä¸ªå¤–éƒ¨è¡¨,è¡¨ä¸­çš„æ•°æ®ä¸ä¼šä»Žæ–‡ä»¶ç³»ç»Ÿä¸­åˆ é™¤ã€‚å¤–éƒ¨è¡¨æŒ‡å‘ä»»ä½•HDFSçš„å­˜å‚¨ä½ç½®,è€Œä¸æ˜¯å­˜å‚¨åœ¨é…ç½®å±žæ€§æŒ‡å®šçš„æ–‡ä»¶å¤¹ hive.metastore.warehouse.dir;).ä¸­ åˆ›å»ºè¡¨ï¼š 1234567891011create EXTERNAL table log1( id int, name string, age int, likes array&lt;string&gt;, address map&lt;string,string&gt; ) row format delimited fields terminated by &apos;,&apos; COLLECTION ITEMS TERMINATED by &apos;-&apos; map keys terminated by &apos;:&apos; lines terminated by &apos;\n&apos;; åŠ è½½æ•°æ®ï¼š 1LOAD DATA LOCAL INPATH &apos;/root/su/log1&apos; INTO TABLE log1; åˆ é™¤å¤–éƒ¨è¡¨ï¼ˆç›¸å½“äºŽåˆ é™¤çš„æ˜¯è¡¨çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œè€Œè¡¨ä¸­çš„æ•°æ®è¿˜ä¿å­˜ï¼‰ 1drop table log1ï¼› ç»“æžœï¼š hive&gt; show tables; æ— log1 MySQlä¸­ä¹Ÿæ— æ­¤è¡¨å…ƒæ•°æ®ä¿¡æ¯ ä½†æ˜¯ï¼Œ åœ¨HDFSæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ­¤è¡¨æ•°æ®ä¾ç„¶å­˜åœ¨ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯è¡¨è¿˜å¯ä»¥æ¢å¤ æ¢å¤è¡¨ï¼š 1é‡æ–°åˆ›å»ºlog1è¡¨ï¼Œè¯¥è¡¨å³å¯æ¢å¤ ï¼ˆ4ï¼‰ä¿®æ”¹è¡¨,æ›´æ–°ï¼Œåˆ é™¤æ•°æ®(è¿™äº›å¾ˆå°‘ç”¨)é‡å‘½åè¡¨ 1234&gt; ALTER TABLE table_name RENAME TO new_table_name;&gt; &gt; Eg: alter table meninem rename to jacke;&gt; æ›´æ–°æ•°æ® 1UPDATE tablename SET column = value [, column = value ...][WHERE expression] åˆ é™¤æ•°æ® 1DELETE FROM tablename [WHERE expression] 2ã€DMLè¯­å¥ï¼ˆæ•°æ®åº“ç®¡ç†è¯­è¨€ï¼‰ï¼ˆ1ï¼‰å…·ä½“å‚è§ï¼šhttps://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML é‡ç‚¹æ˜¯æ•°æ®åŠ è½½å’ŒæŸ¥è¯¢æ’å…¥è¯­æ³• Hiveæ•°æ®æ“ä½œè¯­è¨€ï¼ˆLanguageManual DML;)ï¼‰ ï¼ˆ2ï¼‰å››ç§æ’å…¥/å¯¼å…¥æ•°æ®(é‡è¦) Hiveä¸èƒ½å¾ˆå¥½çš„æ”¯æŒç”¨insertè¯­å¥ä¸€æ¡ä¸€æ¡çš„è¿›è¡Œæ’å…¥æ“ä½œï¼Œä¸æ”¯æŒupdateæ“ä½œã€‚æ•°æ®æ˜¯ä»¥loadçš„æ–¹å¼åŠ è½½åˆ°å»ºç«‹å¥½çš„è¡¨ä¸­ã€‚æ•°æ®ä¸€æ—¦å¯¼å…¥å°±ä¸å¯ä»¥ä¿®æ”¹ã€‚ 1234567create table log3( id int, name string, age int ) row format delimited fields terminated by &apos;,&apos; lines terminated by &apos;\n&apos;; 1.ç›´æŽ¥åŠ è½½æ•°æ®12LOAD DATA [LOCAL] INPATH &apos;filepath&apos; [OVERWRITE] INTO TABLE tablename [PARTITION (partcol1=val1, partcol2=val2 ...)]load data local inpath &apos;/root/su/log1&apos; into table log1; 2.å°†è¡¨1æŸ¥è¯¢ç»“æžœæ’å…¥è¡¨2æ³¨æ„ï¼šæŸ¥è¯¢ç»“æžœçš„å­—æ®µä¸ªæ•°ã€ç±»åž‹ è¦ä¸Žæ’å…¥çš„è¡¨çš„å­—æ®µä¸€ ä¸€åŒ¹é…å¯¹åº” 1234567åˆ›å»ºperson2è¡¨ï¼Œç„¶åŽä»Žè¡¨person1æŸ¥è¯¢æ•°æ®å¯¼å…¥ï¼šè¦†ç›–ï¼šINSERT OVERWRITE TABLE person2 [PARTITION(dt=&apos;2008-06-08&apos;, country)] SELECT id,name, age From ppt;è¿½åŠ ï¼šINSERT INTO TABLE log3 SELECT id,name, age From log; 3.å°†è¡¨1ã€è¡¨2æŸ¥è¯¢ç»“æžœæ’å…¥è¡¨3ã€è¡¨4æ³¨æ„ï¼šæŸ¥è¯¢ç»“æžœçš„å­—æ®µä¸ªæ•°ã€ç±»åž‹ è¦ä¸Žæ’å…¥çš„è¡¨çš„å­—æ®µä¸€ ä¸€åŒ¹é…å¯¹åº” 1234567891011121314FROM person t1INSERT OVERWRITE | INTO TABLE person1 [PARTITION(dt=&apos;2008-06-08&apos;, country)] SELECT t1.id, t1.name, t1.age ; FROM log t1,log1 t2 INSERT OVERWRITE TABLE log4 SELECT t1.id,t1.name,t2.age ; æ˜¯å¦å­˜åœ¨ç¬›å¡å°”ç§¯ï¼šï¼Ÿï¼Ÿï¼Ÿï¼Ÿå­˜åœ¨ã€‚ ä¸ºäº†é˜²æ­¢ç¬›å¡å°”ç§¯ï¼š FROM log t1,log1 t2 INSERT OVERWRITE TABLE log4 SELECT t1.id,t1.name,t2.age where t1.id =t2.id; 1234ã€fromæ”¾å‰é¢å¥½å¤„å°±æ˜¯åŽé¢å¯ä»¥æ’å…¥å¤šæ¡è¯­å¥ ã€‘FROM abc t1,sufei t2 INSERT OVERWRITE TABLE qidu SELECT t1.id,t1.name,t1.age,t2.likes,t2.address ; 12345FROM abc t1,sufei t2 INSERT OVERWRITE TABLE qidu SELECT t1.id,t1.name,t1.age,t1.likes,t1.address whereâ€¦INSERT OVERWRITE TABLE wbb SELECT t2.id,t2.name,t2.age,t2.likes,t2.address whereâ€¦; 4.ç›´æŽ¥åˆ—å‡ºæ•°æ®æ’å…¥è¡¨ä¸­ï¼ˆå¤§é‡æ•°æ®æ—¶ä¸æŽ¨èï¼‰æ³¨æ„ï¼šæŸ¥è¯¢ç»“æžœçš„å­—æ®µä¸ªæ•°ã€ç±»åž‹ è¦ä¸Žæ’å…¥çš„è¡¨çš„å­—æ®µä¸€ ä¸€åŒ¹é…å¯¹åº” 12INSERT INTO TABLE students VALUES (1,&apos;zs&apos;,18,&apos;boy&apos;,&apos;beijng&apos;),(2,&apos;wh&apos;,&apos;girl&apos;,&apos;stu_addr&apos;:shanghai&apos;); æœ¬åœ°loadæ•°æ®å’Œä»ŽHDFSä¸ŠloadåŠ è½½æ•°æ®çš„è¿‡ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æœ¬åœ°ï¼š local ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°HDFSä¸Šçš„hiveçš„**ç›®å½•ä¸‹ Hdfså¯¼å…¥ åŽç§»åŠ¨åˆ°hiveçš„**ç›®å½•ä¸‹ ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®å¹¶ä¿å­˜ ä¿å­˜æ•°æ®åˆ°æœ¬åœ°ï¼š 123456789101112insert overwrite local directory &apos;/opt/datas/hive_exp_emp2&apos; ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;,&apos; select * from db_1128.emp ;ç•™æ„ä¸¤ç§çš„åŒºåˆ«ï¼šä¿å­˜çš„æ•°æ®æ ¼å¼insert overwrite local directory &apos;/sun/temp/hive_save1&apos; row format delimited fields terminated by &apos;,&apos; COLLECTION ITEMS TERMINATED by &apos;-&apos; map keys terminated by &apos;:&apos; select * from log2 ; è¿™é‡Œå¦‚æžœå°† overwrite æ”¹ä¸ºinto ä¼šæŠ¥é”™ã€‚ 12//æŸ¥çœ‹æ•°æ®!cat /sun/temp/hive_save1/000000_0; ä¿å­˜æ•°æ®åˆ°HDFSä¸Šï¼š 12345678910insert overwrite directory &apos;/user/beifeng/hive/hive_exp_emp&apos; select * from db_1128.emp ;insert overwrite directory &apos;/sun/hive/temp/hive_save1&apos; row format delimited fields terminated by &apos;,&apos; COLLECTION ITEMS TERMINATED by &apos;-&apos; map keys terminated by &apos;:&apos; select * from log2 ; è¿™é‡Œå¦‚æžœå°† overwrite æ”¹ä¸ºinto ä¼šæŠ¥é”™ã€‚ åœ¨å¤–éƒ¨shellä¸­å°†æ•°æ®é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ï¼š 123(æ³¨æ„ï¼šéœ€è¦æŒ‡æ˜Žæ˜¯å“ªä¸ªæ•°æ®åº“çš„è¡¨)# hive -e &quot;select * from attr.log;&quot; &gt; /sun/hive/temp/hive_save2# cat /sun/hive/temp/hive_save2 ï¼ˆ4ï¼‰å¤‡ä»½æ•°æ®æˆ–è¿˜åŽŸæ•°æ®ï¼ˆåœ¨HDFSä¸Šï¼‰ å¤‡ä»½æ•°æ®ï¼ˆåŒ…æ‹¬è¡¨çš„å…ƒæ•°æ®å’Œè¡¨ä¸­çš„æ•°æ®ï¼‰ï¼š 1EXPORT TABLE log to &apos;/sun/hive/datas/export/cp1&apos; åˆ é™¤å†è¿˜åŽŸæ•°æ®ï¼š 12345å…ˆåˆ é™¤è¡¨ã€‚drop table log;show tables ;å†è¿˜åŽŸæ•°æ®ï¼šIMPORT FROM &apos;/sun/hive/datas/export/cp1&apos; ; ï¼ˆ5ï¼‰å…¶ä»–Hqlæ“ä½œHiveçš„group by\join(left join right joinç­‰)\having\sort by \order byç­‰æ“ä½œå’ŒMySQLæ²¡æœ‰ä»€ä¹ˆå¤§çš„åŒºåˆ«ï¼šhttp://www.2cto.com/kf/201609/545560.html 3ã€Hive SerDeï¼ˆåºåˆ—åŒ–ã€ååºåˆ—åŒ–ï¼‰(1)å®šä¹‰Hive SerDe - Serializer and Deserializer SerDe ç”¨äºŽåšåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ æž„å»ºåœ¨æ•°æ®å­˜å‚¨å’Œæ‰§è¡Œå¼•æ“Žä¹‹é—´ï¼Œå¯¹ä¸¤è€…å®žçŽ°è§£è€¦ã€‚ å¯¹æ•°æ®å®žçŽ°åºåˆ—åŒ–ï¼Œæ¸…æ´—æ•°æ®ï¼Œä½¿ä¹‹æˆä¸ºæœ‰æ•ˆæ•°æ®å¹¶åŠ è½½ã€‚ Hiveé€šè¿‡ROW FORMAT DELIMITEDä»¥åŠSERDEè¿›è¡Œå†…å®¹çš„è¯»å†™ã€‚ ï¼ˆ2ï¼‰å®žçŽ°1234567row_format: DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS TERMINATED BY char] [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char] : SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, property_name=property_value, ...)] 1234567891011121314151617181920212223242526272829303132Hiveæ­£åˆ™åŒ¹é…ï¼ˆå®žçŽ°æ•°æ®æ¸…æ´—ï¼‰åˆ›å»ºè¡¨ logtblï¼š CREATE TABLE logtbl ( host STRING, identity STRING, t_user STRING, time STRING, request STRING, referer STRING, agent STRING) ROW FORMAT SERDE &apos;org.apache.hadoop.hive.serde2.RegexSerDe&apos; WITH SERDEPROPERTIES ( &quot;input.regex&quot;=&quot;([^ ]*) ([^ ]*) ([^ ]*) \\[(.*)\\] \&quot;(.*)\&quot; (-|[0-9]*) (-|[0-9]*)&quot;) STORED AS TEXTFILE; åŠ è½½æ•°æ®:load data local inpath &apos;/root/su/localhost_access_log.2016-02-29&apos; into table logtbl;æŸ¥çœ‹æ•°æ®ï¼šselect * from logtbl;æ˜¾ç¤ºï¼š192.168.57.4 - - 29/Feb/2016:18:14:35 +0800 GET /bg-upper.png HTTP/1.1 304 -192.168.57.4 - - 29/Feb/2016:18:14:35 +0800 GET /bg-nav.png HTTP/1.1 304 -192.168.57.4 - - 29/Feb/2016:18:14:35 +0800 GET /asf-logo.png HTTP/1.1 304 -...(çœç•¥ã€‚ã€‚ã€‚) è¡¨æ•°æ®è§æ•°æ®æ–‡ä»¶ï¼šlocalhost_access_log.2016-02-29.txt 12345678910111213141516171819202122192.168.57.4 - - [29/Feb/2016:18:14:35 +0800] &quot;GET /bg-upper.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:35 +0800] &quot;GET /bg-nav.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:35 +0800] &quot;GET /asf-logo.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:35 +0800] &quot;GET /bg-button.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:35 +0800] &quot;GET /bg-middle.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET / HTTP/1.1&quot; 200 11217192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET / HTTP/1.1&quot; 200 11217192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.css HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /asf-logo.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-middle.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-button.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-nav.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-upper.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET / HTTP/1.1&quot; 200 11217192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.css HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET / HTTP/1.1&quot; 200 11217192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.css HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /tomcat.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-button.png HTTP/1.1&quot; 304 -192.168.57.4 - - [29/Feb/2016:18:14:36 +0800] &quot;GET /bg-upper.png HTTP/1.1&quot; 304 - äº”ã€Beelineå’ŒHiveserver2ï¼ˆHiveçš„å‡çº§ï¼‰1ã€Hiveserver2ç›´æŽ¥å¯åŠ¨ï¼ˆåªèƒ½åœ¨æœåŠ¡ç«¯å¯åŠ¨ï¼Œç›¸å½“äºŽæœåŠ¡ç«¯ï¼‰1# ./hiveserver2 è‹¥å·²ç»é…ç½®çŽ¯å¢ƒå˜é‡åˆ™å¯åŠ¨æ–¹å¼ä¸ºï¼š 1# hivesever2 2ã€å¯åŠ¨ beelineï¼ˆå¯åœ¨æœåŠ¡ç«¯|å®¢æˆ·ç«¯å¯åŠ¨ï¼Œç›¸å½“äºŽå®¢æˆ·ç«¯ï¼‰ å› ä¸ºbeelineæ˜¯åœ¨Hiveå®‰è£…ç›®å½•çš„/binä¸‹ï¼Œæ‰€ä»¥åªè¦æœ‰hiveåŒ…éƒ½å¯ä»¥å¯åŠ¨ 1234567891011121314151617181920212223242526272829303132333435363738# ./beelinebeeline&gt; !connect jdbc:hive2://node00:10000 root 123456æ˜¾ç¤ºï¼šConnecting to jdbc:hive2://node00:10000Connected to: Apache Hive (version 1.2.1)Driver: Hive JDBC (version 1.2.1)Transaction isolation: TRANSACTION_REPEATABLE_READ0: jdbc:hive2://node00:10000&gt;ä½¿ç”¨ï¼šåˆ—å‡ºæ•°æ®åº“0: jdbc:hive2://node00:10000&gt; show databases;+----------------+--+| database_name |+----------------+--+| attr || attribute || default |+----------------+--+3 rows selected (7.493 seconds)0: jdbc:hive2://node00:10000&gt;è€Œåœ¨æœåŠ¡ç«¯ï¼šæ˜¾ç¤ºï¼š[root@node00 ~]# hiveserver219/01/07 08:52:09 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not existOKOKOKOKé€€å‡ºï¼šæœåŠ¡ç«¯ï¼šctrl + cå®¢æˆ·ç«¯ï¼šï¼quitï¼› æˆ– ctrl + cä½œç”¨ï¼šå¯¹æ“ä½œç»“æžœæ·»åŠ äº†ç¾ŽåŒ–ã€‚ä¸è¿‡ä¸å¤ªå¸¸ç”¨ï¼Œè€—å†…å­˜ï¼Œæ•°æ®å¤§çš„æ—¶å€™ï¼Œè¿˜å½±å“é¡µé¢ã€‚ å…­ã€Hiveçš„JDBC ä¸€èˆ¬æ˜¯å¹³å°ä½¿ç”¨å±•ç¤ºæˆ–æŽ¥å£ï¼ŒæœåŠ¡ç«¯å¯åŠ¨hiveserver2åŽï¼Œåœ¨javaä»£ç ä¸­é€šè¿‡è°ƒç”¨hiveçš„jdbcè®¿é—®é»˜è®¤ç«¯å£10000è¿›è¡Œè¿žæŽ¥ã€è®¿é—® 12345678910111213141516171819public class HivejdbcClient &#123; private static String driverName = "org.apache.hive.jdbc.HiveDriver"; public static void main(String[] args)&#123; try&#123; Class.forName(driverName); &#125;catch (ClassNotFoundException)&#123; e.printStackTrace(); System.exit(1); &#125;// repalace "hive" here with the name of user the queries should run as Connection con = DriverManager.getConnection("jdbc:hive2://node00:10000/default","root","123456"); Statement stmt = con.createStatement(); String sql = "select * from log limit 0"; ResultSet rs = stmt.executeQuery(sql); while(rs.next())&#123; System.out.println(rs.getInt(1)+"-"+rs.getString("name")); &#125; &#125;&#125; ä¸ƒã€Hiveåˆ†åŒºä¸Žè‡ªå®šä¹‰å‡½æ•°UDF UDAF UDTF1ã€Hiveçš„åˆ†åŒºpartitionï¼ˆé‡è¦ï¼‰ åŠŸèƒ½ï¼š ä¸ºäº†æ–¹ä¾¿æµ·é‡æ•°æ®çš„ç®¡ç†å’ŒæŸ¥è¯¢ï¼Œå¯ä»¥å¯¹æ•°æ®å»ºç«‹åˆ†åŒºï¼ˆå¯æŒ‰æ—¥æœŸã€éƒ¨é—¨ã€ç±»åž‹ç­‰å…·ä½“ä¸šåŠ¡ï¼‰ã€‚è¿›è¡Œåˆ†é—¨åˆ«ç±»çš„ç®¡ç†ã€‚ æ³¨æ„ï¼š å¿…é¡»åœ¨å®šä¹‰è¡¨çš„æ—¶å€™åˆ›å»ºpartitionåˆ†åŒº å­˜å‚¨æ•°æ®æ—¶ï¼Œæ·»åŠ åˆ†åŒºå­—æ®µçš„æ•°æ®ï¼Œç›´æŽ¥å°†æ•°æ®æŒ‰åˆ†åŒºè¿›è¡Œå­˜å‚¨ã€‚ æ·»åŠ åˆ†åŒºæ—¶ï¼š â€‹ æ—¶é—´çš„æ ¼å¼ï¼š/ ï¼š å­˜å‚¨æ—¶ä¼šä¹±ç ï¼Œç”¨ - ä¸ä¼šã€‚ â€‹ éœ€è¦æŒ‡å®šåˆ†åŒº â€‹ å¤šä¸ªåˆ†åŒºæ—¶ï¼Œå­˜åœ¨çˆ¶å­ç›®å½•å…³ç³»ï¼ŒæŒ‰é¡ºåºå¯¹åº”ï¼Œå¯¹åº”çˆ¶å­ â€‹ åˆ›å»ºè¡¨æ—¶ï¼Œå·²ç»æŒ‡å®šåˆ†åŒºä¸ªæ•°ï¼Œå°±åªèƒ½å¡«åŠ æŒ‡å®šä¸ªæ•°çš„å­—æ®µæ•°æ® åˆ é™¤åˆ†åŒºæ—¶ï¼š â€‹ è‹¥è¯¥åˆ†åŒºæ˜¯çˆ¶åˆ†åŒºçš„æœ€åŽä¸€ä¸ªå­åŒºï¼Œåˆ™çˆ¶åˆ†åŒºä¹Ÿä¼šè¢«åˆ é™¤ â€‹ è‹¥åˆ é™¤çˆ¶åˆ†åŒºï¼Œå…¶æ‰€æœ‰å­åˆ†åŒºä¹Ÿéƒ½ä¼šå¤‡åˆ é™¤ â€‹ è‹¥åˆ é™¤çš„åˆ†åŒºï¼Œåˆ†åˆ«åœ¨å¤šä¸ªä¸åŒçˆ¶åˆ†åŒºä¸­å­˜åœ¨ï¼Œåˆ™éƒ½ä¼šè¢«åˆ é™¤ é‡å‘½ååˆ†åŒºæ—¶ï¼š â€‹ ä¿®æ”¹ä¹‹åŽçš„åå­—ä¸èƒ½æ˜¯å·²ç»å­˜åœ¨çš„ æ³¨æ„ï¼šåœ¨åˆ›å»º åˆ é™¤å¤šåˆ†åŒºç­‰æ“ä½œæ—¶ä¸€å®šè¦æ³¨æ„åˆ†åŒºçš„å…ˆåŽé¡ºåºï¼Œä»–ä»¬æ˜¯çˆ¶å­èŠ‚ç‚¹çš„å…³ç³»ã€‚åˆ†åŒºå­—æ®µä¸è¦å’Œè¡¨å­—æ®µç›¸åŒ ç±»åˆ«ï¼š å•åˆ†åŒºå’Œå¤šåˆ†åŒº é™æ€åˆ†åŒºå’ŒåŠ¨æ€åˆ†åŒº ï¼ˆ1ï¼‰åˆ›å»ºåˆ†åŒº å•åˆ†åŒºå»ºè¡¨ 123456create table day_table(id int, content string) partitioned by (dt string) row format delimited fields terminated by &apos;,&apos;; æ³¨æ„ï¼šã€å•åˆ†åŒºè¡¨ï¼ŒæŒ‰å¤©åˆ†åŒºï¼Œåœ¨è¡¨ç»“æž„ä¸­å­˜åœ¨idï¼Œcontentï¼Œdtä¸‰åˆ—ï¼›ä»¥dtä¸ºæ–‡ä»¶å¤¹åŒºåˆ†ã€‘ åŒåˆ†åŒºå»ºè¡¨ 123456create table day_hour_table (id int,content string) partitioned by (dt string, hour string) row format delimited fields terminated by &apos;,&apos;; æ³¨æ„ï¼š ã€åŒåˆ†åŒºè¡¨ï¼ŒæŒ‰å¤©å’Œå°æ—¶åˆ†åŒºï¼Œåœ¨è¡¨ç»“æž„ä¸­æ–°å¢žåŠ äº†dtå’Œhourä¸¤åˆ—ï¼›å…ˆä»¥dtä¸ºæ–‡ä»¶å¤¹ï¼Œå†ä»¥hourå­æ–‡ä»¶å¤¹åŒºåˆ†ã€‘ ï¼ˆ2ï¼‰æ·»åŠ åˆ†åŒºè¡¨çš„åˆ†åŒºï¼ˆè¡¨å·²åˆ›å»ºï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ åˆ†åŒºï¼šæŒ‰ä»€ä¹ˆåˆ†åŒºï¼‰ï¼š æ³¨æ„ï¼šæŠ¥é”™ï¼šæ­¤æ—¶æ·»åŠ ï¼Œè¦æ³¨æ„åˆ†åŒºçš„ä¸ªæ•°ç›¸å¯¹åº”ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š 1FAILED: ValidationFailureSemanticException Partition spec &#123;dt=2008-08-08, hour=08&#125; contains non-partition columns æ³¨æ„ï¼šæŠ¥é”™æ­¤æ—¶æ·»åŠ ï¼Œè¦æ³¨æ„åˆ†åŒºçš„å­—æ®µåè¦å¯¹åº”æ·»åŠ ï¼Œå¦åˆ™ä¼šä¿å¦‚ä¸‹é”™è¯¯ï¼š 1FAILED: ValidationFailureSemanticException Partition spec &#123;d=2008-08-08&#125; contains non-partition columns æ³¨æ„ï¼šä¸€å®šæ˜¯å­˜åœ¨åˆ†åŒºï¼Œæ‰å¯æ·»åŠ  æ·»åŠ åˆ†åŒºï¼š 12ALTER TABLE table_nameADD partition_spec [ LOCATION &apos;location1&apos; ] partition_spec [ LOCATION &apos;location2&apos; ] ... 123ä¾‹ï¼š ALTER TABLE day_table ADD PARTITION (dt=&apos;2028-08-08&apos;, hour=&apos;08&apos;);ALTER TABLE day_table ADD PARTITION (dt=&apos;2028-08-08&apos;); ï¼ˆ3ï¼‰åˆ é™¤åˆ†åŒºè¯­æ³•ï¼šï¼ˆâ€“ ç”¨æˆ·å¯ä»¥ç”¨ ALTER TABLE DROP PARTITION æ¥åˆ é™¤åˆ†åŒºã€‚åˆ†åŒºçš„å…ƒæ•°æ®å’Œæ•°æ®å°†è¢«ä¸€å¹¶åˆ é™¤ã€‚ï¼‰ åˆ é™¤å¦‚åŒåˆ†åŒºä¸­çš„å­çº§åˆ†åŒºæ—¶ï¼Œå¦‚æžœä»…å‰©ä¸€ä¸ªå­åˆ†åŒºï¼Œé‚£ä¹ˆçˆ¶çº§åˆ†åŒºä¹Ÿä¼šè¢«åˆ é™¤ã€‚ï¼ˆè¿žåï¼‰ 1ALTER TABLE table_name DROP partition_spec, partition_spec,... 1234ä¾‹ï¼šALTER TABLE day_hour_table DROP PARTITION (dt=&apos;2008-08-08&apos;, hour=&apos;08&apos;);ALTER TABLE day_hour_table DROP PARTITION (dt=&apos;2008-08-08&apos;); ï¼ˆ4ï¼‰æ•°æ®åŠ è½½è¿›åˆ†åŒºè¡¨ä¸­è¯­æ³•ï¼š 1LOAD DATA [LOCAL] INPATH &apos;filepath&apos; [OVERWRITE] INTO TABLE tablename [PARTITION (partcol1=val1,partcol2=val2 ...)] 12345HDFSï¼šLOAD DATA INPATH &apos;/user/pv.txt&apos; INTO TABLE day_hour_table PARTITION(dt=&apos;2008-08-08&apos;, hour=&apos;08&apos;);æœ¬åœ°ï¼šLOAD DATA local INPATH &apos;/user/hua/*&apos; INTO TABLE day_hour partition(dt=&apos;2010-07-07&apos;); ï¼ˆ5ï¼‰æŸ¥çœ‹è¡¨çš„æ‰€æœ‰åˆ†åŒº123hive&gt; show partitions day_hour_table;show partitions day_table; ï¼ˆ6ï¼‰é‡å‘½ååˆ†åŒºè¯­æ³•ï¼š 1ALTER TABLE table_name PARTITION partition_spec RENAME TO PARTITION partition_spec; 12ä¾‹ï¼šALTER TABLE day_table PARTITION (tian=&apos;2018-05-01&apos;) RENAME TO PARTITION (tain=&apos;2018-06-01&apos;); Hiveçš„å‡½æ•°è¯¾å‚è€ƒå®˜ç½‘ï¼Œç”¨æ—¶æŸ¥é˜…å³å¯ï¼š https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF ï¼ˆ7ï¼‰åŠ¨æ€åˆ†åŒº(é‡è¦)â€“æ³¨æ„å¤–éƒ¨è¡¨ åœ¨æœ¬åœ°æ–‡ä»¶/home/grid/a.txtä¸­å†™å…¥ä»¥ä¸‹4è¡Œæ•°æ® aaa,US,CA aaa,US,CB bbb,CA,BB bbb,CA,BC å»ºç«‹éžåˆ†åŒºè¡¨å¹¶åŠ è½½æ•°æ® åˆ›å»ºè¡¨ 123456CREATE TABLE info1 ( name STRING, cty STRING, st STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;,&apos;; åŠ è½½æ•°æ® 1LOAD DATA LOCAL INPATH &apos;/root/su/a&apos; INTO TABLE info1; æŸ¥çœ‹ 1SELECT * FROM info1; å»ºç«‹å¤–éƒ¨åˆ†åŒºè¡¨å¹¶åŠ¨æ€åŠ è½½æ•°æ® ï¼ˆæ³¨æ„åˆ é™¤å¤–éƒ¨è¡¨çš„ç›¸å…³äº‹é¡¹ï¼‰ 123456&gt; CREATE EXTERNAL TABLE info2 (&gt; name STRING&gt; ) &gt; PARTITIONED BY (country STRING, state STRING); &gt; &gt; è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åŠ¨æ€åˆ†åŒºæ¥å®žçŽ°ï¼Œä½¿ç”¨åŠ¨æ€åˆ†åŒºéœ€è¦æ³¨æ„è®¾å®šä»¥ä¸‹å‚æ•°ï¼š hive.exec.dynamic.partition é»˜è®¤å€¼ï¼šfalse æ˜¯å¦å¼€å¯åŠ¨æ€åˆ†åŒºåŠŸèƒ½ï¼Œé»˜è®¤falseå…³é—­ã€‚ ä½¿ç”¨åŠ¨æ€åˆ†åŒºæ—¶å€™ï¼Œè¯¥å‚æ•°å¿…é¡»è®¾ç½®æˆtrue; hive.exec.dynamic.partition.mode é»˜è®¤å€¼ï¼šstrict åŠ¨æ€åˆ†åŒºçš„æ¨¡å¼ï¼Œé»˜è®¤strictï¼Œè¡¨ç¤ºå¿…é¡»æŒ‡å®šè‡³å°‘ä¸€ä¸ªåˆ†åŒºä¸ºé™æ€åˆ†åŒºï¼Œnonstrictæ¨¡å¼è¡¨ç¤ºå…è®¸æ‰€æœ‰çš„åˆ†åŒºå­—æ®µéƒ½å¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒºã€‚ ä¸€èˆ¬éœ€è¦è®¾ç½®ä¸ºnonstrict hive.exec.max.dynamic.partitions.pernode é»˜è®¤å€¼ï¼š100 åœ¨æ¯ä¸ªæ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒºã€‚ è¯¥å‚æ•°éœ€è¦æ ¹æ®å®žé™…çš„æ•°æ®æ¥è®¾å®šã€‚ æ¯”å¦‚ï¼šæºæ•°æ®ä¸­åŒ…å«äº†ä¸€å¹´çš„æ•°æ®ï¼Œå³dayå­—æ®µæœ‰365ä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥å‚æ•°å°±éœ€è¦è®¾ç½®æˆå¤§äºŽ365ï¼Œå¦‚æžœä½¿ç”¨é»˜è®¤å€¼100ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ hive.exec.max.dynamic.partitions é»˜è®¤å€¼ï¼š1000 åœ¨æ‰€æœ‰æ‰§è¡ŒMRçš„èŠ‚ç‚¹ä¸Šï¼Œæœ€å¤§ä¸€å…±å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªåŠ¨æ€åˆ†åŒºã€‚ åŒä¸Šå‚æ•°è§£é‡Šã€‚ hive.exec.max.created.files é»˜è®¤å€¼ï¼š100000 æ•´ä¸ªMR Jobä¸­ï¼Œæœ€å¤§å¯ä»¥åˆ›å»ºå¤šå°‘ä¸ªHDFSæ–‡ä»¶ã€‚ ä¸€èˆ¬é»˜è®¤å€¼è¶³å¤Ÿäº†ï¼Œé™¤éžä½ çš„æ•°æ®é‡éžå¸¸å¤§ï¼Œéœ€è¦åˆ›å»ºçš„æ–‡ä»¶æ•°å¤§äºŽ100000ï¼Œå¯æ ¹æ®å®žé™…æƒ…å†µåŠ ä»¥è°ƒæ•´ã€‚ hive.error.on.empty.partition é»˜è®¤å€¼ï¼šfalse å½“æœ‰ç©ºåˆ†åŒºç”Ÿæˆæ—¶ï¼Œæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ã€‚ ä¸€èˆ¬ä¸éœ€è¦è®¾ç½®ã€‚ 1234567891011set hive.exec.dynamic.partition=true; set hive.exec.dynamic.partition.mode=nonstrict; set hive.exec.max.dynamic.partitions.pernode=1000; INSERT INTO TABLE info2 PARTITION (country, state) SELECT name, cty, st FROM info1; INSERT INTO TABLE info2 PARTITION (country, state) SELECT name, cty, st FROM info1; SELECT * FROM info2; 2ã€è‡ªå®šä¹‰å‡½æ•°UDF UDAF UDTF è‡ªå®šä¹‰å‡½æ•°åŒ…æ‹¬ä¸‰ç§ UDFã€UDAFã€UDTF UDFï¼šä¸€è¿›ä¸€å‡º UDAFï¼šèšé›†å‡½æ•°ï¼Œå¤šè¿›ä¸€å‡ºã€‚å¦‚ï¼šCount/max/min UDTFï¼šä¸€è¿›å¤šå‡ºï¼Œå¦‚ lateralview explore()ï¼Œï¼ˆç±»ä¼¼äºŽmysqlä¸­çš„è§†å›¾ï¼‰ ä½¿ç”¨æ–¹å¼ ï¼šåœ¨HIVEä¼šè¯ä¸­addè‡ªå®šä¹‰å‡½æ•°çš„jar æ–‡ä»¶ï¼Œç„¶åŽåˆ›å»º function ç»§è€Œä½¿ç”¨å‡½æ•° ï¼ˆ1ï¼‰UDF å¼€å‘ï¼ˆç”¨çš„å¤šä¸€ç‚¹ï¼‰1ã€UDFå‡½æ•°å¯ä»¥ç›´æŽ¥åº”ç”¨äºŽ select è¯­å¥ï¼Œå¯¹æŸ¥è¯¢ç»“æž„åšæ ¼å¼åŒ–å¤„ç†åŽï¼Œå†è¾“å‡ºå†…å®¹ã€‚ 2ã€ç¼–å†™ UDF å‡½æ•°çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š aï¼‰è‡ªå®šä¹‰ UDF éœ€è¦ç»§æ‰¿ org.apache.hadoop.hive.ql.UDFã€‚ bï¼‰éœ€è¦å®žçŽ° evaluate å‡½æ•°ï¼Œevaluate å‡½æ•°æ”¯æŒé‡è½½ã€‚ 3ã€æ­¥éª¤ aï¼‰æŠŠç¨‹åºæ‰“åŒ…æ”¾åˆ°ç›®æ ‡æœºå™¨ä¸ŠåŽ»ï¼› ï¼ˆéœ€è¦hiveå’Œhadoopï¼Œjdk çš„ç›¸å…³jaråŒ…ï¼‰ å‡½æ•°ä¸€ï¼šè„±æ•å¤„ç† 123456789101112131415161718192021222324package com.bigdata.hive.udf;import org.apache.hadoop.hive.ql.exec.UDF;import org.apache.hadoop.io.Text;public class TuoMing extends UDF &#123; private Text res = new Text(); public Text evaluate(String string) &#123; // æ ¡éªŒå‚æ•°æ˜¯å¦ä¸ºç©º if(string==null)&#123; return null; &#125; // è‹¥ä¸ºå•ä¸ªå­—ç¬¦ if(string.length()==1)&#123; res.set("*"); &#125; String str1 = string.substring(0,1); String str2 = string.substring(string.length()-1,string.length()); res.set(str1+"***"+str2); return res; &#125; &#125; å‡½æ•°äºŒï¼šaddå‡½æ•° 12345678910111213141516171819202122package com.bigdata.hive.udf;import org.apache.hadoop.hive.ql.exec.UDF;import org.apache.hadoop.io.Text;public class Add extends UDF &#123; private Text res = new Text(); public Text evaluate(String num1,String num2) &#123; // æ ¡éªŒå‚æ•°æ˜¯å¦ä¸ºç©º if(num1==null)&#123; return null; &#125;else if(num2==null)&#123; res.set(num1); return res; &#125; int n = Integer.parseInt(num1)+Integer.parseInt(num2); String str =n+""; res.set(str); return res; &#125; &#125; bï¼‰è¿›å…¥ hive å®¢æˆ·ç«¯ï¼Œæ·»åŠ  jar åŒ… 1234hive&gt;add jar /root/su/TuoMing.jar;(ç›¸å½“äºŽæ·»åŠ åˆ°çŽ¯å¢ƒå˜é‡ä¸­)(æ¸…é™¤ç¼“å­˜æ—¶è®°å¾—åˆ é™¤jaråŒ…ï¼š delete jar /*)delete jar /jar/udf_test.jar; cï¼‰åˆ›å»ºä¸´æ—¶å‡½æ•°ï¼š 123hive&gt;CREATE TEMPORARY FUNCTION add_example AS &apos;hive.udf.add&apos;;CREATE TEMPORARY FUNCTION tm_example AS &apos;com.bigdata.hive.udf.TuoMing&apos;;ï¼ˆas åŽé¢æ·»åŠ çš„æ˜¯ï¼šåŒ…å+ç±»åï¼‰ dï¼‰æŸ¥è¯¢ HQL è¯­å¥ï¼š 12345SELECT add_example(8, 9) FROM scores;SELECT add_example(scores.math, scores.art) FROM scores;SELECT tm_example(id) FROM log; eï¼‰é”€æ¯ä¸´æ—¶å‡½æ•°ï¼š 1hive&gt; DROP TEMPORARY FUNCTION tm_example; ï¼ˆ2ï¼‰UDAFè‡ªå®šä¹‰é›†å‡½æ•°(ç”¨çš„å°‘) å¤šè¡Œè¿›ä¸€è¡Œå‡ºï¼Œå¦‚ sum()ã€min()ï¼Œç”¨åœ¨ group by æ—¶ 1.å¿…é¡»ç»§æ‰¿org.apache.hadoop.hive.ql.exec.UDAF(å‡½æ•°ç±»ç»§æ‰¿) org.apache.hadoop.hive.ql.exec.UDAFEvaluator(å†…éƒ¨ç±» Eval uator å®žçŽ° UDAFEvaluator æŽ¥å£) 2.Evaluator éœ€è¦å®žçŽ° initã€iterateã€terminatePartialã€mergeã€terminate è¿™å‡ ä¸ªå‡½æ•° init():ç±»ä¼¼äºŽæž„é€ å‡½æ•°ï¼Œç”¨äºŽ UDAF çš„åˆå§‹åŒ– iterate():æŽ¥æ”¶ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶è¿›è¡Œå†…éƒ¨çš„è½®è½¬ï¼Œè¿”å›ž boolean terminatePartial():æ— å‚æ•°ï¼Œå…¶ä¸º iterate å‡½æ•°è½®è½¬ç»“æŸåŽï¼Œè¿”å›žè½®è½¬æ•°æ®ï¼Œ ç±»ä¼¼äºŽ hadoop çš„Combinermerge():æŽ¥æ”¶ terminatePartial çš„è¿”å›žç»“æžœï¼Œè¿›è¡Œæ•°æ® merge æ“ä½œï¼Œ â€‹ å…¶è¿”å›žç±»åž‹ä¸º boolean terminate():è¿”å›žæœ€ç»ˆçš„èšé›†å‡½æ•°ç»“æžœ å¼€å‘ä¸€ä¸ªåŠŸèƒ½åŒï¼š Oracle çš„ wm_concat()å‡½æ•° Mysql çš„ group_concat() Hive UDF çš„æ•°æ®ç±»åž‹ï¼š Hive UDF çš„æ•°æ®ç±»åž‹ï¼š ï¼ˆ3ï¼‰UDTFï¼ˆç”¨çš„å°‘ä¸€ç‚¹ï¼‰UDTFï¼šä¸€è¿›å¤šå‡ºï¼Œå¦‚ lateral view explode( ) è¿”å›žä¸€ä¸ªæ•°ç»„è¡¨ Hive Lateral View è§†å›¾ Lateral Viewç”¨äºŽå’ŒUDTFå‡½æ•°ï¼ˆexplodeã€splitï¼‰ç»“åˆæ¥ä½¿ç”¨ã€‚ é¦–å…ˆé€šè¿‡UDTFå‡½æ•°æ‹†åˆ†æˆå¤šè¡Œï¼Œå†å°†å¤šè¡Œç»“æžœç»„åˆæˆä¸€ä¸ªæ”¯æŒåˆ«åçš„è™šæ‹Ÿè¡¨ã€‚ ä¸»è¦è§£å†³ åœ¨selectä½¿ç”¨UDTFåšæŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼ŒæŸ¥è¯¢åªèƒ½åŒ…å«å•ä¸ªUDTFï¼Œä¸èƒ½åŒ…å«å…¶ä»–å­—æ®µã€ä»¥åŠå¤šä¸ªUDTFçš„é—®é¢˜ è¯­æ³•ï¼š LATERAL VIEW udtf(expression) tableAlias AS columnAlias (â€˜,â€™ columnAlias) ä¾‹ï¼š ç»Ÿè®¡äººå‘˜è¡¨ä¸­å…±æœ‰å¤šå°‘ç§çˆ±å¥½ã€å¤šå°‘ä¸ªåŸŽå¸‚? 1234&gt; select count(distinct(myCol1)), count(distinct(myCol2))ï¼Œcount(distinct(myCol3))from log2 &gt; LATERAL VIEW explode(likes) myTable1 AS myCol1 &gt; LATERAL VIEW explode(address) myTable2 AS myCol2, myCol3;&gt; 123select myCol1, myCol2 from log2 LATERAL VIEW explode(likes) myTable1 AS myCol1 LATERAL VIEW explode(address) myTable2 AS myCol2, myCol3; distinct(myCol1) è¡¨ç¤ºåŽ»é‡ LATERAL VIEW explode(likes) myTable1 AS myCol1 å°†likesæŸ¥è¯¢ç»“æžœæ”¾åˆ°mytable1è¡¨ä¸­ï¼Œä½œä¸ºå­—æ®µmyCol1 LATERAL VIEW explode(address) myTable2 AS myCol2, myCol3; å°†addressæŸ¥è¯¢ç»“æžœæ”¾åˆ°myTable2 è¡¨ä¸­ï¼Œä½œä¸ºå­—æ®µmyCol2ï¼ŒmyCol3ï¼Œå› ä¸ºaddressæ˜¯åŒ…å«K-Vçš„ï¼ˆä¸¤ä¸ªï¼‰ å…«ã€Hiveç´¢å¼•(çŸ¥é“) ä¸€ä¸ªè¡¨ä¸Šåˆ›å»ºç´¢å¼•ï¼š ä½¿ç”¨ç»™å®šçš„åˆ—è¡¨çš„åˆ—ä½œä¸ºé”®åˆ›å»ºä¸€ä¸ªç´¢å¼•ã€‚ è¯¦è§åˆ›å»ºç´¢å¼•;)è®¾è®¡æ–‡æ¡£ã€‚ 12345678910111213CREATE INDEX index_name ON TABLE base_table_name (col_name, ...) AS index_type [WITH DEFERRED REBUILD] [IDXPROPERTIES (property_name=property_value, ...)] [IN TABLE index_table_name] [ [ ROW FORMAT ...] STORED AS ... | STORED BY ... ] [LOCATION hdfs_path] [TBLPROPERTIES (...)] [COMMENT &quot;index comment&quot;]; ä¹ã€æ¡ˆä¾‹å®žè·µæ¡ˆä¾‹ä¸€ï¼š(åŸºç«™æŽ‰è¯çŽ‡)åŸºç«™æŽ‰è¯çŽ‡ 1ã€åˆ›å»ºè¡¨cell_monitorè¡¨ 1234567891011121314create table cell_monitor( record_time string, imei string, cell string, ph_num int, call_num int, drop_num int, duration int, drop_rate DOUBLE, net_type string, erl string)ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;,&apos;STORED AS TEXTFILE; ç»“æžœè¡¨cell_drop_monitor 12345678create table cell_drop_monitor(imei string,total_call_num int,total_drop_num int,d_rate DOUBLE) ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\t&apos;STORED AS TEXTFILE; 2ã€loadæ•°æ®1LOAD DATA LOCAL INPATH &apos;/root/su/cdr_summ_imei_cell_info.csv&apos; OVERWRITE INTO TABLE cell_monitor; 3ã€æ‰¾å‡ºæŽ‰çº¿çŽ‡æœ€é«˜çš„åŸºç«™12345from cell_monitor cm insert overwrite table cell_drop_monitor select cm.imei ,sum(cm.drop_num),sum(cm.duration),sum(cm.drop_num)/sum(cm.duration) d_rate group by cm.imei sort by d_rate desc; æ¡ˆä¾‹äºŒï¼šï¼ˆå•è¯ç»Ÿè®¡ï¼‰1ã€å»ºè¡¨12create table docs(line string);create table wc(word string, totalword int); 2ã€åŠ è½½æ•°æ®1load data local inpath &apos;/tmp/wc&apos; into table docs; 3ã€ç»Ÿè®¡12345from (select explode(split(line, &apos; &apos;)) as word from docs) w insert into table wc select word, count(1) as totalword group by word order by word; 4ã€æŸ¥è¯¢ç»“æžœ1select * from wc; åã€åˆ†æ¡¶ï¼ˆé‡è¦ï¼‰1ã€æ¦‚å¿µ ä¸»è¦åº”ç”¨äºŽæ•°æ®æŠ½æ ·ã€‚ é€šè¿‡å¯¹åˆ—å€¼å–å“ˆå¸Œå€¼çš„æ–¹å¼ï¼Œå°†ä¸åŒæ•°æ®æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­å­˜å‚¨ã€‚ å¯¹Hiveä¸­æ¯ä¸ªè¡¨ã€åˆ†åŒºéƒ½å¯ä»¥è¿›è¡Œåˆ†æ¡¶ã€‚ åˆ—çš„å“ˆå¸Œå€¼ /æ¡¶çš„ä¸ªæ•°â†’å†³å®šæ¯æ¡æ•°æ®åˆ’åˆ†åˆ°å“ªä¸ªæ¡¶ä¸­ 2ã€å¼€å¯æ”¯æŒåˆ†æ¡¶1hive&gt; set hive.enforce.bucketing=true; é»˜è®¤ï¼šfalseï¼› è®¾ç½®ä¸ºtrueä¹‹åŽï¼Œmrè¿è¡Œæ—¶ä¼šæ ¹æ®bucketçš„ä¸ªæ•°è‡ªåŠ¨åˆ†é…reduce taskä¸ªæ•°ã€‚ ï¼ˆç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡mapred.reduce.tasksè‡ªå·±è®¾ç½®reduceä»»åŠ¡ä¸ªæ•°ï¼Œä½†åˆ†æ¡¶æ—¶ä¸æŽ¨èä½¿ç”¨ï¼‰ ä¸€æ¬¡ä½œä¸šäº§ç”Ÿçš„æ¡¶æ•° = reducde taskæ•° 3ã€å¾€åˆ†æ¡¶è¡¨ä¸­åŠ è½½æ•°æ®12insert into table bucket_table select columns from tbl;insert overwrite table bucket_table select columns from tbl; 4ã€æ¡¶è¡¨æŠ½æ ·æŸ¥è¯¢1select * from bucket_table tablesample(bucket 1 out of 4 on columns); TABLESAMPLEè¯­æ³•ï¼š 12&gt; TABLESAMPLE(BUCKET x OUT OF y)&gt; xï¼šè¡¨ç¤ºä»Žå“ªä¸ªbucketå¼€å§‹æŠ½å–æ•°æ®ï¼Œx&lt;=y yï¼šå¿…é¡»ä¸ºè¯¥è¡¨æ€»bucketæ•°çš„å€æ•°æˆ–å› å­ ç†è§£ï¼š åˆ†æ¡¶è¡¨å·²ç»æŒ‰ageåˆ†ä¸º4æ¡¶ï¼Œç„¶åŽï¼Œæœ‰yä¸ªäººåŽ»æŠ½ï¼Œä»Žç¬¬(x å–æ¨¡ æ¡¶æ•°)æ¡¶ä¸­æŠ½ 5ã€å®žæˆ˜åˆ›å»ºæ™®é€šè¡¨ 123456CREATE TABLE mm( id INT, name STRING, age INT)ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;,&apos;; æµ‹è¯•æ•°æ® 123456781,tom,112,cat,223,dog,334,hive,445,hbase,556,mr,667,alice,778,scala,88 åŠ è½½æ•°æ®ï¼š 1load data local inpath &apos;/root/su/mm&apos; into table mm; åˆ›å»ºåˆ†æ¡¶è¡¨ 1234567CREATE TABLE psnbucket( id INT, name STRING, age INT)CLUSTERED BY (age) INTO 4 BUCKETS ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;,&apos;; åŠ è½½æ•°æ®ï¼š 1insert into table psnbucket select id, name, age from mm; æŠ½æ · 1select id, name, age from psnbucket tablesample(bucket 2 out of 4 on age); æ³¨æ„ï¼š hive&gt; select id, name, age from psnbucket tablesample(bucket 4 out of 2 on age);FAILED: SemanticException [Error 10061]: Numerator should not be bigger than denominator in sample clause for table psnbucket denominator : åˆ†æ¯ åä¸€ã€è¿è¡Œæ–¹å¼1ã€Hiveè¿è¡Œæ¨¡å¼ â€“ å‘½ä»¤è¡Œæ–¹å¼cliï¼šæŽ§åˆ¶å°æ¨¡å¼ 1234567--ä¸Žhdfsäº¤äº’ * æ‰§è¡Œdfså‘½ä»¤ * ä¾‹ ï¼šhive&gt; dfs -ls / --ä¸ŽLinuxäº¤äº’ * ï¼ å¼€å¤´ * hive&gt; !pwd â€“è„šæœ¬è¿è¡Œæ–¹å¼ï¼šï¼ˆç”Ÿäº§ä¸­å¸¸ç”¨ï¼‰ 123456789101112131415161718192021222324åœ¨å¤–éƒ¨shellä¸­æ‰§è¡Œ,æŒ‡å®šæ•°æ®åº“,åˆ†å·å¯åŠ å¯ä¸åŠ # hive -e &quot;select * from attr.log &quot;# hive -e &quot;select * from attr.logï¼›select * from default.log2&quot;--------------------------------------------------------------å°†æ‰§è¡Œç»“æžœé‡å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶ï¼š# hive -e &quot;select * from attr.log &quot; &gt;&gt;log1--------------------------------------------------------------é™é»˜æ¨¡å¼æ‰§è¡Œï¼Œä¸æ‰“å°logæ—¥å¿—# hive -S -e &quot;select * from attr.log &quot; &gt;&gt;log1--------------------------------------------------------------è„šæœ¬æ‰§è¡Œå…ˆç¼–è¾‘è„šæœ¬é—®ä»·# vim file1ç¼–è¾‘å†…å®¹select * from attr.log where id = 1;select * from attr.log where id &lt; 3;æ‰§è¡Œè„šæœ¬# hive -f file1--------------------------------------------------------------?? ä½¿ç”¨å‘½ä»¤æ–‡ä»¶æ‰§è¡Œhive-init.sql?? # hive -i /home/hive-init.sql--------------------------------------------------------------åœ¨hive cliä¸­æ‰§è¡Œè„šæœ¬æ–‡ä»¶hive&gt; source file1 ï¼Ÿæœªè§£å†³ï¼Ÿ ?? ä½¿ç”¨å‘½ä»¤æ–‡ä»¶æ‰§è¡Œhive-init.sql?? # hive -i /home/hive-init.sql åäºŒã€hiveçš„GUIæŽ¥å£ï¼ˆwebé¡µé¢ï¼‰Hive Web GUIæŽ¥å£ webç•Œé¢å®‰è£…ï¼š1ã€ä¸‹è½½æºç åŒ…apache-hive-1.2.1-src.tar.gz, 2ã€åœ¨æœ¬åœ°Windowsç³»ç»Ÿä¸­è§£åŽ‹ å¹¶å°†\apache-hive-1.2.1-src\hwi\webè·¯å¾„ä¸­æ‰€æœ‰çš„æ–‡ä»¶æ‰“æˆwaråŒ… åˆ¶ä½œæ–¹æ³•ï¼š waråŒ… 1ã€åˆ°\apache-hive-1.2.1-src\hwi\webè·¯å¾„ä¸‹ 2ã€åœ¨è·¯å¾„æ è¾“å…¥å‘½ä»¤ï¼šjar -cvf hive-hwi.war * 3ã€å³å¯ç”Ÿæˆæ–‡ä»¶ï¼šhive-hwi.war 3ã€å°†hwi-waråŒ…æ”¾åœ¨$HIVE_HOME/lib/ä¸­ï¼ˆLinuxç³»ç»Ÿï¼‰ 4ã€å¤åˆ¶tools.jar(åœ¨jdkçš„libç›®å½•ä¸‹)åˆ°$HIVE_HOME/libä¸‹ 5ã€ä¿®æ”¹hive-site.xml è·¯å¾„ï¼š/usr/soft/apache-hive-1.2.1-bin/conf/hive-site.xml 123456789101112&lt;property&gt; &lt;name&gt;hive.hwi.listen.host&lt;/name&gt; &lt;value&gt;0.0.0.0&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.hwi.listen.port&lt;/name&gt; &lt;value&gt;9999&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hive.hwi.war.file&lt;/name&gt; &lt;value&gt;lib/hive-hwi.war&lt;/value&gt; &lt;/property&gt; 6ã€å¯åŠ¨hwiæœåŠ¡(ç«¯å£å·9999) 1hive --service hwi 7ã€æµè§ˆå™¨é€šè¿‡ä»¥ä¸‹é“¾æŽ¥æ¥è®¿é—® http://node00:9999/hwi/ 8ã€ç™»å½•é¡µé¢ï¼š USER: GROUPS: è‡ªå·²å®šä¹‰ åä¸‰ã€æƒé™ç®¡ç†Hive - SQL Standards Based Authorization in HiveServer2 ï¼ˆ1ï¼‰ä¸‰ç§æŽˆæƒæ¨¡åž‹ ï¼ˆ2ï¼‰å¸¸ç”¨ï¼šåŸºäºŽSQLæ ‡å‡†çš„å®Œå…¨å…¼å®¹SQLçš„æŽˆæƒæ¨¡åž‹ç‰¹ç‚¹ï¼š æ”¯æŒå¯¹äºŽç”¨æˆ·çš„æŽˆæƒè®¤è¯ æ”¯æŒè§’è‰²roleçš„æŽˆæƒè®¤è¯ roleå¯ç†è§£ä¸ºæ˜¯ä¸€ç»„æƒé™çš„é›†åˆï¼Œé€šè¿‡roleä¸ºç”¨æˆ·æŽˆæƒ ä¸€ä¸ªç”¨æˆ·å¯ä»¥å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè§’è‰² â€‹ é»˜è®¤åŒ…å«ä¿©ç§è§’è‰²ï¼špublicã€admin é™åˆ¶ ï¼ˆ3ï¼‰æ“ä½œåœ¨hiveæœåŠ¡ç«¯ä¿®æ”¹é…ç½®æ–‡ä»¶hive-site.xmlæ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹ï¼š 1234567891011121314151617181920&lt;property&gt; &lt;name&gt;hive.security.authorization.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hive.server2.enable.doAs&lt;/name&gt; &lt;value&gt;false&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hive.users.in.admin.role&lt;/name&gt; &lt;value&gt;root&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hive.security.authorization.manager&lt;/name&gt;&lt;value&gt;org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hive.security.authenticator.manager&lt;/name&gt; &lt;value&gt;org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator&lt;/value&gt;&lt;/property&gt; æœåŠ¡ç«¯å¯åŠ¨hiveserver2ï¼›å®¢æˆ·ç«¯é€šè¿‡beelineè¿›è¡Œè¿žæŽ¥ è§’è‰²çš„æ·»åŠ ã€åˆ é™¤ã€æŸ¥çœ‹ã€è®¾ç½®ï¼š ç¬¬ä¸€æ¬¡æ“ä½œæ— æƒé™ï¼š éœ€è¦ï¼šCREATE ROLE adminï¼› 12345CREATE ROLE role_name; -- åˆ›å»ºè§’è‰²DROP ROLE role_name; -- åˆ é™¤è§’è‰²SET ROLE (role_name|ALL|NONE); -- è®¾ç½®è§’è‰²SHOW CURRENT ROLES; -- æŸ¥çœ‹å½“å‰å…·æœ‰çš„è§’è‰²SHOW ROLES; -- æŸ¥çœ‹æ‰€æœ‰å­˜åœ¨çš„è§’è‰² ã€å®˜ç½‘ï¼šæƒé™ã€‘ Action Select Insert Update Delete Owership Admin URL Privilege(RWX Permission + Ownership) ALTER DATABASE Y ALTER INDEX PROPERTIES Y ALTER INDEX REBUILD Y ALTER PARTITION LOCATION Y Y (for new partition location) ALTER TABLE (all of them except the ones above) Y ALTER TABLE ADD PARTITION Y Y (for partition location) ALTER TABLE DROP PARTITION Y ALTER TABLE LOCATION Y Y (for new location) ALTER VIEW PROPERTIES Y ALTER VIEW RENAME Y ANALYZE TABLE Y Y CREATE DATABASE Y (if custom location specified) CREATE FUNCTION Y CREATE INDEX Y (of table) CREATE MACRO Y CREATE TABLE Y (of database) Y (for create external table â€“ the location) CREATE TABLE AS SELECT Y (of input) Y (of database) CREATE VIEW Y + G DELETE Y DESCRIBE TABLE Y DROP DATABASE Y DROP FUNCTION Y DROP INDEX Y DROP MACRO Y DROP TABLE Y DROP VIEW Y DROP VIEW PROPERTIES Y EXPLAIN Y INSERT Y Y (for OVERWRITE) LOAD Y (output) Y (output) Y (input location) MSCK (metastore check) Y SELECT Y SHOW COLUMNS Y SHOW CREATE TABLE Y+G SHOW PARTITIONS Y SHOW TABLE PROPERTIES Y SHOW TABLE STATUS Y TRUNCATE TABLE Y UPDATE Y åå››ã€Hiveä¼˜åŒ–ï¼ˆé‡ç‚¹ï¼‰è¯¦è§Hiveä¼˜åŒ–æ–‡æ¡£ HIveå¸¸ç”¨å‡½æ•°ï¼š https://www.cnblogs.com/kimbo/p/6288516.html https://www.iteblog.com/archives/2258.html#3_avg https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-Built-inFunctions MapReducdeåº•å±‚æºç ï¼š http://note.youdao.com/noteshare?id=212e4a69d7bf8fc30979f1e4fc39ff0f&amp;sub=EA7C15DC72DF45248721CE2AD3F93CDD http://note.youdao.com/noteshare?id=86ca5c96d13413f789164ff92f9ab4f9&amp;sub=7F20006D1D714D77AEDE5242603786C1 http://note.youdao.com/noteshare?id=a518dfed10d824b0995380669ddd28c9&amp;sub=3526F532CDAA49628FEA1FE3A61239F3 http://note.youdao.com/noteshare?id=95d458d779f8e9f391d6ea06b6c6d122&amp;sub=0A13B59E10D94C96ABF5388CE4EB89D4]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>Hive</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxç³»ç»Ÿæ•°æ®åº“MySQLå®‰è£…]]></title>
    <url>%2F2019%2F01%2F10%2FLinux%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93MySQL%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[[TOC] Linuxç³»ç»Ÿæ•°æ®åº“MySQLå®‰è£…ä¸€ã€ç¬¬ä¸€æ¬¡å®‰è£…MySQL1ã€yumå®‰è£… å‘½ä»¤ ï¼š yum -y install mysql-server mysql-devel 2ã€ç™»å½• å‘½ä»¤ ï¼š mysql -u -p æ˜¾ç¤ºï¼š 1mysql&gt; 3ã€æŸ¥çœ‹æ•°æ®åº“(æ³¨æ„ç”¨â€˜ ; â€™ç»“æŸ ) å‘½ä»¤ ï¼š show databases; 4ã€é€€å‡ºï¼š å‘½ä»¤ï¼š quitï¼› 5ã€åˆ›å»ºç”¨æˆ·ï¼š å‘½ä»¤ ï¼š mysqladmin -uroot password 123456 6ã€å†ç™»å½•ï¼š å‘½ä»¤ ï¼šmysql -u root -p æ˜¾ç¤ºï¼š 1mysql&gt; è¯´æ˜ŽæˆåŠŸäº†ï¼ 7ã€æ•°æ®åº“æ“ä½œï¼š å‘½ä»¤ ï¼š use mysql; æ˜¾ç¤ºï¼š 1234Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changed 8ã€æŸ¥çœ‹ç”¨æˆ·æ•°æ®è¡¨ï¼š å‘½ä»¤ ï¼š show tables; 9ã€æŸ¥è¯¢userè¡¨éƒ¨åˆ†å­—æ®µï¼š å‘½ä»¤ ï¼š select host,user,password from user; 10ã€é€šè¿‡ä¿®æ”¹userè¡¨çš„hostå­—æ®µï¼Œè®¾ç½®æ•°æ®åº“è®¿é—®æƒé™ï¼Œåªè¦ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ï¼ˆ1ï¼‰æŽ¨èçŽ°å°†userè¡¨ä¸­å…¶ä»–æ— å¯†ç çš„è®°å½•åˆ é™¤ å‘½ä»¤ ï¼š delete from user where password = â€˜ â€˜; (2)æ›´æ–°æœ‰å¯†ç çš„è®°å½•çš„hostå­—æ®µå€¼ å‘½ä»¤ ï¼š update user set host = â€œ%â€; (3)åˆ·æ–°æƒé™ å‘½ä»¤ ï¼šflush privileges; (4)é€€å‡º å‘½ä»¤ ï¼šquit; äºŒã€Linuxç³»ç»Ÿç™»å½•æ•°æ®åº“MySQLæŠ¥é”™æŠ¥é”™ä¸€ï¼š1ã€ç™»å½• mysqld -uroot -p123456 æŠ¥é”™ï¼š 1Can&apos;t connect to local MySQL server through socket &apos;/var/lib/mysql/mysql.sock&apos; (111) è§£å†³ï¼š 1ï¼‰ã€å…ˆåˆ é™¤mysql.sock cd /var/lib/mysql mv mysql.sock mysql.sock.bak 2ï¼‰ã€å†æ¬¡ç™»é™† mysql -uroot -p123456 æŠ¥é”™ï¼š 1Can&apos;t connect to local MySQL server through socket &apos;/var/lib/mysql/mysql.sock&apos; (2) 3ï¼‰ã€çœ‹çœ‹mysqlçš„çŠ¶æ€ï¼Œ /etc/rc.d/init.d/mysqld status æ˜¾ç¤ºï¼š mysqld is stopped 4ï¼‰ã€çœ‹çœ‹æ˜¯ä¸æ˜¯mysqlçš„æƒé™é—®é¢˜åœ¨/var/libç›®å½•ä¸‹ï¼š ls -lt|grep mysql æ˜¾ç¤ºï¼š drwxr-xr-x. 4 mysql mysql 4096 Jan 6 11:09 mysql 5ï¼‰ã€è¯´æ˜ŽmysqlæœåŠ¡æ²¡æœ‰å¯åŠ¨ 2ã€å¯åŠ¨mysqlæœåŠ¡ /etc/init.d/mysqld start æ˜¾ç¤ºï¼š 1Starting mysqld: [ OK ] 3ã€å†æ¬¡ç™»å½•ï¼š mysql -uroot -p123456 æ˜¾ç¤ºï¼š 12345678910111213Welcome to the MySQL monitor. Commands end with ; or \g.Your MySQL connection id is 2Server version: 5.1.73 Source distributionCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.mysql&gt; 4ã€é€€å‡º quit 5ã€è§£å†³å‡ºçŽ°mysql.sockçš„é—®é¢˜ ï¼ˆ1ï¼‰ã€vim /etc/mycnf ç¼–è¾‘å†…å®¹ï¼š 12[mysqld]skip_name_resolve=on innodb_file_per_table=on æŒ‰esc :wq ä¿å­˜å¹¶é€€å‡º ï¼ˆ2ï¼‰ä½¿ç”¨å‘½ä»¤ï¼š mysql_secure_installation ï¼ˆ3ï¼‰ç›´æŽ¥[ enter ] é”®ï¼Œè¾“å…¥å¯†ç ï¼Œ (å¦æŽ¨èï¼šJakie_ZHFè€å¸ˆçš„åšå®¢) æŠ¥é”™äºŒï¼š1ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES)]]></content>
      <categories>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>Linuxç³»ç»ŸçŽ¯å¢ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤§æ•°æ®æ€æƒ³]]></title>
    <url>%2F2019%2F01%2F05%2F%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%80%9D%E6%83%B3%2F</url>
    <content type="text"><![CDATA[[TOC] 1ã€å¤§æ•°æ®æ ¸å¿ƒé—®é¢˜ï¼š==æµ·é‡æ•°æ®ã€å·¥ä¸šæŠ€æœ¯è½åŽã€ç¡¬ä»¶æŸåå¸¸æ€åŒ–ï¼ˆCtrl+Mï¼‰== 2ã€å¤§æ•°æ®æ€ç»´åˆ†è€Œæ²»ä¹‹ æŠŠä¸€ä¸ªå¤æ‚çš„é—®é¢˜æŒ‰ä¸€å®šçš„â€œåˆ†è§£â€æ–¹æ³•åˆ†ä¸ºç­‰ä»·çš„è§„æ¨¡è¾ƒå°çš„è‹¥å¹²éƒ¨åˆ†ï¼Œç„¶åŽé€ä¸ªè§£å†³ï¼Œç„¶åŽåˆ†åˆ«æ‰¾å‡ºå„éƒ¨åˆ†çš„ä¸­é—´ç»“æžœï¼Œæœ€åŽå°†å„ä¸ªéƒ¨åˆ†çš„ä¸­é—´ç»“æžœç»„æˆæ•´ä¸ªé—®é¢˜çš„æœ€ç»ˆç»“æžœï¼ˆCtrl+Qï¼‰ enter description here 3ã€ä¸šåŠ¡åœºæ™¯ä»“å‚¨ã€æ•°ç‰Œ ä¸šåŠ¡ä¸€ï¼šæ‰¾{é‡å¤è¡Œ}(chongfuhang)++çŽ°æœ‰1TBçš„TXTæ–‡ä»¶ ;æ ¼å¼ï¼šæ•°å­—+å­—ç¬¦ ï¼›ç½‘é€Ÿï¼š500M/s ï¼›æœåŠ¡å™¨å†…å­˜å¤§å°ï¼š128M ï¼›æ¡ä»¶ï¼šä»…æœ‰ä¸¤è¡Œé‡å¤ ï¼Œå†…å­˜ä¸èƒ½æ”¾ä¸‹å…¨é‡æ•°æ®ï¼ˆOMï¼šout of memeryï¼‰ï¼›++ enter description here ==æ–¹æ³•== ç­”ï¼šå…±éœ€è¦2æ¬¡IOï¼š2*30min=1h ==ç¬¬ä¸€æ¬¡IO==ï¼š ç»™æ¯ä¸€è¡Œå†…å®¹åŠ ä¸Šå”¯ä¸€æ ‡è®°ï¼ˆhashcodeï¼ˆå†…å®¹ï¼‰ï¼Œvalueï¼ˆè¡Œå·ï¼‰ï¼‰ã€‚å¯¹æ¯ä¸€è¡Œå†…å®¹è¿›è¡Œhashè¿ç®—ï¼Œå¾—åˆ°å”¯ä¸€æ ‡è¯†hashcodeï¼Œä½œä¸ºkeyï¼Œå°†è¡Œå·ä½œä¸ºvalueã€‚ç„¶è€Œï¼Œå¯¹äºŽå†…å®¹å®Œå…¨é‡å¤çš„ä¸¤è¡Œï¼Œå…¶hashcodeå€¼ä¸€å®šç›¸åŒã€‚ `å¯¹æ¯ä¸€è¡Œçš„hashå€¼è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå¹¶æ”¾ç½®äºŽå½’ç±»åˆ†åŒºçš„å°æ–‡ä»¶ä¸­`ã€‚ç”±äºŽæ•°æ®åŸºæ•°è¿‡å¤§ï¼Œå°±å°†æ¯è¡Œçš„keyå€¼å¯¹å–æ¨¡ï¼Œè½¬åŒ–ä¸ºå°æ–‡ä»¶ï¼Œå¦‚å°†hashå€¼å¯¹100å–æ¨¡ï¼Œåˆ™äº§ç”Ÿ100ä¸ªå°æ–‡ä»¶åˆ†åŒºï¼Œå–æ¨¡åŽç›¸åŒçš„æ”¾åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚ ==ç¬¬äºŒæ¬¡IO==ï¼š åœ¨æ¯ä¸ªåˆ†åŒºä¸­çš„å°æ–‡ä»¶éåŽ†ï¼Œå¯¹æ¯ä¸€è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œå› ä¸ºé‡å¤è¡Œä¸€å®šä¼šåœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚è¿™æ ·å·¥ä½œé‡å°±ä¼šå¤§å¤§å‡å°ã€‚ ä¸šåŠ¡äºŒï¼šå¿«{æŽ’åº}(paixu)++çŽ°æœ‰1TBçš„TXTæ–‡ä»¶ ;æ ¼å¼ï¼šæ•°å­—ï¼›ç½‘é€Ÿï¼š500M/s ï¼›æœåŠ¡å™¨å†…å­˜å¤§å°ï¼š128M ï¼›æ¡ä»¶ï¼šå®žçŽ°å¿«æŽ’åºï¼Œå†…å­˜ä¸èƒ½æ”¾ä¸‹å…¨é‡æ•°æ®ï¼ˆOMï¼šout of memeryï¼‰ï¼›++ ä¸¤æ¬¡IOï¼Œ2 * 30åˆ†é’Ÿ = 1å°æ—¶ enter description here ==æ–¹æ³•ä¸€ï¼šå…ˆå…¨å±€æœ‰åºåŽå±€éƒ¨æœ‰åº== 1.å¯¹å…¨å±€æŒ‰åˆ†åŒºæŽ’åºï¼ˆç”±å¤§åˆ°å°ï¼‰ã€‚â€‹ ç”¨ifã€‚ã€‚elseæ–¹æ³•å¯¹æ•°æ®è¿›è¡ŒæŒ‰èŒƒå›´åˆ†ç±»ï¼Œè½åˆ°ä¸åŒçš„åˆ†åŒºä¸­ï¼ˆ0~1000ã€1001~2000ã€2001~3000Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·ï¼‰ 2.å¯¹å±€éƒ¨è¿›è¡ŒæŽ’åºï¼ˆç”±å¤§åˆ°å°ï¼‰ã€‚â€‹ å¯¹æ¯ä¸ªåˆ†åŒºè¿›è¡ŒæŽ’åºã€‚ enter description here ==æ–¹æ³•äºŒï¼šå…ˆå±€éƒ¨æœ‰åºåŽå…¨å±€æœ‰åº== å…ˆå®žçŽ°å±€éƒ¨æœ‰åº(å°â€“&gt;å¤§)ã€‚å°†æ–‡ä»¶åˆ’åˆ†ä¸ºNä¸ªåˆ†åŒºï¼Œåœ¨æ¯ä¸ªåˆ†åŒºå†…éƒ¨è¿›è¡ŒæŽ’åº ä½¿ç”¨å½’å¹¶å®žçŽ°å…¨å±€æœ‰åºã€‚æ¯ä¸ªåˆ†åŒºåˆ†åˆ«å„è‡ªå–å‡ºæœ€å°å€¼ï¼Œæ‹¿å‡ºæ¥æ¯”è¾ƒï¼Œæœ€å°å€¼æ”¾åœ¨ä¸€æ—ï¼Œæœ€å°å€¼æ‰€åœ¨çš„é‚£ä¸ªåˆ†åŒºå†æ‹¿å‡ºå‰©ä¸‹æ•°æ®ä¸­çš„æœ€å°å€¼ï¼Œå†è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒå‡ºçš„æœ€å°å€¼ï¼ŒæŽ’åœ¨ä¸Šä¸€æ¬¡çš„æœ€å°å€¼åŽï¼Œä¾æ¬¡è¿›è¡Œä¸‹åŽ»ï¼Œè¿™æ ·å°±å®žçŽ°äº†å…¨å±€æœ‰åºã€‚ çŸ¥å¦]]></content>
      <categories>
        <category>å¤´è„‘é£Žæš´</category>
      </categories>
      <tags>
        <tag>åˆ†è€Œæ²»ä¹‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MapReduceå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F05%2FMapReduce%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä¸€ã€MapReduceæ˜¯ä»€ä¹ˆ1ã€æ¦‚å¿µ MapReduceæ˜¯ä¸€ç§åˆ†å¸ƒå¼ç¦»çº¿è®¡ç®—æ¡†æž¶ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹æ¨¡åž‹ï¼Œç”¨äºŽåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šå¤§è§„æ¨¡æ•°æ®é›†(å¤§äºŽ1TB)çš„å¹¶è¡Œè¿ç®—ã€‚ åˆ†å¸ƒå¼ç¼–ç¨‹ï¼š å€ŸåŠ©ä¸€ä¸ªé›†ç¾¤ï¼Œé€šè¿‡å¤šå°æœºå™¨åŽ»å¹¶è¡Œå¤„ç†å¤§è§„æ¨¡æ•°æ®é›†ï¼Œä»Žè€ŒèŽ·å¾—æµ·é‡è®¡ç®—èƒ½åŠ›ã€‚ 2ã€ç†è§£ Map(æ˜ å°„) Reduce(å½’çº¦) æŒ‡å®šä¸€ä¸ªMap(æ˜ å°„)å‡½æ•°ï¼Œç”¨æ¥æŠŠä¸€ç»„é”®å€¼å¯¹æ˜ å°„æˆä¸€ç»„æ–°çš„é”®å€¼å¯¹ï¼ŒæŒ‡å®šå¹¶å‘çš„Reduce(å½’çº¦)å‡½æ•°ï¼Œç”¨æ¥ä¿è¯æ‰€æœ‰æ˜ å°„çš„é”®å€¼å¯¹ä¸­çš„æ¯ä¸€ä¸ªå…±äº«ç›¸åŒçš„é”®ç»„ã€‚ äºŒã€MapReduceè®¾è®¡ç†å¿µ1ã€åˆ†å¸ƒå¼è®¡ç®— åˆ†å¸ƒå¼è®¡ç®—å°†è¯¥åº”ç”¨åˆ†è§£æˆè®¸å¤šå°çš„éƒ¨åˆ†ï¼Œåˆ†é…ç»™å¤šå°è®¡ç®—æœºèŠ‚ç‚¹è¿›è¡Œå¤„ç†ã€‚è¿™æ ·å¯ä»¥èŠ‚çº¦æ•´ä½“è®¡ç®—æ—¶é—´ï¼Œå¤§å¤§æé«˜è®¡ç®—æ•ˆçŽ‡ã€‚ åˆ†è€Œæ²»ä¹‹ ç­–ç•¥ï¼š ä¸€ä¸ªå­˜å‚¨åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¤§è§„æ¨¡æ•°æ®é›†ï¼Œ ä¼šè¢«åˆ‡åˆ†æˆè®¸å¤šç‹¬ç«‹çš„åˆ†ç‰‡ï¼ˆsplitï¼‰ï¼Œ è¿™äº›åˆ†ç‰‡å¯ä»¥è¢« å¤šä¸ªMapä»»åŠ¡å¹¶è¡Œå¤„ç† 2ã€ç§»åŠ¨è®¡ç®—ï¼Œè€Œåˆ†ç§»åŠ¨æ•°æ® å°†è®¡ç®—ç¨‹åºåº”ç”¨ç§»åŠ¨åˆ°å…·æœ‰æ•°æ®çš„é›†ç¾¤è®¡ç®—æœºèŠ‚ç‚¹ä¹‹ä¸Šè¿›è¡Œè®¡ç®—æ“ä½œï¼› å°†æœ‰ç”¨ã€å‡†ç¡®ã€åŠæ—¶çš„ä¿¡æ¯æä¾›ç»™ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹çš„ä»»ä½•å®¢æˆ·ã€‚ 3ã€Master/Slaveæž¶æž„ åŒ…æ‹¬ä¸€ä¸ªMasterå’Œè‹¥å¹²ä¸ªSlaveã€‚Masterä¸Šè¿è¡ŒJobTrackerï¼ŒSlaveä¸Šè¿è¡ŒTaskTracker ä¸‰ã€MapReduceè®¡ç®—æ¡†æž¶çš„ç»„æˆ MR 1ã€ Mapperè´Ÿè´£â€œåˆ†â€ï¼Œå³æŠŠå¾—åˆ°çš„å¤æ‚çš„ä»»åŠ¡åˆ†è§£ä¸ºè‹¥å¹²ä¸ªâ€œç®€å•çš„ä»»åŠ¡â€æ‰§è¡Œã€‚ â€‹ â€œç®€å•çš„ä»»åŠ¡â€ï¼š æ•°æ®æˆ–è®¡ç®—è§„æ¨¡ç›¸å¯¹äºŽåŽŸä»»åŠ¡è¦å¤§å¤§ç¼©å°ï¼› å°±è¿‘è®¡ç®—ï¼Œå³ä¼šè¢«åˆ†é…åˆ°å­˜æ”¾äº†æ‰€éœ€æ•°æ®çš„èŠ‚ç‚¹è¿›è¡Œè®¡ç®—ï¼› æ¯ä¸ªmapä»»åŠ¡ä¹‹é—´å¯ä»¥å¹¶è¡Œè®¡ç®—ï¼Œä¸äº§ç”Ÿä»»ä½•é€šä¿¡ã€‚ split 2ã€Splitè§„åˆ™ï¼šï¼ˆå–ä¸‰è€…çš„ä¸­é—´å€¼ï¼‰ â€“ max.split(100M) â€“ min.split(10M) â€“ block(64M) max(min.split,min(max.split,block)) splitå®žé™…å¤§å°=blockå¤§å°ï¼ˆ2.Xï¼š128Mï¼‰ Mapçš„æ•°ç›®é€šå¸¸æ˜¯ç”±è¾“å…¥æ•°æ®çš„å¤§å°å†³å®šçš„ï¼Œä¸€èˆ¬å°±æ˜¯æ‰€æœ‰è¾“å…¥æ–‡ä»¶çš„æ€»å—ï¼ˆblockï¼‰æ•° 3ã€Reduceè¯¦è§£ï¼ˆæ€»Â·é‡è¦ï¼‰ â€“ Reduceçš„ä»»åŠ¡æ˜¯å¯¹mapé˜¶æ®µçš„ç»“æžœè¿›è¡Œâ€œæ±‡æ€»â€å¹¶è¾“å‡ºã€‚ Reducerçš„æ•°ç›®ç”±mapred-site.xmlé…ç½®æ–‡ä»¶é‡Œçš„é¡¹ç›®mapred.reduce.taskså†³å®šã€‚ç¼ºçœå€¼ä¸º1ï¼Œç”¨æˆ·å¯è‡ªå®šä¹‰ã€‚ 4ã€Shuffleè¯¦è§£ï¼ˆæ€»Â·æ ¸å¿ƒï¼‰ â€“ åœ¨mapperå’Œreducerä¸­é—´çš„ä¸€ä¸ªæ­¥éª¤ å¯ä»¥æŠŠmapperçš„è¾“å‡ºæŒ‰ç…§æŸç§keyå€¼é‡æ–°åˆ‡åˆ†å’Œç»„åˆæˆnä»½ï¼ŒæŠŠkeyå€¼ç¬¦åˆæŸç§èŒƒå›´çš„è¾“å‡ºé€åˆ°ç‰¹å®šçš„reduceré‚£é‡ŒåŽ»å¤„ç†ã€‚ â€“ å¯ä»¥ç®€åŒ–reducerè¿‡ç¨‹ Partitoner ï¼š hash(key) mod R å››ã€MapReduceæž¶æž„1ã€éžå…±äº«å¼æž¶æž„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰è‡ªå·±çš„å†…å­˜ï¼Œå®¹é”™æ€§æ¯”è¾ƒå¥½ã€‚ 2ã€ä¸€ä¸»å¤šä»Žæž¶æž„å¯æ‰©å±•æ€§å¥½ï¼Œç¡¬ä»¶è¦æ±‚æ˜“è¾¾åˆ°ã€‚ â€“ ä¸» JobTracker:ï¼ˆResourceManagerèµ„æºç®¡ç†ï¼‰ è´Ÿè´£è°ƒåº¦åˆ†é…æ¯ä¸€ä¸ªå­ä»»åŠ¡taskè¿è¡ŒäºŽTaskTrackerä¸Šï¼Œ å¦‚æžœå‘çŽ°æœ‰å¤±è´¥çš„taskå°±é‡æ–°åˆ†é…å…¶ä»»åŠ¡åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚ æ¯ä¸€ä¸ªhadoopé›†ç¾¤ä¸­åªä¸€ä¸ª JobTracker, ä¸€èˆ¬å®ƒè¿è¡Œåœ¨MasterèŠ‚ç‚¹ä¸Šã€‚ â€“ ä»ŽTaskTracker:ï¼ˆNodeManagerï¼‰ TaskTrackerä¸»åŠ¨ä¸ŽJobTrackeré€šä¿¡ï¼ŒæŽ¥æ”¶ä½œä¸šï¼Œå¹¶è´Ÿè´£ç›´æŽ¥æ‰§è¡Œæ¯ä¸€ä¸ªä»»åŠ¡ï¼Œ ä¸ºäº†å‡å°‘ç½‘ç»œå¸¦å®½TaskTrackeræœ€å¥½è¿è¡Œåœ¨HDFSçš„DataNodeä¸Šã€‚ MapReduceçš„ä½“ç³»ç»“æž„MapReduceä¸»è¦æœ‰ä»¥ä¸‹4ä¸ªéƒ¨åˆ†ç»„æˆ 1234567891011121314151617181 ï¼‰Clientâ€¢ç”¨æˆ·ç¼–å†™çš„MapReduceç¨‹åºé€šè¿‡Clientæäº¤åˆ°JobTrackerç«¯â€¢ç”¨æˆ·å¯é€šè¿‡Clientæä¾›çš„ä¸€äº›æŽ¥å£æŸ¥çœ‹ä½œä¸šè¿è¡ŒçŠ¶æ€2 ï¼‰JobTrackerâ€¢JobTrackerè´Ÿè´£èµ„æºç›‘æŽ§å’Œä½œä¸šè°ƒåº¦â€¢JobTracker ç›‘æŽ§æ‰€æœ‰TaskTrackerä¸ŽJobçš„å¥åº·çŠ¶å†µï¼Œä¸€æ—¦å‘çŽ°å¤±è´¥ï¼Œå°±å°†ç›¸åº”çš„ä»»åŠ¡è½¬ç§»åˆ°å…¶ä»–èŠ‚ç‚¹â€¢JobTracker ä¼šè·Ÿè¸ªä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦ã€èµ„æºä½¿ç”¨é‡ç­‰ä¿¡æ¯ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯å‘Šè¯‰ä»»åŠ¡è°ƒåº¦å™¨ï¼ˆTaskSchedulerï¼‰ï¼Œè€Œè°ƒåº¦å™¨ä¼šåœ¨èµ„æºå‡ºçŽ°ç©ºé—²æ—¶ï¼Œé€‰æ‹©åˆé€‚çš„ä»»åŠ¡åŽ»ä½¿ç”¨è¿™äº›èµ„æº3 ï¼‰TaskTrackerâ€¢TaskTracker ä¼šå‘¨æœŸæ€§åœ°é€šè¿‡â€œå¿ƒè·³â€å°†æœ¬èŠ‚ç‚¹ä¸Šèµ„æºçš„ä½¿ç”¨æƒ…å†µå’Œä»»åŠ¡çš„è¿è¡Œè¿›åº¦æ±‡æŠ¥ç»™JobTrackerï¼ŒåŒæ—¶æŽ¥æ”¶JobTracker å‘é€è¿‡æ¥çš„å‘½ä»¤å¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼ˆå¦‚å¯åŠ¨æ–°ä»»åŠ¡ã€æ€æ­»ä»»åŠ¡ç­‰ï¼‰â€¢TaskTracker ä½¿ç”¨â€œslotâ€ç­‰é‡åˆ’åˆ†æœ¬èŠ‚ç‚¹ä¸Šçš„èµ„æºé‡ï¼ˆCPUã€å†…å­˜ç­‰ï¼‰ã€‚ä¸€ä¸ªTask èŽ·å–åˆ°ä¸€ä¸ªslot åŽæ‰æœ‰æœºä¼šè¿è¡Œï¼Œè€ŒHadoopè°ƒåº¦å™¨çš„ä½œç”¨å°±æ˜¯å°†å„ä¸ªTaskTrackerä¸Šçš„ç©ºé—²slotåˆ†é…ç»™Taskä½¿ç”¨ã€‚slot åˆ†ä¸ºMap slot å’ŒReduce slot ä¸¤ç§ï¼Œåˆ†åˆ«ä¾›MapTaskå’ŒReduce Taskä½¿ç”¨ï¼ˆæ‰€ä»¥æœ€å¥½æ”¾åœ¨DataNodeä¸Šï¼‰4 ï¼‰TaskTask åˆ†ä¸ºMap Task å’ŒReduce Task ä¸¤ç§ï¼Œå‡ç”±TaskTracker å¯åŠ¨ äº”ã€MapReduceæ­å»º1ã€èŠ‚ç‚¹åˆ†å¸ƒæƒ…å†µ NN DN JN ZK ZKFC RM node00 âˆš âˆš node01 âˆš âˆš node02 âˆš 2ã€é…ç½®æ–‡ä»¶ ä¿®æ”¹é…ç½®æ–‡ä»¶ (1)mapred-site.xml:ï¼ˆé…ç½®mapreudceéœ€è¦çš„æ¡†æž¶çŽ¯å¢ƒï¼‰ è·¯å¾„ï¼šF:\hadoop-2.6.5\etc\hadoop\mapred-site.xml 123456&lt;configuration&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; ï¼ˆ2ï¼‰yarn-site.xml:ï¼ˆé…ç½®yarnçš„ä»»åŠ¡è°ƒåº¦çš„è®¡ç®—æ¡†æž¶ï¼‰ 123456&lt;configuration&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; å› ä¸ºResourceManager å’ŒNodeManagerä¸»ä»Žç»“æž„ï¼ŒRMå­˜åœ¨å•ç‚¹æ•…éšœï¼Œè¦å¯¹å®ƒåšHAï¼ˆé€šè¿‡ZKï¼‰ ä¿®æ”¹yarn-site.xmlé…ç½®æ–‡ä»¶,å®Œæ•´çš„å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728 &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt;&lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt; &lt;value&gt;Sunrise&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt; &lt;value&gt;rm1,rm2&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt; &lt;value&gt;node03&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt; &lt;value&gt;node04&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt; &lt;value&gt;node01:2181,node02:2181,node03:2181&lt;/value&gt; &lt;/property&gt; å…­ã€ä¸ªäººç†è§£ åŸºäºŽæºç ï¼Œå¯¹mapreduceçš„å·¥ä½œæµç¨‹çš„æè¿°ï¼š 12345678910111213141516171819ä¸€ä¸ªåº”ç”¨ç¨‹åºè¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®å¤„ç†åˆ†æžæ•°æ®æ–‡ä»¶ä¿å­˜åœ¨HDFSä¸­ï¼Œåˆ†å—å­˜å‚¨åœ¨åˆ†å¸ƒå¼èŠ‚ç‚¹ä¸Šé¦–å…ˆæ˜¯å°†æ•°æ®æ–‡ä»¶åˆ‡åˆ†æˆè®¸å¤šsplitåˆ‡ç‰‡æ¯ä¸€ä¸ªsplitåˆ‡ç‰‡å•ç‹¬å¯åŠ¨ä¸€ä¸ªmapä»»åŠ¡ï¼Œæ‰€ä»¥ä¼šå¯åŠ¨å¤šä¸ªmapä»»åŠ¡mapé˜¶æ®µçš„è¾“å…¥æ˜¯è¯¸å¤š(key,value),è¾“å‡ºæ˜¯æ–°çš„ï¼ˆkey,valueï¼‰,ç„¶åŽè¢«æ‹‰åŽ»åˆ°ä¸åŒçš„reduceä¸Šå¹¶è¡Œå¤„ç†æ“ä½œæ‰€ä»¥æ¯ä¸ªmapçš„è¾“å‡ºé˜¶æ®µéƒ½æ‰§è¡Œåˆ†åŒºæ“ä½œï¼Œå¹¶å†³å®šreduceä»»åŠ¡çš„ä¸ªæ•°ç„¶åŽå¯¹mapè¾“å‡ºç»“æžœè¿›è¡ŒæŽ’åºã€å½’å¹¶ã€åˆå¹¶ï¼Œè¿™ä¸ªè¿‡ç¨‹å«mapé˜¶æ®µçš„shuffleshuffleç»“æŸåŽï¼Œå°†ç›¸åº”çš„ç»“æžœåˆ†å‘ç»™reduceï¼Œè®©reduceå®ŒæˆåŽç»­çš„å·¥ä½œ ç»“æŸåŽï¼Œå°†ç»“æžœè¾“å‡ºç»™HDFSã€‚ä¸åŒçš„mapä¹‹é—´ä¸ä¼šé€šä¿¡ï¼Œä¸åŒçš„reduceä¹Ÿä¸ä¼šé€šä¿¡ï¼Œæ•´ä¸ªè¿‡ç¨‹å¯¹ç”¨æˆ·é€æ˜Žã€‚ shuffle MapReduceæ‰§è¡Œçš„å„ä¸ªé˜¶æ®µï¼š 123456789101112131ã€ä»ŽHDFSä¸­åŠ è½½æ–‡ä»¶ï¼ŒåŠ è½½è¯»å–ç”±INputFormatæ¨¡å—æ¥å®Œæˆï¼Œå¯¹è¾“å…¥è´Ÿè´£æ ¼å¼éªŒè¯ï¼ŒåŒæ—¶ï¼Œå¯¹æ•°æ®è¿›è¡Œé€»è¾‘ä¸Šåˆ‡åˆ†æˆsplit2ã€ç”±record readå…·ä½“æ ¹æ®åˆ†ç‰‡çš„ä½ç½®é•¿åº¦ä¿¡æ¯åŽ»æ‰¾å„ä¸ªblockï¼Œä»¥ï¼ˆkeyï¼Œvalueï¼‰è¾“å‡ºï¼Œä½œä¸ºmapçš„è¾“å…¥ï¼Œ3ã€mapä¸­æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„mapå‡½æ•°å°±å¯ä»¥è¿›è¡Œç›¸åº”çš„æ•°æ®å¤„ç†ï¼Œå¹¶è¾“å‡ºä¸€å †ï¼ˆkeyï¼Œvalueï¼‰ï¼Œä½œä¸ºä¸­é—´ç»“æžœ4ã€ä¹‹åŽï¼Œæ˜¯shuffleï¼ˆæ´—ç‰Œï¼‰è¿‡ç¨‹å¯¹è¿™ä¸­é—´ç»“æžœè¿›è¡Œåˆ†åŒºã€æŽ’åºã€åˆå¹¶ï¼Œå¹¶æº¢å†™åˆ°ç£ç›˜ï¼Œ5ã€ç›¸åº”çš„reduceä»»åŠ¡å°±ä¼šæ¥fetchå¯¹åº”çš„åˆ†åŒºï¼ˆkeyï¼Œvalueï¼ˆlistï¼‰ï¼‰6ã€reduceä¸­æœ‰ç”¨æˆ·è‡ªå®šä¹‰çš„reduceå‡½æ•°å°±å¯ä»¥å®Œæˆå¯¹æ•°æ®çš„åˆ†æžï¼Œç»“æžœä»¥æ–°çš„ï¼ˆkeyï¼Œvalueï¼‰è¾“å‡º7ã€è¾“å‡ºç»“æžœå€ŸåŠ©OutputFormatæ¨¡å—å¯¹è¾“å‡ºæ ¼å¼è¿›è¡Œæ£€æŸ¥ï¼Œä»¥åŠç›¸å…³ç›®å½•æ˜¯å¦å­˜åœ¨ç­‰ï¼Œæœ€åŽå†™å…¥åˆ°HDFSä¸­ã€‚ split å…³äºŽsplitçš„åˆ‡åˆ†çš„ç†è§£ï¼š 1234561ã€InputFormatå°†å¤§çš„æ•°æ®æ–‡ä»¶åˆ†æˆå¾ˆå¤šsplit2ã€æ–‡ä»¶åœ¨HDFSä¸­æ˜¯ä»¥å¾ˆå¤šä¸ªç‰©ç†å—blockåˆ†å¸ƒå¼å­˜å‚¨ä¸åŒçš„èŠ‚ç‚¹ä¸Š3ã€åˆ‡ç‰‡æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„é€»è¾‘åˆ†ç‰‡4ã€splitçš„æ•°é‡å†³å®šmapä»»åŠ¡çš„æ•°é‡5ã€åˆ‡ç‰‡è¿‡å¤šä¼šå¯¼è‡´mapä»»åŠ¡å¯åŠ¨è¿‡å¤šï¼Œmapä»»åŠ¡ä¹‹é—´åˆ‡æ¢çš„æ—¶å€™å°±ä¼šè€—è´¹ç›¸å…³çš„ç®¡ç†èµ„æºï¼Œæ‰€ä»¥åˆ‡ç‰‡è¿‡å¤šä¼šå½±å“æ‰§è¡Œæ•ˆçŽ‡6ã€ åˆ‡ç‰‡è¿‡å°‘åˆä¼šå½±å“ä»»åŠ¡æ‰§è¡Œçš„å¹¶è¡Œåº¦ï¼Œæ‰€ä»¥ç†æƒ³æƒ…å†µç”¨blockå—çš„å¤§å°ä½œä¸ºåˆ‡ç‰‡çš„å¤§å°ã€‚ å…³äºŽshuffleçš„ç†è§£ 123456789mapç«¯shuffle1ã€ä»ŽHDFSè¾“å…¥æ•°æ®å’Œæ‰§è¡Œmapä»»åŠ¡ï¼Œåœ¨mapä»»åŠ¡æ‰§è¡Œä¹‹å‰ï¼ŒRecordReaderé˜…è¯»å™¨è¿˜å°†æ•°æ®å˜æˆæ»¡è¶³Mapå‡½æ•°æ‰€éœ€çš„ï¼ˆKï¼ŒVï¼‰å½¢å¼ï¼Œç„¶åŽInputFormatä¼šå°†å…¶åˆ‡åˆ†æˆè‹¥å¹²åˆ‡ç‰‡ï¼ˆä¸€å †ï¼ˆKï¼ŒVï¼‰ï¼‰ã€‚2ã€æ¯ä¸ªåˆ‡ç‰‡ä¼šåˆ†é…ä¸€ä¸ªmapä»»åŠ¡ï¼Œæ¯ä¸ªmapä»»åŠ¡ä¼šåˆ†é…ä¸€ä¸ªé»˜è®¤çš„ç¼“å­˜ï¼Œä¸€èˆ¬é»˜è®¤ç¼“å­˜ä¸º100M.mapçš„è¾“å‡ºé”®å€¼å¯¹ä½œä¸ºä¸­é—´ç»“æžœå…ˆå†™å…¥åˆ°ç¼“å­˜ï¼ˆç›´æŽ¥å†™å…¥ç£ç›˜ä¼šå¢žåŠ å¯»å€å¼€é”€ï¼Œæ‰€ä»¥é›†ä¸­å†™å…¥ç£ç›˜ä¸€æ¬¡å¯»å€å°±å¯ä»¥å®Œæˆæ‰¹é‡å†™å…¥ï¼Œå°±å¯ä»¥å°†å¯»å€å¼€é”€åˆ†æ‘Šåˆ°å¤§é‡æ•°æ®ä¸­ï¼Œè¿™å°±æ˜¯ç¼“å­˜çš„ä½œç”¨ï¼‰ã€‚3ã€å½“å†™å…¥çš„å†…å®¹è¾¾åˆ°ç¼“å­˜ç©ºé—´çš„ä¸€å®šæ¯”ä¾‹åŽï¼ˆæº¢å†™æ¯”ï¼Œä¸€èˆ¬ä¸º0.8ï¼Œå°±æ˜¯80Mçš„æ—¶å€™ï¼Œä¸ºäº†ä¸å½±å“mapä»»åŠ¡çš„ç»§ç»­æ‰§è¡Œï¼‰ï¼Œä¼šå¯åŠ¨æº¢å†™è¿›ç¨‹ï¼ŒæŠŠç¼“å­˜ä¸­ç›¸å…³æ•°æ®å†™å…¥ç£ç›˜ã€‚4ã€åœ¨æº¢å†™è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰§è¡Œåˆ†åŒºï¼ˆpartitionï¼‰ã€æŽ’åºï¼ˆsortï¼ŒæŒ‰ç…§keyå€¼ï¼‰å’Œå¯èƒ½çš„åˆå¹¶ï¼ˆcombineï¼Œä¸ºäº†å‡å°‘æº¢å†™åˆ°ç£ç›˜çš„æ•°æ®é‡ï¼Œæ…Žç”¨ï¼‰æ“ä½œï¼Œå†™å…¥ç£ç›˜ï¼Œç”Ÿæˆç£ç›˜çš„æº¢å†™æ–‡ä»¶ã€‚5ã€åœ¨mapä»»åŠ¡è¿è¡Œç»“æŸå‰ï¼Œç³»ç»Ÿä¼šå¯¹æº¢å†™æ–‡ä»¶è¿›è¡Œå½’å¹¶ï¼ˆmergeï¼‰ï¼Œå½¢æˆå¤§æ–‡ä»¶ï¼ˆé‡Œé¢çš„é”®å€¼å¯¹æ˜¯åˆ†åŒºï¼ŒæŽ’åºçš„ï¼‰,æ–‡ä»¶æ ¼å¼ä¸ºï¼ˆkey,value&lt;list&gt;ï¼‰ï¼Œå½’å¹¶æ—¶å¦‚æžœæº¢å†™æ–‡ä»¶å¤§äºŽé¢„å®šå€¼ï¼ˆé»˜è®¤ä¸º3ï¼‰ï¼Œä¼šå†æ¬¡åˆå¹¶reduceç«¯shuffle1ã€reduceä»»åŠ¡ä¼šè¯¢é—®JobTrackerï¼ŒåŽ»æ‹‰å–mapæœºå™¨ä¸Šçš„å±žäºŽè‡ªå·±çš„åˆ†åŒºï¼Œå¯¹æ¥è‡ªä¸åŒæœºå™¨çš„æ•°æ®è¿›è¡Œå½’å¹¶ã€åˆå¹¶ï¼Œç„¶åŽè¾“å…¥åˆ°reduceå‡½æ•°ä¸­è¿›è¡Œæ•°æ®çš„å¤„ç†åˆ†æžï¼Œå†å†™å…¥ç£ç›˜ æˆ‘ MapReduceåº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>MapReduce</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hadoop2.X]]></title>
    <url>%2F2019%2F01%2F04%2FHadoop2.X%2F</url>
    <content type="text"><![CDATA[[TOC] ä¸€ã€Hadoop 2.xäº§ç”ŸèƒŒæ™¯1ã€Hadoop 1.0å­˜åœ¨çš„é—®é¢˜ï¼ˆ1ï¼‰HDFSå­˜åœ¨çš„é—®é¢˜ NameNodeå•ç‚¹æ•…éšœï¼Œéš¾ä»¥åº”ç”¨äºŽåœ¨çº¿åœºæ™¯ NameNodeï¼ˆä¸€ä¸ªï¼‰åŽ‹åŠ›è¿‡å¤§ï¼Œå†…å­˜å—é™ï¼Œå½±å“ç³»ç»Ÿæ‰©å±•æ€§ ï¼ˆ2ï¼‰MapReduceå­˜åœ¨çš„é—®é¢˜ JobTrackerè®¿é—®åŽ‹åŠ›å¤§ï¼Œå½±å“ç³»ç»Ÿæ‰©å±•æ€§ éš¾ä»¥æ”¯æŒMapReduceä»¥å¤–çš„è®¡ç®—æ¡†æž¶ï¼Œæ¯”å¦‚Sparkã€Storm 2ã€Hadoop 2.0åˆ†æ”¯HDFSï¼šåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»ŸMapReduceï¼šè®¡ç®—æ¡†æž¶YARNï¼šèµ„æºç®¡ç†ç³»ç»Ÿ 3ã€ç‰¹ç‚¹ 1ï¼‰. è§£å†³å•ç‚¹æ•…éšœï¼šHDFS HAï¼ˆé«˜å¯ç”¨ï¼‰ é€šè¿‡ä¸»å¤‡NameNodeè§£å†³ï¼Œå¦‚æžœä¸»NameNodeå‘ç”Ÿæ•…éšœï¼Œå°±åˆ‡æ¢åˆ°å¤‡NameNodeä¸Š | 2).è§£å†³å†…å­˜å—é™é—®é¢˜ï¼šHDFS Federationï¼ˆè”é‚¦åˆ¶ï¼‰ã€HA HAï¼šä¸¤ä¸ªNameNode (3.0å°±å®žçŽ°äº†ä¸€ç»„å¤šä»Žï¼šæ°´å¹³æ‰©å±•ï¼Œæ”¯æŒå¤šä¸ªNameNodeï¼›æ¯ä¸ªNameNodeåˆ†ç®¡ä¸€éƒ¨åˆ†ç›®å½•ï¼›æ‰€æœ‰NameNodeå…±äº«æ‰€æœ‰DataNodeèµ„æº) 3).ä»…æž¶æž„ä¸Šå‘ç”Ÿå˜åŒ–ä½¿ç”¨æ–¹å¼ä¸å˜ äºŒã€HDFS HAç»“æž„åŠåŠŸèƒ½**HADNï¼šDataNodeï¼ˆæ•°æ®èŠ‚ç‚¹ï¼‰ å­˜æ”¾æ•°æ®blockå—ï¼›éµå¾ªå¿ƒè·³æœºåˆ¶å‘NN Activeå’ŒNN Standbyæ±‡æŠ¥blockå—ä¿¡æ¯ï¼Œä½†åªæ‰§è¡Œactiveçš„å‘½ä»¤ ä¸»å¤‡NNï¼šNameNode Active å’Œ NameNode Standby ï¼ˆä¸»å¤‡åç§°èŠ‚ç‚¹ï¼‰ ä¸»NNå¯¹å¤–æä¾›è¯»å†™æœåŠ¡ï¼Œå¤‡NNåŒæ­¥ä¸»NNå…ƒæ•°æ®ï¼Œä»¥å¾…åˆ‡æ¢ï¼Œæ‰€æœ‰çš„DNåŒæ—¶å‘ä¸¤ä¸ªNNæ±‡æŠ¥æ•°æ®å—ä¿¡æ¯ å…ƒæ•°æ®ä¿¡æ¯åŠ è½½åˆ°ä¸»NNï¼Œå¹¶å†™å…¥JNï¼ˆè‡³å°‘å†™ä¸¤å°ï¼šè¿‡åŠåŽŸåˆ™ï¼‰ï¼› å¤‡NNå¯ä»¥ä»ŽJNä¸­åŒæ­¥å…ƒæ•°æ®ä¿¡æ¯ï¼› è§£å†³å•ç‚¹æ•…éšœï¼› â€“ä¸¤ç§åˆ‡æ¢æ–¹å¼ï¼š æ‰‹åŠ¨ï¼šé€šè¿‡å‘½ä»¤å®žçŽ°ä¸»å¤‡åˆ‡æ¢ è‡ªåŠ¨ï¼šåŸºäºŽZookeeperå®žçŽ°ï¼ˆè¯¦æƒ…è§æ­å»ºæ­¥éª¤ï¼‰ JNï¼šJournalNodeï¼ˆè‡³å°‘3å°ï¼‰ å­˜å‚¨ä¸»NNå…ƒæ•°æ®ä¿¡æ¯ï¼Œå®žçŽ°ä¸»å¤‡NNé—´æ•°æ®å…±äº«ï¼› ï¼ˆéµå¾ªè¿‡åŠåŽŸåˆ™ï¼šè‡³å°‘æœ‰è¿‡åŠçš„æ•°é‡å‚ä¸ŽæŠ•ç¥¨ï¼‰ ZKFCï¼šFailoverControllerï¼ˆç«žäº‰é”ï¼‰ è°æ‹¿åˆ°äº†è¿™ä¸ªæ‰€ï¼Œè°å°±æ˜¯active NN å¿ƒè·³æœºåˆ¶ç›‘æŽ§ä¸»å¤‡NNçŠ¶æ€ï¼Œä¸€æ—¦å‡ºçŽ°ä¸€å°æŒ‚æœºï¼Œå°±ä¼šé‡Šæ”¾é”ï¼Œå¦ä¸€ä¸ªNNå°±ä¼šç«‹å³å¯åŠ¨ç«žäº‰é”ï¼Œæˆä¸ºactive NN ZKï¼šZookeeperï¼ˆè‡³å°‘3å°ï¼‰ ï¼ˆå®žçŽ°ä¸»å¤‡NNåˆ‡æ¢ï¼‰ **è”é‚¦ é€šè¿‡å¤šä¸ªnamenode/namespaceæŠŠå…ƒæ•°æ®çš„å­˜å‚¨å’Œç®¡ç†åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸­ï¼Œä½¿åˆ°namenode/namespaceå¯ä»¥é€šè¿‡å¢žåŠ æœºå™¨æ¥è¿›è¡Œæ°´å¹³æ‰©å±• é€šè¿‡å¤šä¸ªnamespaceæ¥éš”ç¦»ä¸åŒç±»åž‹çš„åº”ç”¨ï¼ŒæŠŠä¸åŒç±»åž‹åº”ç”¨çš„HDFSå…ƒæ•°æ®çš„å­˜å‚¨å’Œç®¡ç†åˆ†æ´¾åˆ°ä¸åŒçš„namenodeä¸­ã€‚ ä¸‰ã€YARN(èµ„æºç®¡ç†)???????è¯¦è§Yarnå­¦ä¹ .md 1ã€æ ¸å¿ƒæ€æƒ³ï¼šSourceManagerï¼ˆèµ„æºç®¡ç†ï¼‰+ReplicationMasterï¼ˆä»»åŠ¡è°ƒåº¦ï¼‰ 2.yarnçš„å¼•å…¥ä½¿å¾—å¤šä¸ªè®¡ç®—æ¡†æž¶å¯ä»¥åº”ç”¨åˆ°ä¸€ä¸ªé›†ç¾¤ä¸­ å››ã€Zookeeperå·¥ä½œåŽŸç†è¯¦è§Zookeeperå­¦ä¹ .md äº”ã€Hadoop2.X é›†ç¾¤æ­å»º1ã€linuxçŽ¯å¢ƒä¸‹æ­å»º NN DN JN ZKFC ZK SM RM node00 âˆš âˆš âˆš âˆš âˆš âˆš âˆš node01 âˆš âˆš âˆš âˆš âˆš âˆš node02 âˆš âˆš âˆš âˆš 0.åœ¨æ­å»ºçŽ¯å¢ƒä¹‹å‰çš„å‡†å¤‡ ä¸‰å°è™šæ‹Ÿæœºï¼š 1234567å…³é—­é˜²ç«å¢™å®‰è£…jdkç¼–è¾‘/etc/hosts/ç»™å„ä¸ªèŠ‚ç‚¹æœåŠ¡å™¨èµ·åˆ«åæ—¶é—´æœåŠ¡å™¨ï¼šntpdate å®‰è£…ï¼šyum install ntpdate -y ç”Ÿæˆï¼šntpdate cn.ntp.org.cnå…å¯†ç™»å½•çŽ¯å¢ƒå‡†å¤‡ åœ¨hadoopå®‰è£…ç›®å½•ä¸‹hadoop-2.6.5/etc/hadoop/ ç¼–è¾‘hadoop-env.sh 1export JAVA_HOME=/usr/soft/jdk1.8.0_191 2.ç¼–è¾‘core-site.xml 123456789101112131415&lt;configuration&gt;&lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://Sunrise&lt;/value&gt;&lt;!--é…ç½®é›†ç¾¤çš„åå­—--&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt; &lt;value&gt;node00:2181,node01:2181,node02:2181&lt;/value&gt; &lt;!--é…ç½®zookeeperï¼šä¸‰ä¸ªèŠ‚ç‚¹--&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/opt/hadoop&lt;/value&gt;&lt;!--é…ç½®hadoopåŸºç¡€é…ç½®å­˜æ”¾çš„è·¯å¾„--&gt;&lt;/property&gt;&lt;/configuration&gt; 3.ç¼–è¾‘hdfs-site.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;configuration&gt;&lt;property&gt; &lt;name&gt;dfs.nameservices&lt;/name&gt; &lt;value&gt;sxt&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.ha.namenodes.Sunrise&lt;/name&gt; &lt;value&gt;nn1,nn2&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.Sunrise.nn1&lt;/name&gt; &lt;value&gt;node00:8020&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.rpc-address.Sunrise.nn2&lt;/name&gt; &lt;value&gt;node01:8020&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.http-address.Sunrise.nn1&lt;/name&gt; &lt;value&gt;node00:50070&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;name&gt;dfs.namenode.http-address.Sunrise.nn2&lt;/name&gt; &lt;value&gt;node01:50070&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;!-- æŒ‡å®šnamenodeå…ƒæ•°æ®å­˜å‚¨åœ¨journalnodeä¸­çš„è·¯å¾„ --&gt; &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt; &lt;value&gt;qjournal://node00:8485;node01:8485;node02:8485/sxt&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;!-- æŒ‡å®šHDFSå®¢æˆ·ç«¯è¿žæŽ¥active namenodeçš„javaç±» --&gt; &lt;name&gt;dfs.client.failover.proxy.provider.Sunrise&lt;/name&gt;&lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;&lt;/property&gt;&lt;property&gt; &lt;!-- é…ç½®éš”ç¦»æœºåˆ¶ä¸ºssh é˜²æ­¢è„‘è£‚ï¼šä¿è¯activeNNä»…æœ‰ä¸€å°--&gt; &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt; &lt;value&gt;sshfence&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;!-- æŒ‡å®šç§˜é’¥çš„ä½ç½® --&gt; &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt; &lt;value&gt;/root/.ssh/id_dsa&lt;/value&gt; &lt;!--å…å¯†ç™»å½•æ˜¯ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæœ‰çš„æ˜¯id_rsa--&gt;&lt;/property&gt;&lt;property&gt; &lt;!-- æŒ‡å®šjournalnodeæ—¥å¿—æ–‡ä»¶å­˜å‚¨çš„è·¯å¾„ --&gt; &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt; &lt;value&gt;/opt/hadoop/data&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;!-- å¼€å¯è‡ªåŠ¨æ•…éšœè½¬ç§» --&gt; &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt; &lt;value&gt;true&lt;/value&gt;&lt;/property&gt;&lt;/configuration&gt; é…ç½®hadoopä¸­çš„slavesï¼ˆä¸»ä»Žæž¶æž„ï¼šdatanodeï¼‰ 123node00node01node02 5.å‡†å¤‡zookeeper ä¸‰å°zookeeperï¼šnode00ï¼Œnode01ï¼Œnode02 ç¼–è¾‘zookeeper-3.4.13/conf/zoo.cfg 123456789tickTime=2000initLimit=10syncLimit=5dataDir=/usr/soft/zookeeper-3.4.13/datadataLogDir=/usr/soft/zookeeper-3.4.13/logsclientPort=2181server.1=node00:2888:3888server.2=node01:2888:3888server.3=node02:2888:3888 åœ¨dataDirç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶myidï¼Œä¸‰å°èŠ‚ç‚¹çš„æ–‡ä»¶å†…å®¹åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3 6.é…ç½®çŽ¯å¢ƒå˜é‡ vim ~/.bash_profile 123456JAVA_HOME=/usr/soft/jdk1.8.0_191export PATH=$PATH:$JAVA_HOME/binHADOOP_HOME=/usr/soft/hadoop-2.6.5export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbinZOOKEEPER_HOME=/usr/soft/zookeeper-3.4.13export PATH=$PATH:$ZOOKEEPER_HOME/bin source ~/.bash_profile ä½¿å…¶æˆä¸ºèµ„æºæ–‡ä»¶ï¼Œå‘é€åˆ°å…¶ä»–èŠ‚ç‚¹åŽï¼Œä¹Ÿéœ€è¦æ­¤æ“ä½œ 7.å°†ä»¥ä¸Šé…ç½®æ–‡ä»¶è¿œç¨‹å‘é€è‡³å…¶ä»–èŠ‚ç‚¹æœåŠ¡å™¨ scp -r filename nodename:pwd 8.å‘½ä»¤æ“ä½œï¼š 123456789101112131415161. å¯åŠ¨ä¸‰ä¸ªzookeeperï¼š./zkServer.sh start2. å¯åŠ¨ä¸‰ä¸ªJournalNodeï¼š./hadoop-daemon.sh start journalnode3. ï¼ˆç”Ÿæˆfsimageæ–‡ä»¶ï¼‰åœ¨å…¶ä¸­ä¸€ä¸ªnamenodeä¸Šæ ¼å¼åŒ–ï¼š hdfs namenode -format4. æŠŠåˆšåˆšæ ¼å¼åŒ–ä¹‹åŽçš„å…ƒæ•°æ®æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªnamenodeä¸Š a) å¯åŠ¨åˆšåˆšæ ¼å¼åŒ–çš„namenode : hadoop-daemon.sh start namenode b) ï¼ˆåŒæ­¥fsimageæ–‡ä»¶ï¼‰åœ¨å¦ä¸€ä¸ªï¼ˆæ²¡æœ‰æ ¼å¼åŒ–çš„ï¼‰namenodeä¸Šæ‰§è¡Œï¼š hdfs namenode -bootstrapStandby c) å¯åŠ¨æ²¡æ ¼å¼åŒ–çš„namenodeï¼š hadoop-daemon.sh start namenode5. ï¼ˆåˆå§‹åŒ–ç«žäº‰é”zookeeperï¼‰åœ¨å…¶ä¸­ä¸€ä¸ªnamenodeä¸Šåˆå§‹åŒ–zkfcï¼š hdfs zkfc -formatZK6. åœæ­¢ä¸Šé¢èŠ‚ç‚¹ï¼šstop-dfs.sh7. å…¨é¢å¯åŠ¨ï¼ˆä¸‰ä¸ªèŠ‚ç‚¹ï¼‰ï¼šstart-dfs.sh8. å¯åŠ¨yarnèµ„æºç®¡ç†å™¨ yarn-daemon.sh start resourcemanager (yarn resourcemanager ) 2ã€ä½¿ç”¨ï¼ˆå¯åŠ¨æ­¥éª¤ï¼‰ 1234(1)å…³é—­é˜²ç«å¢™ï¼šservice iptables stop ï¼ˆ3å°ï¼‰(2)å¯åŠ¨zookeeper:zkServer.sh start ï¼ˆ3å°ï¼‰(3)å¯åŠ¨é›†ç¾¤ï¼šstart-dfs.sh |ï¼ˆstart-all.sh : åŒæ—¶å¯åŠ¨hdfså’Œyarn)(4)å¯åŠ¨yarnï¼šyarn-daemon.sh start resourcemanager ï¼ˆå¯3å°ï¼‰ ï¼ˆå…³é—­æ­¥éª¤ï¼‰ 123(1)å…³é—­yarnï¼šyarn-daemon.sh stop resourcemanager ï¼ˆå¼€å‡ å°å…³å‡ å°ï¼‰(2)å…³é—­é›†ç¾¤ï¼šstop-dfs.sh |ï¼ˆstop-all.sh :åŒæ—¶å…³é—­hdfså’Œyarnï¼‰ ï¼ˆ3å°ï¼‰(3)å…³é—­zookeeperï¼šzkServer.sh stop ï¼ˆ3å°ï¼‰ 12345678æœ‰å¯èƒ½ä¼šå‡ºé”™çš„åœ°æ–¹1ï¼Œ ç¡®è®¤æ¯å°æœºå™¨é˜²ç«å¢™å‡å…³æŽ‰2ï¼Œ ç¡®è®¤æ¯å°æœºå™¨çš„æ—¶é—´æ˜¯ä¸€è‡´çš„3ï¼Œ ç¡®è®¤é…ç½®æ–‡ä»¶æ— è¯¯ï¼Œå¹¶ä¸”ç¡®è®¤æ¯å°æœºå™¨ä¸Šé¢çš„é…ç½®æ–‡ä»¶ä¸€æ ·4ï¼Œ å¦‚æžœè¿˜æœ‰é—®é¢˜æƒ³é‡æ–°æ ¼å¼åŒ–ï¼Œé‚£ä¹ˆå…ˆæŠŠæ‰€æœ‰èŠ‚ç‚¹çš„è¿›ç¨‹å…³æŽ‰5ï¼Œ åˆ é™¤ä¹‹å‰æ ¼å¼åŒ–çš„æ•°æ®ç›®å½•hadoop.tmp.dirå±žæ€§å¯¹åº”çš„ç›®å½•ï¼Œæ‰€æœ‰èŠ‚ç‚¹åŒæ­¥éƒ½åˆ æŽ‰ï¼Œåˆ«å•åˆ æŽ‰ä¹‹å‰çš„ä¸€ä¸ªï¼Œåˆ æŽ‰ä¸‰å°JNèŠ‚ç‚¹ä¸­dfs.journalnode.edits.dirå±žæ€§æ‰€å¯¹åº”çš„ç›®å½•6ï¼Œ æŽ¥ä¸Šé¢çš„ç¬¬6æ­¥åˆå¯ä»¥é‡æ–°æ ¼å¼åŒ–å·²ç»å¯åŠ¨äº†7ï¼Œ æœ€ç»ˆActive NamenodeåœæŽ‰çš„æ—¶å€™ï¼ŒStandByå¯ä»¥è‡ªåŠ¨æŽ¥ç®¡ï¼]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Zookeeperå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F03%2FZookeeper%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[[TOC] åŠ¨ç‰©å›­ç®¡ç†å‘˜ æŽ¨èå›¾ä¹¦ï¼šã€Šä»ŽPaxoåˆ°Zookeeperã€‹ Zookeeper1ã€ç®€ä»‹ å¼€æºçš„ã€åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œæä¾›ä¸€è‡´æ€§æœåŠ¡ï¼Œæ˜¯Haoop ï¼ˆå®žçŽ°HAï¼‰å’ŒHbaseï¼ˆå’Œzookeeperæ˜¯å¼ºä¾èµ–å…³ç³»ï¼‰çš„é‡è¦ç»„ä»¶ æä¾›çš„åŠŸèƒ½ï¼š é…ç½®ç»´æŠ¤ åŸŸåç»´æŠ¤ åˆ†å¸ƒå¼çš„åŒæ­¥ ç»„æœåŠ¡ Zookeeperâ†’æä¾›é€šç”¨åˆ†å¸ƒå¼é”æœåŠ¡ï¼Œç”¨ä»¥åè°ƒåˆ†å¸ƒå¼åº”ç”¨ Keepalivedâ†’å®žçŽ°èŠ‚ç‚¹å¥åº·æ£€æŸ¥ï¼Œé‡‡ç”¨ä¼˜å…ˆçº§ç›‘æŽ§ï¼Œæ²¡æœ‰ååŒå·¥ä½œï¼ŒåŠŸèƒ½å•ä¸€ï¼Œå¯æ‰©å±•æ€§å·®ã€‚ 2ã€Zookeepè€Œè§’è‰² ï¼ˆä¸€èˆ¬å¾ˆå°‘é…ç½®Observerï¼Œå› ä¸ºç”¨çš„å°‘ï¼Œè€Œä¸”é…ç½®çš„èŠ‚ç‚¹ä¸€èˆ¬ä¸ºå¥‡æ•°ï¼‰ Zookeeperéœ€ä¿è¯é«˜å¯ç”¨å’Œå¼ºä¸€è‡´æ€§ï¼› â€‹ ä¸ºäº†æ”¯æŒæ›´å¤šçš„å®¢æˆ·ç«¯ï¼Œéœ€è¦å¢žåŠ æ›´å¤šServerï¼› â€‹ Serverå¢žå¤šï¼ŒæŠ•ç¥¨é˜¶æ®µå»¶è¿Ÿå¢žå¤§ï¼Œå½±å“æ€§èƒ½ï¼› â€‹ æƒè¡¡ä¼¸ç¼©æ€§å’Œé«˜åžåçŽ‡ï¼Œå¼•å…¥Observer â€‹ Observerä¸å‚ä¸ŽæŠ•ç¥¨ï¼› â€‹ ObserversæŽ¥å—å®¢æˆ·ç«¯çš„è¿žæŽ¥ï¼Œå¹¶å°†å†™è¯·æ±‚è½¬å‘ç»™leaderèŠ‚ç‚¹ï¼› â€‹ åŠ å…¥æ›´å¤šObserverèŠ‚ç‚¹ï¼Œæé«˜ä¼¸ç¼©æ€§ï¼ŒåŒæ—¶ä¸å½±å“åžåçŽ‡ã€‚ 3ã€Zookeeperç‰¹ç‚¹ ç‰¹ç‚¹ è¯´æ˜Ž æœ€ç»ˆä¸€è‡´æ€§ ä¸ºå®¢æˆ·ç«¯å±•ç¤ºåŒä¸€ä¸ªè§†å›¾ï¼Œè¿™æ˜¯zookeeperé‡Œé¢ä¸€ä¸ªéžå¸¸é‡è¦çš„åŠŸèƒ½ï¼ˆä¸Žå¼ºä¸€è‡´æ€§ç›¸å¯¹ï¼‰ å¯é æ€§ å¦‚æžœæ¶ˆæ¯è¢«åˆ°ä¸€å°æœåŠ¡å™¨æŽ¥å—ï¼Œé‚£ä¹ˆå®ƒå°†è¢«æ‰€æœ‰çš„æœåŠ¡å™¨æŽ¥å—. å®žæ—¶æ€§ Zookeeperä¸èƒ½ä¿è¯ä¸¤ä¸ªå®¢æˆ·ç«¯èƒ½åŒæ—¶å¾—åˆ°åˆšæ›´æ–°çš„æ•°æ®ï¼Œå¦‚æžœéœ€è¦æœ€æ–°æ•°æ®ï¼Œåº”è¯¥åœ¨è¯»æ•°æ®ä¹‹å‰è°ƒç”¨sync()æŽ¥å£ã€‚ ç‹¬ç«‹æ€§ å„ä¸ªClientä¹‹é—´äº’ä¸å¹²é¢„ åŽŸå­æ€§ æ›´æ–°åªèƒ½æˆåŠŸæˆ–è€…å¤±è´¥ï¼Œæ²¡æœ‰ä¸­é—´çŠ¶æ€ã€‚ é¡ºåºæ€§ æ‰€æœ‰Serverï¼ŒåŒä¸€æ¶ˆæ¯å‘å¸ƒé¡ºåºä¸€è‡´ã€‚ 4ã€å®‰è£…éƒ¨ç½²ï¼šå®˜ç½‘ï¼š ä¸‹è½½ï¼š ï¼ˆ1ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š åœ¨Zokeeperçš„å®‰è£…ç›®å½•ä¸­çš„confç›®å½•ä¸‹ï¼Œå°†zoo_sample.cfgæ–‡ä»¶æ”¹åä¸ºzoo.cfg mv zoo_sample.cfg zoo.cfg ç¼–è¾‘ï¼š vim /usr/soft/zookeeper-3.4.13/conf/zoo.cfg 12345678910111213#å‘é€å¿ƒè·³çš„é—´éš”æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’tickTime=2000 dataDir=/usr/soft/zookeeper-3.4.13/datadataLogDir=/usr/soft/zookeeper-3.4.13/logsdataLogDir=/Users/zdandljb/zookeeper/dataLog#å®¢æˆ·ç«¯è¿žæŽ¥ Zookeeper æœåŠ¡å™¨çš„ç«¯å£ï¼ŒclientPort=2181 #Zookeeper ä¼šç›‘å¬è¿™ä¸ªç«¯å£ï¼ŒæŽ¥å—å®¢æˆ·ç«¯çš„è®¿é—®è¯·æ±‚ã€‚initLimit=5syncLimit=2server.1=node01:2888:3888server.2=node02:2888:3888server.3=node03:2888:3888 é…ç½®è§£é‡Š: initLimitï¼š è¿™ä¸ªé…ç½®é¡¹æ˜¯ç”¨æ¥é…ç½® Zookeeper æŽ¥å—å®¢æˆ·ç«¯ï¼ˆè¿™é‡Œæ‰€è¯´çš„å®¢æˆ·ç«¯æ˜¯ Zookeeper æœåŠ¡å™¨é›†ç¾¤ä¸­è¿žæŽ¥åˆ° Leader çš„ Follower æœåŠ¡å™¨ï¼‰åˆå§‹åŒ–è¿žæŽ¥æ—¶æœ€é•¿èƒ½å¿å—å¤šå°‘ä¸ªå¿ƒè·³æ—¶é—´é—´éš”æ•°ã€‚å½“å·²ç»è¶…è¿‡ 5 ä¸ªå¿ƒè·³çš„æ—¶é—´ï¼ˆä¹Ÿå°±æ˜¯ tickTimeï¼‰é•¿åº¦åŽ Zookeeper æœåŠ¡å™¨è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿”å›žä¿¡æ¯ï¼Œé‚£ä¹ˆè¡¨æ˜Žè¿™ä¸ªå®¢æˆ·ç«¯è¿žæŽ¥å¤±è´¥ã€‚æ€»çš„æ—¶é—´é•¿åº¦å°±æ˜¯ 5*2000=10 ç§’ syncLimitï¼šè¿™ä¸ªé…ç½®é¡¹æ ‡è¯† Leader ä¸Ž Follower ä¹‹é—´å‘é€æ¶ˆæ¯ï¼Œè¯·æ±‚å’Œåº”ç­”æ—¶é—´é•¿åº¦ï¼Œæœ€é•¿ä¸èƒ½è¶…è¿‡å¤šå°‘ä¸ª tickTime çš„å¿ƒè·³æ—¶é—´é•¿åº¦ï¼Œæ€»çš„æ—¶é—´é•¿åº¦å°±æ˜¯ 2*2000=4 ç§’ server.A=Bï¼šCï¼šDï¼šå…¶ ä¸­ A æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¿™ä¸ªæ˜¯ç¬¬å‡ å·æœåŠ¡å™¨ï¼›B æ˜¯è¿™ä¸ªæœåŠ¡å™¨çš„ ip åœ°å€ï¼›C è¡¨ç¤ºçš„æ˜¯è¿™ä¸ªæœåŠ¡å™¨ä¸Žé›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ï¼›D è¡¨ç¤ºçš„æ˜¯ä¸‡ä¸€é›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨æŒ‚äº†ï¼Œéœ€è¦ä¸€ä¸ªç«¯å£æ¥é‡æ–°è¿›è¡Œé€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„ Leaderï¼Œè€Œè¿™ä¸ªç«¯å£å°±æ˜¯ç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ã€‚å¦‚æžœæ˜¯ä¼ªé›†ç¾¤çš„é…ç½®æ–¹å¼ï¼Œç”±äºŽ B éƒ½æ˜¯ä¸€æ ·ï¼Œæ‰€ä»¥ä¸åŒçš„ Zookeeper å®žä¾‹é€šä¿¡ç«¯å£å·ä¸èƒ½ä¸€æ ·ï¼Œæ‰€ä»¥è¦ç»™å®ƒä»¬åˆ†é…ä¸åŒçš„ç«¯å£å· (2)åˆ›å»ºmyidæ–‡ä»¶ï¼ˆåœ¨ä¸Šé¢é…ç½®æ–‡ä»¶ä¸­é…ç½®dataDir çš„ç›®å½•ä¸‹ï¼‰ 123server1æœºå™¨çš„å†…å®¹ä¸ºï¼š1ï¼Œserver2æœºå™¨çš„å†…å®¹ä¸ºï¼š2ï¼Œserver3æœºå™¨çš„å†…å®¹ä¸ºï¼š3 ï¼ˆ3ï¼‰å°†zookeeperåŒ…å‘åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Š Paxoç®—æ³•å®˜ç½‘ï¼š 1ã€ç®€ä»‹ä¸€ä¸ªåŸºäºŽæ¶ˆæ¯ä¼ é€’çš„ä¸€è‡´æ€§ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºŽåˆ†å¸ƒå¼è®¡ç®—ä¸­ï¼Œæ˜¯åˆ°ç›®å‰ä¸ºæ­¢å”¯ä¸€çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ã€‚ å‰æï¼š Paxos æœ‰ä¸€ä¸ªå‰æï¼šæ²¡æœ‰æ‹œå åº­å°†å†›é—®é¢˜ã€‚å°±æ˜¯è¯´ Paxosåªæœ‰åœ¨ä¸€ä¸ªå¯ä¿¡çš„è®¡ç®—çŽ¯å¢ƒä¸­æ‰èƒ½æˆç«‹ï¼Œè¿™ä¸ªçŽ¯å¢ƒæ˜¯ä¸ä¼šè¢«å…¥ä¾µæ‰€ç ´åçš„ã€‚ 2ã€ç»“åˆæ•…äº‹çš„å¯¹åº”ç†è§£ å°å²›(Island)â€”â€”ZK Server Clusterè®®å‘˜(Senator)â€”â€”ZK Serveræè®®(Proposal)â€”â€”ZNode Change(Create/Delete/SetDataâ€¦)æè®®ç¼–å·(PID)â€”â€”Zxid(ZooKeeper Transaction Id)æ­£å¼æ³•ä»¤â€”â€”æ‰€æœ‰ ZNode åŠå…¶æ•°æ® æ€»ç»Ÿâ€”â€”ZK Server Leader zookeeperçš„èŠ‚ç‚¹åŠå·¥ä½œåŽŸç†1ã€å·¥ä½œåŽŸç† 1.æ¯ä¸ªServeråœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ï¼› 2.Zookeeperå¯åŠ¨æ—¶ï¼Œå°†ä»Žå®žä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ªleaderï¼ˆPaxosåè®®ï¼‰ 3.Leaderè´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œ 4.ä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸï¼Œå½“ä¸”ä»…å½“å¤§å¤šæ•°Serveråœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚ Zookeeperçš„æ ¸å¿ƒæ˜¯åŽŸå­å¹¿æ’­ï¼Œè¿™ä¸ªæœºåˆ¶ä¿è¯äº†å„ä¸ªserverä¹‹é—´çš„åŒæ­¥ã€‚å®žçŽ°è¿™ä¸ªæœºåˆ¶çš„åè®®å«åšZabåè®®ã€‚ Zabåè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ¢å¤æ¨¡å¼å’Œå¹¿æ’­æ¨¡å¼ã€‚ å½“æœåŠ¡å¯åŠ¨æˆ–è€…åœ¨é¢†å¯¼è€…å´©æºƒåŽï¼ŒZabå°±è¿›å…¥äº†æ¢å¤æ¨¡å¼ï¼Œå½“é¢†å¯¼è€…è¢«é€‰ä¸¾å‡ºæ¥ï¼Œä¸”å¤§å¤šæ•°serverçš„å®Œæˆäº†å’Œleaderçš„çŠ¶æ€åŒæ­¥ä»¥åŽï¼Œæ¢å¤æ¨¡å¼å°±ç»“æŸäº†ã€‚çŠ¶æ€åŒæ­¥ä¿è¯äº†leaderå’Œserverå…·æœ‰ç›¸åŒçš„ç³»ç»ŸçŠ¶æ€ã€‚ä¸€æ—¦leaderå·²ç»å’Œå¤šæ•°çš„followerè¿›è¡Œäº†çŠ¶æ€åŒæ­¥åŽï¼Œä»–å°±å¯ä»¥å¼€å§‹å¹¿æ’­æ¶ˆæ¯äº†ï¼Œå³è¿›å…¥å¹¿æ’­çŠ¶æ€ã€‚è¿™æ—¶å€™å½“ä¸€ä¸ªserveråŠ å…¥zookeeperæœåŠ¡ä¸­ï¼Œå®ƒä¼šåœ¨æ¢å¤æ¨¡å¼ä¸‹å¯åŠ¨ï¼Œå‘çŽ°leaderï¼Œå¹¶å’Œleaderè¿›è¡ŒçŠ¶æ€åŒæ­¥ã€‚å¾…åˆ°åŒæ­¥ç»“æŸï¼Œå®ƒä¹Ÿå‚ä¸Žæ¶ˆæ¯å¹¿æ’­ã€‚ZookeeperæœåŠ¡ä¸€ç›´ç»´æŒåœ¨BroadcastçŠ¶æ€ï¼Œç›´åˆ°leaderå´©æºƒäº†æˆ–è€…leaderå¤±åŽ»äº†å¤§éƒ¨åˆ†çš„followersæ”¯æŒ. å¹¿æ’­æ¨¡å¼éœ€è¦ä¿è¯proposalè¢«æŒ‰é¡ºåºå¤„ç†ï¼Œå› æ­¤zké‡‡ç”¨äº†é€’å¢žçš„äº‹åŠ¡idå·(zxid)æ¥ä¿è¯ã€‚æ‰€æœ‰çš„æè®®(proposal)éƒ½åœ¨è¢«æå‡ºçš„æ—¶å€™åŠ ä¸Šäº†zxidã€‚å®žçŽ°ä¸­zxidæ˜¯ä¸€ä¸ª64ä½çš„æ•°å­—ï¼Œå®ƒé«˜32ä½æ˜¯epochç”¨æ¥æ ‡è¯†leaderå…³ç³»æ˜¯å¦æ”¹å˜ï¼Œæ¯æ¬¡ä¸€ä¸ªleaderè¢«é€‰å‡ºæ¥ï¼Œå®ƒéƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„epochã€‚ä½Ž32ä½æ˜¯ä¸ªé€’å¢žè®¡æ•°ã€‚ å½“leaderå´©æºƒæˆ–è€…leaderå¤±åŽ»å¤§å¤šæ•°çš„followerï¼Œè¿™æ—¶å€™zkè¿›å…¥æ¢å¤æ¨¡å¼ï¼Œæ¢å¤æ¨¡å¼éœ€è¦é‡æ–°é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„leaderï¼Œè®©æ‰€æœ‰çš„serveréƒ½æ¢å¤åˆ°ä¸€ä¸ªæ­£ç¡®çš„çŠ¶æ€ã€‚ 2ã€ZnodeèŠ‚ç‚¹ï¼ˆ1ï¼‰Znodeæœ‰ä¸¤ç§ç±»åž‹ï¼ŒçŸ­æš‚çš„ï¼ˆephemeralï¼‰å’ŒæŒä¹…çš„ï¼ˆpersistentï¼‰ Znodeçš„ç±»åž‹åœ¨åˆ›å»ºæ—¶ç¡®å®šå¹¶ä¸”ä¹‹åŽä¸èƒ½å†ä¿®æ”¹ã€‚ çŸ­æš‚znodeçš„å®¢æˆ·ç«¯ä¼šè¯ç»“æŸæ—¶ï¼Œzookeeperä¼šå°†è¯¥çŸ­æš‚znodeåˆ é™¤ï¼ŒçŸ­æš‚znodeä¸å¯ä»¥æœ‰å­èŠ‚ç‚¹ æŒä¹…znodeä¸ä¾èµ–äºŽå®¢æˆ·ç«¯ä¼šè¯ï¼Œåªæœ‰å½“å®¢æˆ·ç«¯æ˜Žç¡®è¦åˆ é™¤è¯¥æŒä¹…znodeæ—¶æ‰ä¼šè¢«åˆ é™¤ ï¼ˆ2ï¼‰Znodeæœ‰å››ç§å½¢å¼çš„ç›®å½•èŠ‚ç‚¹ PERSISTENTã€æŒä¹…çš„ EPHEMERALã€çŸ­æš‚çš„ PERSISTENT_SEQUENTIALã€æŒä¹…ä¸”æœ‰åºçš„ EPHEMERAL_SEQUENTIAL çŸ­æš‚ä¸”æœ‰åºçš„ 3ã€shellæ“ä½œå¯åŠ¨æœåŠ¡ç«¯ï¼š./zkServer.sh start åœæ­¢æœåŠ¡ï¼š./zkServer.sh stop å¯åŠ¨å®¢æˆ·ç«¯ï¼š./zkCli.sh -server 127.0.0.1 : 2081 â€‹ (localhostã€node01) â€‹ ï¼ˆä¹Ÿå¯è¿žæŽ¥å…¶ä»–èŠ‚ç‚¹ï¼‰ â€‹ (porté»˜è®¤2081,å¯çœï¼›ipä¹Ÿå¯çœ) é€€å‡ºå®¢æˆ·ç«¯ï¼šquit æ“ä½œæŒ‡å—ï¼šhelp æŸ¥çœ‹æ ¹ç›®å½•ï¼šll / â€‹ ï¼ˆll +è·¯å¾„ï¼‰ èŽ·å–å…·ä½“æœåŠ¡å†…å®¹ï¼šget / â€‹ (get +è·¯å¾„+æœåŠ¡)å¯æŸ¥çœ‹æ³¨å†ŒzookeeperæœåŠ¡çš„èŠ‚ç‚¹ä¿¡æ¯ ï¼ˆå¦‚æžœä½œä¸ºleaderçš„namenodeæŒ‚äº†ï¼Œæœ€æ–°æ–‡ä»¶ä¼šç›¸åº”çš„æ›´æ¢æ•°æ®ä¿¡æ¯ï¼Œå¦‚æžœæ²¡æœ‰nnï¼Œé‚£ä¹ˆå°±æ²¡æœ‰ç›¸åº”çš„æœ€æ–°æ–‡ä»¶ï¼Œåªä¼šæœ‰è®°å½•ä¸Šä¸€ä¸ªé˜¶æ®µæ•°æ®çš„æ–‡ä»¶ï¼‰ åˆ›å»ºæœåŠ¡ï¼šcreate /sun aabbcc â€‹ (create +è·¯å¾„ + æ•°æ®å†…å®¹) åœ¨å…¶ä»–èŠ‚ç‚¹ä¹Ÿå¯å¯åŠ¨å®¢æˆ·ç«¯ï¼Œåˆ›å»ºæœåŠ¡ åˆ é™¤æœåŠ¡ï¼šrmr /sun 4ã€APIæ“ä½œ è§ä»£ç testzookeeper æ€»ç»“ Zookeeper ä½œä¸º Hadoop é¡¹ç›®ä¸­çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œæ˜¯Hadoop é›†ç¾¤ç®¡ç†çš„ä¸€ä¸ªå¿…ä¸å¯å°‘çš„æ¨¡å—ï¼Œå®ƒä¸»è¦ç”¨æ¥æŽ§åˆ¶é›†ç¾¤ä¸­çš„æ•°æ®ï¼Œå¦‚å®ƒç®¡ç† Hadoop é›†ç¾¤ä¸­çš„NameNodeï¼Œè¿˜æœ‰ Hbase ä¸­ Masterã€ Server ä¹‹é—´çŠ¶æ€åŒæ­¥ç­‰ã€‚ â€‹ Zoopkeeper æä¾›äº†ä¸€å¥—å¾ˆå¥½çš„åˆ†å¸ƒå¼é›†ç¾¤ç®¡ç†çš„æœºåˆ¶ï¼Œå°±æ˜¯å®ƒè¿™ç§åŸºäºŽå±‚æ¬¡åž‹çš„ç›®å½•æ ‘çš„æ•°æ®ç»“æž„ï¼Œå¹¶å¯¹æ ‘ä¸­çš„èŠ‚ç‚¹è¿›è¡Œæœ‰æ•ˆç®¡ç†ï¼Œä»Žè€Œå¯ä»¥è®¾è®¡å‡ºå¤šç§å¤šæ ·çš„åˆ†å¸ƒå¼çš„æ•°æ®ç®¡ç†æ¨¡åž‹ã€‚]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>Zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[YARNçš„å…¥é—¨å­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F03%2FYarn%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[[TOC] ä¸€ã€ç®€ä»‹yarnï¼ˆèµ„æºç®¡ç†å™¨ï¼‰ï¼ˆ1ï¼‰å­˜åœ¨èƒŒæ™¯ï¼šMR1.0å­˜åœ¨ç¼ºé™·ï¼š å•ç‚¹æ•…éšœï¼š ä»…æœ‰ä¸€ä¸ªJobTrackerè´Ÿè´£æ•´ä¸ªä½œä¸šçš„è°ƒåº¦ã€ç®¡ç†ã€ç›‘æŽ§ã€èµ„æºè°ƒåº¦ ï¼ˆä¸€ä¸ªä½œä¸šæ‹¿åˆ°åŽä¼šåˆ†è§£å¤šä¸ªä»»åŠ¡åŽ»æ‰§è¡Œmapduceï¼ŒJobTrackeræŠŠä»»åŠ¡åˆ†é…ç»™TaskTrackeræ¥å…·ä½“è´Ÿè´£æ‰§è¡Œç›¸å…³mapæˆ–reduceä»»åŠ¡ï¼‰ JobTrackerâ€˜å¤§åŒ…å¤§æ½â€™ï¼Œç®¡ç†äº‹é¡¹è¿‡å¤š ï¼ˆä¸Šé™4000ä¸ªèŠ‚ç‚¹ï¼‰ å®¹æ˜“å‡ºçŽ°å†…å­˜æº¢å‡º èµ„æºåˆ’åˆ†ä¸åˆç† ï¼ˆå¼ºè¡Œåˆ’åˆ†slotï¼Œmapèµ„æºå’Œreduceèµ„æºä¸èƒ½äº’ç”¨ï¼Œå¯¼è‡´å¿™çš„å¿™æ­»ï¼Œé—²çš„é—²æ­»ï¼‰ 1æ—¢æ˜¯ä¸€ä¸ªè®¡ç®—æ¡†æž¶ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªèµ„æºç®¡ç†æ¡†æž¶ ï¼ˆ2ï¼‰yarnäº§ç”Ÿ å¯¹JobTrackerè¿›è¡ŒåŠŸèƒ½åˆ†è§£ï¼Œå°†èµ„æºç®¡ç†åŠŸèƒ½åˆ†ç»™ResourceManagerï¼Œå°†ä»»åŠ¡è°ƒåº¦å’Œä»»åŠ¡ç›‘æŽ§åˆ†ç»™ApplicationMasterï¼Œå°†TaskTrackerçš„ä»»åŠ¡äº¤ç»™NodeManager 12çº¯ç²¹çš„èµ„æºç®¡ç†æ¡†æž¶è¢«å‰¥ç¦»èµ„æºç®¡ç†è°ƒåº¦åŠŸèƒ½çš„MapReduceå°±å˜æˆäº†MR2.0ï¼Œä»–å°±æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨YARNä¸Šçš„ä¸€ä¸ªçº¯ç²¹çš„è®¡ç®—æ¡†æž¶ï¼Œç”±YARNä¸ºå…¶æä¾›èµ„æºç®¡ç†è°ƒåº¦æœåŠ¡ ä»€ä¹ˆå«çº¯ç²¹çš„è®¡ç®—æ¡†æž¶ï¼Ÿï¼Ÿ å®ƒæä¾›ä¸€äº›è®¡ç®—åŸºç±»ï¼Œä½¿ç”¨æ—¶ï¼Œç¼–å†™mapç±»å’Œreduceç±»çš„å­ç±»ï¼ŒåŽ»ç»§æ‰¿å®ƒã€‚ç„¶åŽè®¡ç®—æ¡†æž¶åŽ»åšåŽå°è‡ªåŠ¨åˆ†ç‰‡ï¼Œshuffleè¿‡ç¨‹ã€‚ èµ„æºç®¡ç†æ¡†æž¶ï¼Ÿï¼Ÿ å®ƒä¸“é—¨ç®¡ç†CPUå†…å­˜èµ„æºçš„åˆ†é… äºŒã€YARNè®¾è®¡æ€è·¯ ä¸‰ã€YARNä½“ç³»ç»“æž„ä¸‰å¤§æ ¸å¿ƒï¼š 1ã€RecourceManagerï¼ˆRMï¼‰ ResourceManagerï¼ˆRMï¼‰æ˜¯ä¸€ä¸ªå…¨å±€çš„èµ„æºç®¡ç†å™¨ï¼Œè´Ÿè´£æ•´ä¸ªç³»ç»Ÿçš„èµ„æºç®¡ç†å’Œåˆ†é…ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªç»„ä»¶ï¼Œå³è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰å’Œåº”ç”¨ç¨‹åºç®¡ç†å™¨ï¼ˆApplications Managerï¼‰ è°ƒåº¦å™¨æŽ¥æ”¶æ¥è‡ªApplicationMasterçš„åº”ç”¨ç¨‹åºèµ„æºè¯·æ±‚ï¼ŒæŠŠé›†ç¾¤ä¸­çš„èµ„æºä»¥â€œå®¹å™¨â€çš„å½¢å¼åˆ†é…ç»™æå‡ºç”³è¯·çš„åº”ç”¨ç¨‹åºï¼Œå®¹å™¨çš„é€‰æ‹©é€šå¸¸ä¼šè€ƒè™‘åº”ç”¨ç¨‹åºæ‰€è¦å¤„ç†çš„æ•°æ®çš„ä½ç½®ï¼Œè¿›è¡Œå°±è¿‘é€‰æ‹©ï¼Œä»Žè€Œå®žçŽ°â€œè®¡ç®—å‘æ•°æ®é æ‹¢â€ å®¹å™¨ï¼ˆContainerï¼‰ä½œä¸ºåŠ¨æ€èµ„æºåˆ†é…å•ä½ï¼Œæ¯ä¸ªå®¹å™¨ä¸­éƒ½å°è£…äº†ä¸€å®šæ•°é‡çš„CPUã€å†…å­˜ã€ç£ç›˜ç­‰èµ„æºï¼Œä»Žè€Œé™å®šæ¯ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨çš„èµ„æºé‡ è°ƒåº¦å™¨è¢«è®¾è®¡æˆæ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ç»„ä»¶ï¼ŒYARNä¸ä»…è‡ªèº«æä¾›äº†è®¸å¤šç§ç›´æŽ¥å¯ç”¨çš„è°ƒåº¦å™¨ï¼Œä¹Ÿå…è®¸ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€æ±‚é‡æ–°è®¾è®¡è°ƒåº¦å™¨ åº”ç”¨ç¨‹åºç®¡ç†å™¨ï¼ˆApplications Managerï¼‰è´Ÿè´£ç³»ç»Ÿä¸­æ‰€æœ‰åº”ç”¨ç¨‹åºçš„ç®¡ç†å·¥ä½œï¼Œä¸»è¦åŒ…æ‹¬åº”ç”¨ç¨‹åºæäº¤ã€ä¸Žè°ƒåº¦å™¨åå•†èµ„æºä»¥å¯åŠ¨ApplicationMasterã€ç›‘æŽ§ApplicationMasterè¿è¡ŒçŠ¶æ€å¹¶åœ¨å¤±è´¥æ—¶é‡æ–°å¯åŠ¨ç­‰ 2ã€ApplicationMaster ResourceManageræŽ¥æ”¶ç”¨æˆ·æäº¤çš„ä½œä¸šï¼ŒæŒ‰ç…§ä½œä¸šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä»¥åŠä»ŽNodeManageræ”¶é›†æ¥çš„å®¹å™¨çŠ¶æ€ä¿¡æ¯ï¼Œå¯åŠ¨è°ƒåº¦è¿‡ç¨‹ï¼Œä¸ºç”¨æˆ·ä½œä¸šå¯åŠ¨ä¸€ä¸ªApplicationMasterApplicationMasterçš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼šï¼ˆ1ï¼‰å½“ç”¨æˆ·ä½œä¸šæäº¤æ—¶ï¼ŒApplicationMasterä¸ŽResourceManageråå•†èŽ·å–èµ„æºï¼ŒResourceManagerä¼šä»¥å®¹å™¨çš„å½¢å¼ä¸ºApplicationMasteråˆ†é…èµ„æºï¼› ï¼ˆ2ï¼‰æŠŠèŽ·å¾—çš„èµ„æºè¿›ä¸€æ­¥åˆ†é…ç»™å†…éƒ¨çš„å„ä¸ªä»»åŠ¡ï¼ˆMapä»»åŠ¡æˆ–Reduceä»»åŠ¡ï¼‰ï¼Œå®žçŽ°èµ„æºçš„â€œäºŒæ¬¡åˆ†é…â€ï¼› ï¼ˆ3ï¼‰ä¸ŽNodeManagerä¿æŒäº¤äº’é€šä¿¡è¿›è¡Œåº”ç”¨ç¨‹åºçš„å¯åŠ¨ã€è¿è¡Œã€ç›‘æŽ§å’Œåœæ­¢ï¼Œç›‘æŽ§ç”³è¯·åˆ°çš„èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œå¯¹æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦å’ŒçŠ¶æ€è¿›è¡Œç›‘æŽ§ï¼Œå¹¶åœ¨ä»»åŠ¡å‘ç”Ÿå¤±è´¥æ—¶æ‰§è¡Œå¤±è´¥æ¢å¤ï¼ˆå³é‡æ–°ç”³è¯·èµ„æºé‡å¯ä»»åŠ¡ï¼‰ï¼› ï¼ˆ4ï¼‰å®šæ—¶å‘ResourceManagerå‘é€â€œå¿ƒè·³â€æ¶ˆæ¯ï¼ŒæŠ¥å‘Šèµ„æºçš„ä½¿ç”¨æƒ…å†µå’Œåº”ç”¨çš„è¿›åº¦ä¿¡æ¯ï¼› ï¼ˆ5ï¼‰å½“ä½œä¸šå®Œæˆæ—¶ï¼ŒApplicationMasterå‘ResourceManageræ³¨é”€å®¹å™¨ï¼Œæ‰§è¡Œå‘¨æœŸå®Œæˆã€‚ 3ã€NodeManager NodeManageræ˜¯é©»ç•™åœ¨ä¸€ä¸ªYARNé›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„ä»£ç†ï¼Œæœ‰æ‰€éœ€æ•°æ®çš„èŠ‚ç‚¹ï¼Œä¸»è¦è´Ÿè´£ï¼š å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç† ç›‘æŽ§æ¯ä¸ªå®¹å™¨çš„èµ„æºï¼ˆCPUã€å†…å­˜ç­‰ï¼‰ä½¿ç”¨æƒ…å†µ è·Ÿè¸ªèŠ‚ç‚¹å¥åº·çŠ¶å†µ ä»¥â€œå¿ƒè·³â€çš„æ–¹å¼ä¸ŽResourceManagerä¿æŒé€šä¿¡ å‘ResourceManageræ±‡æŠ¥ä½œä¸šçš„èµ„æºä½¿ç”¨æƒ…å†µå’Œæ¯ä¸ªå®¹å™¨çš„è¿è¡ŒçŠ¶æ€ æŽ¥æ”¶æ¥è‡ªApplicationMasterçš„å¯åŠ¨/åœæ­¢å®¹å™¨çš„å„ç§è¯·æ±‚ éœ€è¦è¯´æ˜Žçš„æ˜¯ï¼ŒNodeManagerä¸»è¦è´Ÿè´£ç®¡ç†æŠ½è±¡çš„å®¹å™¨ï¼Œåªå¤„ç†ä¸Žå®¹å™¨ç›¸å…³çš„äº‹æƒ…ï¼Œè€Œä¸å…·ä½“è´Ÿè´£æ¯ä¸ªä»»åŠ¡ï¼ˆMapä»»åŠ¡æˆ–Reduceä»»åŠ¡ï¼‰è‡ªèº«çŠ¶æ€çš„ç®¡ç†ï¼Œå› ä¸ºè¿™äº›ç®¡ç†å·¥ä½œæ˜¯ç”±ApplicationMasterå®Œæˆçš„ï¼ŒApplicationMasterä¼šé€šè¿‡ä¸æ–­ä¸ŽNodeManageré€šä¿¡æ¥æŽŒæ¡å„ä¸ªä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ å››ã€YARN å·¥ä½œæµç¨‹ äº”ã€YARNæ¡†æž¶ä¸ŽMapReduce1.0æ¡†æž¶çš„å¯¹æ¯”åˆ†æž ä»ŽMapReduce1.0æ¡†æž¶å‘å±•åˆ°YARNæ¡†æž¶ï¼Œå®¢æˆ·ç«¯å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå…¶å¤§éƒ¨åˆ†è°ƒç”¨APIåŠæŽ¥å£éƒ½ä¿æŒå…¼å®¹ï¼Œå› æ­¤ï¼ŒåŽŸæ¥é’ˆå¯¹Hadoop1.0å¼€å‘çš„ä»£ç ä¸ç”¨åšå¤§çš„æ”¹åŠ¨ï¼Œå°±å¯ä»¥ç›´æŽ¥æ”¾åˆ°Hadoop2.0å¹³å°ä¸Šè¿è¡Œ æ€»ä½“è€Œè¨€ï¼ŒYARNç›¸å¯¹äºŽMapReduce1.0æ¥è¯´å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š å¤§å¤§å‡å°‘äº†æ‰¿æ‹…ä¸­å¿ƒæœåŠ¡åŠŸèƒ½çš„ResourceManagerçš„èµ„æºæ¶ˆè€— ApplicationMasteræ¥å®Œæˆéœ€è¦å¤§é‡èµ„æºæ¶ˆè€—çš„ä»»åŠ¡è°ƒåº¦å’Œç›‘æŽ§ å¤šä¸ªä½œä¸šå¯¹åº”å¤šä¸ªApplicationMasterï¼Œå®žçŽ°äº†ç›‘æŽ§åˆ†å¸ƒåŒ– MapReduce1.0æ—¢æ˜¯ä¸€ä¸ªè®¡ç®—æ¡†æž¶ï¼Œåˆæ˜¯ä¸€ä¸ªèµ„æºç®¡ç†è°ƒåº¦æ¡†æž¶ï¼Œä½†æ˜¯ï¼Œåªèƒ½æ”¯æŒMapReduceç¼–ç¨‹æ¨¡åž‹ã€‚è€ŒYARNåˆ™æ˜¯ä¸€ä¸ªçº¯ç²¹çš„èµ„æºè°ƒåº¦ç®¡ç†æ¡†æž¶ï¼Œåœ¨å®ƒä¸Šé¢å¯ä»¥è¿è¡ŒåŒ…æ‹¬MapReduceåœ¨å†…çš„ä¸åŒç±»åž‹çš„è®¡ç®—æ¡†æž¶ï¼Œåªè¦ç¼–ç¨‹å®žçŽ°ç›¸åº”çš„ApplicationMaster YARNä¸­çš„èµ„æºç®¡ç†æ¯”MapReduce1.0æ›´åŠ é«˜æ•ˆ ä»¥å®¹å™¨ä¸ºå•ä½ï¼Œè€Œä¸æ˜¯ä»¥slotä¸ºå•ä½ å…­ã€YARN çš„å‘å±•ç›®æ ‡YARN çš„ç›®æ ‡å°±æ˜¯å®žçŽ°â€œä¸€ä¸ªé›†ç¾¤å¤šä¸ªæ¡†æž¶â€ï¼Ÿ ï¼Œä¸ºä»€ä¹ˆï¼Ÿ ä¸€ä¸ªä¼ä¸šå½“ä¸­åŒæ—¶å­˜åœ¨å„ç§ä¸åŒçš„ä¸šåŠ¡åº”ç”¨åœºæ™¯ï¼Œéœ€è¦é‡‡ç”¨ä¸åŒçš„è®¡ç®—æ¡†æž¶ MapReduceå®žçŽ°ç¦»çº¿æ‰¹å¤„ç† ä½¿ç”¨Impalaå®žçŽ°å®žæ—¶äº¤äº’å¼æŸ¥è¯¢åˆ†æž ä½¿ç”¨Stormå®žçŽ°æµå¼æ•°æ®å®žæ—¶åˆ†æž ä½¿ç”¨Sparkå®žçŽ°è¿­ä»£è®¡ç®— è¿™äº›äº§å“é€šå¸¸æ¥è‡ªä¸åŒçš„å¼€å‘å›¢é˜Ÿï¼Œå…·æœ‰å„è‡ªçš„èµ„æºè°ƒåº¦ç®¡ç†æœºåˆ¶ ä¸ºäº†é¿å…ä¸åŒç±»åž‹åº”ç”¨ä¹‹é—´äº’ç›¸å¹²æ‰°ï¼Œä¼ä¸šå°±éœ€è¦æŠŠå†…éƒ¨çš„æœåŠ¡å™¨æ‹†åˆ†æˆå¤šä¸ªé›†ç¾¤ï¼Œåˆ†åˆ«å®‰è£…è¿è¡Œä¸åŒçš„è®¡ç®—æ¡†æž¶ï¼Œå³â€œä¸€ä¸ªæ¡†æž¶ä¸€ä¸ªé›†ç¾¤â€ å¯¼è‡´é—®é¢˜ é›†ç¾¤èµ„æºåˆ©ç”¨çŽ‡ä½Ž æ•°æ®æ— æ³•å…±äº« ç»´æŠ¤ä»£ä»·é«˜ YARNçš„ç›®æ ‡å°±æ˜¯å®žçŽ°â€œä¸€ä¸ªé›†ç¾¤å¤šä¸ªæ¡†æž¶â€ï¼Œå³åœ¨ä¸€ä¸ªé›†ç¾¤ä¸Šéƒ¨ç½²ä¸€ä¸ªç»Ÿä¸€çš„èµ„æºè°ƒåº¦ç®¡ç†æ¡†æž¶YARNï¼Œåœ¨YARNä¹‹ä¸Šå¯ä»¥éƒ¨ç½²å…¶ä»–å„ç§è®¡ç®—æ¡†æž¶ ç”±YARNä¸ºè¿™äº›è®¡ç®—æ¡†æž¶æä¾›ç»Ÿä¸€çš„èµ„æºè°ƒåº¦ç®¡ç†æœåŠ¡ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ ¹æ®å„ç§è®¡ç®—æ¡†æž¶çš„è´Ÿè½½éœ€æ±‚ï¼Œè°ƒæ•´å„è‡ªå ç”¨çš„èµ„æºï¼Œå®žçŽ°é›†ç¾¤èµ„æºå…±äº«å’Œèµ„æºå¼¹æ€§æ”¶ç¼© å¯ä»¥å®žçŽ°ä¸€ä¸ªé›†ç¾¤ä¸Šçš„ä¸åŒåº”ç”¨è´Ÿè½½æ··æ­ï¼Œæœ‰æ•ˆæé«˜äº†é›†ç¾¤çš„åˆ©ç”¨çŽ‡ ä¸åŒè®¡ç®—æ¡†æž¶å¯ä»¥å…±äº«åº•å±‚å­˜å‚¨ï¼Œé¿å…äº†æ•°æ®é›†è·¨é›†ç¾¤ç§»åŠ¨]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>yarn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HDFSå­¦ä¹ ]]></title>
    <url>%2F2019%2F01%2F03%2FHDFS%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[[TOC] Hadoopå­¦ä¹ ä¸€ã€åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»ŸHDFS1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿ å®šä¹‰ï¼šå°†æµ·é‡çš„æ•°æ®ï¼Œå¤æ‚çš„ä¸šåŠ¡åˆ†å‘åˆ°ä¸åŒçš„è®¡ç®—æœºèŠ‚ç‚¹å’ŒæœåŠ¡å™¨ä¸Šåˆ†å¼€å¤„ç†å’Œè®¡ç®—ã€‚ ç‰¹ç‚¹ï¼š å¤šå‰¯æœ¬ï¼Œæé«˜æœåŠ¡çš„å®¹é”™çŽ‡ã€å®‰å…¨æ€§ã€é«˜å¯é æ€§ é€‚åˆæ‰¹å¤„ç†ï¼Œæé«˜æœåŠ¡çš„æ•ˆçŽ‡å’Œé€Ÿåº¦ï¼Œ å‡è½»å•å°æœåŠ¡çš„åŽ‹åŠ› å…·æœ‰å¾ˆå¥½çš„å¯æ‰©å±•æ€§ è®¡ç®—å‘æ•°æ®é æ‹¢ï¼Œå®‰å…¨ï¼Œé«˜æ•ˆ å¤§æ•°æ®ä¸‰é©¾é©¬è½¦ï¼šGFSã€MapReduceã€Bigtable 2ã€ä»€ä¹ˆæ˜¯HDFSï¼Ÿï¼ˆ1ï¼‰HDFSä¸ºä»€ä¹ˆä¼šå‡ºçŽ°ï¼Ÿ ä¸»è¦è§£å†³å¤§é‡ã€pbçº§ä»¥ä¸Šã€‘çš„å¤§æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨é—®é¢˜ ï¼ˆ2ï¼‰HDFSçš„ç‰¹ç‚¹ $$ åˆ†å¸ƒå¼ç‰¹æ€§ï¼š é€‚åˆå¤§æ•°æ®å¤„ç†ï¼šGBã€TBã€PBä»¥ä¸Šçš„æ•°æ® ç™¾ä¸‡è§„æ¨¡ä»¥ä¸Šçš„æ–‡ä»¶æ•°é‡:10K+ èŠ‚ç‚¹ é€‚åˆæ‰¹å¤„ç†ï¼šç§»åŠ¨è®¡ç®—è€Œéžæ•°æ®(MR),æ•°æ®ä½ç½®æš´éœ²ç»™è®¡ç®—æ¡†æž¶ $$ è‡ªèº«ç‰¹æ€§ï¼š å¯æž„å»ºåœ¨å»‰ä»·æœºå™¨ä¸Š é«˜å¯é æ€§ï¼šé€šè¿‡å¤šå‰¯æœ¬ææé«˜ é«˜å®¹é”™æ€§ï¼šæ•°æ®è‡ªåŠ¨ä¿å­˜å¤šä¸ªå‰¯æœ¬ï¼›å‰¯æœ¬ä¸¢å¤±åŽï¼Œè‡ªåŠ¨æ¢å¤,æä¾›äº†æ¢å¤æœºåˆ¶ $$ ç¼ºç‚¹ï¼š â€”â€“ä½Žå»¶è¿Ÿé«˜æ•°æ®åžåè®¿é—®é—®é¢˜ï¼ˆä¸é€‚åˆä½Žå»¶è¿Ÿæ•°æ®è®¿é—®ï¼ŒHbaseé€‚åˆï¼‰ ä¸æ”¯æŒæ¯«ç§’çº§ åžåé‡å¤§ä½†æœ‰é™åˆ¶äºŽå…¶å»¶è¿Ÿï¼ˆç“¶é¢ˆï¼šä½Žå»¶è¿Ÿæ— æ³•çªç ´ï¼‰ â€”â€“å°æ–‡ä»¶å­˜å–å ç”¨NameNodeå¤§é‡å†…å­˜(å¯»é“æ—¶é—´è¶…è¿‡è¯»å–æ—¶é—´,çº¦å 99%) â€”â€”-ä¸æ”¯æŒå¤šç”¨æˆ·å†™å…¥åŠä»»æ„ä¿®æ”¹æ–‡ä»¶ ä¸æ”¯æŒæ–‡ä»¶ä¿®æ”¹ï¼šä¸€ä¸ªæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªå†™è€… æ–‡ä»¶ä»…æ”¯æŒappendä¸æ”¯æŒä¿®æ”¹ ï¼ˆå…¶å®žæœ¬èº«æ˜¯æ”¯æŒçš„ï¼Œä¸»è¦ä¸ºäº†ç”¨ç©ºé—´æ¢æ—¶é—´ï¼ŒèŠ‚çº¦æˆæœ¬ï¼‰ $$ å®žçŽ°ç›®æ ‡ï¼š å…¼å®¹å»‰ä»·çš„ç¡¬ä»¶è®¾æ–½ å®žçŽ°æµæ•°æ®è¯»å†™ æ”¯æŒå¤§æ•°æ®é›† æ”¯æŒç®€å•çš„æ–‡ä»¶æ¨¡åž‹ å¼ºå¤§çš„è·¨å¹³å°å…¼å®¹æ€§ ï¼ˆ3ï¼‰HDFSæž¶æž„å›¾HDFSæž¶æž„å›¾ HDFSæž¶æž„å›¾ å…³ç³»åž‹æ•°æ®åº“ï¼šå®‰å…¨ï¼Œå­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼›å¦‚MySqlã€Oracleã€SQlServer éžå…³ç³»åž‹æ•°æ®åº“ï¼šä¸å®‰å…¨ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼›å¦‚Redisã€MemcacheDBã€mongDBã€Hbase 3ã€HDFSçš„åŠŸèƒ½æ¨¡å—åŠåŽŸç†è¯¦è§£ HDFSæ•°æ®å­˜å‚¨æ¨¡åž‹ï¼ˆblockï¼‰block ï¼ˆ1ï¼‰æ–‡ä»¶è¢«çº¿æ€§åˆ‡åˆ†å›ºå®šå¤§å°çš„æ•°æ®å—ï¼šblock é€šè¿‡åç§»é‡offsetï¼ˆå•ä½ï¼šbyteï¼‰æ ‡è®° é»˜è®¤æ•°æ®å—å¤§å°ä¸º64MB (hadoop1.xï¼Œhadoop2.xé»˜è®¤ä¸º128Mï¼‰)ï¼Œå¯è‡ªå®šä¹‰é…ç½® è‹¥æ–‡ä»¶å¤§å°ä¸åˆ°64MB ï¼Œåˆ™å•ç‹¬å­˜æˆä¸€ä¸ªblock ï¼ˆ2ï¼‰ä¸€ä¸ªæ–‡ä»¶å­˜å‚¨æ–¹å¼ æŒ‰å¤§å°è¢«åˆ‡åˆ†æˆè‹¥å¹²ä¸ªblock ï¼Œå­˜å‚¨åˆ°ä¸åŒèŠ‚ç‚¹ä¸Š é»˜è®¤æƒ…å†µä¸‹æ¯ä¸ªblockéƒ½æœ‰2ä¸ªå‰¯æœ¬ å…±3ä¸ªå‰¯æœ¬ å‰¯æœ¬æ•°ä¸å¤§äºŽèŠ‚ç‚¹æ•° ï¼ˆ3ï¼‰Blockå¤§å°å’Œå‰¯æœ¬æ•°é€šè¿‡Clientç«¯ä¸Šä¼ æ–‡ä»¶æ—¶è®¾ç½®ï¼Œ æ–‡ä»¶ä¸Šä¼ æˆåŠŸåŽå‰¯æœ¬æ•°å¯ä»¥å˜æ›´ï¼ŒBlock Sizeå¤§å°ä¸å¯å˜æ›´ å—çš„å¤§å°è¿œè¿œå¤§äºŽæ™®é€šæ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥æœ€å°åŒ–å¯»å€å¼€é”€ NameNodeï¼ˆç®€ç§°NNï¼‰ å­˜å‚¨å…ƒæ•°æ®ï¼› å…ƒæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼› ä¿å­˜æ–‡ä»¶ã€blockå—ã€datanodeä¹‹é—´çš„æ˜ å°„å…³ç³» 1&gt; NNä¸»è¦åŠŸèƒ½ï¼š æŽ¥æ”¶å®¢æˆ·ç«¯çš„è¯»å†™æœåŠ¡ï¼›æŽ¥æ”¶DNæ±‡æŠ¥blockä½ç½®å…³ç³» 2&gt; NNä¿å­˜metadateå…ƒä¿¡æ¯ åŸºäºŽå†…å­˜å­˜å‚¨ï¼Œä¸ä¼šå’Œç£ç›˜å‘ç”Ÿäº¤æ¢ â€‹ metadataå…ƒæ•°æ®ä¿¡æ¯åŒ…æ‹¬ä»¥ä¸‹ æ–‡ä»¶çš„å½’å±žï¼ˆownershipï¼‰å’Œæƒé™ï¼ˆpermissionï¼‰ æ–‡ä»¶å¤§å°å’Œå†™å…¥æ—¶é—´ blockåˆ—è¡¨ã€åç§»é‡ã€‘ï¼šå³ä¸€ä¸ªå®Œæ•´æ–‡ä»¶æœ‰å“ªäº›blockï¼ˆb0+b1+b2+..=fileï¼‰ ä½ç½®ä¿¡æ¯ï¼ˆåŠ¨æ€çš„ï¼‰ï¼šBlockæ¯ä¸ªå‰¯æœ¬ä¿å­˜åœ¨å“ªä¸ªDataNodeä¸­ *æ³¨æ„*ï¼šä½ç½®ä¿¡æ¯æ˜¯ç”±DNå¯åŠ¨æ—¶ä¸ŠæŠ¥ç»™NN ï¼Œå› ä¸ºå®ƒä¼šéšæ—¶å˜åŒ–ï¼Œæ‰€ä»¥ä¸ä¼šä¿å­˜åœ¨å†…å­˜å’Œç£ç›˜ä¸­ 3&gt; NameNodeçš„metadateä¿¡æ¯åœ¨å¯åŠ¨åŽä¼šåŠ è½½åˆ°å†…å­˜ åŒæ—¶ï¼š metadataä¿¡æ¯ä¹Ÿä¼šä¿å­˜fsimageæ–‡ä»¶ä¸­ï¼ˆfsimageæ–‡ä»¶æ˜¯ä½äºŽç£ç›˜ä¸Šçš„é•œåƒæ–‡ä»¶ï¼‰ å¯¹metadataçš„æ“ä½œæ—¥å¿—ä¹Ÿä¼šè®°å½•åœ¨edits æ–‡ä»¶ä¸­ï¼ˆeditsæ–‡ä»¶æ˜¯ä½äºŽç£ç›˜ä¸Šçš„æ—¥å¿—æ–‡ä»¶ï¼‰ SecondaryNameNodeï¼ˆç®€ç§°SNNï¼‰1&gt;SNNä¸»è¦åŠŸèƒ½ å¸®åŠ©NameNodeåˆå¹¶editså’Œfsimageæ–‡ä»¶ï¼Œå‡å°‘NNå¯åŠ¨æ—¶é—´ï¼› SecondaryNameNodeä¸€èˆ¬æ˜¯å•ç‹¬è¿è¡Œåœ¨ä¸€å°æœºå™¨ä¸Šï¼› å®ƒä¸æ˜¯NNçš„å¤‡ä»½ï¼ˆä½†å¯ä»¥åšå¤‡ä»½)ã€‚ 2&gt;åˆå¹¶æµç¨‹SNNåˆå¹¶ 123456789101112SecondaryNameNodeçš„å·¥ä½œæƒ…å†µï¼šï¼ˆ1ï¼‰SecondaryNameNodeä¼šå®šæœŸå’ŒNameNodeé€šä¿¡ï¼Œè¯·æ±‚å…¶åœæ­¢ä½¿ç”¨EditLogæ–‡ä»¶ï¼Œ æš‚æ—¶å°†æ–°çš„å†™æ“ä½œå†™åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶edit.newä¸Šæ¥ï¼Œè¿™ä¸ªæ“ä½œæ˜¯çž¬é—´å®Œæˆï¼Œ ä¸Šå±‚å†™æ—¥å¿—çš„å‡½æ•°å®Œå…¨æ„Ÿè§‰ä¸åˆ°å·®åˆ«ï¼›ï¼ˆ2ï¼‰SecondaryNameNodeé€šè¿‡HTTP GETæ–¹å¼ä»ŽNameNodeä¸ŠèŽ·å–åˆ°FsImageå’ŒEditLogæ–‡ ä»¶ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°çš„ç›¸åº”ç›®å½•ä¸‹ï¼›ï¼ˆ3ï¼‰SecondaryNameNodeå°†ä¸‹è½½ä¸‹æ¥çš„FsImageè½½å…¥åˆ°å†…å­˜ï¼Œç„¶åŽä¸€æ¡ä¸€æ¡åœ°æ‰§è¡ŒEditLogæ–‡ä»¶ ä¸­çš„å„é¡¹æ›´æ–°æ“ä½œï¼Œä½¿å¾—å†…å­˜ä¸­çš„FsImageä¿æŒæœ€æ–°ï¼› è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯EditLogå’ŒFsImageæ–‡ä»¶åˆå¹¶ï¼›ï¼ˆ4ï¼‰SecondaryNameNodeæ‰§è¡Œå®Œï¼ˆ3ï¼‰æ“ä½œä¹‹åŽï¼Œ ä¼šé€šè¿‡postæ–¹å¼å°†æ–°çš„FsImageæ–‡ä»¶å‘é€åˆ°NameNodeèŠ‚ç‚¹ä¸Šï¼ˆ5ï¼‰NameNodeå°†ä»ŽSecondaryNameNodeæŽ¥æ”¶åˆ°çš„æ–°çš„FsImageæ›¿æ¢æ—§çš„FsImageæ–‡ä»¶ï¼Œ åŒæ—¶å°†edit.newæ›¿æ¢EditLogæ–‡ä»¶ï¼Œé€šè¿‡è¿™ä¸ªè¿‡ç¨‹EditLogå°±å˜å°äº† 3&gt;åˆå¹¶æœºåˆ¶ â€”â€”-SNNæ‰§è¡Œåˆå¹¶æ—¶é—´å’Œæœºåˆ¶ Aã€æ ¹æ®é…ç½®æ–‡ä»¶è®¾ç½®çš„æ—¶é—´é—´éš”fs.checkpoint.period é»˜è®¤3600ç§’ Bã€æ ¹æ®é…ç½®æ–‡ä»¶è®¾ç½®edits logå¤§å° fs.checkpoint.size â€‹ è§„å®šeditsæ–‡ä»¶çš„æœ€å¤§å€¼é»˜è®¤æ˜¯64MB DataNodeï¼ˆç®€ç§°DNï¼‰1&gt; DNä¸»è¦åŠŸèƒ½ å­˜å‚¨æ–‡ä»¶å†…å®¹ï¼ˆblockï¼‰ï¼› æ–‡ä»¶å†…å®¹ä¿å­˜åœ¨ç£ç›˜ï¼› ç»´æŠ¤äº†block id åˆ°datanodeæœ¬åœ°æ–‡ä»¶çš„æ˜ å°„å…³ç³» å¯åŠ¨DNçº¿ç¨‹çš„æ—¶å€™ä¼šå‘NameNodeæ±‡æŠ¥blockä½ç½®ä¿¡æ¯ 2&gt; DNå·¥ä½œæœºåˆ¶12345â€¢ æ•°æ®èŠ‚ç‚¹æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFSçš„å·¥ä½œèŠ‚ç‚¹ï¼Œè´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œè¯»å–ï¼Œâ€¢ ä¼šæ ¹æ®å®¢æˆ·ç«¯æˆ–è€…æ˜¯åç§°èŠ‚ç‚¹çš„è°ƒåº¦æ¥è¿›è¡Œæ•°æ®çš„å­˜å‚¨å’Œæ£€ç´¢ï¼Œâ€¢ å¹¶ä¸”é€šè¿‡å¿ƒè·³æœºåˆ¶å‘åç§°èŠ‚ç‚¹å®šæœŸå‘é€è‡ªå·±æ‰€å­˜å‚¨çš„å—çš„åˆ—è¡¨ï¼Œä¿æŒä¸Žå…¶è”ç³»ï¼ˆ3ç§’ä¸€æ¬¡ï¼‰ ï¼ˆå¦‚æžœNN 10åˆ†é’Ÿæ²¡æœ‰æ”¶åˆ°DNçš„å¿ƒè·³ï¼Œåˆ™è®¤ä¸ºå…¶å·²ç»lostï¼Œå¹¶copyå…¶ä¸Šçš„blockåˆ°å…¶å®ƒDNï¼‰â€¢ æ¯ä¸ªæ•°æ®èŠ‚ç‚¹ä¸­çš„æ•°æ®ä¼šè¢«ä¿å­˜åœ¨å„è‡ªèŠ‚ç‚¹çš„æœ¬åœ°Linuxæ–‡ä»¶ç³»ç»Ÿä¸­ 3&gt; blockçš„å‰¯æœ¬æ”¾ç½®ç­–ç•¥ â€“ ç¬¬ä¸€ä¸ªå‰¯æœ¬ï¼šæ”¾ç½®åœ¨ä¸Šä¼ æ–‡ä»¶çš„DNï¼ˆé›†ç¾¤å†…æäº¤ï¼‰ï¼› â€‹ å¦‚æžœæ˜¯é›†ç¾¤å¤–æäº¤ï¼Œåˆ™éšæœºæŒ‘é€‰ä¸€å°ç£ç›˜ä¸å¤ªæ»¡ï¼ŒCPUä¸å¤ªå¿™çš„èŠ‚ç‚¹ã€‚ â€“ ç¬¬äºŒä¸ªå‰¯æœ¬ï¼šæ”¾ç½®åœ¨äºŽç¬¬ä¸€ä¸ªå‰¯æœ¬ä¸åŒçš„æœºæž¶çš„èŠ‚ç‚¹ä¸Šã€‚ â€“ ç¬¬ä¸‰ä¸ªå‰¯æœ¬ï¼šä¸Žç¬¬äºŒä¸ªå‰¯æœ¬ç›¸åŒæœºæž¶çš„ä¸åŒèŠ‚ç‚¹ã€‚ â€“ æ›´å¤šå‰¯æœ¬ï¼šéšæœºèŠ‚ç‚¹ blockå—å­˜æ”¾ä½ç½® 4ã€HDFSè¯»å†™æµç¨‹ è¯»æ–‡ä»¶è¿‡ç¨‹read 1ã€é¦–å…ˆclientç«¯è°ƒç”¨FileSystemå¯¹è±¡ï¼ˆFSï¼‰çš„openæ–¹æ³•ï¼Œï¼ˆFSï¼šä¸€ä¸ªDistributedFileSystemçš„å®žä¾‹ï¼‰ã€‚2ã€DistributedFileSystemé€šè¿‡rpcåè®®ä»ŽNameNodeï¼ˆNNï¼‰èŽ·å¾—æ–‡ä»¶çš„ç¬¬ä¸€æ‰¹blockçš„locationsï¼Œï¼ˆåŒä¸€ä¸ªblockæŒ‰å‰¯æœ¬æ•°ä¼šè¿”å›žå¤šä¸ªlocationsï¼Œå› ä¸ºåŒä¸€æ–‡ä»¶çš„blockåˆ†å¸ƒå¼å­˜å‚¨åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šï¼‰ï¼Œè¿™äº›locationsæŒ‰ç…§hadoopæ‹“æ‰‘ç»“æž„æŽ’åºï¼Œè·ç¦»å®¢æˆ·ç«¯è¿‘çš„æŽ’åœ¨å‰é¢ï¼ˆå°±è¿‘é€‰æ‹©ï¼‰ã€‚ 3ã€å‰ä¸¤æ­¥ä¼šè¿”å›žä¸€ä¸ªFSDataInputStreamå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šè¢«å°è£…DFSInputStreamå¯¹è±¡ï¼ŒDFSInputStreamå¯ä»¥æ–¹ä¾¿çš„ç®¡ç†DNå’ŒNNçš„æ•°æ®æµã€‚å®¢æˆ·ç«¯è°ƒç”¨readæ–¹æ³•ï¼ŒDFSInputStreamä¼šè¿žæŽ¥ç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„DNï¼Œæ•°æ®ä»ŽDNæºæºä¸æ–­çš„æµå‘å®¢æˆ·ç«¯ï¼ˆå¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜Žçš„ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªè¯»å…¥çš„Inputæµï¼‰ã€‚ 4ã€å¦‚æžœç¬¬ä¸€æ‰¹blockéƒ½è¯»å®Œäº†ï¼Œ DFSInputStreamå°±ä¼šåŽ»NNæ‹¿ä¸‹ä¸€æ‰¹blockçš„locationsï¼Œç„¶åŽç»§ç»­è¯»ï¼Œå¦‚æžœæ‰€æœ‰çš„å—éƒ½è¯»å®Œï¼Œè¿™æ—¶å°±ä¼šå…³é—­æŽ‰æ‰€æœ‰çš„æµ è¯» æ³¨æ„ï¼š 123456å¦‚æžœåœ¨è¯»æ•°æ®çš„æ—¶å€™ï¼Œ DFSInputStreamå’ŒDNçš„é€šè®¯å‘ç”Ÿå¼‚å¸¸ï¼Œå°±ä¼šå°è¯•è¿žæŽ¥æ­£åœ¨è¯»çš„blockçš„æŽ’åºç¬¬äºŒè¿‘çš„DN,å¹¶ä¸”ä¼šè®°å½•å“ªä¸ªDNå‘ç”Ÿé”™è¯¯ï¼Œå‰©ä½™çš„blocksè¯»çš„æ—¶å€™å°±ä¼šç›´æŽ¥è·³è¿‡è¯¥DNã€‚ DFSInputStreamä¹Ÿä¼šæ£€æŸ¥blockæ•°æ®æ ¡éªŒå’Œï¼Œå¦‚æžœå‘çŽ°ä¸€ä¸ªåçš„block,å°±ä¼šå…ˆæŠ¥å‘Šåˆ°NNï¼Œç„¶åŽDFSInputStreamåœ¨å…¶ä»–çš„DNä¸Šè¯»è¯¥blockçš„é•œåƒã€‚è¯¥è®¾è®¡å°±æ˜¯å®¢æˆ·ç«¯ç›´æŽ¥è¿žæŽ¥DNæ¥æ£€ç´¢æ•°æ®ï¼Œå¹¶ä¸”NNæ¥è´Ÿè´£ä¸ºæ¯ä¸€ä¸ªblockæä¾›æœ€ä¼˜çš„DNï¼ŒNNä»…ä»…å¤„ç†block locationçš„è¯·æ±‚ï¼Œè¿™äº›ä¿¡æ¯éƒ½åŠ è½½åœ¨NNçš„å†…å­˜ä¸­ï¼Œhdfsé€šè¿‡DNé›†ç¾¤å¯ä»¥æ‰¿å—å¤§é‡å®¢æˆ·ç«¯çš„å¹¶å‘è®¿é—®ã€‚* RPC *ï¼ˆRemote Procedure Call Protocolï¼‰â€”â€”è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åè®®ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œä»Žè¿œç¨‹è®¡ç®—æœºç¨‹åºä¸Šè¯·æ±‚æœåŠ¡ï¼Œè€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®ã€‚RPCåè®®å‡å®šæŸäº›ä¼ è¾“åè®®çš„å­˜åœ¨ï¼Œå¦‚TCPæˆ–UDPï¼Œä¸ºé€šä¿¡ç¨‹åºä¹‹é—´æºå¸¦ä¿¡æ¯æ•°æ®ã€‚åœ¨OSIç½‘ç»œé€šä¿¡æ¨¡åž‹ä¸­ï¼ŒRPCè·¨è¶Šäº†ä¼ è¾“å±‚å’Œåº”ç”¨å±‚ã€‚RPCä½¿å¾—å¼€å‘åŒ…æ‹¬ç½‘ç»œåˆ†å¸ƒå¼å¤šç¨‹åºåœ¨å†…çš„åº”ç”¨ç¨‹åºæ›´åŠ å®¹æ˜“ã€‚RPCé‡‡ç”¨å®¢æˆ·æœº/æœåŠ¡å™¨æ¨¡å¼ã€‚è¯·æ±‚ç¨‹åºå°±æ˜¯ä¸€ä¸ªå®¢æˆ·æœºï¼Œè€ŒæœåŠ¡æä¾›ç¨‹åºå°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ã€‚é¦–å…ˆï¼Œå®¢æˆ·æœºè°ƒç”¨è¿›ç¨‹å‘é€ä¸€ä¸ªæœ‰è¿›ç¨‹å‚æ•°çš„è°ƒç”¨ä¿¡æ¯åˆ°æœåŠ¡è¿›ç¨‹ï¼Œç„¶åŽç­‰å¾…åº”ç­”ä¿¡æ¯ã€‚åœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿›ç¨‹ä¿æŒç¡çœ çŠ¶æ€ç›´åˆ°è°ƒç”¨ä¿¡æ¯åˆ°è¾¾ä¸ºæ­¢ã€‚å½“ä¸€ä¸ªè°ƒç”¨ä¿¡æ¯åˆ°è¾¾ï¼ŒæœåŠ¡å™¨èŽ·å¾—è¿›ç¨‹å‚æ•°ï¼Œè®¡ç®—ç»“æžœï¼Œå‘é€ç­”å¤ä¿¡æ¯ï¼Œç„¶åŽç­‰å¾…ä¸‹ä¸€ä¸ªè°ƒç”¨ä¿¡æ¯ï¼Œæœ€åŽï¼Œå®¢æˆ·ç«¯è°ƒç”¨è¿›ç¨‹æŽ¥æ”¶ç­”å¤ä¿¡æ¯ï¼ŒèŽ·å¾—è¿›ç¨‹ç»“æžœï¼Œç„¶åŽè°ƒç”¨æ‰§è¡Œç»§ç»­è¿›è¡Œã€‚ å†™æ–‡ä»¶è¿‡ç¨‹write 1.å®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨DistributedFileSystemçš„createæ–¹æ³•åˆ›å»ºæ–°æ–‡ä»¶ã€‚ 2.DistributedFileSystemé€šè¿‡RPCè°ƒç”¨NNåŽ»åˆ›å»ºä¸€ä¸ªæ²¡æœ‰blockså…³è”çš„æ–°æ–‡ä»¶ï¼Œåˆ›å»ºå‰ï¼ŒNNä¼šåšå„ç§æ ¡éªŒï¼Œæ¯”å¦‚æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå®¢æˆ·ç«¯æœ‰æ— æƒé™åŽ»åˆ›å»ºç­‰ã€‚å¦‚æžœæ ¡éªŒé€šè¿‡ï¼ŒNNå°±ä¼šè®°å½•ä¸‹æ–°æ–‡ä»¶ï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºIOå¼‚å¸¸ã€‚ 3.å‰ä¸¤æ­¥ç»“æŸåŽï¼Œä¼šè¿”å›žFSDataOutputStreamçš„å¯¹è±¡ï¼Œå°è£…åœ¨DFSOutputStreamï¼Œå®¢æˆ·ç«¯å¼€å§‹å†™æ•°æ®åˆ°DFSOutputStreamï¼ŒDFSOutputStreamä¼šæŠŠæ•°æ®åˆ‡æˆä¸€ä¸ªä¸ªå°çš„packetï¼Œç„¶åŽæŽ’æˆé˜Ÿåˆ—dataQueneã€‚ 4.NNä¼šç»™è¿™ä¸ªæ–°çš„blockåˆ†é…æœ€é€‚åˆå­˜å‚¨çš„å‡ ä¸ªdatanodeï¼ŒDFSOutputStreamæŠŠpacketåŒ…æŽ’æˆä¸€ä¸ªç®¡é“pipelineè¾“å‡ºã€‚å…ˆæŒ‰é˜Ÿåˆ—è¾“å‡ºåˆ°ç®¡é“çš„ç¬¬ä¸€ä¸ªdatanodeä¸­ï¼Œå¹¶å°†è¯¥Packetä»ŽdataQueueé˜Ÿåˆ—ä¸­ç§»åˆ°ackQueueé˜Ÿåˆ—ä¸­ï¼Œç¬¬ä¸€ä¸ªdatanodeåˆæŠŠpacketè¾“å‡ºåˆ°ç¬¬äºŒä¸ªdatanodeä¸­ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ 5.DFSOutputStreamä¸­çš„ackQueneï¼Œä¹Ÿæ˜¯ç”±packetç»„æˆï¼Œç­‰å¾…DNçš„æ”¶åˆ°å“åº”ï¼Œå½“pipelineä¸­çš„DNéƒ½è¡¨ç¤ºå·²ç»æ”¶åˆ°æ•°æ®çš„æ—¶å€™ï¼Œè¿™æ—¶ackQueneæ‰ä¼šæŠŠå¯¹åº”çš„packetåŒ…ç§»é™¤æŽ‰ã€‚ å¦‚æžœåœ¨å†™çš„è¿‡ç¨‹ä¸­æŸä¸ªDNå‘ç”Ÿé”™è¯¯ï¼Œä¼šé‡‡å–ä»¥ä¸‹å‡ æ­¥ï¼š â€‹ 1) pipelineè¢«å…³é—­æŽ‰ï¼› â€‹ 2)ä¸ºäº†é˜²æ­¢ä¸¢åŒ…ï¼ŒackQueneé‡Œçš„packetä¼šåŒæ­¥åˆ°dataQueneé‡Œ;æ–°å»ºpipelineç®¡é“æŽ¥åˆ°å…¶ä»–æ­£å¸¸DNä¸Š â€‹ 4)å‰©ä¸‹çš„éƒ¨åˆ†è¢«å†™åˆ°å‰©ä¸‹çš„æ­£å¸¸çš„datanodeä¸­ï¼› â€‹ 5)NNæ‰¾åˆ°å¦å¤–çš„DNåŽ»åˆ›å»ºè¿™ä¸ªå—çš„å¤åˆ¶ã€‚ï¼ˆå¯¹å®¢æˆ·ç«¯é€æ˜Žï¼‰ 6.å®¢æˆ·ç«¯å®Œæˆå†™æ•°æ®åŽè°ƒç”¨closeæ–¹æ³•å…³é—­å†™å…¥æµ æ³¨æ„ï¼šå®¢æˆ·ç«¯æ‰§è¡Œwriteæ“ä½œåŽï¼Œå†™å®Œçš„blockæ‰æ˜¯å¯è§çš„ï¼Œæ­£åœ¨å†™çš„blockå¯¹å®¢æˆ·ç«¯æ˜¯ä¸å¯è§çš„ å†™ 5.HDFSæ–‡ä»¶æƒé™å’Œå®‰å…¨æ¨¡å¼ï¼Ÿï¼ŸHDFSæ–‡ä»¶æƒé™ï¼Ÿï¼Ÿâ€“ ä¸ŽLinuxæ–‡ä»¶æƒé™ç±»ä¼¼ â€¢ r: read; w:write; x:executeï¼Œæƒé™xå¯¹äºŽæ–‡ä»¶å¿½ç•¥ï¼Œå¯¹äºŽæ–‡ä»¶å¤¹è¡¨ç¤ºæ˜¯å¦å…è®¸è®¿é—®å…¶å†…å®¹ â€“ å¦‚æžœLinuxç³»ç»Ÿç”¨æˆ·zsä½¿ç”¨hadoopå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ª æ–‡ä»¶åœ¨HDFSä¸­ownerå°±æ˜¯zsã€‚ â€“ HDFSçš„æƒé™ç›®çš„ï¼šé˜»æ­¢å¥½äººåšé”™äº‹ï¼Œè€Œä¸æ˜¯é˜»æ­¢åäººåšåäº‹ã€‚ ï¼Ÿï¼Ÿå®‰å…¨æ¨¡å¼ï¼Ÿï¼Ÿ NNå¯åŠ¨çš„æ—¶å€™ï¼Œé¦–å…ˆå°†æ˜ åƒæ–‡ä»¶(fsimage)è½½å…¥å†…å­˜ï¼Œå¹¶æ‰§è¡Œç¼–è¾‘æ—¥å¿—(edits)ä¸­çš„å„é¡¹æ“ä½œã€‚ ä¸€æ—¦åœ¨å†…å­˜ä¸­æˆåŠŸå»ºç«‹æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®çš„æ˜ å°„ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„fsimageæ–‡ä»¶(è¿™ä¸ªæ“ä½œä¸éœ€è¦SecondaryNameNode)å’Œä¸€ä¸ªç©ºçš„ç¼–è¾‘æ—¥å¿—ã€‚ æ­¤åˆ»namenodeè¿è¡Œåœ¨å®‰å…¨æ¨¡å¼ã€‚å³namenodeçš„æ–‡ä»¶ç³»ç»Ÿå¯¹äºŽå®¢æœç«¯æ¥è¯´æ˜¯åªè¯»çš„ã€‚(æ˜¾ç¤ºç›®å½•ï¼Œæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ç­‰ã€‚å†™ã€åˆ é™¤ã€é‡å‘½åéƒ½ä¼šå¤±è´¥)ã€‚ åœ¨æ­¤é˜¶æ®µNamenodeæ”¶é›†å„ä¸ªdatanodeçš„æŠ¥å‘Šï¼Œå½“æ•°æ®å—è¾¾åˆ°æœ€å°å‰¯æœ¬æ•°ä»¥ä¸Šæ—¶ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯â€œå®‰å…¨â€çš„ï¼Œ åœ¨ä¸€å®šæ¯”ä¾‹ï¼ˆå¯è®¾ç½®ï¼‰çš„æ•°æ®å—è¢«ç¡®å®šä¸ºâ€œå®‰å…¨â€åŽï¼Œå†è¿‡è‹¥å¹²æ—¶é—´ï¼Œå®‰å…¨æ¨¡å¼ç»“æŸ å½“æ£€æµ‹åˆ°å‰¯æœ¬æ•°ä¸è¶³çš„æ•°æ®å—æ—¶ï¼Œè¯¥å—ä¼šè¢«å¤åˆ¶ç›´åˆ°è¾¾åˆ°æœ€å°å‰¯æœ¬æ•°ï¼Œç³»ç»Ÿä¸­æ•°æ®å—çš„ä½ç½®å¹¶ä¸æ˜¯ç”±namenodeç»´æŠ¤çš„ï¼Œè€Œæ˜¯ä»¥å—åˆ—è¡¨å½¢å¼å­˜å‚¨åœ¨datanodeä¸­ã€‚ å¼‚å¸¸ äºŒã€å®Œå…¨åˆ†å¸ƒå¼æ­å»ºåŠeclipseæ’ä»¶1ã€å®Œå…¨åˆ†å¸ƒå¼æ­å»ºï¼ˆå¿…å¤‡ï¼‰(1)çŽ¯å¢ƒçš„å‡†å¤‡ Linux (å‰é¢å·²ç»å®‰è£…å¥½äº†) JDKï¼ˆå‰é¢å·²ç»å®‰è£…å¥½äº†ï¼‰ å‡†å¤‡è‡³å°‘3å°æœºå™¨ï¼ˆé€šè¿‡å…‹éš†è™šæ‹Ÿæœºï¼›) (ç½‘ç»œé…ç½®ã€JDKæ­å»ºã€hostsé…ç½®ï¼Œä¿è¯èŠ‚ç‚¹é—´èƒ½äº’pingé€šï¼‰ æ—¶é—´åŒæ­¥ (ntpdate time.nist.gov) sshå…ç§˜é’¥ç™»å½• (ä¸¤ä¸¤äº’é€šå…ç§˜é’¥) ï¼ˆ2ï¼‰å®Œå…¨åˆ†å¸ƒå¼æ­å»ºæ­¥éª¤è¯¦æƒ…è§Hadoop2.X.mdæ–‡ä»¶ 2ã€HDFSå‘½ä»¤(0) å‘½ä»¤ ï¼šhdfs dfs(1)ä¸Šä¼ æ–‡ä»¶åˆ°HDFSï¼š hdfs dfs -put fileName[æœ¬åœ°æ–‡ä»¶å] PATHã€hdfsçš„æ–‡ä»¶è·¯åŠ²ã€‘ ä¸Šä¼ æœ¬åœ°æ–‡ä»¶install.logåˆ°/myhdfsç›®å½•ä¸‹ hdfs dfs -put install.log /myhdfs â€‹ ï¼ˆæ–‡ä»¶è·¯å¾„) (ä¸Šä¼ ç›®å½•ï¼‰ (2)åˆ›å»ºæ–‡ä»¶å¤¹ hdfs dfs -mkdir[-p] (3)åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ hdfs dfs -rm -r /myhadoop1.0 123456789hdfs dfs -du -s URI[URI ...] æ˜¾ç¤ºæ–‡ä»¶(å¤¹)å¤§å°. hdfs dfs -cp -f]URI[URI...]&lt;dest&gt; å¤åˆ¶æ–‡ä»¶(å¤¹)ï¼Œå¯ä»¥è¦†ç›–ï¼Œå¯ä»¥ä¿ç•™åŽŸæœ‰æƒé™ä¿¡æ¯hdfs dfs -count -q&lt;paths&gt;åˆ—å‡ºæ–‡ä»¶å¤¹æ•°é‡ã€æ–‡ä»¶æ•°é‡ã€å†…å®¹å¤§å°.hdfs dfs -chown -R[:[GROUP]]URI[URI] ä¿®æ”¹æ‰€æœ‰è€….hdfs dfs -chmod [-R]&lt;MODE[,MODE]...|OCTALMODE&gt;URI[URI ...] ä¿®æ”¹æƒé™. ï¼ˆ4ï¼‰æŒ‡å®šblockå¤§å° 123456789äº§ç”Ÿ100000æ¡æ•°æ®ï¼šfor i in `seq 100000`;do echo &quot;hello sxt $i&quot; &gt;&gt; test.txt;doneä¸Šä¼ æ–‡ä»¶test.txtåˆ°æŒ‡å®šçš„Java22ç›®å½•ä¸‹ï¼Œå¹¶æŒ‡å®šblockå—çš„å¤§å°1Mï¼šhdfs dfs -D dfs.blocksize=1048576-put test.txt /java22-D ----è®¾ç½®å±žæ€§ 3ã€eclipseæ’ä»¶å®‰è£…é…ç½®ï¼ˆ1ï¼‰ã€å¯¼å…¥æ’ä»¶ å°†ä»¥ä¸‹jaråŒ…æ”¾å…¥eclipseçš„pluginsæ–‡ä»¶å¤¹ä¸­ â€‹ hadoop-eclipse-plugin-2.6.0.jar å¯åŠ¨eclipseï¼šå‡ºçŽ°ç•Œé¢å¦‚ä¸‹ï¼š æ’ä»¶åº”ç”¨ ï¼ˆ2ï¼‰é…ç½®çŽ¯å¢ƒå˜é‡Eclipseæ’ä»¶å®‰è£…å®ŒåŽä¿®æ”¹windowsä¸‹çš„ç”¨æˆ·åï¼Œç„¶åŽé‡å¯Eclipseï¼š çŽ¯å¢ƒå˜é‡ ï¼ˆ3ï¼‰æ–°å»ºJavaé¡¹ç›® ä¸‰ã€ç½‘ç›˜1ã€ä»£ç ç¼–å†™ æ–°å»ºJavaé¡¹ç›®ï¼Œå¯¼å…¥æ‰€éœ€è¦çš„jaråŒ… 1234567hadoopä¸­çš„share\hadoop\hdfshadoopä¸­çš„share\hadoop\hdfs\libhadoopä¸­çš„share\hadoop\commonhadoopä¸­çš„share\hadoop\common\libä¸‹çš„jaråŒ…ã€‚ blockåº•å±‚â€”offsetåç§»é‡æ¥è¯»å–å­—èŠ‚æ•°ç»„ 123456789101112131415161718private static void blk() throws Exception &#123; Path ifile = new Path(""); FileStatus file = fs.getFileStatus(ifile );// èŽ·å–blockçš„locationä¿¡æ¯HDFSåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿæ ¹æ®å…¶åç§»é‡çš„ä½ç½®ä¿¡æ¯æ¥è¯»å–å…¶å†…å®¹ BlockLocation[] blk = fs.getFileBlockLocations(file,0, file.getLen()); for (BlockLocation bb : blk) &#123; System.out.println(bb); &#125; FSDataInputStream input = fs.open(ifile); System.out.println((char)input.readByte()); System.out.println((char)input.readByte()); // æŒ‡å®šä»Žå“ªä¸ªoffsetçš„ä½ç½®åç§»é‡æ¥è¯» input.seek(1048576); System.out.println((char)input.readByte()); input.seek(1048576); System.out.println((char)input.readByte()); &#125; private static void blk() throws Exception { Path ifile = new Path(â€œâ€); FileStatus file = fs.getFileStatus(ifile ); // èŽ·å–blockçš„locationä¿¡æ¯ HDFSåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿæ ¹æ®å…¶åç§»é‡çš„ä½ç½®ä¿¡æ¯æ¥è¯»å–å…¶å†…å®¹ BlockLocation[] blk = fs.getFileBlockLocations(file , 0, file.getLen()); for (BlockLocation bb : blk) { System.out.println(bb); } FSDataInputStream input = fs.open(ifile); System.out.println((char)input.readByte()); System.out.println((char)input.readByte()); // æŒ‡å®šä»Žå“ªä¸ªoffsetçš„ä½ç½®åç§»é‡æ¥è¯» input.seek(1048576); System.out.println((char)input.readByte()); input.seek(1048576); System.out.println((char)input.readByte()); }]]></content>
      <categories>
        <category>HDFS</category>
      </categories>
      <tags>
        <tag>HDFS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginxå­¦ä¹ (æ€»)]]></title>
    <url>%2F2019%2F01%2F02%2FNginx%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[[TOC] Nginxå­¦ä¹ ï¼šå¤§åž‹ç½‘ç«™é«˜å¹¶å‘è¿è¡Œå¤„ç†ä¸€ã€Nginxä½¿ç”¨èƒŒæ™¯1ã€èƒŒæ™¯ 1ï¼‰é«˜å¹¶å‘ï¼ˆæµ·é‡æ•°æ®ï¼Œå¤æ‚ä¸šåŠ¡ï¼Œå¤§é‡çº¿ç¨‹ï¼‰é›†ä¸­è®¿é—®æœåŠ¡å™¨ 2)æœåŠ¡å™¨èµ„æºå’Œèƒ½åŠ›æœ‰é™ ä½¿å¾—æœåŠ¡å™¨å®•æœºï¼Œæ— æ³•æä¾›æœåŠ¡ 2ã€æ¦‚å¿µç†è§£ 1)é«˜å¹¶å‘ æµ·é‡æ•°æ®è®¿é—®ï¼Œå¤šä¸ªè¿›ç¨‹åŒæ—¶å¤„ç†ä¸åŒæ“ä½œ 2ï¼‰è´Ÿè½½å‡è¡¡ å‡åŒ€åˆ†é…è¯·æ±‚|æ•°æ®åˆ°ä¸åŒæ“ä½œå•å…ƒä¸Š 3ï¼‰å¸¸è§äº’è”ç½‘æž¶æž„ å®¢æˆ·ç«¯å±‚â†’åå‘ä»£ç†å±‚â†’ç«™ç‚¹å±‚â†’æœåŠ¡å±‚â†’æ•°æ®å±‚ äºŒã€Nginxå…¥é—¨1ã€äº†è§£nginxæ˜¯ä»€ä¹ˆ nginxæ˜¯ä¸€æ¬¾è½»é‡çº§ï¼ˆå¼€å‘æ–¹ä¾¿ï¼Œé…ç½®ç®€æ·ï¼‰çš„Web æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ 2ã€ç‰¹ç‚¹ å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œnginxçš„å¹¶å‘èƒ½åŠ›ç¡®å®žåœ¨åŒç±»åž‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨çŽ°éžå¸¸å¥½ã€‚ ï¼ˆä½¿ç”¨Cè¯­è¨€ç¼–å†™ï¼‰ 3ã€é…ç½®æ­å»ºNginxï¼ˆLinuxç³»ç»ŸçŽ¯å¢ƒä¸‹ï¼‰èµ„æºï¼š Tengineï¼ˆæŽ¨èï¼‰ï¼šTengine-2.2.3.tar.gz â€‹ å…¶ä»–ç‰ˆæœ¬ nginxï¼šnginx/Windows-1.8.1 1ï¼‰å®‰è£…ä¾èµ– å‘½ä»¤ï¼šyum -y install gcc openssl-devel pcre-devel zlib-devel 2ï¼‰è§£åŽ‹taråŒ… å‘½ä»¤ï¼štar -zxvf Tengine-2.2.3.tar.gz 3ï¼‰configureé…ç½®ï¼šåœ¨è§£åŽ‹åŽçš„æºç ç›®å½•ä¸­ ä¸¤ç§æ–¹æ¡ˆï¼š å‘½ä»¤ï¼š ./configure é»˜è®¤é…ç½®/usr/soft/nginx å‘½ä»¤ : ./configure â€“profix==/usr/soft/nginx é…ç½®åœ¨æŒ‡å®šè·¯å¾„ 4ï¼‰ç¼–è¯‘å¹¶å®‰è£…(é»˜è®¤ä¼šåœ¨/usr/localä¸‹ç”Ÿæˆnginxç›®å½•) make &amp;&amp; make install 5ï¼‰é…ç½®nginxæœåŠ¡ åœ¨/etc/rc.d/init.d/ç›®å½•ä¸­å»ºç«‹æ–‡æœ¬æ–‡ä»¶nginx 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126#!/bin/sh## nginx - this script starts and stops the nginx daemon## chkconfig: - 85 15 # description: Nginx is an HTTP(S) server, HTTP(S) reverse \# proxy and IMAP/POP3 proxy server# processname: nginx# config: /etc/nginx/nginx.conf# config: /etc/sysconfig/nginx# pidfile: /var/run/nginx.pid # Source function library.. /etc/rc.d/init.d/functions # Source networking configuration.. /etc/sysconfig/network # Check that networking is up.[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0 nginx=&quot;/usr/local/nginx/sbin/nginx&quot;prog=$(basename $nginx) NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot; [ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx lockfile=/var/lock/subsys/nginx make_dirs() &#123; # make required directories user=`nginx -V 2&gt;&amp;1 | grep &quot;configure arguments:&quot; | sed &apos;s/[^*]*--user=\([^ ]*\).*/\1/g&apos; -` options=`$nginx -V 2&gt;&amp;1 | grep &apos;configure arguments:&apos;` for opt in $options; do if [ `echo $opt | grep &apos;.*-temp-path&apos;` ]; then value=`echo $opt | cut -d &quot;=&quot; -f 2` if [ ! -d &quot;$value&quot; ]; then # echo &quot;creating&quot; $value mkdir -p $value &amp;&amp; chown -R $user $value fi fi done&#125; start() &#123; [ -x $nginx ] || exit 5 [ -f $NGINX_CONF_FILE ] || exit 6 make_dirs echo -n $&quot;Starting $prog: &quot; daemon $nginx -c $NGINX_CONF_FILE retval=$? echo [ $retval -eq 0 ] &amp;&amp; touch $lockfile return $retval&#125; stop() &#123; echo -n $&quot;Stopping $prog: &quot; killproc $prog -QUIT retval=$? echo [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile return $retval&#125; restart() &#123; configtest || return $? stop sleep 1 start&#125; reload() &#123; configtest || return $? echo -n $&quot;Reloading $prog: &quot; killproc $nginx -HUP RETVAL=$? echo&#125; force_reload() &#123; restart&#125; configtest() &#123; $nginx -t -c $NGINX_CONF_FILE&#125; rh_status() &#123; status $prog&#125; rh_status_q() &#123; rh_status &gt;/dev/null 2&gt;&amp;1&#125; case &quot;$1&quot; in start) rh_status_q &amp;&amp; exit 0 $1 ;; stop) rh_status_q || exit 0 $1 ;; restart|configtest) $1 ;; reload) rh_status_q || exit 7 $1 ;; force-reload) force_reload ;; status) rh_status ;; condrestart|try-restart) rh_status_q || exit 0 ;; *) echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot; exit 2esac 6ï¼‰ä¿®æ”¹nginxæ–‡ä»¶çš„æƒé™ å‘½ä»¤ ï¼š chmod +x nginx 7ï¼‰å°†æ–‡ä»¶æ·»åŠ åˆ°ç³»ç»ŸæœåŠ¡ä¸­ chkconfig â€“add nginx 8ï¼‰éªŒè¯ chkconfig â€“list nginx 9ï¼‰å¯åŠ¨|åœæ­¢æœåŠ¡ service nginx start|stop 4ã€è´Ÿè½½å‡è¡¡é…ç½®1ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š å‘½ä»¤ ï¼š vim /usr/local/nginx/conf/nginx.conf å…·ä½“è´Ÿè½½é…ç½®ï¼š 1234567891011121314151617181920212223242526272829303132333435363738ï¼ˆ1ï¼‰ï¼ˆé»˜è®¤ï¼‰è½®è¯¢è´Ÿè½½http &#123; upstream shsxt&#123; server node01; server node02; &#125; server &#123; listen 80; server_name localhost; location / &#123; proxy_pass http://shsxt; &#125; &#125; &#125;ï¼ˆ2ï¼‰åŠ æƒè´Ÿè½½upstream shsxt&#123; server sxt1.com weight=3; server sxt2.com;&#125;(3)æœ€å°‘è¿žæŽ¥è´Ÿè½½upstream shsxt&#123; least_conn; servcer node01; server node02;&#125;(4)ip_hashè´Ÿè½½ï¼ˆä¿æŒå›žè¯æŒä¹…æ€§ï¼‰upstream shsxt&#123; ip_hash; server node01; server node02;&#125;3. è®¿é—®æŽ§åˆ¶ï¼ˆallow ä»£è¡¨å…è®¸å…¶è®¿é—®ï¼Œdeny ç¦æ­¢å…¶è®¿é—®ï¼‰location / &#123; deny 192.168.4.29; allow 192.168.198.0/24; deny all; proxy_pass http://shsxt;&#125; 5ã€sessionä¸€è‡´æ€§é—®é¢˜ å®žçŽ°sessionå…±äº«å³å¯è§£å†³è¿™ä¸ªé—®é¢˜ å®žçŽ°å·¥å…·ï¼šmemcached ä½œç”¨ï¼šä¸“é—¨ç®¡ç†sessionçš„å·¥å…· 1ï¼‰åœ¨tomcatçš„libç›®å½•ä¸‹å¯¼å…¥è¿žæŽ¥memcachedæ‰€éœ€çš„jaråŒ… asm-3.2.jar kryo-1.04.jar kryo-serializers-0.11.jar memcached-session-manager-1.7.0.jar memcached-session-manager-tc7-1.8.1.jar minlog-1.2.jar msm-kryo-serializer-1.7.0.jar reflectasm-1.01.jar spymemcached-2.7.3.jar 2ï¼‰åœ¨tomcatçš„confç›®å½•ä¸‹ç¼–è¾‘context.xmlæ–‡ä»¶ 1234567&lt;Manager className="de.javakaffee.web.msm.MemcachedBackupSessionManager" memcachedNodes="n1:192.168.17.9:11211" sticky="true" lockingMode="auto" sessionBackupAsync="false" requestUriIgnorePattern=".*\.(ico|png|gif|jpg|css|js)$"sessionBackupTimeout="1000" transcoderFactoryClass="de.javakaffee.web.msm.serializer.kryo.KryoTranscoderFactory" /&gt; ï¼ˆæ³¨æ„ï¼šé…ç½®memcachedNodeså±žæ€§æ—¶ï¼Œé…ç½®å…¶ipå’Œç«¯å£ï¼Œé»˜è®¤ä¸º11211ï¼Œå­˜åœ¨å¤šä¸ªmemecacahedæ•°æ®åº“æ—¶ï¼Œç”¨éƒ½é€—å·éš”å¼€ï¼‰ 3ï¼‰éªŒè¯sessionï¼šä¿®æ”¹index.jspï¼ˆåœ¨/usr/soft/apache-tomcat-8.5.24/webapps/ROOT/index.jspï¼‰ï¼Œå–sessionidçœ‹ä¸€çœ‹ 12345SessionID:&lt;%=session.getId()%&gt;&lt;/br&gt;SessionIP:&lt;%=request.getServerName()%&gt;&lt;/br&gt;&lt;h1&gt;tomcat1&lt;/h1&gt; 4)å®‰è£…ï¼š memcached å‘½ä»¤ ï¼šyum install memcached â€“y 5ï¼‰å¯åŠ¨memcached (IPåœ°å€ä¸ºmemcachedå®‰è£…çš„èŠ‚ç‚¹çš„IPåœ°å€) memcached -d -m 128m -p 11211 -l 192.168.198.128 -u root -P /tmp/ 6ï¼‰åœ¨æµè§ˆå™¨æ®µè®¿é—®æœåŠ¡å™¨ï¼Œé»˜è®¤ç«¯å£ ï¼š 80 ï¼Œå¯¹æ­¤æµ‹éªŒï¼Œå°±ä¼šå‘çŽ°sessionIDä¸ä¼šæ”¹å˜ ä¸‰ã€è™šæ‹Ÿä¸»æœº1ã€ä»€ä¹ˆæ˜¯è™šæ‹Ÿä¸»æœºï¼Ÿï¼ˆ1ï¼‰æ˜¯æŒ‡åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Šåˆ†å‡ºä¸€å®šçš„ç£ç›˜ç©ºé—´ï¼Œç§Ÿç»™ç”¨æˆ·ä»¥æ”¾ç½®ç«™ç‚¹ä»¥åŠåº”ç”¨ç©ºé—´ï¼Œå¹¶æä¾›å¿…è¦çš„å­˜å‚¨å’Œä¼ è¾“åŠŸèƒ½ã€‚ ï¼ˆ2ï¼‰æ˜¯è¢«è™šæ‹ŸåŒ–çš„é€»è¾‘ä¸»æœºï¼Œä¹Ÿå¯ç†è§£ä¸ºå°±æ˜¯æŠŠä¸€å°ç‰©ç†æœåŠ¡å™¨åˆ’åˆ†æˆå¤šä¸ªâ€œè™šæ‹Ÿâ€œçš„æœåŠ¡å™¨ï¼Œå„ä¸ªè™šæ‹Ÿä¸»æœºä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œå¯¹å¤–ç•Œå‘ˆçŽ°çš„çŠ¶æ€ä¹ŸåŒå•ç‹¬ç‰©ç†ä¸»æœºè¡¨çŽ°å®Œå…¨ç›¸åŒã€‚ 2ã€è™šæ‹Ÿä¸»æœ‰å•¥ç‰¹ç‚¹ï¼Ÿï¼ˆ1ï¼‰å¤šå°è™šæ‹Ÿä¸»æœºå…±äº«ä¸€å°çœŸå®žä¸»æœºèµ„æºï¼Œå¤§å¹…åº¦é™ä½Žäº†ç¡¬ä»¶ã€ç½‘ç»œç»´æŠ¤ã€é€šä¿¡çº¿è·¯ç­‰çš„è´¹ç”¨ ï¼ˆ2ï¼‰ä¹Ÿå¤§å¤§ç®€åŒ–äº†æœåŠ¡å™¨ç®¡ç†çš„å¤æ‚æ€§ï¼› 3ã€è™šæ‹Ÿä¸»æœºæœ‰å“ªäº›ç±»åˆ«ï¼Ÿï¼ˆ1ï¼‰åŸºäºŽåŸŸå 1234567891011121314151617181920212223242526http &#123; upstream shsxt&#123; server node01; server node02; &#125; upstream bjsxt&#123; server node03; &#125; server &#123; listen 80; //è®¿é—®sxt2.comçš„æ—¶å€™ï¼Œä¼šæŠŠè¯·æ±‚å¯¼åˆ°bjsxtçš„æœåŠ¡å™¨ç»„é‡Œ server_name sxt2.com; location / &#123; proxy_pass http://bjsxt; &#125; &#125; server &#123; listen 80; //è®¿é—®sxt1.comçš„æ—¶å€™ï¼Œä¼šæŠŠè¯·æ±‚å¯¼åˆ°shsxtçš„æœåŠ¡å™¨ç»„é‡Œ server_name sxt1.com; location / &#123; proxy_pass http://shsxt; &#125; &#125; &#125; æ³¨æ„ï¼š ï¼ˆ1ï¼‰åŸºäºŽåŸŸåçš„è™šæ‹Ÿæœºä¸»æœº åœ¨æ¨¡æ‹Ÿåº”ç”¨åœºæ™¯æ—¶ï¼Œéœ€è¦åœ¨windowsç³»ç»Ÿçš„hostsæ–‡ä»¶é‡Œé…ç½®åŸŸåæ˜ å°„ã€‚ ï¼ˆC:\Windows\System32\drivers\etc\hosts ç»™IPå–åˆ«åï¼‰ å¦‚ï¼š192.168.198.130 sxt1.com ï¼ˆ2ï¼‰æ¯å°æœåŠ¡å™¨çš„Tomcatçš„ç«¯å£ä¸ä¸Žé…ç½®ä¸­çš„listenä¸€è‡´ï¼Œé‚£ä¹ˆwindowsç³»ç»Ÿæµè§ˆå™¨è®¿é—®æ—¶ï¼Œéœ€è¦åŠ ä¸ŠTomcatçš„ç«¯å£ï¼Œï¼ˆ192.168.198.128ï¼š8080ï¼‰ â€‹ å¦‚æžœä¸€è‡´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸åŠ Tomcatçš„ç«¯å£å› ä¸ºNginxæœåŠ¡å™¨é»˜è®¤ç«¯å£ä¸º80 ï¼ˆ2ï¼‰åŸºäºŽç«¯å£ 12345678910111213141516171819202122232425http &#123; upstream shsxt&#123; server node01; server node02; &#125; upstream bjsxt&#123; server node03 &#125; server &#123; //å½“è®¿é—®nginxçš„80ç«¯å£æ—¶ï¼Œå°†è¯·æ±‚å¯¼ç»™bjsxtç»„ listen 8080; server_name 192.168.198.128; location / &#123; proxy_pass http://bjsxt; &#125;&#125; server &#123; //å½“è®¿é—®nginxçš„81ç«¯å£æ—¶ï¼Œå°†è¯·æ±‚å¯¼ç»™shsxtç»„ listen 81; server_name 192.168.198.128; //nginxæœåŠ¡å™¨çš„IP location / &#123; proxy_pass http://shsxt; &#125; &#125; &#125; ï¼ˆ3ï¼‰åŸºäºŽIP ï¼šï¼ˆä¸å¸¸ç”¨ï¼‰ å››ã€æ­£å‘ä»£ç†å’Œåå‘ä»£ç†1ã€æ­£å‘ä»£ç†ç†è§£ï¼š ä»£ç†å®¢æˆ·ç«¯ï¼Œå¦‚é€šè¿‡VPN ï¼Œéšè—å®¢æˆ·ç«¯ï¼Œè®¿é—®ç›®æ ‡æœåŠ¡å™¨ï¼ˆæœåŠ¡ç«¯å¯è§ï¼‰ ä¸¾ä¾‹ï¼š å›½å†…ä¸èƒ½ç›´æŽ¥è®¿é—®è°·æ­Œï¼Œä½†æ˜¯å¯ä»¥è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨å¯ä»¥è®¿é—®è°·æ­Œã€‚ï¼ˆå°±æ˜¯ç¿»å¢™ï¼‰ ä½†æ˜¯ï¼Œéœ€è¦å®¢æˆ·ç«¯å¿…é¡»è®¾ç½®æ­£å‘ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¦çŸ¥é“æ­£å‘ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£ 2ã€åå‘ä»£ç†ç†è§£ï¼š ä»£ç†æœåŠ¡ç«¯ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆå¦‚Nginxï¼‰ï¼Œéšè—æœåŠ¡ç«¯ï¼Œåˆ†å‘å®¢æˆ·ç«¯çš„ä¸åŒè¯·æ±‚ï¼ˆå®¢æˆ·ç«¯å¯è§ï¼‰åˆ°å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ ä¸¾ä¾‹ï¼š å¦‚æˆ‘ä»¬è®¿é—®www.baidu.comçš„æ—¶å€™ï¼Œå®ƒèƒŒåŽæœ‰å¾ˆå¤šå°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“å…·ä½“æ˜¯å“ªä¸€å°æœåŠ¡å™¨ç»™ä½ æä¾›çš„æœåŠ¡ï¼Œåªè¦çŸ¥é“åå‘ä»£ç†æœåŠ¡å™¨æ˜¯è°å°±å¥½äº†ï¼Œåå‘ä»£ç†æœåŠ¡å™¨å°±ä¼šæŠŠæˆ‘ä»¬çš„è¯·æ±‚è½¬å‘åˆ°çœŸå®žæœåŠ¡å™¨ä¸Šã€‚ Nginxå°±æ˜¯æ€§èƒ½å¾ˆå¥½çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨æ¥ä½œè´Ÿè½½å‡è¡¡ã€‚]]></content>
      <categories>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>è´Ÿè½½å‡è¡¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‰‹åŠ¨å®‰è£…mavenåæ ‡ä¾èµ–]]></title>
    <url>%2F2018%2F12%2F28%2F%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85maven%E5%9D%90%E6%A0%87%E4%BE%9D%E8%B5%96%2F</url>
    <content type="text"><![CDATA[ä¸€ã€äº‹ä»¶åŽŸå› ï¼šå­¦ä¹ quartzæ¡†æž¶æ—¶ï¼Œåœ¨mavené¡¹ç›®çš„pom.xmlæ–‡ä»¶ä¸­æ·»åŠ quartzæ‰€éœ€è¦çš„åæ ‡ä¾èµ–æ—¶ï¼Œæ˜¾ç¤ºjaråŒ…ä¸å­˜åœ¨ã€‚ 12345678910111213æç¤ºï¼š"Dependency 'xxxxâ€˜ not found"ï¼Œ å¹¶ä¸”æ·»åŠ çš„å¦‚ä¸‹ä¸¤ä¸ªåæ ‡ä¾èµ–å‡æŠ¥çº¢ã€‚ &lt;dependency&gt; &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; &lt;artifactId&gt;quartz&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- å·¥å…· --&gt; &lt;dependency&gt; &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; &lt;artifactId&gt;quartz-jobs&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; åˆ†æžï¼š 1ã€mavené¡¹ç›®æ‰€éœ€è¦çš„jaråŒ…å‡å­˜æ”¾åœ¨mavençš„F:\m2\repository(é¡¹ç›®æ‰€éœ€çš„jaråŒ…ä»“åº“)æ–‡ä»¶å¤¹ä¸­ 2ã€åœ¨F:\apache-maven-3.5.4\confçš„settings.xmlæ–‡ä»¶ä¸­æœ‰å¦‚ä¸‹è®¾ç½®ï¼šï¼ˆç”±äºŽä½¿ç”¨è¿œç¨‹ä»“åº“å¤ªæ…¢ï¼Œé˜¿é‡Œäº‘ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªé•œåƒä»“åº“ï¼Œä¾¿äºŽæˆ‘ä»¬ä½¿ç”¨ï¼Œä¸”åªåŒ…å«centralä»“åº“ä¸­çš„jarï¼‰ 1234567&lt;!--æ–‡ä»¶ä¸­åŽŸæœ‰çš„é…ç½®ï¼šè¿œç¨‹ä»“åº“---&gt;&lt;mirror&gt; &lt;id&gt;mirrorId&lt;/id&gt; &lt;mirrorOf&gt;repositoryId&lt;/mirrorOf&gt; &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt; &lt;url&gt;http://my.repository.com/repo/path&lt;/url&gt; &lt;/mirror&gt; 1234567&lt;!--æ–‡ä»¶ä¸­è‡ªå·±æ‰‹åŠ¨é…ç½®ï¼šé˜¿é‡Œé•œåƒä»“åº“---&gt;&lt;mirror&gt; &lt;id&gt;nexus-aliyun&lt;/id&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;name&gt;Nexus aliyun&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt; &lt;/mirror&gt; 3.å¯æ˜¯æˆ‘ä»¬åœ¨https://mvnrepository.com/ï¼ˆmavenä»“åº“ï¼‰ä¸­å‘çŽ°æœ‰æˆ‘ä»¬è¦çš„jaråŒ…ï¼Œè€Œä¸”å°±åœ¨Centralä»“åº“é‡Œï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¾ˆå¥‡æ€ªäº†ï¼ŒåŽæ¥å°±é€‰æ‹©è¿˜æ˜¯æ‰‹åŠ¨å®‰è£…jaråŒ…å§ ï¼ˆå¦‚æžœæœ‰å°ä¼™ä¼´æœ‰åˆ«çš„è§£å†³æ–¹æ¡ˆï¼Œè¿˜è¯·æŒ‡ç‚¹ä¸€äºŒã€‚ï¼‰ 1&lt;!--more--&gt; äºŒã€è§£å†³æ–¹æ¡ˆ1ã€é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä»Žmaven Repositoryä¸­ä¸‹è½½æˆ‘ä»¬éœ€è¦çš„jaråŒ…ï¼ˆéœ€è¦çš„ä¸¤ä¸ªjaråŒ…ï¼Œä¸‹è½½åŽŸç†ç›¸åŒï¼‰ 2ã€æ³¨æ„æˆ‘ä»¬çš„mavenå®‰è£…ï¼Œéœ€è¦é…ç½®çŽ¯å¢ƒå˜é‡ï¼Œæ‰èƒ½åœ¨dosçª—å£ï¼ŒæŒ‡ä»¤å®‰è£…jaråŒ… å› ä¸ºæˆ‘ä¹‹å‰æŸ¥èµ„æ–™æ—¶ï¼Œæœ‰å°ä¼™ä¼´è¯´ï¼Œjavaçš„çŽ¯å¢ƒå˜é‡é…ç½®ä¹Ÿä¼šå½±å“ï¼Œæ‰€ä»¥ï¼Œæˆ‘åœ¨è¿™é‡Œä¹ŸæŠŠjavaçš„çŽ¯å¢ƒå˜é‡é…ç½®ä¹Ÿè´´å‡ºæ¥ 1 1544699916763 1544699989775 JAVA_HOME F:\Java\jdk1.8.0_131ï¼ˆ æ ¹æ®è‡ªå·±çš„jdkå®‰è£…ç›®å½•ï¼‰ CLASSPATH .;%JAVA_HOME%\lib;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar MAVEN_HOME F:\apache-maven-3.5.4ï¼ˆ æ ¹æ®è‡ªå·±mavenå®‰è£…ç›®å½•ï¼‰ Pathï¼ˆæ³¨æ„é…ç½®çš„æ—¶å€™ï¼Œä¸€å®šè¦å’Œé…ç½®homeæ—¶çš„å˜é‡åä¸€è‡´ï¼Œå¦‚MAVEN_HOME,æˆ‘é…ç½®æˆäº†%MVN_HOME%\bin;ï¼‰ %JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;%MYSQL_HOME%\bin;%MAVEN_HOME%\bin; é…ç½®è¿™äº›çŽ¯å¢ƒå˜é‡ï¼Œåœ¨dosçª—å£æ‰èƒ½ä½¿java ï¼Œmvn ä¹‹ç±»çš„æŒ‡ä»¤å¯ä»¥ç”¨ï¼› å¦åˆ™ä¼šå‡ºçŽ°å¦‚ä¸‹æ˜¾ç¤ºã€‚ â€˜mvnâ€™ ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº (è¿™å°±æ˜¯çŽ¯å¢ƒå˜é‡æ²¡æœ‰é…æˆåŠŸçš„ç»“æžœ) 3.å®‰è£… C:\Users\Administrator&gt;mvn -v 1544701045091 C:\Users\Administrator&gt;mvn install:install-file -Dfile=F:/apache-maven-3.5.4/m2/quartz-2.3.0.jarï¼ˆjaråŒ…æ‰€åœ¨è·¯å¾„ï¼‰ -DgroupId=org.quartz-scheduler -DartifactId=quartz -Dversion=2.3.0 -Dpackaging=jar ï¼ˆæ ¹æ®ä¸‹é¢æ‰€ç¤ºçš„é…ç½®groupIdã€artifactIdã€versionï¼‰ 12345&lt;dependency&gt; &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; &lt;artifactId&gt;quartz&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; 1544702128551 å¦‚å›¾æ‰€ç¤ºï¼Œå®‰è£…æˆåŠŸã€‚ 1544702179172]]></content>
      <categories>
        <category>maven</category>
      </categories>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨Linuxå‘½ä»¤çš„å­¦ä¹ ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2018%2F12%2F28%2F%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[â€‹â€‹ [TOC] ä¸€ã€ç£ç›˜æŒ‡ä»¤ æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯ å‘½ä»¤ï¼šdf ï¼ˆé»˜è®¤å¤§å°ä»¥kbæ˜¾ç¤ºï¼‰ df -kï¼ˆä»¥kbä¸ºå•ä½ï¼‰ df -mï¼ˆ ä»¥mbä¸ºå•ä½ï¼‰ df â€“h ï¼ˆæ˜“äºŽé˜…è¯»ï¼‰ æŸ¥çœ‹æ–‡ä»¶/ç›®å½•çš„å¤§å° å‘½ä»¤ï¼šdu filename|foldername ï¼ˆé»˜è®¤å•ä½ä¸ºkbï¼‰-k kbå•ä½ -m mbå•ä½ -a æ‰€æœ‰æ–‡ä»¶å’Œç›®å½• -h æ›´æ˜“äºŽé˜…è¯» â€‹ --max-depth=0 ç›®å½•æ·±åº¦ äºŒã€ç½‘ç»œæŒ‡ä»¤ æŸ¥çœ‹ç½‘ç»œé…ç½®ä¿¡æ¯ å‘½ä»¤:ifconfig æµ‹è¯•ä¸Žç›®æ ‡ä¸»æœºçš„è¿žé€šæ€§ å‘½ä»¤ï¼šping remote_ip ctrl + c :ç»“æŸpingè¿›ç¨‹ æ˜¾ç¤ºå„ç§ç½‘ç»œç›¸å…³ä¿¡æ¯ å‘½ä»¤ï¼šnetstat æŸ¥çœ‹ç«¯å£å·ï¼ˆæ˜¯å¦è¢«å ç”¨ï¼‰ (1)ã€lsof -i:ç«¯å£å· ï¼ˆéœ€è¦å…ˆå®‰è£…lsofï¼‰ (2)ã€netstat -tunlp|grep ç«¯å£å· æµ‹è¯•è¿œç¨‹ä¸»æœºçš„ç½‘ç»œç«¯å£ å‘½ä»¤ï¼š telnet ip port ï¼ˆéœ€è¦å…ˆå®‰è£…telnetï¼‰ æµ‹è¯•æˆåŠŸåŽï¼ŒæŒ‰ctrl + ] é”®ï¼Œç„¶åŽå¼¹å‡ºtelnet&gt;æ—¶ï¼Œå†æŒ‰qé€€å‡º httpè¯·æ±‚æ¨¡æ‹Ÿ curl -X get www.baidu.com æ¨¡æ‹Ÿè¯·æ±‚ç™¾åº¦ ä¸‰ã€ç³»ç»Ÿç®¡ç†æŒ‡ä»¤ ç”¨æˆ·æ“ä½œ 12345678910 æ“ä½œ å‘½ä»¤åˆ›å»ºç”¨æˆ· useradd|adduser usernameä¿®æ”¹å¯†ç  passwd usernameåˆ é™¤ç”¨æˆ· userdel â€“r usernameä¿®æ”¹ç”¨æˆ·ï¼ˆå·²ä¸‹çº¿ï¼‰ï¼š ä¿®æ”¹ç”¨æˆ·å: usermod â€“l new_name oldname é”å®šè´¦æˆ·: usermod â€“L username è§£é™¤è´¦æˆ·ï¼š usermod â€“U usernameæŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ· ä»…root ç”¨æˆ·ï¼šwhoami | cat /etc/shadow æ™®é€šç”¨æˆ·ï¼šcat /etc/pqsswd ç”¨æˆ·ç»„æ“ä½œ 12345 æ“ä½œ å‘½ä»¤ åˆ›å»ºç”¨æˆ·ç»„ groupadd groupnameåˆ é™¤ç”¨æˆ·ç»„ groupdel groupnameä¿®æ”¹ç”¨æˆ·ç»„ groupmod â€“n new_name old_nameæŸ¥çœ‹ç”¨æˆ·ç»„ groups ï¼ˆæŸ¥çœ‹çš„æ˜¯å½“å‰ç”¨æˆ·æ‰€åœ¨çš„ç”¨æˆ·ç»„ï¼‰ ç”¨æˆ·+ç”¨æˆ·ç»„ 12345 æ“ä½œ å‘½ä»¤ ä¿®æ”¹ç”¨æˆ·çš„ä¸»ç»„ usermod â€“g groupname usernameç»™ç”¨æˆ·è¿½åŠ é™„åŠ ç»„ usermod â€“G groupname usernameæŸ¥çœ‹ç”¨æˆ·ç»„ä¸­ç”¨æˆ·æ•° cat /etc/groupæ³¨æ„ï¼šåˆ›å»ºç”¨æˆ·æ—¶ï¼Œç³»ç»Ÿé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªå’Œç”¨æˆ·åå­—ä¸€æ ·çš„ä¸»ç»„ ç³»ç»Ÿæƒé™ 12345678910 æ“ä½œ å‘½ä»¤ æŸ¥çœ‹/usrä¸‹æ‰€æœ‰æƒé™ ll /usr æƒé™ç±»åˆ« rï¼ˆè¯»å–ï¼š4ï¼‰ wï¼ˆå†™å…¥ï¼š2ï¼‰ xï¼ˆæ‰§è¡Œï¼š1ï¼‰ ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œæ— æƒé™ç”¨ â€”ä»£æ›¿ UGOæ¨¡åž‹ Uï¼ˆUserï¼‰ G(Group) O(å…¶ä»–)æƒé™ä¿®æ”¹ ä¿®æ”¹æ‰€æœ‰è€…ï¼šchown username file|folder (é€’å½’)ä¿®æ”¹æ‰€æœ‰è€…å’Œæ‰€å±žç»„ï¼š chown -r usernameï¼šgroupname file|folder ä¿®æ”¹æ‰€å±žç»„ï¼šchgrp groupname file|folder ä¿®æ”¹æƒé™ï¼šchmod ugo+rwx file|folder å››ã€ç³»ç»Ÿé…ç½®æŒ‡ä»¤ 1.ä¿®æ”¹ä¸»æœºå 123 ç¼–è¾‘æ–‡ä»¶ï¼š å‘½ä»¤ï¼š vim /etc/sysconfig/network æ–‡ä»¶å†…å®¹ï¼š HOSTNAME=node00ï¼ˆé‡å¯ç”Ÿæ•ˆ)reboot 2.DNSé…ç½® 12ç¼–è¾‘æ–‡ä»¶ï¼š å‘½ä»¤ï¼švim /etc/resolv.confæ–‡ä»¶å†…å®¹ï¼š nameserver 192.168.198.0 3.sudoæƒé™é…ç½® 1234567891011121314151617 æ“ä½œ å‘½ä»¤ç¼–è¾‘æƒé™é…ç½®æ–‡ä»¶ï¼š vim /etc/sudoersæ ¼å¼ï¼š æŽˆæƒç”¨æˆ· ä¸»æœº=[(åˆ‡æ¢åˆ°å“ªäº›ç”¨æˆ·æˆ–ç”¨æˆ·ç»„)] [æ˜¯å¦éœ€è¦å¯†ç éªŒè¯] è·¯å¾„/å‘½ä»¤ä¸¾ä¾‹ï¼š test ALL=(root) /usr/bin/yum,/sbin/serviceè§£é‡Šï¼š testç”¨æˆ·å°±å¯ä»¥ç”¨yumå’Œservieå‘½ä»¤ï¼Œ ä½†æ˜¯ï¼Œä½¿ç”¨æ—¶éœ€è¦åœ¨å‰é¢åŠ ä¸Šsudoå†æ•²å‘½ä»¤ã€‚ ç¬¬ä¸€æ¬¡ä½¿ç”¨éœ€è¦è¾“å…¥ç”¨æˆ·å¯†ç ,ä¸”æ¯ä¸ªåäº”åˆ†é’Ÿéœ€è¦ä¸€æ¬¡å¯†ç éªŒè¯ä¿®æ”¹ï¼š test ALL=(root) NOPASSWD: /usr/bin/yum,/sbin/serviceè¿™æ ·å°±ä¸éœ€è¦å¯†ç äº†å°†æƒé™èµ‹äºˆæŸä¸ªç»„ï¼Œ%+ç»„å%group ALL=(root) NOPASSWD: /usr/bin/yum,/sbin/serviceåˆ—å‡ºç”¨æˆ·æ‰€æœ‰çš„sudoæƒé™ sudo â€“l 4.ç³»ç»Ÿæ—¶é—´ 12345678æ“ä½œ å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´ date ---æŸ¥çœ‹å½“å‰æ—¶é—´è¯¦æƒ… cal ---æŸ¥çœ‹å½“å‰æœˆæ—¥åŽ† cal 2018 ---æŸ¥çœ‹2018å¹´å®Œæ•´æ—¥åŽ† cal 12 2018 ---æŸ¥çœ‹æŒ‡å®šå¹´æœˆçš„æ—¥åŽ† æ›´æ–°ç³»ç»Ÿæ—¶é—´ï¼ˆæŽ¨èï¼‰ yum install ntpdate â€“y ---å®‰è£…ntpæœåŠ¡ ntpdate cn.ntp.org.cn ---åˆ°åŸŸåä¸ºcn.ntp.org.cnçš„æ—¶é—´æœåŠ¡å™¨ä¸ŠåŒæ­¥æ—¶é—´ 5.å…³äºŽhostsé…ç½® ç›¸å½“äºŽç»™IPåœ°å€å…¶åˆ«åï¼Œå¯ä»¥é€šè¿‡åˆ«åè®¿é—® è·¯å¾„ï¼š Windowsç³»ç»Ÿ C:/Windows/System32/drivers/etc/hosts æ–‡ä»¶ Linuxç³»ç»Ÿ /etc/hostsæ–‡ä»¶ï¼švim +è·¯å¾„ ç»Ÿä¸€ ç¼–è¾‘æ ¼å¼ IPåœ°å€ åˆ«åï¼š192.168.198.128 node00 6.å…³äºŽhostnameé…ç½® ç›¸å½“äºŽç»™å¯¹åº”çš„è™šæ‹Ÿæœºå™¨èµ·åˆ«å Linuxç³»ç»Ÿï¼š vi /etc/sysconfig/network ç¼–è¾‘å†…å®¹ï¼š HOSTNAME=node01 äº”ã€é‡å®šå‘ä¸Žç®¡é“ç¬¦ è¾“å‡ºé‡å®šå‘ è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶æˆ–è®¾å¤‡ï¼š &gt; è¦†ç›–åŽŸæ¥çš„æ–‡ä»¶ &gt;&gt; è¿½åŠ åŽŸæ¥çš„æ–‡ä»¶ ä¸¾ä¾‹ï¼š ls &gt; log â€” åœ¨logæ–‡ä»¶ä¸­åˆ—å‡ºæ‰€æœ‰é¡¹ï¼Œå¹¶è¦†ç›–åŽŸæ–‡ä»¶ echo â€œhelloâ€&gt;&gt;log â€”å°†helloè¿½åŠ åˆ°logæ–‡ä»¶ä¸­ è¾“å…¥é‡å®šå‘ &lt; è¾“å…¥é‡å®šå‘åˆ°ä¸€ä¸ªç¨‹åº ä¸¾ä¾‹ï¼šcat &lt; log â€”å°†logæ–‡ä»¶ä½œä¸ºcatå‘½ä»¤çš„è¾“å…¥ï¼ŒæŸ¥çœ‹logæ–‡ä»¶çš„å†…å®¹ æ ‡å‡† è¾“å‡º é‡å®šå‘ 1 &gt; æˆ– &gt; å«ä¹‰ï¼š è¾“å‡ºé‡å®šå‘æ—¶ï¼Œåªç”¨æ­£ç¡®çš„è¾“å‡ºæ‰ä¼šé‡å®šå‘åˆ°æŒ‡çš„æ–‡ä»¶ä¸­ é”™è¯¯çš„åˆ™ä¼šç›´æŽ¥æ‰“å°åˆ°å±å¹•ä¸Š é”™è¯¯ è¾“å‡º é‡å®šå‘ 2 &gt; å«ä¹‰ï¼š é”™è¯¯çš„è¾“å‡ºä¼šé‡å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶é‡Œï¼Œæ­£ç¡®çš„æ—¥å¿—åˆ™ç›´æŽ¥æ‰“å°åˆ°å±å¹•ä¸Šã€‚ ç»“åˆ ä½¿ç”¨ 2&gt;&amp;1 å«ä¹‰ï¼š å°†æ— è®ºæ˜¯æ­£ç¡®çš„è¾“å‡ºè¿˜æ˜¯é”™è¯¯çš„è¾“å‡ºéƒ½é‡å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶ ç®¡é“ **\ ** å«ä¹‰ï¼š æŠŠå‰ä¸€ä¸ªè¾“å‡ºå½“åšåŽä¸€ä¸ªè¾“å…¥ grep é€šè¿‡æ­£åˆ™æœç´¢æ–‡æœ¬ï¼Œå¹¶å°†åŒ¹é…çš„è¡Œæ‰“å°å‡ºæ¥ netstat -anp \ grep 22 æŠŠnetstat â€“anp å‘½ä»¤çš„è¾“å‡º å½“åšæ˜¯grep å‘½ä»¤çš„è¾“å…¥ å‘½ä»¤ æ‰§è¡Œ æŽ§åˆ¶ &amp;&amp; å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡ŒåŽä¸€ä¸ªå‘½ä»¤ **\ \ ** å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥æ‰ä¼šæ‰§è¡ŒåŽä¸€ä¸ªå‘½ä»¤]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linuxå‘½ä»¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨Linuxå‘½ä»¤çš„å­¦ä¹ ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2018%2F12%2F27%2F%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[[TOC] ä¸€ã€å‘½ä»¤æŒ‡å—ï¼ˆmanualï¼‰ï¼šman å®‰è£…ï¼šyum install man â€“y ï¼ˆ-y è¡¨ç¤ºèŽ·å¾—å…è®¸ï¼Œæ— éœ€ç¡®è®¤ï¼‰ æŸ¥çœ‹lså‘½ä»¤æŒ‡å—ï¼š man ls äºŒã€ç›®å½•å‘½ä»¤åˆ‡æ¢ç›®å½•ï¼šcd + ç›®å½•çš„è·¯å¾„ æŸ¥çœ‹å½“å‰ç›®å½•æ‰€åœ¨çš„å®Œæ•´è·¯å¾„ï¼špwd æ–°å»ºç›®å½•ï¼šmkdir +ç›®å½•åå­— æŸ¥çœ‹å½“å‰ç›®å½•æ‰€ç”¨æœ‰çš„å­ç›®å½•å’Œæ–‡ä»¶ï¼šls ï¼Œllç­‰ä»·äºŽ ls â€“l â€‹ æŸ¥çœ‹ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸œè¥¿ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰ï¼š ls â€“al ç­‰ä»·äºŽ ll -aâ€‹æ‹·è´ç›®å½•æˆ–æ–‡ä»¶ï¼šcp â€“r install.log install2.log åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ï¼šrm -r install.log (rmdiråªèƒ½åˆ é™¤ç©ºç›®å½•) ç§»åŠ¨ç›®å½•æˆ–æ–‡ä»¶ï¼šmv + ç›®å½•/æ–‡ä»¶åå­— + å…¶ä»–è·¯å¾„ â€‹ å°†testç›®å½•ç§»åŠ¨åˆ° æ ¹ç›®å½•/ ä¸‹ : mv test / ï¼ˆå¦‚æžœç§»åŠ¨åˆ°å½“å‰ç›®å½•ï¼Œç”¨å¦å¤–ä¸€ä¸ªåç§°ï¼Œåˆ™å¯ä»¥å®žçŽ°é‡å‘½åçš„æ•ˆæžœï¼‰ æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„åå­—ï¼šmv + æ—§ç›®å½•åå­— + æ–°ç›®å½•å ( -r ç”¨äºŽé€’å½’çš„æ‹·è´ï¼Œåˆ é™¤ï¼Œç§»åŠ¨ç›®å½•) ä¸‰ã€æ–‡ä»¶å‘½ä»¤1ã€ä¸€èˆ¬æ–‡ä»¶æ“ä½œæ–°å»ºæ–‡ä»¶ï¼štouch install.logâ€‹ (vim install.log ç¼–è¾‘æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶ï¼Œå¹¶è¿›å…¥æ–‡ä»¶çš„ç¼–è¾‘æ¨¡å¼ï¼Œå¦‚æžœæŒ‰ :wq ä¼šä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºï¼Œå¦‚æžœæŒ‰ :q åˆ™ä¸ä¿å­˜é€€å‡º)â€‹æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼šcat +ï¼ˆæ–‡ä»¶åï¼‰ï¼ˆä¸€æ¬¡æ€§æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæ–‡ä»¶å†…å®¹è¿‡å¤šæ—¶ç”¨æˆ·ä½“éªŒä¸å¥½ï¼‰ ä¸€æ¬¡å‘½ä»¤æ˜¾ç¤ºä¸€å±æ–‡æœ¬ï¼š 1234567 more +ï¼ˆæ–‡ä»¶åï¼‰ æŒ‰é”® æ•ˆæžœ Space æ˜¾ç¤ºä¸‹ä¸€å±æ–‡æœ¬å†…å®¹B æ˜¾ç¤ºä¸Šä¸€å±æ–‡æœ¬å†…å®¹Enter æ˜¾ç¤ºä¸‹ä¸€è¡Œæ–‡æœ¬å†…å®¹Q é€€å‡ºæŸ¥çœ‹ less+ï¼ˆæ–‡ä»¶åï¼‰ æŒ‰é”® æ•ˆæžœ h æ˜¾ç¤ºå¸®åŠ©ç•Œé¢ u å‘åŽæ»šåŠ¨åŠé¡µ d å‘å‰ç¿»åŠé¡µ e | Enter å‘åŽç¿»ä¸€è¡Œæ–‡æœ¬ space æ»šåŠ¨ä¸€é¡µ b å‘åŽç¿»ä¸€é¡µ [pagedown]ï¼š å‘ä¸‹ç¿»åŠ¨ä¸€é¡µ [pageup]ï¼š å‘ä¸Šç¿»åŠ¨ä¸€é¡µ ä¸Šä¸‹é”®ï¼Œå‘ä¸Šä¸€è¡Œï¼Œå‘ä¸‹ä¸€è¡Œ ä»Žå¤´æ‰“å°æ–‡ä»¶å†…å®¹ï¼šâ€‹ head -10 +ï¼ˆæ–‡ä»¶åï¼‰ æ‰“å°æ–‡ä»¶1åˆ°10è¡Œ ä»Žå°¾éƒ¨æ‰“å°æ–‡ä»¶å†…å®¹â€‹ tail -10 +ï¼ˆæ–‡ä»¶åï¼‰æ‰“å°æ–‡ä»¶æœ€åŽ10è¡Œ tail -f (æ–‡ä»¶å) å¸¸ç”¨äºŽæŸ¥çœ‹æ–‡ä»¶å†…å®¹çš„æ›´æ–°å˜åŒ– æŸ¥æ‰¾æ–‡ä»¶æˆ–ç›®å½•â€‹ find +ï¼ˆè·¯å¾„åï¼‰ â€“name +ï¼ˆæ–‡ä»¶åï¼‰â€‹ ä¸¾ä¾‹ï¼šfind / -name profileâ€‹ åœ¨/(æ ¹ç›®å½•)ç›®å½•ä¸‹æŸ¥æ‰¾ åå­—ä¸ºprofileçš„æ–‡ä»¶æˆ–ç›®å½• â€‹ ä¹Ÿå¯åˆ©ç”¨æ­£åˆ™ï¼šâ€‹ ä¸¾ä¾‹ï¼š find /etc -name pro*â€‹ åœ¨/etcç›®å½•ä¸‹æŸ¥æ‰¾ä»¥proå¼€å¤´çš„æ–‡ä»¶æˆ–ç›®å½• è·¯å¾„è¶Šç²¾ç¡®ï¼ŒæŸ¥æ‰¾çš„èŒƒå›´è¶Šå°ï¼Œé€Ÿåº¦è¶Šå¿« i 2ã€æ–‡ä»¶ç¼–è¾‘viï¼ˆ1ï¼‰ vi è¿›å…¥ç¼–è¾‘æ¨¡å¼ â€”â€“&gt;æŒ‰i è¿›å…¥æ’å…¥æ¨¡å¼ â€”â€”-&gt; æŒ‰Esc é€€å‡ºç¼–è¾‘æ¨¡å¼ 1234vi filename :æ‰“å¼€æˆ–æ–°å»ºæ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬ä¸€è¡Œé¦– vi +n filename ï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬nè¡Œé¦– vi + filename ï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽæœ€åŽä¸€è¡Œé¦– vi +/pattern filenameï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç½®äºŽç¬¬ä¸€ä¸ªä¸Ž patternåŒ¹é…çš„å­—ç¬¦ä¸²æ‰€åœ¨çš„è¡Œé¦– filename ä¸ºæ–‡ä»¶å ï¼ˆ2ï¼‰åœ¨æ–‡ä»¶viï¼ˆæ–‡ä»¶ç¼–è¾‘ï¼‰æ¨¡å¼ä¸‹ å‘½ä»¤è¡Œæ¨¡å¼ 123456789:w ä¿å­˜:q é€€å‡º:wq ä¿å­˜å¹¶é€€å‡º:q! å¼ºåˆ¶é€€å‡º:set nu |ctrl+g æ˜¾ç¤ºæ–‡æœ¬è¡Œæ•°:set nonu åŽ»é™¤æ˜¾ç¤ºçš„è¡Œæ•°:s/p1/p2/g å°†å½“å‰è¡Œä¸­æ‰€æœ‰p1å‡ç”¨p2æ›¿ä»£ :n1,n2s/p1/p2/g å°†ç¬¬n1è‡³n2è¡Œä¸­æ‰€æœ‰p1å‡ç”¨p2æ›¿ä»£ :g/p1/s//p2/g å°†æ–‡ä»¶ä¸­æ‰€æœ‰p1å‡ç”¨p2æ›¿æ¢ ä¸€èˆ¬æ¨¡å¼ 12345678910111213141516171819202122232425262728293031æŒ‰é”®ï¼šyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ(å¸¸ç”¨) nyy å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œçš„å‘ä¸‹nè¡Œï¼Œä¾‹å¦‚ï¼Œ 20yyåˆ™æ˜¯å¤åˆ¶20è¡Œ(å¸¸ç”¨) p|P pä¸ºå¤åˆ¶çš„æ•°æ®ç²˜è´´åœ¨å…‰æ ‡ä¸‹ä¸€è¡Œï¼Œ Påˆ™ä¸ºç²˜è´´åœ¨å…‰æ ‡ä¸Šä¸€è¡Œ(å¸¸ç”¨)G å…‰æ ‡ç§»è‡³ç¬¬æœ€åŽä¸€è¡ŒnG å…‰æ ‡ç§»åŠ¨è‡³ç¬¬Nè¡Œè¡Œé¦–n+ å…‰æ ‡ä¸‹ç§»nè¡Œ n- å…‰æ ‡ä¸Šç§»nè¡Œ H å…‰æ ‡ç§»è‡³å±å¹•é¡¶è¡Œ M å…‰æ ‡ç§»è‡³å±å¹•ä¸­é—´è¡Œ L å…‰æ ‡ç§»è‡³å±å¹•æœ€åŽè¡Œ dd åˆ é™¤æ‰€åœ¨è¡Œ xæˆ–X åˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œxåˆ é™¤å…‰æ ‡åŽçš„ï¼Œè€ŒXåˆ é™¤å…‰æ ‡å‰çš„ u æ’¤é”€(å¸¸ç”¨)åˆ é™¤ç¬¬Nè¡Œåˆ°ç¬¬Mè¡Œï¼šN,Mdï¼š,$-1d åˆ é™¤å½“å‰å…‰æ ‡åˆ°åˆ°æ•°ç¬¬ä¸€è¡Œæ•°æ®æŒ‰é”®ï¼š i: åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨å­—ç¬¦çš„å‰é¢ï¼Œè½¬ä¸ºè¾“å…¥æ¨¡å¼ï¼› a: åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨å­—ç¬¦çš„åŽé¢ï¼Œè½¬ä¸ºè¾“å…¥æ¨¡å¼ï¼› o: åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹æ–¹ï¼Œæ–°å»ºä¸€è¡Œï¼Œå¹¶è½¬ä¸ºè¾“å…¥æ¨¡å¼ï¼› Iï¼šåœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„è¡Œé¦–ï¼Œè½¬æ¢ä¸ºè¾“å…¥æ¨¡å¼ Aï¼šåœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„è¡Œå°¾ï¼Œè½¬æ¢ä¸ºè¾“å…¥æ¨¡å¼ Oï¼šåœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸Šæ–¹ï¼Œæ–°å»ºä¸€è¡Œï¼Œå¹¶è½¬ä¸ºè¾“å…¥æ¨¡å¼ï¼›---é€å­—ç¬¦ç§»åŠ¨ï¼šh: å·¦ l: å³j: ä¸‹ k: ä¸Š vim å®‰è£…ï¼šyum install vim -y ç”¨vim æ‰“å¼€/etc/profile æ–‡ä»¶ï¼Œ ç‰¹ç‚¹ï¼šç¼–è¾‘å™¨å¯¹æ–‡æœ¬çš„å†…å®¹è¿›è¡Œäº†é«˜äº®ï¼Œä½¿æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹å¯è¯»æ€§å¤§å¤§åŠ å¼º ï¼Œå…¶ä»–å‡ä¸Žviç›¸åŒ 3ã€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ å®‰è£…ä¸Šä¼ ä¸‹è½½å‘½ä»¤ï¼šyum install lrzsz -y ä¸Šä¼ æ–‡ä»¶ï¼šï¼ˆwindowsâ€”&gt;linuxï¼‰ å‘½ä»¤ ï¼šrz å¼¹å‡ºwindowsä¸Šä¼ æ–‡ä»¶çª—å£ ä¸‹è½½æ–‡ä»¶ï¼š(linuxâ€”&gt;windows) æ³¨æ„ï¼šszå‘½ä»¤åªèƒ½ä¸‹è½½æ–‡ä»¶ï¼Œä¸èƒ½ä¸‹è½½ç›®å½•ï¼ŒæŽ¨èå°†ç›®å½•åŽ‹ç¼©æˆtaråŒ…æˆ–ä½¿ç”¨å·¥å…·è½¯ä»¶ï¼šWinscpã€Xftpã€‘ å‘½ä»¤ï¼šsz ï¼ˆæ–‡ä»¶åï¼‰ å¼¹å‡ºwindowsä¸‹è½½çª—å£,ä¸‹è½½æ–‡ä»¶åˆ°æŒ‡å®šæ–‡ä»¶ç›®å½• 4ã€æ–‡ä»¶ä¼ è¾“(1)ã€æœ¬åœ°â†’è¿œç¨‹ æ–‡ä»¶ ï¼š scp local_file remote_username@remote_ip:remote_folder ç›®å½• ï¼š scp -r local_folder remote_username@remote_ip:remote_folder (2ï¼‰ã€è¿œç¨‹â†’æœ¬åœ° æ–‡ä»¶ ï¼š scp remote_username@remote_ip:remote_file local_folder ç›®å½• ï¼š scp remote_username@remote_ip:remote_folder local_folder]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linuxå‘½ä»¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸ç”¨Linuxå‘½ä»¤çš„å­¦ä¹ ï¼ˆä¸‰ï¼‰]]></title>
    <url>%2F2018%2F12%2F27%2F%E5%B8%B8%E7%94%A8Linux%E5%91%BD%E4%BB%A4%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%89%EF%BC%89%2F</url>
    <content type="text"><![CDATA[[TOC] ä¸€ã€æœåŠ¡æ“ä½œ åˆ—å‡º æ‰€æœ‰ æœåŠ¡ chkconfig æœåŠ¡ æ“ä½œ service æœåŠ¡å start\ stop\ status\ restart æ°¸ä¹…å…³é—­\ æ‰“å¼€ ï¼ˆå¯åŠ¨åŽç”Ÿæ•ˆï¼‰ chkconfig iptables on\ off æ·»åŠ  æœåŠ¡ 1) ç¼–è¾‘è„šæœ¬ï¼švim myservice.sh ç¼–è¾‘å†…å®¹ï¼š ï¼ˆåœ¨æœ€å‰é¢åŠ ä¸€ä¸‹ä¸¤å¥ï¼‰ #chkconfig: 2345 80 90 #description:auto_run (è‡ªå·±çš„æœåŠ¡è„šæœ¬ï¼šå¼€æœºæ—¶åŒæ­¥æ—¶é—´ï¼‰ result=â€™ntpdate cn.ntp.org.cnâ€™ é€€å‡ºç¼–è¾‘å¹¶ä¿å­˜ï¼šæŒ‰escé”® æŒ‰ ï¼šwq åœ¨ntpdate.logæ–‡ä»¶ä¸­è¾“å‡ºæ‰“å°ï¼šecho $result &gt; /usr/ntpdate.log 2) ä¿®æ”¹æƒé™ï¼Œä½¿å…¶æ‹¥æœ‰å¯æ‰§è¡Œæƒé™: chmod 700 myservice.sh 3) å°†è„šæœ¬æ‹·è´åˆ°/etc/init.dç›®å½•ï¼š 4) åŠ å…¥æœåŠ¡ï¼šchkconfig â€“add myservice.sh 5) é‡å¯æœåŠ¡å™¨ï¼ŒéªŒè¯æœåŠ¡æ˜¯å¦æ·»åŠ æˆåŠŸï¼šdate 6ï¼‰/usrç›®å½•ä¸‹äº§ç”Ÿntpdate.log åˆ é™¤ æœåŠ¡ chkconfig â€“del name æ›´æ”¹ æœåŠ¡åˆ æ‰§è¡Œ ç­‰çº§ chkconfig â€“level 2345 æœåŠ¡å off\ on chkconfig æœåŠ¡å on\ of f äºŒã€å®šæ—¶è°ƒåº¦ ç¼–è¾‘å®šæ—¶ä»»åŠ¡ crontab â€“e æ ¼å¼ï¼šminute hour day month dayofweek command ä¸¾ä¾‹ * echo â€œhelloâ€ æ¯åˆ†é’Ÿæ‰“å°â€œhelloâ€ æ—¶é—´ä¸€åˆ°ï¼Œæ‰§è¡Œæ“ä½œå‘½ä»¤åŽ ä¼šå‡ºçŽ°ï¼šYou have new mail in /var/spool/mail/root æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œæƒ…å†µ vim /var/spool/mail/root æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡ ll /var/spool/cron æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡ contab â€“l æ³¨æ„ â€œâ€ä»£è¡¨ä»»æ„çš„æ•°å­—, â€œ/â€ä»£è¡¨â€æ¯éš”å¤šä¹…â€, â€œ-â€ä»£è¡¨ä»ŽæŸä¸ªæ•°å­—åˆ°æŸä¸ªæ•°å­—, â€œ,â€åˆ†å¼€å‡ ä¸ªç¦»æ•£çš„æ•°å­— å¦‚ï¼š 30-40 12 echo â€œhelloâ€ â€”â€”â€“æ¯å¤©12ç‚¹30åˆ†è‡³40åˆ†æœŸé—´ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å‘½ä»¤ 30,40 â€”â€”â€“æ¯å¤©12ç‚¹30åˆ†å’Œ12ç‚¹40åˆ† 0/5 â€”â€”â€“æ¯å¤©çš„12ç‚¹æ•´è‡³12ç‚¹55åˆ†æœŸé—´ï¼Œæ¯éš”5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å‘½ä»¤ ä¸‰ã€è¿›ç¨‹æ“ä½œ æŸ¥çœ‹ è¿›ç¨‹ ps -aux -a åˆ—å‡ºæ‰€æœ‰ -u åˆ—å‡ºç”¨æˆ· -x è¯¦ç»†åˆ—å‡ºï¼Œå¦‚cpuã€å†…å­˜ç­‰ -e æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ -f å…¨æ ¼å¼ ps - ef \ grep ssh æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹é‡ŒCMDæ˜¯ssh çš„è¿›ç¨‹ä¿¡æ¯ ps -aux â€“sort â€“pcpu æ ¹æ® CPU ä½¿ç”¨æ¥å‡åºæŽ’åº ä½¿ç¨‹åº åŽå°è¿è¡Œ åªéœ€è¦åœ¨å‘½ä»¤åŽæ·»åŠ  &amp; ç¬¦å· echo â€œhelloâ€ &amp; jobs â€“l â€“åˆ—å‡ºå½“å‰è¿žæŽ¥çš„æ‰€æœ‰åŽå°è¿›ç¨‹ï¼ˆjobsä»…é€‚ç”¨äºŽå½“å‰ç«¯ï¼‰ ps -ef \ grep è¿›ç¨‹å â€”-ï¼ˆæŽ¨èï¼‰åˆ—å‡ºåŽå°è¿›ç¨‹ æ€æ­»è¿›ç¨‹ ï¼ˆå¼ºåˆ¶ï¼‰kill -9 pid â€”-pidä¸ºè¿›ç¨‹å· å››ã€å…¶ä»–å‘½ä»¤ wget 1ï¼‰ å®‰è£…ï¼šyum install wget â€“y 2ï¼‰ ç”¨æ³•ï¼šwget [option] ç½‘å€ -O æŒ‡å®šä¸‹è½½ä¿å­˜çš„è·¯å¾„ 3ï¼‰ ä¹Ÿå¯ç”¨äºŽåšçˆ¬è™« yum 1ï¼‰ å¤‡ä»½åŽŸé•œåƒï¼š cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOSBase.repo.backup 2ï¼‰ ä¸‹è½½æ–°é•œåƒï¼š wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo 3ï¼‰ æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼švim /etc/yum.repos.d/CentOS-Base.repo 4ï¼‰ ç”Ÿæˆç¼“å­˜ï¼šyum makecache rpm 1ï¼‰ å®‰è£… rpm â€“ivh rpmåŒ… 2ï¼‰ æŸ¥æ‰¾å·²å®‰è£…çš„rpmåŒ…ï¼šrpm â€“q ntp 3ï¼‰ å¸è½½ï¼šrpm â€“e ntp-4.2.6p5-10.el6.centos.2.x86_64ï¼ˆå…¨åï¼‰ tar 1ï¼‰ è§£åŽ‹ï¼štar -zvxf xxxx.tar.gz 2ï¼‰ åŽ‹ç¼©ï¼štar -zcf åŽ‹ç¼©åŒ…å‘½å åŽ‹ç¼©ç›®æ ‡ 3ï¼‰ ä¾‹å­ï¼štar -zcf tomcat.tar.gz apache-tomcat-7.0.61 4ï¼‰ -z gzipè¿›è¡Œè§£åŽ‹æˆ–åŽ‹ç¼©ï¼Œå¸¦.gzéœ€è¦åŠ ï¼ŒåŽ‹ç¼©å‡ºæ¥.gzä¹Ÿéœ€è¦åŠ  -x è§£åŽ‹ -c åŽ‹ç¼© -f ç›®æ ‡æ–‡ä»¶ï¼ŒåŽ‹ç¼©æ–‡ä»¶æ–°å‘½åæˆ–è§£åŽ‹æ–‡ä»¶å -v è§£åŽ‹ç¼©è¿‡ç¨‹ä¿¡æ¯æ‰“å° zip 1ï¼‰å®‰è£…zipï¼šyum install zip â€“y 2ï¼‰åŽ‹ç¼©å‘½ä»¤ï¼šzip -r åŒ…å ç›®æ ‡ç›®å½• 3ï¼‰å®‰è£… ï¼šunzip,yum install unzip â€“y 4ï¼‰è§£åŽ‹ ï¼šunzip filename äº”ã€å®‰è£…éƒ¨ç½² JDK éƒ¨ç½² 1) è§£åŽ‹: tar -zxf jdk-7u80-linux-x64.tar.gz 2) é…ç½®çŽ¯å¢ƒå˜é‡ ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼švim /etc/profile ç¼–è¾‘å†…å®¹ ï¼š JAVA_HOME= /usr/soft/jdk1.7.0_75 PATH=$PATH:$JAVA_HOME/bin 3) é‡æ–°åŠ è½½çŽ¯å¢ƒå˜é‡ï¼šsource /etc/profile 4) éªŒè¯: java -version mysqléƒ¨ç½² yumå®‰è£… mysql 1) yum install mysql-server -y 2) yum install mysql-devel -y 3) service mysqld start 4) mysql -uroot -p 5) mysqladmin -u root password 123456 å…­ã€å…å¯†ç™»å½•| æ³•ä¸€ | 1ï¼‰ ç”Ÿæˆå…¬é’¥å’Œå¯†é’¥ï¼šssh-keygen -t rsa ï¼Œå¹¶ä¸”å›žè½¦3æ¬¡ ï¼ˆåœ¨ç”¨æˆ·çš„æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª â€œ.sshâ€çš„æ–‡ä»¶å¤¹ï¼‰ 2ï¼‰ æŸ¥çœ‹å…¬é’¥å’Œç§é’¥ï¼šll ~/.ssh ï¼ˆç›®å½•ä¸­ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼‰ authorized_keys:å­˜æ”¾è¿œç¨‹å…å¯†ç™»å½•çš„å…¬é’¥,ä¸»è¦é€šè¿‡è¿™ä¸ªæ–‡ä»¶è®°å½•å¤šå°æœºå™¨çš„å…¬é’¥ id_rsa : ç”Ÿæˆçš„ç§é’¥æ–‡ä»¶ id_rsa.pub ï¼š ç”Ÿæˆçš„å…¬é’¥æ–‡ä»¶ know_hosts : å·²çŸ¥çš„ä¸»æœºå…¬é’¥æ¸…å• å¦‚æžœå¸Œæœ›sshå…¬é’¥ç”Ÿæ•ˆéœ€æ»¡è¶³è‡³å°‘ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼š 1&gt; .sshç›®å½•çš„æƒé™å¿…é¡»æ˜¯700 * 2&gt; .ssh/authorized_keysæ–‡ä»¶æƒé™å¿…é¡»æ˜¯600 3ï¼‰ å°†Açš„.sshç›®å½•ä¸‹çš„å…¬é’¥è¿½åŠ æ‹·è´åˆ°Bçš„authorized_keysæ–‡ä»¶é‡Œ scp -p ~/.ssh/id_rsa.pub root@&lt;remote_ip&gt;:/root/.ssh/authorized_keys 4) éªŒè¯ï¼šå°†æ–‡ä»¶è¿œç¨‹æ‹·è´åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼Œçœ‹æ˜¯å¦éœ€è¦å¯†ç  | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” :â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ ï¼ˆæ­¤æ–¹æ³•æœ‰å¾…è€ƒç©¶ï¼‰æ³•äºŒï¼šé€šè¿‡Ansibleå®žçŽ° æ‰¹é‡ å…å¯† 1ï¼‰ã€ å°†éœ€è¦åšå…å¯†æ“ä½œçš„æœºå™¨hostsæ·»åŠ åˆ°/etc/ansible/hostsä¸‹ï¼š [&nbsp;Avoid close] 192.168.91.132 192.168.91.133 192.168.91.134 2ï¼‰ã€ æ‰§è¡Œå‘½ä»¤è¿›è¡Œå…å¯†æ“ä½œ ï¼šâ€‹ 1ansible &lt;groupname&gt; -m authorized_key -a &quot;user=root key=&apos;&#123;&#123; lookup(&apos;file&apos;,&apos;/root/.ssh/id_rsa.pub&apos;) &#125;&#125;&apos;&quot; -k â€‹ |]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linuxå‘½ä»¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginxå…¥é—¨å­¦ä¹ ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2018%2F12%2F20%2FNginx%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E7%AC%AC%E4%BA%8C%E5%9B%9E%E5%90%88%EF%BC%89%2F</url>
    <content type="text"><![CDATA[2018å¹´12æœˆ20æ—¥ å‘¨å›› é˜´ ä¸€ã€è™šæ‹Ÿä¸»æœº1ã€ä»€ä¹ˆæ˜¯è™šæ‹Ÿä¸»æœºï¼Ÿï¼ˆ1ï¼‰æ˜¯æŒ‡åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Šåˆ†å‡ºä¸€å®šçš„ç£ç›˜ç©ºé—´ï¼Œç§Ÿç»™ç”¨æˆ·ä»¥æ”¾ç½®ç«™ç‚¹ä»¥åŠåº”ç”¨ç©ºé—´ï¼Œå¹¶æä¾›å¿…è¦çš„å­˜å‚¨å’Œä¼ è¾“åŠŸèƒ½ã€‚ ï¼ˆ2ï¼‰æ˜¯è¢«è™šæ‹ŸåŒ–çš„é€»è¾‘ä¸»æœºï¼Œä¹Ÿå¯ç†è§£ä¸ºå°±æ˜¯æŠŠä¸€å°ç‰©ç†æœåŠ¡å™¨åˆ’åˆ†æˆå¤šä¸ªâ€œè™šæ‹Ÿâ€œçš„æœåŠ¡å™¨ï¼Œå„ä¸ªè™šæ‹Ÿä¸»æœºä¹‹é—´å®Œå…¨ç‹¬ç«‹ï¼Œå¯¹å¤–ç•Œå‘ˆçŽ°çš„çŠ¶æ€ä¹ŸåŒå•ç‹¬ç‰©ç†ä¸»æœºè¡¨çŽ°å®Œå…¨ç›¸åŒã€‚ 2ã€è™šæ‹Ÿä¸»æœ‰å•¥ç‰¹ç‚¹ï¼Ÿï¼ˆ1ï¼‰å¤šå°è™šæ‹Ÿä¸»æœºå…±äº«ä¸€å°çœŸå®žä¸»æœºèµ„æºï¼Œå¤§å¹…åº¦é™ä½Žäº†ç¡¬ä»¶ã€ç½‘ç»œç»´æŠ¤ã€é€šä¿¡çº¿è·¯ç­‰çš„è´¹ç”¨ ï¼ˆ2ï¼‰ä¹Ÿå¤§å¤§ç®€åŒ–äº†æœåŠ¡å™¨ç®¡ç†çš„å¤æ‚æ€§ï¼› 3ã€è™šæ‹Ÿä¸»æœºæœ‰å“ªäº›ç±»åˆ«ï¼Ÿï¼ˆ1ï¼‰åŸºäºŽåŸŸå 1234567891011121314151617181920212223242526http &#123; upstream shsxt&#123; server node01; server node02; &#125; upstream bjsxt&#123; server node03; &#125; server &#123; listen 80; //è®¿é—®sxt2.comçš„æ—¶å€™ï¼Œä¼šæŠŠè¯·æ±‚å¯¼åˆ°bjsxtçš„æœåŠ¡å™¨ç»„é‡Œ server_name sxt2.com; location / &#123; proxy_pass http://bjsxt; &#125; &#125; server &#123; listen 80; //è®¿é—®sxt1.comçš„æ—¶å€™ï¼Œä¼šæŠŠè¯·æ±‚å¯¼åˆ°shsxtçš„æœåŠ¡å™¨ç»„é‡Œ server_name sxt1.com; location / &#123; proxy_pass http://shsxt; &#125; &#125; &#125; æ³¨æ„ï¼š ï¼ˆ1ï¼‰åŸºäºŽåŸŸåçš„è™šæ‹Ÿæœºä¸»æœº åœ¨æ¨¡æ‹Ÿåº”ç”¨åœºæ™¯æ—¶ï¼Œéœ€è¦åœ¨windowsç³»ç»Ÿçš„hostsæ–‡ä»¶é‡Œé…ç½®åŸŸåæ˜ å°„ã€‚ ï¼ˆC:\Windows\System32\drivers\etc\hosts ç»™IPå–åˆ«åï¼‰ å¦‚ï¼š192.168.198.130 sxt1.com ï¼ˆ2ï¼‰æ¯å°æœåŠ¡å™¨çš„Tomcatçš„ç«¯å£ä¸ä¸Žé…ç½®çš„listenä¸€è‡´ï¼Œé‚£ä¹ˆwindowsç³»ç»Ÿæµè§ˆå™¨è®¿é—®æ—¶ï¼Œéœ€è¦åŠ ä¸ŠTOmcatçš„ç«¯å£ï¼Œï¼ˆ192.168.198.128ï¼š8080ï¼‰ â€‹ å¦‚æžœä¸€è‡´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸åŠ Tomcatçš„ç«¯å£å› ä¸ºNginxæœåŠ¡å™¨é»˜è®¤ç«¯å£ä¸º80 ï¼ˆ2ï¼‰åŸºäºŽç«¯å£ 12345678910111213141516171819202122232425http &#123; upstream shsxt&#123; server node01; server node02; &#125; upstream bjsxt&#123; server node03 &#125; server &#123; //å½“è®¿é—®nginxçš„80ç«¯å£æ—¶ï¼Œå°†è¯·æ±‚å¯¼ç»™bjsxtç»„ listen 8080; server_name 192.168.198.128; location / &#123; proxy_pass http://bjsxt; &#125;&#125; server &#123; //å½“è®¿é—®nginxçš„81ç«¯å£æ—¶ï¼Œå°†è¯·æ±‚å¯¼ç»™shsxtç»„ listen 81; server_name 192.168.198.128; //nginxæœåŠ¡å™¨çš„IP location / &#123; proxy_pass http://shsxt; &#125; &#125; &#125; ï¼ˆ3ï¼‰åŸºäºŽIP ï¼šï¼ˆä¸å¸¸ç”¨ï¼‰ äºŒã€æ­£å‘ä»£ç†å’Œåå‘ä»£ç†1ã€æ­£å‘ä»£ç†ç†è§£ï¼š ä»£ç†å®¢æˆ·ç«¯ï¼Œå¦‚é€šè¿‡VPN ï¼Œéšè—å®¢æˆ·ç«¯ï¼Œè®¿é—®ç›®æ ‡æœåŠ¡å™¨ï¼ˆæœåŠ¡ç«¯å¯è§ï¼‰ ä¸¾ä¾‹ï¼š å›½å†…ä¸èƒ½ç›´æŽ¥è®¿é—®è°·æ­Œï¼Œä½†æ˜¯å¯ä»¥è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨å¯ä»¥è®¿é—®è°·æ­Œã€‚ï¼ˆå°±æ˜¯ç¿»å¢™ï¼‰ ä½†æ˜¯ï¼Œéœ€è¦å®¢æˆ·ç«¯å¿…é¡»è®¾ç½®æ­£å‘ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”è¦çŸ¥é“æ­£å‘ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£ 2ã€åå‘ä»£ç†ç†è§£ï¼š ä»£ç†æœåŠ¡ç«¯ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼ˆå¦‚Nginxï¼‰ï¼Œéšè—æœåŠ¡ç«¯ï¼Œåˆ†å‘å®¢æˆ·ç«¯çš„ä¸åŒè¯·æ±‚ï¼ˆå®¢æˆ·ç«¯å¯è§ï¼‰åˆ°å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ ä¸¾ä¾‹ï¼š å¦‚æˆ‘ä»¬è®¿é—®www.baidu.comçš„æ—¶å€™ï¼Œå®ƒèƒŒåŽæœ‰å¾ˆå¤šå°æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“å…·ä½“æ˜¯å“ªä¸€å°æœåŠ¡å™¨ç»™ä½ æä¾›çš„æœåŠ¡ï¼Œåªè¦çŸ¥é“åå‘ä»£ç†æœåŠ¡å™¨æ˜¯è°å°±å¥½äº†ï¼Œåå‘ä»£ç†æœåŠ¡å™¨å°±ä¼šæŠŠæˆ‘ä»¬çš„è¯·æ±‚è½¬å‘åˆ°çœŸå®žæœåŠ¡å™¨ä¸Šã€‚ Nginxå°±æ˜¯æ€§èƒ½å¾ˆå¥½çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨æ¥ä½œè´Ÿè½½å‡è¡¡ã€‚ ä¸‰ã€Nginxçš„sessionä¸€è‡´æ€§é—®é¢˜1ã€èƒŒæ™¯ï¼šhttpåè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œå¤šæ¬¡è®¿é—®å¦‚æžœæ˜¯ä¸åŒæœåŠ¡å™¨å“åº”è¯·æ±‚ï¼Œå°±ä¼šå‡ºçŽ°ä¸Šæ¬¡è®¿é—®ç•™ä¸‹çš„sessionæˆ–cookieå¤±æ•ˆã€‚è¿™å°±å¼•å‘äº†sessionå…±äº«çš„é—®é¢˜ã€‚ 2ã€Sessionä¸€è‡´æ€§è§£å†³æ–¹æ¡ˆï¼ˆ1ï¼‰â€“sessionå¤åˆ¶ tomcat æœ¬èº«å¸¦æœ‰å¤åˆ¶sessionçš„åŠŸèƒ½ã€‚ ï¼ˆ2ï¼‰-å…±äº«session éœ€è¦ä¸“é—¨ç®¡ç†sessionçš„è½¯ä»¶ï¼Œ memcached ç¼“å­˜æœåŠ¡ï¼Œå¯ä»¥å’Œtomcatæ•´åˆï¼Œå¸®åŠ©tomcatå…±äº«ç®¡ç†sessionã€‚ 3ã€å®‰è£…memcachedmemcached ï¼ˆåŒredisä¸€æ ·ï¼‰æ˜¯åŸºäºŽå†…å­˜çš„æ•°æ®åº“ 1ã€å®‰è£… yum â€“y install memcached å¯ä»¥ç”¨telnet localhost 11211 å¯åŠ¨ï¼š memcached -d -m 128m -p 11211 -l 192.168.235.113 -u root -P /tmp/ 2.webæœåŠ¡å™¨è¿žæŽ¥memcachedçš„jaråŒ…æ‹·è´åˆ°tomcatçš„libç›®å½•ä¸‹ è®¿é—®TomcatæœåŠ¡å™¨æœŸé—´äº§ç”Ÿçš„sessioné€šè¿‡ç›¸å…³jaråŒ…ï¼Œæ‰èƒ½å†™å…¥åˆ°memcachedæ•°æ®åº“ä¸­ memcached-session-manager-1.7.0.jar memcached-session-manager-tc7-1.8.1.jar 3.é…ç½®tomcatçš„confç›®å½•ä¸‹çš„context.xml 1234567&lt;Manager className="de.javakaffee.web.msm.MemcachedBackupSessionManager" memcachedNodes="n1:192.168.198.128:11211" sticky="true" lockingMode="auto" sessionBackupAsync="false" requestUriIgnorePattern=".*\.(ico|png|gif|jpg|css|js)$"sessionBackupTimeout="1000" transcoderFactoryClass="de.javakaffee.web.msm.serializer.kryo.KryoTranscoderFactory" /&gt; é…ç½®memcachedNodeså±žæ€§ï¼Œ é…ç½®memcachedæ•°æ®åº“çš„ipå’Œç«¯å£ï¼Œé»˜è®¤11211ï¼Œå¤šä¸ªçš„è¯ç”¨é€—å·éš”å¼€. ç›®çš„æ˜¯ä¸ºäº†è®©tomcatæœåŠ¡å™¨ä»Žmemcachedç¼“å­˜é‡Œé¢æ‹¿sessionæˆ–è€…æ˜¯æ”¾session å°†é…ç½®å®Œæˆçš„context.xmlå‘é€åˆ°å…¶ä»–è™šæ‹Ÿæœºå™¨ä¸Š scp -r context.xml root@node01:pwd æˆ– scp -r context.xml node01:pwd æˆ– scp -r context.xml root@192.168.198.130:pwd 4.ä¿®æ”¹tomcatç›®å½•ä¸­webapps/ROOTä¸‹çš„ index.jspï¼Œå–sessionidçœ‹ä¸€çœ‹ 12345678&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;&lt;html lang="en"&gt;SessionID:&lt;%=session.getId()%&gt;&lt;/br&gt;SessionIP:&lt;%=request.getServerName()%&gt;&lt;/br&gt;&lt;h1&gt;tomcat1&lt;/h1&gt;&lt;/html&gt;]]></content>
      <categories>
        <category>è´Ÿè½½å‡è¡¡</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2018%2F12%2F19%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
